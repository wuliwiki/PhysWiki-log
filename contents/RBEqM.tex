% 刚体的运动方程
% 刚体|运动方程|惯性张量|旋转矩阵|角动量|力矩

\pentry{刚体的平面运动方程\upref{RBEM}， 惯性张量\upref{ITensr}}

一般情况下下刚体的运动方程要比平面运动复杂许多， 但我们仍然可以将运动分解为质心的运动以及刚体绕质心的旋转， 前者由合力决定， 所以仍然有（\autoref{RBEM_eq1}~\upref{RBEM}）
\begin{equation}\label{RBEqM_eq8}
M\bvec a_c = \sum_i \bvec F_i
\end{equation}
所以相对于平面运动， 该问题的困难在于绕质心转动的计算． 虽然角动量定理（\autoref{AMLaw_eq1}~\upref{AMLaw}）仍然成立， 但惯性张量\upref{ITensr} $\mat I$ 随时间的变化会使问题复杂得多． 下面我们会看到， 刚体绕固定点转动的角动量定理可以记为
\begin{equation}\label{RBEqM_eq1}
\bvec\tau = \dot{\bvec L} = \bvec\omega \cross \bvec L + \mat I \dot{\bvec\omega}
\end{equation}
其中 $\dot{\bvec\omega} = \dv*{\bvec\omega}{t}$ 是矢量\textbf{角加速度}， 角速度和角加速度的关系可以类比速度和加速度\upref{VnA}． 本文中符号上方一点都表示对时间求导， 对矩阵和列矢量求导就是对每个元素分别求导．  对比平面运动的\autoref{RBEM_eq2}~\upref{RBEM}， 转动惯量变为了惯性张量， 且多了一项 $\bvec\omega \cross \bvec L$． 当二者共线时， 叉乘为零， 就回到了平面运动的式子．

\subsection{定点转动的方程}
我们接下来假设刚体可以绕坐标原点自由转动， 而原点未必是刚体的质心\footnote{例如我们考虑陀螺的运动时， 可以把它与地面的接触点作为旋转点（坐标原点）， 这会比把运动分解为质心的运动和绕质心的转动更方便． 但注意此时惯性张量也必须是关于旋转点而不是关于质心的， 详见\autoref{ITensr_exe2}~\upref{ITensr}．}． 当参考系为非惯性系时， 需要考虑惯性力带来的力矩\footnote{在平动参考系中， 如果取刚体的质心为原点， 可以证明惯性力产生的合力矩为零．}．

沿用\autoref{ITensr_sub1}~\upref{ITensr}中的符号规范， 令体坐标系中惯性张量为 $\mat I_0$， 体坐标系到实验室坐标系的旋转矩阵为 $\mat R$， 那么 $\mat R$ 和 $\bvec \omega$ 完整描述了刚体绕原点转动的\textbf{状态}， 其中 $\mat R$ 确定了刚体每一点的位置， 而 $\bvec \omega$ 进一步确定了刚体上每一点的速度． 若已知刚体在初始时间的运动状态， 且力矩 $\bvec \tau$ 是一个关于时间和刚体运动状态的已知函数 $\bvec \tau(t, \mat R, \bvec\omega)$， 那么求解以下运动方程可以得到刚体接下来的运动
\begin{equation}\label{RBEqM_eq6}
\dot{\bvec \omega} = \mat R \mat I_0^{-1} \mat R\Tr \qty[\bvec \tau  - \bvec\omega\cross(\mat R \mat I_0 \mat R\Tr \bvec\omega)]
\end{equation}
\begin{equation}\label{RBEqM_eq4}
\dot{\mat R} = \mat\Omega \mat R
\end{equation}
其中
\begin{equation}\label{RBEqM_eq5}
\mat\Omega = \pmat{0 & -\omega_z & \omega_y \\ \omega_z & 0 & -\omega_x\\ -\omega_y & \omega_x & 0}
\end{equation}
\autoref{RBEqM_eq6} 和\autoref{RBEqM_eq4} 组成一个非线性一阶常微分方程组， 写成标量的形式共有 12 条， 未知数分别为 $\omega_x, \omega_y, \omega_z$， $R_{i,j}$ 共 12 个．

事实上旋转矩阵 $\mat R$ 的 9 个矩阵元中只有三个自由度\upref{DoF}， 如果我们能用三个变量表示 $\mat R$， 就可以得到 6 元方程组． 一种方法是使用欧拉角（链接未完成）． 另一种折衷的方法是用 4 元数， 即用 4 个变量表示 $\mat R$， 可以得到相对简单的 7 元方程组， 详见 “刚体运动方程（四元数）\upref{RBEMQt}”．

\subsection{推导}
\pentry{旋转矩阵的导数\upref{RotDer}}

\autoref{RBEqM_eq4} 的含义和推导见 “旋转矩阵的导数\upref{RotDer}”． 而\autoref{RBEqM_eq6} 就是\autoref{RBEqM_eq1} 的变形：
\begin{equation}\label{RBEqM_eq7}
\dot{\bvec \omega} = \mat I^{-1} (\bvec\tau - \bvec\omega\cross\bvec L)
\end{equation}
这里的角动量要用惯性张量来计算（\autoref{ITensr_eq3}~\upref{ITensr} 和\autoref{ITensr_eq6}~\upref{ITensr}）
\begin{equation}\label{RBEqM_eq2}
\bvec L = \mat I \bvec \omega = \mat R \mat I_0 \mat R\Tr \bvec \omega
\end{equation}
其中 $\mat I_0$ 不随时间变化， $\bvec L$， $\bvec \omega$ 和 $\bvec R$ 都是时间的函数． 另外 $\mat I = \mat R \mat I_0 \mat R\Tr$ 的逆矩阵是 $\mat I^{-1} = \mat R \mat I_0^{-1} \mat R\Tr$， $\mat I_0^{-1}$ 是 $\mat I_0$ 的逆矩阵． \autoref{RBEqM_eq2} 代入\autoref{RBEqM_eq7} 就是\autoref{RBEqM_eq6}．

要证明\autoref{RBEqM_eq1}， 从角动量定理（\autoref{AMLaw_eq1}~\upref{AMLaw}）得
\begin{equation}\label{RBEqM_eq3}
\bvec \tau = \dot{\bvec L} = \dot{\mat I} \bvec\omega + \mat I \dot{\bvec\omega}
\end{equation}
其中
\begin{equation}
\begin{aligned}
\dot{\mat I}\bvec\omega &= \dv{t}(\mat R \mat I_0 \mat R\Tr)\bvec\omega
= \dot{\mat R} \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \dot{\mat R}\Tr \bvec\omega\\
&= \mat \Omega \mat R \mat I_0 \mat R\Tr \bvec\omega + \mat R \mat I_0 \mat R\Tr \mat \Omega\Tr \bvec\omega
= \mat \Omega \mat I \bvec\omega - \mat I \mat \Omega \bvec\omega\\
&= \bvec \omega \cross \bvec L - \mat I (\bvec\omega\cross\bvec\omega)
= \bvec \omega \cross \bvec L
\end{aligned}
\end{equation}
证毕．
