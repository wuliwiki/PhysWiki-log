% 柱坐标系中的矢量算符
% keys 柱坐标|梯度|散度|旋度|拉普拉斯|曲线坐标系
% license Xiao
% type Tutor

\begin{issues}
\issueDraft
\end{issues}

\pentry{正交曲线坐标系中的矢量算符\nref{nod_CVecOp}}{nod_6a61}
柱坐标系中标量函数 $u(r, \theta, z)$ 和矢量函数 $\bvec v(r, \theta, z)$ 的梯度， 散度， 旋度和拉普拉斯算符的公式如下。 其中 $r$、$\theta$ 是 $xOy$ 面上的极径和极角，$z$ 是竖坐标。

梯度
\begin{equation}
\grad u = \pdv{u}{r} \uvec r + \frac{1}{r}\pdv{u}{\theta}\uvec \theta + \pdv{u}{z}\uvec z~.
\end{equation}
散度
\begin{equation}
\div \bvec v = \frac{1}{r}\pdv{r} (r v_r) + \frac{1}{r} \pdv{v_\theta}{\theta} + \pdv{v_z}{z}~.
\end{equation}
旋度
\begin{equation}
\curl \bvec v = \qty(\frac{1}{r}\pdv{v_z}{\theta} - \pdv{v_\theta}{z})\uvec r + \qty(\pdv{v_r}{z} - \pdv{v_z}{r})\uvec \theta + \frac{1}{r}\qty[\pdv{r}(r v_\theta) - \pdv{v_r}{\theta}] \uvec z~.
\end{equation}
拉普拉斯算子
\begin{equation}\label{eq_CylNab_4}
\laplacian u = \frac{1}{r}\pdv{r}\qty(r \pdv{u}{r}) + \frac{1}{r^2} \pdv[2]{u}{\theta} + \pdv[2]{u}{z}~.
\end{equation}

\subsection{推导}
位置矢量 $\uvec r$ 在直角坐标系中展开为
\begin{equation}\label{eq_CylNab_1}
\bvec r(r, \theta, z) = r\cos\theta\, \uvec x + r\sin\theta\, \uvec y + z\uvec z~.
\end{equation}
柱坐标系中三个单位矢量 $\uvec r, \uvec \theta, \uvec z$ 的方向被定义为每个坐标单独增加时 $\bvec r$ 增加的方向， 即以下偏导数的方向
\begin{equation}\label{eq_CylNab_2}
\leftgroup{
\pdv{\bvec r}{r} &= \cos\theta\, \uvec x + \sin\theta\, \uvec y\\
\pdv{\bvec r}{\theta} &= -r\sin\theta\, \uvec x + r \cos\theta\, \uvec y\\
\pdv{\bvec r}{z} &= \uvec z
}~.\end{equation}
将这三个矢量归一化% \addTODO{相关文章中可以给一道例题}
， 就得到三个单位矢量
\begin{equation}\label{eq_CylNab_3}
\begin{cases}
\uvec r = \cos\theta\, \uvec x + \sin\theta\, \uvec y\\
\uvec \theta = -\sin\theta\, \uvec x + \cos\theta\, \uvec y\\
\uvec z = \uvec z
\end{cases}~.
\end{equation}

可见柱坐标系和直角坐标系中的 $\uvec z$ 相同， 而 $\uvec r, \uvec \theta$ 分别是 $\uvec x, \uvec y$ 绕 $z$ 轴逆时针旋转 $\theta$ 角所得。 所以尽管柱坐标系中的三个单位矢量的方向取决于坐标， 但它们始终两两垂直。 可见柱坐标系是一个\enref{正交曲线坐标系}{CurCor}。

现在我们可以将\autoref{eq_CylNab_1} 和\autoref{eq_CylNab_2} 用柱坐标中的三个单位矢量来表示。
\begin{equation}
\bvec r = r\uvec r + z\uvec z~,
\end{equation}
\begin{equation}\label{eq_CylNab_5}
\pdv{\bvec r}{r} = \uvec r \qquad \pdv{\bvec r}{\theta} = r\uvec \theta \qquad \pdv{\bvec r}{z} = \uvec z~.
\end{equation}
\addTODO{这样的基本公式应该放到 “柱坐标和直角坐标的转换” 里面}

与\enref{极坐标}{DPol1}的情况类似，将\autoref{eq_CylNab_3} 对 $\theta$ 求偏导可以得到单位矢量的偏导
\begin{equation}
\pdv{\uvec r}{\theta} = \uvec \theta \qquad
\pdv{\uvec \theta}{\theta} = -\uvec r \qquad
\pdv{\uvec z}{\theta} = \bvec 0~.
\end{equation}
根据\autoref{eq_CylNab_5} 和矢量函数的全微分，% \addTODO{链接}
柱坐标系中一段微小位移可记为
\begin{equation}\label{eq_CylNab_7}
\dd{\bvec r} = \pdv{\bvec r}{r}\dd{r} + \pdv{\bvec r}{\theta}\dd{\theta} + \pdv{\bvec r}{z}\dd{z} = \dd{r}\uvec r + r\dd{\theta} \uvec \theta + \dd{z} \uvec z~,
\end{equation}
代入\autoref{eq_CVecOp_4} 到\autoref{eq_CVecOp_6} 即可完成推导。
