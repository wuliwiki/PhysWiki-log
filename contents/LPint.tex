% 直线和平面的交点
% keys 立体几何|平面|直线|矢量|法向量

\pentry{高中解析立体几何， 几何矢量\upref{GVec}}

若平面上任意一点为 $\bvec p = (p_x, p_y, p_z)$， 法向量为 $\bvec n = (n_x, n_y, n_z)$。 直线上一点为 $\bvec s = (s_x, s_y, s_z)$， 方向为 $\bvec v = (v_x, v_y, v_z)$， 求射线与平面的交点。 注意 $\bvec n$ 和 $\bvec v$ 不必是单位矢量。

平面方程为
\begin{equation}\label{eq_LPint_2}
(\bvec r - \bvec p) \vdot \bvec n = 0~.
\end{equation}
直线的参数方程为
\begin{equation}\label{eq_LPint_1}
\bvec r = \lambda \bvec v + \bvec s~.
\end{equation}
\autoref{eq_LPint_1} 代入\autoref{eq_LPint_2} 解得
\begin{equation}
\lambda = \frac{(\bvec p - \bvec s)\vdot \bvec n}{\bvec v \vdot \bvec n}~.
\end{equation}
再代入\autoref{eq_LPint_1} 得交点为
\begin{equation}\label{eq_LPint_3}
\bvec r = \frac{(\bvec p - \bvec s)\vdot \bvec n}{\bvec v \vdot \bvec n} \bvec v + \bvec s~.
\end{equation}

（未完成： 给出 Matlab 代码）
