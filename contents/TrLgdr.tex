% 勒让德变换
% 勒让德变换|分部积分|平移性质|标度性质|反函数性质

\pentry{分部积分\upref{IntBP}}

勒让德变换的定义很多，有的定义虽然严谨却不易理解。本节采用其最方便理解的方式来定义。

\subsection{定义}

\subsubsection{单自变量勒让德变换}
\begin{definition}{}
给定一个实单自变量函数 $f(t)$，假设它是一个凸函数，即其导函数 $f'(t)$ 严格单调。将 $f'(t)$ 重命名为一个新的实变量 $s$，如果存在一个实函数 $g(s)$，使得 $g'(s)=t$，那么称 $g(s)$ 是 $f(t)$ 的\textbf{勒让德变换（Legendre transformation）}。
\end{definition}

简单来说，勒让德变换就是有两个函数，$f(t)$ 和 $g(s)$，它们使用不同的自变量，但是各自求导以后却能得到对方的自变量：$f'(t)=s$，$g'(s)=t$。这个关系是\textbf{对称}的，因此 $f(t)$ 也是 $g(s)$ 的勒让德变换。使用勒让德变换，可以把凸函数 $f(t)$ 所表示的某些性质改用 $g(s)$ 来表示，相当于用新自变量描述同样的信息。

如何求 $f(t)$ 勒让德变换呢？如果已知 $f(t)$ 的表达式，那么就可以计算出 $f'(t)=s$，由定义，$f'(t)$ 是一个单调函数，因此存在反函数 $F(s)=t$。由于 $g'(s)=t=F(s)$，我们就可以写出：
\begin{equation}
g(s)=\int t \dd{s}=\int F(s) \dd{s}
\end{equation}

许多情形下，我们并不知道 $f(t)$ 的显式表达，这个方法就可能并不适用。多亏了分部积分的结果，我们可以有以下简单的方式来得到一个函数的勒让德变换。


\subsubsection{与分部积分的关系}

假设 $f(t)$ 和 $g(s)$ 互为彼此的勒让德变换。由分部积分可得，
\begin{equation}
\begin{aligned}
\dd{ts}&=s\dd{t}+t\dd{s}\\&=f'(t)\dd{t}+g'(s)\dd{s}\quad\text{（这一步由勒让德变换得）}\\&=\dd{f}+\dd{g}
\end{aligned}
\end{equation}

这个结果说明，$\dd{g}=\dd{ts}-\dd{f}$，由此得
\begin{equation}
g=ts-f
\end{equation}

简单总结一下，把 $f(t)$ 变换成 $g(s)$ 的过程，就是用相互交换的两个元素 $t$ 和 $s$ 作乘积，再减去 $f$。注意 $t$ 和 $s$ 的关系是：$f'(t)=s$，$g'(s)=t$。

\subsubsection{多自变量勒让德变换}

把微分拓展到偏微分，我们可以自然地推广出多自变量的勒让德变换。

\begin{definition}{}\label{TrLgdr_def1}
给定一个实函数 $f(t_1, t_2, \cdots, t_n)$，假设对于任意 $i=1, 2, \cdots, n$，都有 $\pdv{t_i}f$ 是关于 $t_i$ 的凸函数。将 $\pdv{t_i}f$ 重命名为 $s_i$，如果存在 $g(s_1, s_2, \cdots, s_k, t_{k+1},\cdots, t_n)$，使得对于任意 $i=1,2,\cdots k$，都有 $\pdv{s_i}g=t_i$，那么称 $g$ 是 $f$ 替换了自变量 $t_1, \cdots, t_k$ 后的勒让德变换。
\end{definition}

同样地，多自变量勒让德变换也可以用分部积分来求得。如果 $g$ 是\autoref{TrLgdr_def1} 中所说的替换了前 $k$ 个 $t_i$ 的 $f$ 的勒让德变换，那么有：\begin{equation}\label{TrLgdr_eq1}
g=\sum\limits_{i=1,2,\cdots, k}t_is_i-f
\end{equation}

\subsection{勒让德变换的性质}

以下描述中，假设 $f_i(t)$ 的勒让德变换是 $g_i(t)$。

\begin{exercise}{标度性质}
证明：
\begin{itemize}
\item 如果 $f_2(t)=af_1(t)$，那么 $g_2(s)=ag_1(s/a)$，
\item 如果 $f_2(t)=f_1(at)$，那么 $g_2(s)=g_1(s/a)$。
\end{itemize}
\end{exercise}

\begin{corollary}{标度性质的推论}
如果 $f_1(t)$ 是一个 $m$ 次齐次函数\upref{Homeul}，那么 $g_1(s)$ 就是一个 $n$ 齐次函数，其中 $1/m+1/n=1$。
\end{corollary}

\begin{exercise}{平移性质}
证明：
\begin{itemize}
\item $f_2(t)=f_1(t)+c\Rightarrow g_2(s)=g_1(s)-c$，其中 $c$ 是任意常数，下同；
\item $f_2(t)=f_1(t+c)\Rightarrow g_2(s)=g_1(s)-cs$
\end{itemize}
\end{exercise}

\begin{exercise}{反函数性质}
证明：

$f_2(t)=f_1^{-1}(t)\Rightarrow g_2(s)=-sg_1(1/p)$
\end{exercise}








