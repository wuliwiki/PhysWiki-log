% 费曼-海尔曼定理（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Hellmann\%E2\%80\%93Feynman_theorem}{相关文章}。

在量子力学中，赫尔曼–费曼定理将总能量相对于某个参数的导数与哈密顿量对该参数的导数的期望值关联起来。根据该定理，一旦通过求解薛定谔方程确定了电子的空间分布，系统中的所有力都可以使用经典静电学来计算。

该定理已被许多作者独立证明，包括保罗·古廷格（1932年）、沃尔夫冈·泡利（1933年）、汉斯·赫尔曼（1937年）和理查德·费曼（1939年）。

定理表述为：
\[
\frac{\mathrm{d} E_{\lambda}}{\mathrm{d} \lambda} = \langle \psi_{\lambda} | \frac{\mathrm{d} \hat{H}_{\lambda}}{\mathrm{d} \lambda} | \psi_{\lambda} \rangle~
\]
其中：
\begin{itemize}
\item \(\hat{H}_{\lambda}\) 是一个依赖于连续参数 \(\lambda\) 的厄米算符，
\item \(|\psi_{\lambda} \rangle\) 是哈密顿量的本征态（本征函数），隐含地依赖于 \(\lambda\)，
\item \(E_{\lambda}\) 是状态 \(|\psi_{\lambda} \rangle\) 的能量（本征值），即 \(\hat{H}_{\lambda} |\psi_{\lambda} \rangle = E_{\lambda} |\psi_{\lambda} \rangle\)。
\end{itemize}
注意，在热力学极限下，赫尔曼-费曼定理在量子临界点附近会出现失效。[5]
\subsection{证明}
赫尔曼–费曼定理的证明要求波函数是所考虑的哈密顿量的本征函数；然而，也可以更一般地证明，该定理适用于所有对于所有相关变量（如轨道旋转）是定常的（偏导数为零）的非本征函数波函数。哈特里–福克波函数是一个重要的例子，它是一个近似的本征函数，但仍然满足赫尔曼–费曼定理。赫尔曼–费曼定理不适用的一个显著例子是有限阶的莫勒–普莱塞特微扰理论，因为它不是变分的。[6]

证明中还使用了一个归一化波函数的恒等式——波函数与自身的重叠的导数必须为零。使用狄拉克的bra-ket符号，这两个条件可以写作：
\[
\hat{H}_{\lambda} |\psi_{\lambda} \rangle = E_{\lambda} |\psi_{\lambda} \rangle,~
\]
\[
\langle \psi_{\lambda} | \psi_{\lambda} \rangle = 1 \Rightarrow \frac{\mathrm{d}}{\mathrm{d} \lambda} \langle \psi_{\lambda} | \psi_{\lambda} \rangle = 0.~
\]
然后，证明通过对哈密顿量的期望值应用导数乘积法则来进行，视哈密顿量为 \(\lambda\) 的函数：
\[
\frac{\mathrm{d} E_{\lambda}}{\mathrm{d} \lambda} = \frac{\mathrm{d}}{\mathrm{d} \lambda} \langle \psi_{\lambda} | \hat{H} |\psi_{\lambda} \rangle~
\]
\[
= \langle \frac{\mathrm{d} \psi_{\lambda}}{\mathrm{d} \lambda} | \hat{H} | \psi_{\lambda} \rangle + \langle \psi_{\lambda} | \hat{H} | \frac{\mathrm{d} \psi_{\lambda}}{\mathrm{d} \lambda} \rangle + \langle \psi_{\lambda} | \frac{\mathrm{d} \hat{H}}{\mathrm{d} \lambda} | \psi_{\lambda} \rangle~
\]
\[
= E_{\lambda} \langle \frac{\mathrm{d} \psi_{\lambda}}{\mathrm{d} \lambda} | \psi_{\lambda} \rangle + E_{\lambda} \langle \psi_{\lambda} | \frac{\mathrm{d} \psi_{\lambda}}{\mathrm{d} \lambda} \rangle + \langle \psi_{\lambda} | \frac{\mathrm{d} \hat{H}}{\mathrm{d} \lambda} | \psi_{\lambda} \rangle~
\]
\[
= E_{\lambda} \frac{\mathrm{d}}{\mathrm{d} \lambda} \langle \psi_{\lambda} | \psi_{\lambda} \rangle + \langle \psi_{\lambda} | \frac{\mathrm{d} \hat{H}}{\mathrm{d} \lambda} | \psi_{\lambda} \rangle~
\]
\[
= \langle \psi_{\lambda} | \frac{\mathrm{d} \hat{H}}{\mathrm{d} \lambda} | \psi_{\lambda} \rangle.~
\]
\subsection{替代证明}
赫尔曼–费曼定理实际上是变分原理（即瑞利–里茨变分原理）的直接结果，在此基础上可以推导出薛定谔方程。因此，赫尔曼–费曼定理适用于那些虽然不是哈密顿量的本征函数，但仍来源于变分原理的波函数（例如哈特里–福克波函数）。这也是为什么它适用于密度泛函理论的原因，密度泛函理论并非基于波函数，并且其标准推导并不适用。

根据瑞利–里茨变分原理，薛定谔方程的本征函数是泛函的驻点（简便起见，称为薛定谔泛函）：
\[
E[\psi, \lambda] = \frac{\langle \psi | \hat{H}_{\lambda} | \psi \rangle}{\langle \psi | \psi \rangle}.~
\]
本征值是在驻点处薛定谔泛函所取的值：
\[
E_{\lambda} = E[\psi_{\lambda}, \lambda],~
\]
其中，\(\psi_{\lambda}\) 满足变分条件：
\[
\left. \frac{\delta E[\psi, \lambda]}{\delta \psi (x)} \right|_{\psi = \psi_{\lambda}} = 0.~
\]
通过使用链式法则对公式（3）求导，可以得到以下公式：
\[
\frac{d E_{\lambda}}{d \lambda} = \frac{\partial E[\psi_{\lambda}, \lambda]}{\partial \lambda} + \int \frac{\delta E[\psi, \lambda]}{\delta \psi(x)} \frac{d \psi_{\lambda}(x)}{d \lambda} dx.~
\]
由于变分条件（公式4），公式（5）中的第二项为零。用一句话总结，赫尔曼–费曼定理表示，对于一个依赖于某个参数的函数（或泛函）的驻值对该参数的导数，只能通过显式的依赖关系计算，忽略隐式依赖关系。[citation needed] 由于薛定谔泛函只能通过哈密顿量显式地依赖外部参数，因此公式（1）显然成立。
\subsection{示例应用}
\subsubsection{分子力}
赫尔曼–费曼定理的最常见应用是计算分子中的分子内力。这使得可以计算平衡几何结构——即在此结构下，由电子和其他原子核作用于原子核的力为零的核坐标。参数 \(\lambda\) 对应于原子核的坐标。对于一个包含 \(1 \leq i \leq N\) 个电子，其坐标为 \(\{\mathbf{r}_i\}\)，以及 \(1 \leq \alpha \leq M\) 个原子核，每个原子核位于指定的点 \(\{\mathbf{R}_{\alpha} = \{X_{\alpha}, Y_{\alpha}, Z_{\alpha}\}\}\)，并且具有核电荷 \(Z_{\alpha}\)，其限制原子核哈密顿量为：
\[
\hat{H} = \hat{T} + \hat{U} - \sum_{i=1}^{N} \sum_{\alpha=1}^{M} \frac{Z_{\alpha}}{|\mathbf{r}_i - \mathbf{R}_{\alpha}|} + \sum_{\alpha}^M \sum_{\beta > \alpha}^M \frac{Z_{\alpha} Z_{\beta}}{|\mathbf{R}_{\alpha} - \mathbf{R}_{\beta}|}.~
\]
作用于给定原子核的力的 \(x\)-分量等于总能量对该坐标的导数的负值。通过应用赫尔曼–费曼定理，可以得到：
\[
F_{X_{\gamma}} = -\frac{\partial E}{\partial X_{\gamma}} = -\langle \psi | \frac{\partial \hat{H}}{\partial X_{\gamma}} | \psi \rangle.~
\]
只有两个哈密顿量的分量贡献于所需的导数——电子-原子核项和原子核-原子核项。对哈密顿量求导得到：
\[
\frac{\partial \hat{H}}{\partial X_{\gamma}} = \frac{\partial}{\partial X_{\gamma}} \left( - \sum_{i=1}^{N} \sum_{\alpha=1}^{M} \frac{Z_{\alpha}}{|\mathbf{r}_i - \mathbf{R}_{\alpha}|} + \sum_{\alpha}^M \sum_{\beta > \alpha}^M \frac{Z_{\alpha} Z_{\beta}}{|\mathbf{R}_{\alpha} - \mathbf{R}_{\beta}|} \right)~
\]
\[
= -Z_{\gamma} \sum_{i=1}^{N} \frac{x_i - X_{\gamma}}{|\mathbf{r}_i - \mathbf{R}_{\gamma}|^3} + Z_{\gamma} \sum_{\alpha \neq \gamma}^M Z_{\alpha} \frac{X_{\alpha} - X_{\gamma}}{|\mathbf{R}_{\alpha} - \mathbf{R}_{\gamma}|^3}.~
\]
将这个代入赫尔曼–费曼定理，可以得到给定原子核的 \(x\)-分量力，表示为电子密度 \(\rho(\mathbf{r})\) 和原子坐标及核电荷的形式：
\[
F_{X_{\gamma}} = Z_{\gamma} \left( \int \mathrm{d} \mathbf{r} \, \rho(\mathbf{r}) \frac{x - X_{\gamma}}{|\mathbf{r} - \mathbf{R}_{\gamma}|^3} - \sum_{\alpha \neq \gamma}^M Z_{\alpha} \frac{X_{\alpha} - X_{\gamma}}{|\mathbf{R}_{\alpha} - \mathbf{R}_{\gamma}|^3} \right).~
\]
关于赫尔曼–费曼定理在量子化学中的类似应用的全面调查，见 B. M. Deb（编辑）《化学中的力概念》，Van Nostrand Rheinhold，1981。
\subsubsection{期望值}
应用赫尔曼–费曼定理的另一种方法是将哈密顿量中出现的固定或离散的参数提升为连续变量，纯粹为了数学上求导的目的。可能的参数包括物理常数或离散的量子数。举个例子，氢类原子的径向薛定谔方程为：
\[
\hat{H}_l = - \frac{\hbar^2}{2\mu r^2} \left( \frac{d}{dr} \left( r^2 \frac{d}{dr} \right) - l(l+1) \right) - \frac{Ze^2}{r},~
\]
其中依赖于离散的方位量子数 \(l\)。将 \(l\) 提升为一个连续参数，便可对哈密顿量求导：
\[
\frac{\partial \hat{H}_l}{\partial l} = \frac{\hbar^2}{2\mu r^2}(2l+1).~
\]
赫尔曼–费曼定理随后允许确定氢类原子的 \(\frac{1}{r^2}\) 的期望值：
\[
\langle \psi_{nl} \left| \frac{1}{r^2} \right| \psi_{nl} \rangle = \frac{2\mu}{\hbar^2} \frac{1}{2l+1} \langle \psi_{nl} \left| \frac{\partial \hat{H}_l}{\partial l} \right| \psi_{nl} \rangle ~
\]
\[=\frac{2\mu}{\hbar^2} \frac{1}{2l+1} \frac{\partial E_n}{\partial l}.~\]
\[
= \frac{2\mu}{\hbar^2} \frac{1}{2l+1} \frac{\partial E_n}{\partial n} \frac{\partial n}{\partial l}~
\]
\[
= \frac{2\mu}{\hbar^2} \frac{1}{2l+1} \frac{Z^2 \mu e^4}{\hbar^2 n^3}~
\]
\[
= \frac{Z^2 \mu^2 e^4}{\hbar^4 n^3 (l + 1/2)}.~
\]
为了计算能量的导数，需要知道 \(n\) 如何依赖于 \(l\)。这些量子数通常是独立的，但在此情况下，必须调整解，以保持波函数中的节点数不变。节点数为 \(n - l - 1\)，因此：\(\partial n/\partial l = 1.\)
\subsubsection{范德华力}
在费曼的论文结尾，他指出：“范德华力也可以解释为源于核间电荷分布的更高浓度。薛定谔微扰理论研究了两个相互作用的原子在距离 \(R\) 远大于原子半径的情况下的行为，得出的结果是，每个原子的电荷分布从中心对称性发生了扭曲，在每个原子中产生了一个约为 \(1/R^7\) 的偶极矩。每个原子的负电荷分布的重心稍微向另一个原子移动。然而，导致范德华力的并不是这些偶极矩之间的相互作用，而是每个原子核对其自身电子的扭曲电荷分布的吸引作用，这种吸引力给出了 \(1/R^7\) 的吸引力。
\subsection{时间依赖波函数的赫尔曼–费曼定理}
对于满足时间依赖薛定谔方程的一般时间依赖波函数，赫尔曼–费曼定理并不成立。然而，以下恒等式成立：[9][10]
\[
\langle \Psi_{\lambda}(t) | \frac{\partial H_{\lambda}}{\partial \lambda} | \Psi_{\lambda}(t) \rangle = i \hbar \frac{\partial}{\partial t} \langle \Psi_{\lambda}(t) | \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} \rangle~
\]
其中，
\[
i \hbar \frac{\partial \Psi_{\lambda}(t)}{\partial t} = H_{\lambda} \Psi_{\lambda}(t).~
\]
\subsubsection{证明}
证明仅依赖于薛定谔方程，并假设 \(\lambda\) 和 \(t\) 的偏导数可以交换次序。
\[
\langle \Psi_{\lambda}(t) | \frac{\partial H_{\lambda}}{\partial \lambda} | \Psi_{\lambda}(t) \rangle = \frac{\partial}{\partial \lambda} \langle \Psi_{\lambda}(t) | H_{\lambda} | \Psi_{\lambda}(t) \rangle 
- \langle \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} | H_{\lambda} | \Psi_{\lambda}(t) \rangle 
- \langle \Psi_{\lambda}(t) | H_{\lambda} | \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} \rangle.~
\]
\[
= i\hbar \frac{\partial}{\partial \lambda} \langle \Psi_{\lambda}(t) | \frac{\partial \Psi_{\lambda}(t)}{\partial t} \rangle 
- i\hbar \langle \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} | \frac{\partial \Psi_{\lambda}(t)}{\partial t} \rangle 
+ i\hbar \langle \frac{\partial \Psi_{\lambda}(t)}{\partial t} | \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} \rangle.~
\]
\[
= i\hbar \langle \Psi_{\lambda}(t) | \frac{\partial^2 \Psi_{\lambda}(t)}{\partial \lambda \partial t} \rangle + i\hbar \langle \frac{\partial \Psi_{\lambda}(t)}{\partial t} | \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} \rangle.~
\]
\[
= i\hbar \frac{\partial}{\partial t} \langle \Psi_{\lambda}(t) | \frac{\partial \Psi_{\lambda}(t)}{\partial \lambda} \rangle.~
\]
\subsection{参考文献}
\begin{enumerate}
\item Güttinger, P. (1932). "Das Verhalten von Atomen im magnetischen Drehfeld". *Zeitschrift für Physik*. 73 (3–4): 169–184. Bibcode:1932ZPhy...73..169G. doi:10.1007/BF01351211. S2CID 124962011.
\item Pauli, W. (1933). "Principles of Wave Mechanics". *Handbuch der Physik*. Vol. 24. Berlin: Springer. p. 162.
\item Hellmann, H. (1937). *Einführung in die Quantenchemie*. Leipzig: Franz Deuticke. p. 285. OL 21481721M.
\item Feynman, R. P. (1939). "Forces in Molecules". *Physical Review*. 56 (4): 340–343. Bibcode:1939PhRv...56..340F. doi:10.1103/PhysRev.56.340. S2CID 121972425.
\item Squillante, Lucas; Ricco, Luciano S.; Ukpong, Aniekan Magnus; Lagos-Monaco, Roberto E.; Seridonio, Antonio C.; de Souza, Mariano (2023年10月6日). "Grüneisen parameter as an entanglement compass and the breakdown of the Hellmann-Feynman theorem". *Physical Review B*. 108 (14): L140403. arXiv:2306.00566. Bibcode:2023PhRvB.108n0403S. doi:10.1103/PhysRevB.108.L140403. S2CID 258999942.
\item Jensen, Frank (2007). *Introduction to Computational Chemistry*. West Sussex: John Wiley & Sons. p. 322. ISBN 978-0-470-01186-7.
\item Piela, Lucjan (2006). *Ideas of Quantum Chemistry*. Amsterdam: Elsevier Science. p. 620. ISBN 978-0-444-52227-6.
\item Fitts, Donald D. (2002). *Principles of Quantum Mechanics: as Applied to Chemistry and Chemical Physics*. Cambridge: Cambridge University Press. p. 186. ISBN 978-0-521-65124-0.
\item Epstein, Saul (1966). "Time-Dependent Hellmann-Feynman Theorems for Variational Wavefunctions". *The Journal of Chemical Physics*. 45 (1): 384. Bibcode:1966JChPh..45..384E. doi:10.1063/1.1727339.
\item Hayes, Edward F.; Parr, Robert G. (1965). "Time-Dependent Hellmann-Feynman Theorems". *The Journal of Chemical Physics*. 43 (5): 1831. Bibcode:1965JChPh..43.1831H. doi:10.1063/1.1697020.
\end{enumerate}