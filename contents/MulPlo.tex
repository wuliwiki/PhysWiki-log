% 多元函数的极值
% 极值|充要条件|二次型

\pentry{二元函数的极值（简明微积分）\upref{F2Exm}， 二次多项式与二次型\upref{QuaPol}}
\subsection{极值}
设函数 $u=f(x_1,\cdots,x_n)$ 定义于区域 $\mathcal{D}$ 中，且 $(x_1^0,\cdots,x_n^0)$ 是这区域的内点。

\begin{definition}{极值}\label{def_MulPlo_1}
若点 $(x_1^0,\cdots,x_n^0)$ 有这样一个邻域
\[(x_1^0-\delta,x_1^0+\delta;\cdots;x_n^0-\delta,x_n^0+\delta)~,\]
使对于其中一切点都能成立不等式
\begin{equation}
\begin{aligned}
f(x_1,\cdots,x_n)&\leq f(x_1^0,\cdots,x_n^0)\\
&(\geq)
\end{aligned}~.
\end{equation}
就说，函数 $f(x_1,\cdots,x_n)$ 在点 $(x_1^0,\cdots,x_n^0)$ 处有\textbf{极大值}（\textbf{极小值}）.

若在除去点 $(x_1^0,\cdots,x_n^0)$ 本身以外区域中的每一点都能成立严格不等式
\begin{equation}
\begin{aligned}
f(x_1,\cdots,x_n)&< f(x_1^0,\cdots,x_n^0)\\
&(>)
\end{aligned}~.
\end{equation}
就说，函数 $f(x_1,\cdots,x_n)$ 在点 $(x_1^0,\cdots,x_n^0)$ 处有\textbf{真正的}极大值（极小值）；否则，极大值（极小值）就称为\textbf{广义的}。

极大值和极小值总称为\textbf{极值}。
\end{definition}
\subsection{极值的必要条件}
\begin{theorem}{}
若函数 $f$ 在某一点 $(x_1^0,\cdots,x_n^0)$ 处有极值，且在这一点处存在着（有限）偏导数
\[f'_{x_1}(x_1^0,\cdots,x_n^0),\cdots,f'_{x_n}(x_1^0,\cdots,x_n^0)~,\]
则这些偏导数都为0。
\end{theorem}
\textbf{证明：}令 $x_2=x_2^0,\cdots,x_n=x_n^0$ ，而 $x_1$ 仍保持为变量；那么，就得到 $x_1$ 的一元函数：
\begin{equation}
u=f(x_1,x_2^0,\cdots,x_n^0)~.
\end{equation}
因为函数在点 $(x_1^0,\cdots,x_n^0)$ 有极值（为明确，设为极大值）存在，由极值\autoref{def_MulPlo_1} ，在点 $x_1=x_1^0$ 的某一邻域 $(x_1^0-\delta,x_1^0+\delta)$ 内，必成立不等式
\begin{equation}
f(x_1,x_2^0\cdots,x_n^0)\leq f(x_1^0,\cdots,x_n^0)~.
\end{equation}
于是上述一元函数在点 $x_1=x_1^0$ 将有极大值，由费马定理\autoref{the_MeanTh_1}~\upref{MeanTh}，就得
\begin{equation}
f'_{x_1}(x_1^0,\cdots,x_n^0)=0~,
\end{equation}
同样的方法可证明在点 $(x_1^0,\cdots,x_n^0)$ 处其它偏导数也都为0。

\textbf{证毕}。

于是，一阶偏导数等于0是极值存在的必要条件。

因此，对极值的“怀疑”就是那些一阶偏导数全为0的点，它们的坐标可由解方程组
\begin{equation}
\begin{aligned}
f'_{x_1}(x_1,\cdots,x_n)&=0,\\
&\vdots\\
f'_{x_n}(x_1,\cdots,x_n)&=0~.
\end{aligned}
\end{equation}
求出。这种点称为\textbf{静止点}。

\subsection{极值的充分条件}
\pentry{多元泰勒展开\upref{NDtalr}， 正定矩阵\upref{DefMat}}
设函数 $f(x_1,\cdots,x_n)$ 是在某一静止点 $(x_1^0,\cdots,x_n^0)$ 的邻域内定义着的连续并有一阶及二阶连续导数。
按照多元函数的泰勒公式（\autoref{eq_NDtalr_1}~\upref{NDtalr}）展开下式到二阶项（由于是在静止点，一阶项为0）
\begin{equation}
\Delta=f(x_1,\cdots,x_n)-f(x_1^0,\cdots,x_n^0)~.
\end{equation}
得
\begin{equation}
\begin{aligned}
\Delta=&\frac{1}{2}\mathrm{d}^2 f(x_0+\theta\Delta x_0,\cdots,x_n+\theta\Delta x_n)\\
=&\frac{1}{2}[f''_{x_1^2}\Delta x_1^2+f''_{x_2^2}\Delta x_2^2+\cdots+f''_{x_n^2}\Delta x_n^2+2f''_{x_1x_2}\Delta x_1\Delta x_2\\
&+2f''_{x_1x_3}\Delta x_1\Delta x_3+\cdots+2f''_{x_{n-1}x_n}\Delta x_{n-1}\Delta x_n\large]
 \\
 =&\frac{1}{2}\sum_{i,k=1}^nf''_{x_ix_k}\Delta x_i\Delta x_k \quad (0<\theta<1)~.
\end{aligned}
\end{equation}
式中的 $\Delta x_i=x_i-x_i^0$ ，一切导数都在某一点
\begin{equation}
(x_1^0+\theta\Delta x_1,\cdots,x_n^0+\theta\Delta x_n) \quad (0<\theta<1)~,
\end{equation}
计算它们的数值。

引入数值
\begin{equation}
f''_{x_ix_k}(x_1^0,\cdots,x_n^0)=a_{ik}\quad (i,k=1,\cdots,n)~,
\end{equation}
于是
\begin{equation}
f''_{x_ix_k}(x_1^0+\theta\Delta x_1,\cdots,x_n^0+\theta\Delta x_n)=a_{ik}+\alpha_{ik}~,
\end{equation}
且
\begin{equation}\label{eq_MulPlo_3}
\alpha_{ik}\rightarrow 0\;\mathrm{when}\;\Delta x_1\rightarrow0,\cdots,\Delta x_n\rightarrow0~.
\end{equation}
现在，可把 $\Delta$ 写为
\begin{equation}
\Delta=\frac{1}{2}\qty(\sum_{i,k=1}^na_{ik}\Delta x_i\Delta x_k+\sum_{i,k=1}^n\alpha_{ik}\Delta x_i\Delta x_k )~.
\end{equation}
括号前一部分是函数 $f$ 在所考察点的二阶微分，它是变元为 $\Delta x_1,\cdots,\Delta x_n$ 的二次型\upref{QuaFor}。
\begin{theorem}{}
若二阶微分，即二次型
\begin{equation}\label{eq_MulPlo_1}
\sum_{i,k=1}^na_{ik}\Delta x_i\Delta x_k
\end{equation}
是正（负）定的，则在静止点 $(x_1^0,\cdots,x_n^0)$ 函数有极小值（极大值）。
\end{theorem}
\textbf{证明：}引入点 $(x_1^0,\cdots,x_n^0)$ 与 $(x_1,\cdots,x_n)$ 之间的距离
\begin{equation}
\rho=\sqrt{\Delta x_1^2+\cdots+\Delta x_n^2}~,
\end{equation}
 并令 $\frac{\Delta x_i}{\rho}=\xi_i$
 则 $\Delta$ 可改写为
 \begin{equation}\label{eq_MulPlo_2}
 \Delta=\frac{\rho^2}{2}\qty(\sum_{i,k=1}^na_{ik}\xi_i\xi_k+\sum_{i,k=1}^n\alpha_{ik} \xi_i\xi_k)~.
 \end{equation}
 一切 $\xi_i$ 并不同时为0，因此，由二次型\autoref{eq_MulPlo_1} 的正定性。\autoref{eq_MulPlo_2} 括号的前一和式恒有正号。即，因为
 \begin{equation}
 \sum_{i=1}^n\xi_i^2=1~,
 \end{equation}
 所以必有正的常数 $m$，使得对于 $\xi_i$ 可能有的一切数值总有
 \begin{equation}
 \sum_{i,k=1}^na_{ik}\xi_i\xi_k\geq m~.
 \end{equation}
 \autoref{eq_MulPlo_2} 括号后一和式当 $\rho$ 充分小时显然在绝对值上可小于 $m$（\autoref{eq_MulPlo_3} ），于是全括号内的值是正的。因此，在中心为点 $(x_1^0,\cdots,x_n^0)$ 的充分小的球内，差 $\Delta$ 必取正值。由此可见在所说的点处函数 $f(x_1,\cdots,x_n)$ 有极小值。

 同样，当二次型\autoref{eq_MulPlo_1} 是负定时函数有极大值。

\textbf{证毕}。
