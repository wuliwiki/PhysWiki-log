% Python 处理 CSV 和 Excel 笔记

\begin{issues}
\issueDraft
\end{issues}

\pentry{文本文件与字符编码\upref{encode}}

\subsection{CSV}
CSV 是一个简单的表格格式， 用文本编码。 Excel 表格可以另存为 CSV。

在 CSV 中， 可以用 \verb|"字符串"| 来表示一整个单元格， 里面的逗号不会被用于分割单元格。 若要表示 \verb|"| 符号， 可以用连续两个双引号： \verb|""|。

一个例子： CSV 使用 UTF-8 编码（无 BOM）
\begin{lstlisting}[language=python]
import csv
table = []
with open('test.csv', newline='') as csvfile:
    # sheet 的类型是 _csv.reader, 不能 sheet[i]
    sheet = csv.reader(csvfile)
    for row in sheet: # row 的类型是 list， 元素都是 str
        print(', '.join(row))
        table.append(row)
\end{lstlisting}
如果有 BOM 的话， 第一个元素将会多出一个 BOM 字符， print 出来是一个空格。

\subsection{Excel}
\begin{itemize}
\item 推荐的库： XlsxWriter, Xlwings, Pandas, 
\end{itemize}
