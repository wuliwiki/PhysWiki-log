% 狄拉克 delta 函数
% keys 微积分|定积分|狄拉克 delta 函数|\delta 函数
% license Xiao
% type Tutor

\pentry{定积分\nref{nod_DefInt}， sinc 函数\nref{nod_sinc}}{nod_302a}
\footnote{参考 \cite{Arfken} 相关内容。参考 Wikipedia \href{https://en.wikipedia.org/wiki/Dirac_delta_function}{相关页面}。}在物理中我们经常会遇到一些模型， 如质点和点电荷等， 这类模型使用了极限的思想（如令体积趋于无穷小）。 如果考察质点的密度或点电荷的电荷密度， 将得到无穷大， 然而将其密度（电荷密度）在空间中积分却又能得到有限的质量与电荷。 为了描述这样的密度（电荷密度）分布， 我们引入\textbf{狄拉克 $\delta$ 函数（Dirac delta function）}。

$\delta(x)$ 并不是数学中一个严格意义上的函数， 而是在泛函分析中被称为\textbf{广义函数（generalized function）}或\textbf{分布（distribution）}， 详见泛函分析教材如\cite{Zeidler}。

\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/e99764bce3026b21.pdf}
\caption{$\delta(x - x_0)$ 函数列的简单例子} \label{fig_Delta_1}
\end{figure}

我们来给出 $\delta$ 函数的一个模糊概念：考虑一个含有参数 $h$ 的函数（\autoref{fig_Delta_1} 左 1）
\begin{equation}\label{eq_Delta_6}
f_h(x) =
\begin{cases}
h & \qty( \abs{x - x_0} \leqslant \frac{1}{2h} )\\
0 & \qty( \abs{x - x_0} > \frac{1}{2h} )
\end{cases}\qquad (h > 0)~.
\end{equation}
其中 $h, x_0$ 是常数。 由函数图像易得函数曲线下面的面积始终为 $\int_{-\infty}^{+\infty} f_h(x) \dd{x} = 1$。 现在我们可以不断让 $h$ 变大，长方形的高将趋于无穷大， 宽将趋于零， 而定积分结果不变。

粗略地说， $\delta(x - x_0)$ 就是代表上面的 $f_h(x)$ 中 $h$ 无限变大的\textbf{过程}。 当然， 我们还可以选取其他含有参数 $h$ 的函数来逼近 $\delta$ 函数， 如\autoref{fig_Delta_1} 中的另外两种情况。

一些物理教材会把 $\delta(x)$ 的性质简单记为（一般默认 $x_0 = 0$，下同）
\begin{equation}\label{eq_Delta_2}
\delta(x) =
\begin{cases}
+\infty & (x = 0)\\
0 & (x \ne 0)
\end{cases}~,
\end{equation}
\begin{equation}\label{eq_Delta_3}
\int_{-\infty}^{+\infty} \delta(x) \dd{x} = 1~.
\end{equation}
这是十分不严谨的， 因为如果直接用\autoref{eq_Delta_2} \textbf{定义函数} $\delta(x)$， 那么上述 $h$ 逐渐变大的图像将彻底丢失， 且不可能得到\autoref{eq_Delta_3}。况且接下来也会看到 $x \ne x_0$ 时极限 $\lim_{h\to \infty}f_h(x)$ 也未必存在，更未必为零（\autoref{ex_Delta_2}）。

\subsection{用函数列严格定义}

\footnote{参考 Digital Library of Mathematical Functions \href{https://dlmf.nist.gov/1.17}{相关页面}。}这里我们给出一种\textbf{严谨的定义}： 把 $\delta$ 函数看作是满足一定条件的\textbf{函数序列}（delta sequence）， 即无穷个函数像数列一样按一定顺序排列。
\begin{definition}{狄拉克 $\delta$ 函数}\label{def_Delta_1}
令 $\delta_1(x), \delta_2(x), \dots$ 为一组连续实函数的序列。 若 $\delta_n(x)$ 满足以下条件， 那么我们把该函数列称为狄拉克 $\delta$ 函数（列）：
\begin{equation}\label{eq_Delta_5}
\lim_{n\to\infty}\int_{-\infty}^{+\infty} \delta_n(x) \dd{x} = 1~.
\end{equation}
且对任意给定的不包含 0 的区间 $(a,b)$（$a,b \ne 0$， 可取 $\pm\infty$）， 有
\begin{equation}\label{eq_Delta_4}
\lim_{n\to\infty} \int_{a}^{b} \delta_n(x) \dd{x} = 0~.
\end{equation}
\end{definition}
事实上， 教材上（如\cite{Arfken}）常使用以下定义， 但这两种定义是等价的\footnote{容易证明\autoref{def_Delta_1} 是\autoref{def_Delta_2} 的必要条件（只需要令\autoref{def_Delta_2} 中的 $f(x) = 1$ 证明\autoref{eq_Delta_5} ； 再令 $f(x)$ 在区间 $(a,b)$ 为 1 ， 否则为 0， 证明\autoref{eq_Delta_4}。）。 充分条件笔者不会证明。}。

\begin{definition}{狄拉克 $\delta$ 函数 2}\label{def_Delta_2}
令 $\delta_1(x), \delta_2(x), \dots$ 为一个连续实函数的序列。 若 $\delta_n(x)$ 满足以下两个条件， 那么我们把该函数列称为狄拉克 $\delta$ 函数（列）：

对所有性质良好（例如在 $x = 0$ 连续）的 $f(x)$， 都有
\begin{equation}
\lim_{n\to\infty}\int_{-\infty}^{+\infty} \delta_n(x)f(x) \dd{x} = f(0)~.
\end{equation}
\end{definition}

\begin{exercise}{高斯函数}\label{exe_Delta_2}
证明\enref{高斯分布函数}{GausPD} 可以构成以下 $\delta$ 函数列
\begin{equation}
\delta_n(x) = \sqrt{\frac{n}{\pi}} \E^{-n x^2} \qquad (n = 1, 2, \dots)~.
\end{equation}
\end{exercise}

\begin{example}{sinc 函数}\label{ex_Delta_2}
可以证明 \enref{$\sinc$ 函数}{sinc}可以构成以下 $\delta$ 函数列
\begin{equation}\label{eq_Delta_10}
\delta_n(x) = \frac{n}{\pi}\sinc(n x) \qquad (n = 1, 2, \dots)~.
\end{equation}
该式在傅里叶分析和量子力学中有重要应用（下文以及\cite{Arfken}）， 但证明起来比较困难暂且从略（证明\autoref{eq_Delta_5} 可用\autoref{eq_sinc_2}~\upref{sinc}）。 注意即使对于 $x \ne 0$，极限 $\lim_{n\to\infty} \delta_n(x)$ 也不存在， 可见\autoref{eq_Delta_2} 是十分不严谨的。 \autoref{fig_Delta_1} 的三个例子也较为片面。
\end{example}
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/28f1bbccff5307c0.pdf}
\caption{\autoref{ex_Delta_2} 中的 $n\sinc(n x)$，注意 $n$ 变大时该函数的 “轮廓” 并不会变窄而是保持近似 $1/x$ 的形状} \label{fig_Delta_2}
\end{figure}

\subsection{常见性质}
\subsubsection{性质 1}
若一个等式中出现了所谓的 $\delta$ 函数 $\delta(x)$， 那么其严格的定义是先将 $\delta(x)$ 替换为符合\autoref{def_Delta_1} 的任意函数列 $\delta_n(x)$， 再令\textbf{等式两边在取极限 $n\to\infty$ 时成立}。

例如 $\delta(x)$ 一个重要的性质是： 对任意在 $x = x_0$ 处连续函数 $f(x)$， 有
\begin{equation}\label{eq_Delta_7}
\int_{-\infty}^{+\infty} f(x) \delta(x - x_0) \dd{x}= f(x_0)~.
\end{equation}
使用函数列 $\delta_n(x)$， 该等式的严格意义是（注意该极限和积分不可交换，极限必须在最外面）
\begin{equation}\label{eq_Delta_11}
\lim_{n\to\infty}\int_{-\infty}^{+\infty} f(x) \delta_n(x - x_0) \dd{x}= f(x_0)~.
\end{equation}
由于我们假设\autoref{def_Delta_1} 和\autoref{def_Delta_2} 等效， 这是成立的。

\subsubsection{性质 2}
\begin{equation}\label{eq_Delta_1}
\delta(ax) = \frac{1}{\abs{a}} \delta(x)~.
\end{equation}
我们从\autoref{eq_Delta_6} 的几何上来不严谨地证明这个性质： 与 $\delta(x)$ 相比较， $\delta(ax)$ 的图像在 $x$ 方向变窄了 $\abs{a}$ 倍， 所以函数曲线下的面积变为原来的 $1/\abs{a}$ 倍， 故 $\abs{a}\delta(ax)$ 下的面积是 $1$， 证毕。

\subsubsection{性质 3}
作为\autoref{eq_Delta_1} 的拓展， 令 $f(x)$ 的根为 $x_1, x_2, \dots$， 在这些根处的导数为 $f'(x_i)$， 那么
\begin{equation}\label{eq_Delta_12}
\delta[f(x)] = \sum_i \frac{1}{\abs{f'(x_i)}} \delta(x - x_i)~,
\end{equation}
证明和\autoref{eq_Delta_1} 类似。

\subsubsection{性质 4}
对性质良好的函数 $g(x)$ 有
\begin{equation}
g(x)\delta(x) = g(0)\delta(x)~.
\end{equation}
证明： 对于性质良好的 $f(x)$， $\int f(x) g(x)\delta(x) \dd{x} = f(0)g(0) = \int f(x)g(0)\delta(x) \dd{x}$。 证毕。

\subsection{应用}
再次强调我们不能 “按字面意思” 理解任何含有 $\delta(x)$ 的等式。
\begin{example}{}\label{ex_Delta_1}
在傅里叶分析中， 时常会看到
\begin{equation}\label{eq_Delta_8}
\int_{-\infty}^{+\infty} \E^{\I kx}\dd{x} = 2\pi \delta(k)~.
\end{equation}
然而严格来说， 该积分并不收敛， 所以不能 “按字面意思” 理解该式。 要严格证明， 上式两边除以 $2\pi$， 令有限区间 $[-n,n]$ 内的积分为
\begin{equation}
\delta_n(k) = \frac{1}{2\pi}\int_{-n}^{n} \E^{\I kx}\dd{x} = \frac{\sin(n k)}{\pi k} = \frac{n}{\pi} \sinc(n k)~.
\end{equation}
由\autoref{ex_Delta_2} 中的结论得 $\delta_n(k)$ 是一个 delta 函数列。证毕。
\end{example}
\autoref{eq_Delta_8} 是傅里叶分析中重要的公式，稍微变形可得
\begin{equation}
\int_{-\infty}^{+\infty} \qty(\frac{\E^{\I k'x}}{\sqrt{2\pi}})\Cj \frac{\E^{\I kx}}{\sqrt{2\pi}}\dd{x} = \delta(k-k')~.
\end{equation}
其中星号代表复共轭。 由于函数的\enref{内积}{InerPd}通常定义为 $\int f^*(x) g(x) \dd{x}$ 的形式， 该式说明两列简谐波（\autoref{sub_PWave_2}~\upref{PWave}）存在某种意义上的\textbf{正交归一}，详见 “\enref{连续正交归一基底与傅里叶变换}{COrNoB}”。

\begin{example}{}
事实上\autoref{eq_Delta_8} 不止一种理解， \autoref{ex_Delta_1} 中限制积分上下限的方法相当于给\autoref{eq_Delta_8} 的被积函数乘以窗口函数
\begin{equation}
g(x) = \leftgroup{
&1 && (\abs{x} \leq n)\\
&0 && (\abs{x} > n)~.
}\end{equation}
那么该例中， 我们可以使用一个更平滑的窗口函数
\begin{equation}
g(x) = \E^{-x^2/(4n)}~.
\end{equation}
得
\begin{equation}
\int_{-\infty}^\infty \E^{-x^2/(4n)} \E^{\I k x} \dd{x} = 2\pi \sqrt{\frac{n}{\pi}}\E^{-n x^2}~.
\end{equation}
而根据\autoref{exe_Delta_2}，等式右边就是 $2\pi\delta_n(x)$。 而随着 $n$ 变大， $\E^{-x^2/(4n)}$ 接近 $1$， 左边的积分也 “接近” \autoref{eq_Delta_8} 的左边。
\end{example}

\begin{exercise}{}\label{exe_Delta_3}
证明
\begin{equation}\label{eq_Delta_9}
\begin{aligned}% 已验证
&\quad\int_{-\infty}^{+\infty} \sin(k'x) \sin(kx) \dd{x} = \int_{-\infty}^{+\infty} \cos(k'x) \cos(kx) \dd{x}\\
&= \pi\delta(k' - k) - \pi\delta(k' + k)~.
\end{aligned}
\end{equation}
提示：使用\autoref{eq_CTrig_1}~\upref{CTrig}，\autoref{eq_CTrig_2}~\upref{CTrig} 和\autoref{eq_Delta_8} 。
\end{exercise}

\begin{example}{}
请证明
\begin{equation}\label{eq_Delta_13}
\int_{-\infty}^{+\infty} \delta(x-x_1) \delta(x-x_2) \dd{x} = \delta(x_1 - x_2)~.
\end{equation}
注意由此可得积分 $\int_{-\infty}^{+\infty}\delta(x)^2 \dd{x} = +\infty$， 即不收敛。

\textbf{证明}： 考虑和上文一样的含参函数 $\delta_n(x)$， 令 $I_n = \int_{-\infty}^{+\infty} \delta_n(x) \dd{x}$， 有 $\lim_{n\to\infty} I_n = 1$。 再令
\begin{equation}
f_n(x_1, x_2) = \int_{-\infty}^{+\infty} \delta_n(x-x_1) \delta_n(x-x_2) \dd{x}~.
\end{equation}
\addTODO{以下证明不严谨， 待更正}
我们希望证明 $\lim_{n\to\infty }f_n(x_1, x_2) = \delta(x_1 - x_2)$。 首先对于给定的 $x_1 \ne x_2$ 显然有 $\lim_{n\to\infty }f_n(x_1, x_2) = 0$。 所以只需证明
\begin{equation}
\lim_{n\to\infty }\int_{-\infty}^{+\infty} f_n(x_1, x_2) \dd{x_2} = 1~.
\end{equation}
交换积分顺序得
\begin{equation}
\begin{aligned}
&\lim_{n\to\infty }\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty} \delta_n(x-x_1) \delta_n(x-x_2) \dd{x}\dd{x_2}\\
&= \lim_{n\to\infty }\int_{-\infty}^{+\infty} \delta_n(x-x_1) \int_{-\infty}^{+\infty} \delta_n(x-x_2)\dd{x_2} \dd{x}\\
&= \lim_{n\to\infty } I_n \int_{-\infty}^{+\infty} \delta_n(x-x_1)\dd{x}\\
&= \lim_{n\to\infty } I_n^2 = 1~,
\end{aligned}
\end{equation}
证毕。
\end{example}
