% 平面旋转矩阵
% 线性代数|矩阵|平面旋转变换|线性变换|平面旋转矩阵|基底变换|逆变换

\pentry{矩阵\upref{Mat}}

我们之前学过的 “平面旋转变换\upref{Rot2DT}” 属于线性变换\upref{LinMap}，以下用矩阵 $\mat R_2$ 表示．虽然我们可以直接把变换写成矩阵乘以列矢量的形式，但这里我们用另一种方法推导一次， 能更好地帮助理解和记忆．

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/Rot2D_1.pdf}
\caption{把单位矢量 $\uvec x$ 和 $\uvec y$ 逆时针旋转 $\theta$} \label{Rot2D_fig1}
\end{figure}

已知单位矢量 $\uvec x = (1, 0)\Tr, \uvec y = (0, 1)\Tr$ 逆时针旋转 $\theta$ 得（\autoref{Rot2D_fig1} ）
\begin{equation}
\mat R_2\pmat{1\\0} = \pmat{\cos \theta \\ \sin \theta}
\qquad
\mat R_2\pmat{0\\1} = \pmat{-\sin\theta \\ \cos\theta}
\end{equation}
要求任意矢量 $\bvec v = (v_1, v_2)\Tr$ 的旋转矩阵， 可以将 $\bvec v$ 表示成 $\uvec x$ 和 $\uvec y$ 的线性组合（\autoref{GVecOp_eq1}~\upref{GVecOp}） $\bvec v = v_1\uvec x + v_2\uvec y$． 由\autoref{Mat_eq17}~\upref{Mat}， 该线性组合的旋转变换等于 $\uvec x, \uvec y$ 分别做旋转变换再做同样的线性组合， 即
\begin{equation}
\ali{
\mat R_2 \qty(v_1 \uvec x + v_2 \uvec y)
&= v_1 \mat R_2\uvec x + v_2 \mat R_2\uvec y\\
&= v_1\pmat{\cos \theta \\ \sin \theta} 
  + v_2 \pmat{-\sin\theta \\ \cos\theta} \\
&= \pmat{\cos \theta & - \sin \theta \\ \sin \theta & \cos \theta }
\pmat{v_1 \\v_2}
}\end{equation}
所以旋转矩阵为
\begin{equation}\label{Rot2D_eq3}
\mat R_2 = \begin{pmatrix}
\cos\theta & - \sin\theta\\
\sin\theta &\cos\theta
\end{pmatrix}
\end{equation}
这与平面旋转变换\upref{Rot2DT}得出的结果一致．

把这个推导推广到一般情况， 就是如果已知每个基底 $\bvec \beta_i$ 的线性变换（记变换矩阵为 $\mat A$）结果为 $\bvec \alpha_i = \mat A \bvec \beta_i$， 那么变换矩阵的第 $i$ 列就是第 $i$ 个列矢量 $\bvec \alpha_i$．

\subsubsection{绕任意点旋转}
由\autoref{Rot2DT_eq5}~\upref{Rot2DT}可得绕任一点 $(x_0, y_0)$ 旋转为
\begin{equation}
\begin{aligned}
\pmat{x'\\y'} &= \pmat{\cos\theta & -\sin\theta\\ \sin\theta & \cos\theta}\pmat{x - x_0\\ y - y_0} + \pmat{x_0 \\ y_0}\\
&= \pmat{\cos\theta & -\sin\theta\\ \sin\theta & \cos\theta}\pmat{x\\ y} + \pmat{1-\cos\theta & -\sin\theta\\ \sin\theta & 1-\cos\theta}\pmat{x_0\\ y_0}
\end{aligned}
\end{equation}
可见绕任意点旋转并不能简单表示为单个矩阵和 $(x,y)\Tr$ 相乘， 所以不是线性变换． 所以习惯上讨论旋转变换时都是默认关于原点旋转．

\subsection{主动和被动理解}
我们将任意矢量 $\bvec v$ 的旋转变换记为 $\bvec u = \mat R_2 \bvec v$， 我们把 $\bvec v$ 看做是二维空间中某矢量关于基底 $\uvec x, \uvec y$ 的坐标． 若我们把 $\bvec u$ 看做是另一矢量关于 $\uvec x, \uvec y$ 的坐标， 那么 $\uvec u$ 就等于 $\uvec v$ 逆时针旋转 $\theta$ 角． 旋转矩阵的这种理解被称为\textbf{主动}的．

另一种可能的理解是， $\bvec u$ 和 $\bvec v$ 代表二维空间中的同一矢量关于不同基底的展开． 我们把 $\bvec u$ 使用的基底记为 $\uvec u_1, \uvec u_2$， $\bvec v$ 使用的基底记为 $\uvec v_1, \uvec v_2$． 我们有
\begin{equation}
u_1 \uvec u_1 + u_2 \uvec u_2 = v_1 \uvec v_1 + v_2 \uvec v_2
\end{equation}
将 $\mat R_2$ 的矩阵元记为 $R_{ij}$， 不难证明两组基底之间的关系为
\begin{equation}
\leftgroup{
\uvec v_1 = R_{11} \uvec u_1 + R_{21} \uvec u_2 \\
\uvec v_2 = R_{12} \uvec u_1 + R_{22} \uvec u_2
}\end{equation}
将矩阵元代入可知， 基底 $\uvec u_1, \uvec u_2$ 分别是基底 $\uvec v_1, \uvec v_2$ 顺时针旋转 $\theta$ 角所得． 我们把这种理解叫做\textbf{被动}的， 即旋转矩阵表示同一个矢量的\textbf{基底变换}．

\subsection{逆矩阵}
我们既可以使用 “平面旋转变换\upref{Rot2DT}” 中求逆变换的方法把 $\theta$ 变为 $-\theta$ 再化简求出 $\mat R_2$ 的逆矩阵，也可以通过解方程求逆矩阵（\autoref{Mat_eq25}~\upref{Mat}）． 但最方便的是，由于 $\mat R_2$ 是一个单位正交阵% 链接未完成： \upref{UniMat}？
， 我们只需要把矩阵转置即可得到逆矩阵．
\begin{equation}
\mat R_2^{-1} = \mat R_2\Tr = \begin{pmatrix}
\cos\theta &\sin\theta \\
-\sin\theta &\cos\theta
\end{pmatrix}
\end{equation}
