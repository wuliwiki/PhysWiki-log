% 平面旋转矩阵
% keys 线性代数|矩阵|平面旋转变换|线性变换|平面旋转矩阵|基底变换|逆变换
% license Xiao
% type Tutor

\pentry{矩阵\nref{nod_Mat}， 平面旋转变换\nref{nod_Rot2DT}}{nod_6207}

我们之前学过的 “\enref{平面旋转变换}{Rot2DT}” 属于\enref{线性变换}{LinMap}，以下用矩阵 $\mat R_2$ 表示。虽然我们可以直接把\autoref{eq_Rot2DT_1}  到\autoref{eq_Rot2DT_4}  写成矩阵乘以列矢量的形式， 得到
\begin{equation}
\pmat{x'\\ y'} =
\begin{pmatrix}
\cos\theta & - \sin\theta\\
\sin\theta &\cos\theta
\end{pmatrix}\pmat{x\\ y}~.
\end{equation}
但这里我们用另一种方法推导一次， 能更好地帮助理解和记忆。
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/4569abc4d944a6d5.pdf}
\caption{把单位矢量 $\uvec x$ 和 $\uvec y$ 逆时针旋转 $\theta$} \label{fig_Rot2D_1}
\end{figure}

已知单位矢量 $\uvec x = (1, 0), \uvec y = (0, 1)$ 逆时针旋转 $\theta$ 得（\autoref{fig_Rot2D_1}）
\begin{equation}
\mat R_2\pmat{1\\0} = \pmat{\cos \theta \\ \sin \theta}~,
\qquad
\mat R_2\pmat{0\\1} = \pmat{-\sin\theta \\ \cos\theta}~.
\end{equation}
要求任意矢量 $\bvec v = (v_1, v_2)$ 的旋转矩阵， 可以将 $\bvec v$ 表示成 $\uvec x$ 和 $\uvec y$ 的线性组合（\autoref{eq_GVecOp_1}） $\bvec v = v_1\uvec x + v_2\uvec y$。 由\autoref{eq_Mat_17}， 该线性组合的旋转变换等于 $\uvec x, \uvec y$ 分别做旋转变换再做同样的线性组合， 即
\begin{equation}
\ali{
\mat R_2 \qty(v_1 \uvec x + v_2 \uvec y)
&= v_1 \mat R_2\uvec x + v_2 \mat R_2\uvec y\\
&= v_1\pmat{\cos \theta \\ \sin \theta} 
  + v_2 \pmat{-\sin\theta \\ \cos\theta} \\
&= \pmat{\cos \theta & - \sin \theta \\ \sin \theta & \cos \theta }
\pmat{v_1 \\v_2}~.
}\end{equation}
所以旋转矩阵为
\begin{equation}\label{eq_Rot2D_3}
\mat R_2 = \begin{pmatrix}
\cos\theta & - \sin\theta\\
\sin\theta &\cos\theta
\end{pmatrix}~.
\end{equation}
这与\enref{平面旋转变换}{Rot2DT}得出的结果一致。

把这个推导推广到一般情况， 就是如果已知每个基底 $\bvec \beta_i$ 的线性变换（记变换矩阵为 $\mat A$）结果为 $\bvec \alpha_i = \mat A \bvec \beta_i$， 那么变换矩阵的第 $i$ 列就是第 $i$ 个列矢量 $\bvec \alpha_i$。

\subsubsection{绕任意点旋转}
由\autoref{eq_Rot2DT_5} 可得绕任一点 $(x_0, y_0)$ 旋转为
\begin{equation}
\begin{aligned}
\pmat{x'\\y'} &= \pmat{\cos\theta & -\sin\theta\\ \sin\theta & \cos\theta}\pmat{x - x_0\\ y - y_0} + \pmat{x_0 \\ y_0}\\
&= \pmat{\cos\theta & -\sin\theta\\ \sin\theta & \cos\theta}\pmat{x\\ y} + \pmat{1-\cos\theta & -\sin\theta\\ \sin\theta & 1-\cos\theta}\pmat{x_0\\ y_0}~.
\end{aligned}
\end{equation}
可见绕任意点旋转并不能简单表示为单个矩阵和 $(x\ y)\Tr$ 相乘， 所以不是线性变换。 习惯上讨论旋转变换时都是默认关于原点旋转。

\subsection{主动理解和被动理解}
我们将任意矢量 $\bvec v$ 的旋转变换记为 $\bvec u = \mat R_2 \bvec v$， 我们把 $\bvec v$ 看做是二维空间中某矢量关于基底 $\uvec x, \uvec y$ 的坐标。 若我们把 $\bvec u$ 看做是另一矢量关于 $\uvec x, \uvec y$ 的坐标， 那么 $\uvec u$ 就等于 $\uvec v$ 逆时针旋转 $\theta$ 角。 旋转矩阵的这种理解被称为\textbf{主动的（active）}。

另一种可能的理解是， $\bvec u$ 和 $\bvec v$ 代表二维空间中的同一矢量关于不同基底的展开。 我们把 $\bvec u$ 使用的基底记为 $\uvec u_1, \uvec u_2$， $\bvec v$ 使用的基底记为 $\uvec v_1, \uvec v_2$。 我们有
\begin{equation}
u_1 \uvec u_1 + u_2 \uvec u_2 = v_1 \uvec v_1 + v_2 \uvec v_2~.
\end{equation}
将 $\mat R_2$ 的矩阵元记为 $R_{ij}$， 不难证明两组基底之间的关系为
\begin{equation}
\leftgroup{
\uvec u_1 = R_{11} \uvec v_1 + R_{12} \uvec v_2 \\
\uvec u_2 = R_{21} \uvec v_1 + R_{22} \uvec v_2
}~.\end{equation}
将矩阵元代入可知， 基底 $\uvec u_1, \uvec u_2$ 分别是基底 $\uvec v_1, \uvec v_2$ 顺时针旋转 $\theta$ 角所得。 我们把这种理解叫做\textbf{被动（passive）}的， 即旋转矩阵表示同一个矢量的\textbf{基底变换}。

\subsection{矩阵元的意义（被动理解）}
在被动理解中， 矩阵元 $R_{i,j}$ 的几何意义就是单位矢量 $\uvec u_i$ 和 $\uvec v_j$ 的\enref{点乘（内积）}{Dot}。 于是变换可以写成
\begin{equation}\label{eq_Rot2D_1}
\pmat{u_1\\u_2} = \pmat{\uvec u_1 \vdot \uvec v_1 & \uvec u_1 \vdot \uvec v_2\\ \uvec u_2 \vdot \uvec v_1 & \uvec u_2 \vdot \uvec v_2} \pmat{v_1 \\ v_2}~,
\end{equation}
展开后得
\begin{equation}
\begin{aligned}
&u_1 = (v_1 \uvec v_1 + v_2 \uvec v_2) \vdot \uvec u_1~,\\
&u_2 = (v_1 \uvec v_1 + v_2 \uvec v_2) \vdot \uvec u_2~,
\end{aligned}
\end{equation}
这正是 $u_1, u_2$ 的定义。

若考虑从 $u_i$ 到 $v_i$ 的逆变换， 同理有
\begin{equation}\label{eq_Rot2D_2}
\pmat{v_1\\v_2} = \pmat{\uvec v_1 \vdot \uvec u_1 & \uvec v_1 \vdot \uvec u_2\\ \uvec v_2 \vdot \uvec u_1 & \uvec v_2 \vdot \uvec u_2} \pmat{u_1 \\ u_2}~.
\end{equation}
由于几何矢量的点乘满足交换律， 对比\autoref{eq_Rot2D_1} 和\autoref{eq_Rot2D_2} 可以发现后者的矩阵就是 $\mat R$ 的转置即 $\mat R\Tr$。

事实上， 任何 $2\times2$ 的实数\enref{正交归一矩阵}{UniMat}都可以表示平面旋转变换， 所以我们证明了正交归一矩阵的一个重要的性质：
\begin{theorem}{}
正交矩阵的逆矩阵等于它的转置。
\end{theorem}
