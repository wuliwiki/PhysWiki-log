% 多元数量函数的隐函数定理
% keys 多元函数|数量函数|隐函数定理
% license Usr
% type Tutor

\pentry{连续函数的保号性、微分中值定理、梯度、数量函数的全微分}{nod_7e9e}

本文出现的变量 $x$ 都是指 $\mathbb{R}^n$ 中的元素， 即 $x\in\mathbb{R}^n$， $x$ 有 $n$ 个分量。

\begin{theorem}{(介值定理的一个应用)}\label{the_impli_1}
设 $D\times E\subset\mathbb{R}^{n}\times\mathbb{R}$ 是开集，
$F:D\times E\rightarrow\mathbb{R}$ 是数量函数。 点 $(x_{0},y_{0})\in D\times E.$ 

考虑方程 $F(x,y)=0$ 能否解出 $y=f(x)$ 满足 $F(x,f(x))=0.$ 

若满足以下 3 个条件：

\begin{enumerate}
\item $F(x_{0},y_{0})=0~.$
\item $F\in\mathrm{C}(D\times E)$, 即 $F(x,y)$ 在 $D\times E$ 上连续
\item 任意固定 $x\in D$, 函数 $y\mapsto F(x,y)$ 都是 $E$ 上的严格单调函数
\end{enumerate}

则方程 $F(x,y)=0$ 在 $x=x_{0}$ 附近是\textbf{ 唯一、局部地连续可解} 的， 即存在 $x_{0}$
的某邻域 $B(x_{0},\delta)\subset D$ 及定义在 $B(x_{0},\delta)$ 上的 \textbf{唯一的}\textbf{
连续函数} $y=f(x)$ 使得
$$
f(x_{0})=y_{0},\quad F(x,f(x))=0,\quad\forall x\in B(x_{0},\delta)~.
$$
\end{theorem}

\textsl{证明}：不妨设条件 3 中是严格单增函数。 

由函数 $y\mapsto F(x,y)$ 严格单增和条件 1 可知存在 $y_{1}>y_{0}>y_{2}$ 使得 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$. 

再由 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$ 和连续函数的保号性知 $F(x,y)$ 在 $(x_{0},y_{1})$
的附近总是正的， 而在 $(x_{0},y_{2})$ 的附近总是负的。 

于是结合条件 ③ 即知， 只要每次固定住 $x$, 沿着 $y$ 轴正方向走， $F$ 就可以从负值走向正值。 因此， 可以利用连续函数的介值定理，
在 $(x_{0},y_{0})$ 的附近唯一地形成一条轨迹 $y=f(x)$ 使得 $F(x,f(x))=0$. 

下证 $f(x)$ 的连续性。 事实上， $f(x)$ 的连续性是由上述方法的构造过程决定的。 若不然， 取 $\overline{x}\in B(x_0,\delta)$ 并假设 $f(x)$ 在
$x=\overline{x}$ 不连续， 则存在 $\varepsilon_{0}>0$ 及 $x_{n}\rightarrow\overline{x}$
使得 $f(x_{n})\notin(f(\overline{x})-\varepsilon,f(\overline{x})+\varepsilon)$.
注意到
$$
F(\overline{x},f(\overline{x})+\varepsilon)>0>F(\overline{x},f(\overline{x})-\varepsilon)~,
$$
因此可以重复存在性的构造过程， 在 \textbf{$\overline{x}$ }的附近及区间 $(f(\overline{x})-\varepsilon,f(\overline{x})+\varepsilon)$
内部形成一条轨迹， 而根据唯一性， 该轨迹恰是 $y=f(x)$. 这就与 $f(x_{n})\notin(f(\overline{x})-\varepsilon,f(\overline{x})+\varepsilon)$
矛盾了。 $\square$ 

下面介绍多元数量函数的隐函数定理，当 $n=2$ 时即为二元数量函数的隐函数定理。多元数量函数的隐函数定理有两个版本 （\textbf{偏导数版本} 和\textbf{ 全微分版本}），它们的前半部分在满足条件①②③的情况下是完全相同的，即确定了隐函数的局部存在性和唯一性； 而后半部分在导出隐函数的梯度计算公式时所需要的条件却是有区别的，这一点读者不可不知。另外，还有多元向量函数的隐函数定理，参见下一章。

首先给出隐函数定理的偏导数版本：

 \begin{theorem}{(隐函数定理：偏导数版本)}\label{the_impli_2}
 设 $D\times E\subset\mathbb{R}^{n}\times\mathbb{R}$ 是开集， $F:D\times E\rightarrow\mathbb{R}$
是数量函数。 点 $(x_{0},y_{0})\in D\times E.$ 

考虑方程 $F(x,y)=0$ 能否解出 $y=f(x)$ 满足 $F(x,f(x))=0.$ 

若满足以下 3 个条件：

① $F(x_{0},y_{0})=0$；

② $F\in\mathrm{C}(D\times E)$, 即 $F(x,y)$ 在 $D\times E$ 上连续； 

③ $F_{y}(x_{0},y_{0})\neq0$, 且 $F_{y}(x,y)$ 在点 $(x_0,y_0)$ 处连续，

则方程 $F(x,y)=0$ 在 $x=x_{0}$ 附近是\textbf{ 唯一、局部地连续可解} 的， 即存在 $x_{0}$
的某邻域 $B(x_{0},\delta)\subset D$ 及定义在 $B(x_{0},\delta)$ 上的 \textbf{唯一的} \textbf{
连续函数} $y=f(x)$ 使得
$$
f(x_{0})=y_{0},\quad F(x,f(x))=0,\quad\forall x\in B(x_{0},\delta)~.
$$

进一步， 若还有以下条件：

④\footnote{条件 ④ 若只是对某个偏导数成立也有相应结论。 } 梯度 $\nabla_{x}F(x,y)$ 在 $D\times E$
都存在， 且 $F_y\in\mathrm{C}(D\times E)$ $\,$\footnote{\textsl{注}：此条件指 $F(x,y)$ 关于 $y$ 的偏导数 $F_{y}(x,y)$
 在 $D\times E$ 上连续。 注意， 这里加强了条件 ③ 的后半部分， 要求 $F_{y}(x,y)$ 必须对两个变元连续， 不可以只对 $y$
 变元连续， 更不可以只在 $(x_0,y_0)$ 连续， 因为推导公式 （ \autoref{eq_impli_2} ） 时会用到。},

则相应的隐函数 $y=f(x)$ 在 $x=x_{0}$ 附近的梯度函数 $\nabla f$ 也都存在， 并且成立计算公式
\[
\nabla f(x)=-{\displaystyle \frac{\nabla_{x}F(x,f(x))}{F_{y}(x,f(x))}},\quad\forall x\in B(x_{0},\delta)~.
\]

更进一步， 若还有：

⑤\footnote{条件 ⑤ 若只是对某个偏导数成立也有相应结论。} $\nabla_{x}F(x,y)$ 在 $D\times E$
上连续， 

则相应的隐函数 $y=f(x)$ 梯度函数 $\nabla f$ 在 $x=x_{0}$ 附近也连续。

\textbf{证明}：
不妨设条件 ③ 中 $F_{y}(x_{0},y_{0})>0.$ 由 $F_{y}(x_{0},y_{0})>0$ 和
① 知存在 $y_{1}>y_{0}>y_{2}$ 使得 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$. 

又由 $F_{y}(x_{0},y_{0})>0$ 和保号性知 $F_{y}(x,y)$ 在 $(x_{0},y_{0})$
的附近 $B((x_{0},y_{0}),\delta)$ 内是严格正的， 即 $F(x,y)$ 关于 $y$ 变元在 \textbf{该附近}\footnote{\textsl{注}：这一点很重要， 需保证 $F(x,y)$ 关于 $y$ 变元在该附近都是严格单增的才行， 倘若只要求 $F(x_{0},y)$
关于 $y$ 严格单增则是远远不够的。 如可定义一个连续函数 $F(x,y)$ 使得它只在区域 \{$x-y\geqslant0$,
$x+y\geqslant0$, $x\geqslant0$\} 及区域 \{$x-y\leqslant0$, $x+y\leqslant0$,
$x\leqslant0$\} 取零值而在 $y$ 轴上严格单增。 } 是严格单增的 （沿 $y$ 轴正方向严格单增）. 

再由 $F(x_{0},y_{1})>0>F(x_{0},y_{2})$ 和保号性知 $F(x,y)$ 在 $(x_{0},y_{1})$
的附近总是正的， 而在 $(x_{0},y_{2})$ 的附近总是负的。 

结合以上三点就可以利用上一个 \autoref{the_impli_1} , 得到相同的结论。 

进一步， 若还有条件 ④, 取 \textbf{$\overline{x}$ }为 $B(x_{0},\delta)$ 中任意一点并固定它， 来证 $\nabla f(\overline{x})$存在。 因而取 $\left|\triangle x\right|\ll1$
有

\begin{equation}\label{eq_impli_1}
\nabla f(x)={\displaystyle {\displaystyle \lim_{\triangle x\rightarrow0}}\frac{f(\overline{x}+\triangle x)-f(\overline{x})}{\triangle x}:={\displaystyle \lim_{\triangle x\rightarrow0}}\frac{A}{\triangle x}}~.
\end{equation}

另一方面， 由于 $F(\overline{x},f(\overline{x}))=F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))=0$
则两式相减得
\begin{equation}
\begin{aligned}
0 & = F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))-F(\overline{x},f(\overline{x}))\\
 & = \left[F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))-F(\overline{x}+\triangle x,f(\overline{x}))\right]+\left[F(\overline{x}+\triangle x,f(\overline{x}))-F(\overline{x},f(\overline{x}))\right]\\
 & = F_{y}(\overline{x}+\triangle x,\xi)\cdot A+\left[F(\overline{x}+\triangle x,f(\overline{x}))-F(\overline{x},f(\overline{x}))\right]~.
\end{aligned}
\end{equation}
其中用到了微分中值定理， 且 $\xi=\xi(\triangle x)$ 使得 $f(\overline{x})<\xi<f(\overline{x}+\triangle x)$.
上式说明了 
$$
A=-{\displaystyle \frac{F(\overline{x}+\triangle x,f(\overline{x}))-F(\overline{x},f(\overline{x}))}{F_{y}(\overline{x}+\triangle x,\xi)}}~.
$$
将它代入 （ \autoref{eq_impli_1} ） 并取极限即得
\begin{equation}\label{eq_impli_2}
\nabla f(\overline{x})=-{\displaystyle \frac{\nabla_{x}F(\overline{x},f(\overline{x}))}{F_{y}(\overline{x},f(\overline{x}))}}~,
\end{equation}
而取极限的过程要用到 $F_{y}$ 在 $D\times E$ 上的连续性\footnote{至少需要$F_y$在 $(x_0,y_0)$ 的某个小邻域的连续性。} (由条件 ② 保证). 

更进一步， 若还有条件 ⑤, 则 $\nabla f$ 在 $x=x_{0}$ 附近的连续性由计算公式 （ \autoref{eq_impli_2} ） 的形式保证。 
 \end{theorem}

\verb| |

接下来给出隐函数定理的全微分版本：
 \begin{theorem}{(隐函数定理：全微分版本)}
 设 $D\times E\subset\mathbb{R}^{n}\times\mathbb{R}$ 是开集， $F:D\times E\rightarrow\mathbb{R}$
是数量函数。 点 $(x_{0},y_{0})\in D\times E.$ 

考虑方程 $F(x,y)=0$ 能否解出 $y=f(x)$ 满足 $F(x,f(x))=0.$ 

若满足以下 3 个条件：

① $F(x_{0},y_{0})=0$；

② $F\in\mathrm{C}(D\times E)$, 即 $F(x,y)$ 在 $D\times E$ 上连续； 

③ $F_{y}(x_{0},y_{0})\neq0$, 且 $F_{y}(x,y)$ 在点 $(x_0,y_0)$ 处连续，

则方程 $F(x,y)=0$ 在 $x=x_{0}$ 附近是\textbf{ 唯一、局部地连续可解} 的， 即存在 $x_{0}$
的某邻域 $B(x_{0},\delta)\subset D$ 及定义在 $B(x_{0},\delta)$ 上的 \textbf{唯一的} \textbf{
连续函数} $y=f(x)$ 使得
$$
f(x_{0})=y_{0},\quad F(x,f(x))=0,\quad\forall x\in B(x_{0},\delta)~.
$$

进一步， 若还有以下条件：

④\footnote{说明梯度 $\nabla F(x,y)$ 在 $D\times E$ 都存在， 且可运用全微分公式。} 全微分 $\mathrm{d}_{x}F(x,y)$ 在 $D\times E$ 都存在， 且 \textbf{$\nabla_x f(x,y)$ 关于变元 $y$ 连续},

则相应的隐函数 $y=f(x)$ 在 $x=x_{0}$ 附近的梯度函数 $\nabla f$ 也都存在， 并且成立计算公式
$$
\nabla f(x)=-{\displaystyle \frac{\nabla_{x}F(x,f(x))}{F_{y}(x,f(x))}},\quad\forall x\in B(x_{0},\delta)~.
$$

\textbf{证明}： 定理在满足条件①②③时的前半部分是与上一个 \autoref{the_impli_2} 完全一样的，因而结论和证明不需修改。

下证在满足条件 ④ 时 $f(x)$ 在 $x=x_{0}$ 附近的梯度函数 $\nabla f$ 也都存在。事实上， 取 $\overline{x}\in B(x_{0},\delta)$ 并固定它，再取 $\left|\triangle x\right|\ll1$。 % 预览段落  168 至  169 段落之源代码

由于 $F(\overline{x},f(\overline{x}))=F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))=0$,
则两式相减得
\begin{equation}
\begin{aligned}
0 & = F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))-F(\overline{x},f(\overline{x}))\\
 & = \left[F(\overline{x}+\triangle x,f(\overline{x}+\triangle x))-F(\overline{x},f(\overline{x}+\triangle x))\right]+\left[F(\overline{x},f(\overline{x}+\triangle x))-F(\overline{x},f(\overline{x}))\right]\\
 & := \mathrm{I}+\mathrm{II}~.
\end{aligned}
\end{equation}
注意这里的加一项减一项的处理与上一个定理是不同的。 利用全微分公式可得当 $\triangle x\rightarrow0$ 时有
$$
\mathrm{I}=\mathrm{\nabla}_{x}F(\overline{x},f(\overline{x}+\triangle x))\cdot\triangle x+o(|\triangle x|)~,
$$
\begin{equation}
\begin{aligned}
\mathrm{II} & = F_{y}(\overline{x},f(\overline{x}))\cdot\left(f(\overline{x}+\triangle x))-f(\overline{x})\right)+o\left(|f(\overline{x}+\triangle x))-f(\overline{x})|\right)\\
 & = F_{y}(\overline{x},f(\overline{x}))\cdot\left(f(\overline{x}+\triangle x))-f(\overline{x})\right)\cdot(1+o(1))~.
\end{aligned}
\end{equation}
因为 $\mathrm{I}+\mathrm{II}=0$ 且 $F_{y}(\overline{x},f(\overline{x}))\neq0$
(由条件 ③ 的保号性保证), 所以当 $\triangle x\rightarrow0$ 时有
$$
\left(f(\overline{x}+\triangle x))-f(\overline{x})\right)\cdot(1+o(1))={\displaystyle -\frac{\mathrm{\nabla}_{x}F(\overline{x},f(\overline{x}+\triangle x))\cdot\triangle x}{F_{y}(\overline{x},f(\overline{x}))}+o(|\triangle x|).}~
$$
由于 $(1+o(1))^{-1}=1+o(1)$, 且 $\mathrm{\nabla}_{x}F(\overline{x},f(\overline{x}+\triangle x))=\mathrm{\nabla}_{x}F(\overline{x},f(\overline{x}))(1+o(1))$,
所以
$$
\left(f(\overline{x}+\triangle x))-f(\overline{x})\right)={\displaystyle -\frac{\mathrm{\nabla}_{x}F(\overline{x},f(\overline{x}))\cdot\triangle x}{F_{y}(\overline{x},f(\overline{x}))}+o(|\triangle x|)\quad\quad(\triangle x\rightarrow0),}~
$$
即 
$$
\nabla f(\overline{x})=-\frac{\mathrm{\nabla}_{x}F(\overline{x},f(\overline{x}))}{F_{y}(\overline{x},f(\overline{x}))}~.
$$
\end{theorem}
