% 拉格朗日方程的证明、达朗贝尔原理
% 拉格朗日方程证明|广义力|非约束力|达朗贝尔原理

\pentry{拉格朗日方程（额外广义力）\upref{LagEqQ}}

本文使用牛顿第二定律证明拉格朗日方程， 其中会使用到一个关于约束的定理叫做达朗贝尔原理\textbf{（D'Alembert's principle）}． 另一种推导方法见 “最小作用量、哈密顿原理\upref{HamPrn}”．

\subsection{由牛顿第二定律证明拉格朗日方程}
下面来证明包含额外广义力的拉格朗日方程（\autoref{LagEqQ_eq1}~\upref{LagEqQ}）．

注意以下所有的函数偏导都是把 $q_1, q_2\dots q_N,\ \dot q_1, \dot q_2\dots \dot q_N,\ t$ 作为变量，即对一个变量求导数而把其他变量看做常数．另外，势能 $V$ 和位矢 $\bvec r_j$ 与 $\dot q_i$ 无关，偏导为 0．

把系统看成质点组， 每个质点质量为 $m_j$， 位置矢量是广义坐标的函数 $\bvec r_j(q_1,\dots,q_N,t)$， 那么系统动能为
\begin{equation}
T = \frac12 \sum_j m_j \bvec v_j^2 = \frac12 \sum_j m_j \dot{\bvec r}_j \vdot \dot{\bvec r}_j
\end{equation}
由矢量内积的求导法则
\begin{equation}\label{dAlbt_eq5}
\pdv{T}{\dot q_i} = \sum_j m_j \dot{\bvec r}_j \vdot \pdv{\dot{\bvec r}_j}{\dot q_i}
\end{equation}
其中质点 $j$ 的速度可以用全导数\upref{TotDer} 公式
\begin{equation}
\dot{\bvec r}_j = \sum_k \pdv{\bvec r_j}{q_k} \dot q_k  + \pdv{\bvec r_j}{t}
\end{equation}
对 $\dot q_i$ 求偏导，注意位矢与$\dot q_i$ 无关，所以求偏导时 $\pdv*{r_j}{q_k}$ 与 $\pdv*{r_j}{t}$ 可看做常数．
\begin{equation}\label{dAlbt_eq27}
\pdv{\dot{\bvec r}_j}{\dot q_i} = \pdv{\bvec r_j}{q_i}
\end{equation}
代入\autoref{dAlbt_eq5} 并对时间求导得到拉格朗日方程的左边（我们暂时只讨论 $\pdv*{V}{\dot q_i} = 0$ 的情况）
\begin{equation}\label{dAlbt_eq8}
\dv{t} \pdv{T}{\dot q_i} = \sum_j m_j \ddot{\bvec r}_j \vdot \pdv{\bvec r_j}{q_i}  + \sum_j m_j \dot{\bvec r}_j \vdot \dv{t} \pdv{\bvec r_j}{q_i}
\end{equation}
拉格朗日方程（\autoref{LagEqQ_eq1}~\upref{LagEqQ}）的右边为
\begin{equation}
\pdv{L}{q_i} = \pdv{T}{q_i} - \pdv{V}{q_i} + Q_i^{(e)}
\end{equation}
其中右边第一项为
\begin{equation}\label{dAlbt_eq28}
\pdv{T}{q_i} = \sum_j m_j \dot{\bvec r}_j \vdot \pdv{\dot{\bvec r}_j}{q_i} = \sum_j m_j \dot{\bvec r}_j \vdot \pdv{q_i} \dv{\bvec r_j}{t}
\end{equation}
第二项是包含在势能中的广义力
\begin{equation}\label{dAlbt_eq29}
Q_i^{(V)} = - \pdv{V}{q_i} = \sum_j \qty(-\pdv{V}{x_j} \pdv{x_j}{q_i} - \pdv{V}{y_j}\pdv{y_j}{q_i} - \pdv{V}{z_j} \pdv{z_j}{q_i}) = \sum_j \bvec F_j^{(V)} \vdot \pdv{\bvec r_j}{q_i}
\end{equation}
其中
\begin{equation}
\bvec F_j^{(V)} = - \grad_j V = -\pdv{V}{x_j}\uvec x - \pdv{V}{y_j}\uvec y - \pdv{V}{z_j} \uvec z
\end{equation}
这是\textbf{非约束力}．%未完成，最好以上的例子中能说明非约束力
势能外的广义力的定义为
\begin{equation}
Q_i^{(e)}(q, \dot q, t) = \sum_j \bvec F_j^{(e)} \vdot \pdv{\bvec r_j}{q_i} \qquad (i=1,\dots,N)
\end{equation}
每个质点的总非约束力为
\begin{equation}
\bvec F_j^{(a)} = \bvec F_j^{(V)} + \bvec F_j^{(e)}
\end{equation}
那么总广义力为
\begin{equation}\label{dAlbt_eq1}
Q_i = Q_i^{(V)} + Q_i^{(e)} = \sum_j \bvec F_j^{(a)} \vdot \pdv{\bvec r_j}{q_i}
\end{equation}
所以要证明拉格朗日方程，即证明\autoref{dAlbt_eq8} 等于\autoref{dAlbt_eq28} 加\autoref{dAlbt_eq1}， 首先需要证明
\begin{equation}
\dv{t} \pdv{\bvec r_j}{q_i} = \pdv{q_i} \dv{\bvec r_j}{t}
\end{equation}
也就是证明全导数和偏导数运算可对易．使用全导数\upref{TotDer} 的定义，以及混合偏导\upref{ParDer} 的性质，有
\begin{equation}
\dv{t} \pdv{\bvec r_j}{q_i} = \sum_k \pdv{q_k} \pdv{\bvec r_i}{q_i} \dot q_k  + \pdv{t} \pdv{\bvec r_j}{q_i} = \sum_k \pdv{q_i} \pdv{\bvec r_i}{q_k} \dot q_k + \pdv{q_i} \pdv{\bvec r_j}{t} = \pdv{q_i} \dv{\bvec r_j}{t}
\end{equation}
然后我们需要证明
\begin{equation}
\sum_j \qty(\bvec F_j^{(a)} - m\ddot{\bvec r}_j) \vdot \pdv{\bvec r_j}{q_i}  = 0
\qquad (i = 1\dots N)
\end{equation}
即可证明拉格朗日方程．该式被称为\textbf{达朗贝尔原理}．注意由于这里的 $\bvec F_j^{(a)}$ 为质点 $j$ 所受的非约束力而不是合力，所以求和项的小括号一般不为 0．

\subsection{达朗贝尔原理证明}
令第 $j$ 个质点所受和力为 $\bvec F_j = \bvec F_j^{(a)} + \bvec F_j^{(c)}$， 两项分别为非约束力和约束力．由牛顿第二定律 $\bvec F_j - m\ddot{\bvec r}_j = 0$， 所以
\begin{equation}
\sum_j \qty(\bvec F_j^{(a)}+\bvec F_j^{(c)} - m\ddot{\bvec r}_j) \vdot \pdv{\bvec r_j}{q_i} = 0
\qquad (i = 1\dots N)
\end{equation}
现在我们只需证明
\begin{equation}
\sum_j  \bvec F_j^{(c)} \vdot \pdv{\bvec r_j}{q_i}  = 0
\qquad (i = 1\dots N)
\end{equation}
由于以上偏微分中时间保持不变，约束力不做功，该求和为零，证毕．%未完成: 这样的解释连我都不明白... 真的要结合有约束的例题来解释了
