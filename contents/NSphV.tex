% 多维球体的体积
% keys 多元微积分|定积分|N 维空间|N 维直角坐标系|N 维球体
% license Xiao
% type Tutor

\pentry{gamma 函数\upref{Gamma}}
半径为 $R$ 的 $n$ 维欧几里得空间中的球体的体积可以用 $\Gamma$ 函数表示为
\begin{equation}\label{eq_NSphV_8}
V_n = \frac{\pi^{n/2}}{\Gamma (n/2+1)} R^n = \frac{\pi^{n/2}}{(n/2)!} R^n~,
\end{equation}
其中阶乘和 Gamma 函数的关系见\autoref{eq_Gamma_1}~\upref{Gamma}。 若定义 $n$ 维球体的表面满足方程 $\sum_{i=1}^n x_i^2 = R_n^2$， 其中 $x_i$ 为 $n$ 维直角坐标系中第 $i$ 个坐标。所有满足 $\sum_{i=1}^n x_i^2 \leqslant R_n^2$ 的坐标点都定义为球内的点，且定义 $n$ 维直角坐标系中的体积为 $V_n = \int \dd{x_1}\dd{x_2}\dots\dd{x_n}$， 积分是对所有球内的点积分。

如果这些定义看起来很抽象，不妨代入到三维空间中考虑。三维直角坐标系中， $x_1, x_2, x_3$ 分别是 $x,y,z$，  $R_3$ 是球的半径，球表面上任意一点都满足 $x^2 + y^2 + z^2 = R_3^2$， 且球的体积分为 $\int \dd{x}\dd{y}\dd{z}$ 是对球内部的所有点积分。 另外，若把上述定义代入到 1 维和 2 维， 不难发现所谓的“1 维球”和“2 维球”分别是半径为 $R_1$ 的线段和半径为 $R_2$ 的圆。

\subsection{推导}
由于正常人的空间想象力最高是 3 维，我们先由 3 维以内的球体总结出体积的递推公式，这样即使我们无法想象高维球的形状，也可以计算其体积。下面在推导前 3 个维度时，请把所有 $x_1, x_2, x_3$ 想象成 $xyz$。 
\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/ae637c003981d4b4.pdf}
\caption{二维和三维球的体积} \label{fig_NSphV_1}
\end{figure}
\subsection{1 维球}
这是一条线段，满足 $x_1^2 \leqslant R_1^2$， “体积”就是线段长度
\begin{equation}\label{eq_NSphV_1}
V_1 = \int \dd{x_1} = 2 R_1~.
\end{equation}
\subsection{ 2 维球}
这是一个圆，满足 $x_1^2 + x_2^2 \leqslant R_2^2$， 在计算体积 $V_2 = \int \dd{x_1}\dd{x_2}$ 时，可以先对 $x_1$ 积分再对 $x_2$ 积分
\begin{equation}\label{eq_NSphV_2}
V_2 = \int \qty(\int \dd{x_1}) \dd{x_2}  = \int V_1(x_2) \dd{x_2}~.
\end{equation}
在几何上，这就是说把圆从沿 $x_1$ 轴切成许多一维球（线段），由 $x_1^2 \leqslant R_2^2 - x_2^2$， 一维球的半径为 $R_1(x_2) = (R_2^2 - x_2^2)^{1/2}$。 代入\autoref{eq_NSphV_1}， 得 $x_2$ 处切出的一维球的体积（线段的长度）为
\begin{equation}\label{eq_NSphV_3}
V_1 (x_2) = \int \dd{x_1} = 2R_1 = 2(R_2^2 - x_2^2)^{1/2}~.
\end{equation}
再代入\autoref{eq_NSphV_2}， 得二维球的体积为（注意 $ -R_2 < x_2 < R_2$ ）
\begin{equation}\label{eq_NSphV_4}
V_2 = \int V_1 \dd{x_2} = \int 2 (R_2^2 - x_2^2)^{1/2} \dd{x_2}  = \pi R_2^2~.
\end{equation}
\subsection{ 3 维球}
这是一个球体，满足 $x_1^2 + x_2^2 + x_3^2 \leqslant R_3^2$， 计算体积 $V_3 = \int \dd{x_1}\dd{x_2} \dd{x_3}$ 时，可以先对 $x_1 x_2$ 积分
\begin{equation}\label{eq_NSphV_5}
V_3 = \int \qty(\int \dd{x_1} \dd{x_2}) \dd{x_3} = \int V_2(x_3) \dd{x_3}~.
\end{equation}
在几何意义上，这是说把球沿 $x_1 x_2$ 平面切成许多二维球（圆），然后把球的体积（面积）沿 $x_3$ 轴积分。由 $x_1^2 + x_2^2 \leqslant R_3^2 - x_3^2$， 得 $x_3$ 处二维球半径为 $R_2 = (R_3^2 - x_3^2)^{1/2}$。 由\autoref{eq_NSphV_4} 得体积为
\begin{equation}\label{eq_NSphV_6}
V_2 (x_3) = \pi R_2^2 = \pi (R_3^2 - x_3^2)~.
\end{equation}
代入\autoref{eq_NSphV_5} 得三维球体积（注意 $-R_2 < x_2 < R_2$）
\begin{equation}\label{eq_NSphV_7}
V_3 = \int V_2(x_3) \dd{x_3} = \int \pi (R_3^2 - x_3^2)\dd{x_3}  = \frac43 \pi R^3~.
\end{equation}
\subsection{ $n$ 维球}
由以上两个推导，可以在代数上总结出递推的规律。把 $n$ 维球在 $n+1$ 维积分，得\footnote{可使用  Mathematica 软件计算积分，见 Mathematica 积分}%未完成:链接
\begin{equation}
V_4 = \int_{-R}^R \frac43 \pi (R_4^2 - x_4^2)^{3/2} \dd{x_4}  = \frac12 \pi^2 R^4~.
\end{equation}
令 $n$ 维球体体积维 $C_n R^n$， 那么可以总结出递推公式为
\begin{equation}
V_{n+1} = \int_{-R}^R C_n (R^2 - x^2)^{n/2}\dd{x}~.
\end{equation}
使用换元积分法\upref{IntCV}， 令 $x = R\sin\theta$， 有
\begin{equation}
\begin{aligned}
\int_{-R}^R (R^2 - x^2)^{n/2}\dd{x} &= R^{n+1} \int_{-\pi/2}^{\pi/2} \cos^{n+1}\theta \dd{\theta}\\
&= \sqrt{\pi} \frac{\Gamma(n/2+1)}{\Gamma[(n+1)/2+1]} R^{n+1}~.
\end{aligned}
\end{equation}
用阶乘表示递归公式（\autoref{eq_Gamma_1}~\upref{Gamma}）， 就是
\begin{equation}
C_{n+1} = C_n \frac{\sqrt{\pi}(n/2)!}{[(n+1)/2]!}~.
\end{equation}
已知 $C_1 = 2$， 易得
\begin{equation}
C_n = \frac{\pi^{n/2}}{(n/2)!}~,
\end{equation}
这样就得到了\autoref{eq_NSphV_8}。
