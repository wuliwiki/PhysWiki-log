% 定积分（极简微积分）
% keys 微积分|积分|极限|定积分|牛顿-莱布尼兹公式
% license Usr
% type Tutor

\pentry{导数\nref{nod_Der}}{nod_a949}

首先以不均匀细绳的质量为例，引入定积分的思想。 具体来说本文介绍的是\textbf{黎曼积分（Riemann integral）}，在 “极简微积分” 系列中，所有的定积分都是指黎曼积分。适用范围更广的\enref{勒贝格积分}{Lebes1}不在该系列的范围。

\begin{example}{不均匀细绳的质量}\label{ex_DefInt_1}
一条密度不均匀的绳子长为 $L$， 横截面积是 $S$， 细绳距离 $O$ 端 $x$（$x < L$）处的密度为 $\rho(x)$。 求绳子的质量。

\begin{figure}[ht]
\centering
\includegraphics[width=9cm]{./figures/7d97a557bce5a219.pdf}
\caption{密度不均匀的绳子} \label{fig_DefInt_1}
\end{figure}

如果题目中，密度是恒定的，那么直接可以写出绳子的质量为 $m = LS\rho$。 但是题中 $\rho(x)$ 是关于 $x$ 的函数，所以我们要寻找另外的做法。假设绳子的密度变化是连续且“平滑”的，我们可以通过把绳子分割成 $n$ 小节（注意这些小节必须严格地首尾相接，不能有重合或者空隙）。第 $i$ 节取 $x_i$ 到 $x_{i +1}$， 令其长度为 $x_{i + 1} - {x_i} = \Delta x_i$ 使每一个小节内，密度可以近似看成是恒定的，这样我们可以用 $\rho(\xi_i)\,\, (x_i \leqslant \xi_i \leqslant x_{i + 1})$ 来代替第 $i$ 节的密度，当每一节足够小时，可以认为 $\xi_i$ 在 $x_i \leqslant \xi_i \leqslant x_{i + 1}$ 约束下的取值并不会影响结果。 第 $i$ 小节的质量为
\begin{equation}
\Delta {m_i} = \rho (\xi_i)\Delta {x_i}S ~.
\end{equation}
所以总的质量用求和符号来表示，就是
\begin{equation}
m = \sum_{i = 1}^n \Delta m_i  \approx \sum_{i = 1}^n \rho(\xi_i)\Delta x_i S   = S \sum_{i = 1}^n \rho (\xi_i)\Delta x_i~.
\end{equation}
%（我们把重叠的“面”视作无质量的，） addis：这过于严谨了，一个物体切成几段，总质量等于每段质量相加没有问题
由于当 $n$ 取有限值时，上式并不精确成立，所以只能使用约等号，但是 $n$ 越大，约等号两边就越精确成立。这是极限的思想，用极限符号来表，就是
\begin{equation}
m = \lim_{n \to \infty } \sum_{i = 1}^n {\Delta {m_i}}  = \lim_{n \to \infty } \sum_{i = 1}^n \rho(\xi_i)\Delta {x_i} S = S \lim_{n \to \infty } \sum_{i = 1}^n \rho(\xi_i)\Delta {x_i}~.
\end{equation}
这种表达式在物理中反复出现，所以使用积分符号 $\int {} $ 用于代替极限和求和符号。另外把 ${\xi_i}$ 写成 $x$ （当 $n$ 趋近于无穷大时，参量 $i$ 和 $\Delta {x_i}$ 具体是多少就不重要了），把表示增量的 $\Delta $ 变为表示微分的 $\mathrm{d}$， 上式就写为
\begin{equation}
m = \int \dd{m}  = \int S\rho(x) \dd{x}  = S\int \rho(x) \dd{x}~.
\end{equation}
下面先看看 $\int \rho(x) \dd{x}$， 即 $\lim\limits_{n \to \infty } \sum\limits_{i = 1}^n \rho(\xi_i)\Delta {x_i}$ 的另一种理解。画出 $\rho (x)$ 图像。例如 $\rho(x) = x + 1$， 则 $\rho(\xi_i)\Delta {x_i}$ 可以表示左图的第 $i$ 个小长方形的面积， $\sum\limits_{i = 1}^n \rho(\xi_i)\Delta x_i$ 表示长方形面积之和。如果 $n$ 非常大且每个 $\Delta x_i$ 取得非常小，左图看起来就会像右图。 所以 $\int \rho(x) \dd{x}$ 可以用来表示右图阴影部分的面积。

\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/fa69fe2d709ce630.pdf}
\caption{定积分可以理解为曲线下面的面积， 并看做由无限多个无穷窄的矩形组成。当最大的矩形也足够小时，矩形的划分方式将不会影响面积的计算。} \label{fig_DefInt_4}
\end{figure}

但 $\int \rho(x) \dd{x}$ 里面显然不包含 $0$ 和 $L$ 的信息，我们根据题目中的情况，说这个积分是“从 $0$ 积到 $L$”，其中 $0$ 是\textbf{积分下限}，$L$ 是\textbf{积分上限}。为了表示这个信息，把它写到积分号右边变为
\begin{equation}
\int_0^L \rho(x) \dd{x}~.
\end{equation}
这就是定积分的标准形式，但有时候为了书写方便，在不混淆的情况下可以把积分上下限省略。
\end{example}

这样的写法是很形象的，可以想象，积分号顺时针旋转 90 度后就是函数的曲线需要积分的部分，下标的位置代表积分的起点，上标代表终点。 这样，很多问题就可以用积分表示了。

更一般地，如果把积分的起点和终点记为实数 $a,b$， 那么对于一元函数的定积分就可以写为如下形式：
\begin{equation}
S=\int^b_a f(x) \dd x~.
\end{equation}
要注意的是，当函数值为负数时，我们\textbf{定义} “曲线下方的面积” 也取负数。 此外，我们定义当 $a > b$， 定义积分的结果是把 $a,b$ 互换后的积分结果乘以 $-1$， 即
\begin{equation}
\int^b_a f(x) \dd x = -\int^a_b f(x) \dd x~.
\end{equation}

至于计算积分的具体方法，比求导要复杂得多，甚至很多积分的结果不能用初等函数表示，只能表示为级数等形式。然而对于基本初等函数的积分，用\enref{牛顿－莱布尼兹公式}{NLeib}即可马上求解。

\begin{example}{圆的面积}\label{ex_DefInt_2}
在直角坐标系中， 圆的方程为 $x^2 + y^2 = R^2$， 上半圆的方程可看做 $y$ 关于 $x$ 的函数
\begin{equation}
y = f(x) = \sqrt{R^2 - x^2} \quad (x\in [-R,R])~.
\end{equation}
将该式定积分再乘以 2 即可得到圆的面积
\begin{equation}
S = 2\int_{-R}^{R} f(x) \dd{x} = 2\int_{-R}^{R} \sqrt{R^2 - x^2} \dd{x}~,
\end{equation}

我们还可以用另一种方法验证圆的面积公式。 把原划分成许多微小圆环， 由\autoref{ex_Diff_2}， 每个微小圆环的面积为 $2\pi r\dd{r}$， 所以圆的面积可以用定积分表示为
\begin{equation}
S = \int_0^{R} 2\pi r\dd{r}~.
\end{equation}

以上两个定积分的结果都为 $\pi R^2$， 过程见 “牛顿—莱布尼兹公式\upref{NLeib}”的\autoref{ex_NLeib_2}。
\end{example}

\begin{example}{球体的表面积}\label{ex_DefInt_3}

\begin{figure}[ht]
\centering
\includegraphics[width=3.2cm]{./figures/133b2334e97cbe22.pdf}
\caption{将球的表面划分成许多细圆环， 每个对应的极角为 $\dd{\theta}$} \label{fig_DefInt_3}
\end{figure}

以球心为原点建立球坐标系， 我们可以把球体的表面根据不同的 $\theta$ 划分成许多细圆环（如\autoref{fig_DefInt_3}）， 每个圆环的面积等于周长乘以宽度， 即
\begin{equation}\label{eq_DefInt_9}
\dd{S} = 2\pi R\sin\theta \cdot R\dd{\theta}~.
\end{equation}
所以球的表面积可以用定积分记为
\begin{equation}
S = \int_0^{\pi} 2\pi R\sin\theta \cdot R\dd{\theta} = 2\pi R^2 \int_0^{\pi} \sin\theta \dd{\theta}~.
\end{equation}

虽然我们还不会计算这个定积分（见 “\enref{牛顿—莱布尼兹公式}{NLeib}”）， 但我们现在可以用一种巧妙的方法来简化问题。 让我们来计算每个细圆环在极轴方向投影的长度。 我们不妨把极轴叫做 $z$ 轴， 则对某个细圆环有 $z = R\cos\theta$， 微分得 $\dd{z} = -R\sin\theta \dd{\theta}$， 将该式消去\autoref{eq_DefInt_9} 中的 $\dd{\theta}$ 得
\begin{equation}
\dd{S} = -2\pi R\dd{z}~.
\end{equation}
这说明无论细圆环的位置如何， 其面积与其在 $z$ 轴投影的长度的比值恒为 $2\pi$。 至于上式中的负号， 是因为我们假设了正的 $\dd{\theta}$ 对应正的面积， 而正的 $\dd{\theta}$ 却对应负的 $\dd{z}$。 由于面积恒为正值， 我们可以取绝对值将负号去掉。 这样， 球的表面积就可以用定积分表示为
\begin{equation}\label{eq_DefInt_12}
S = \int_{-R}^{R} 2\pi R\dd{z}~.
\end{equation}
由于被积函数是一个常数， 定积分的结果就是该常数乘以积分区间的长度即 $4\pi R^2$。
\end{example}

\begin{example}{球的体积}\label{ex_DefInt_4}
要计算一个半径为 $R$ 的球体的体积， 可以将球划分为无限个薄球壳， 每个薄球壳的体积等于该球壳的表面积乘以厚度（见\autoref{ex_Diff_2}  ）， 即 $\dd{V} = 4\pi r^2 \dd{r}$。 所以球的体积可用定积分表示为
\begin{equation}
V = \int_0^R 4\pi r^2 \dd{r}~.
\end{equation}
同样由“\enref{牛顿—莱布尼兹公式}{NLeib}” 可得积分结果为 $4\pi R^3/3$。
\end{example}

\subsubsection{定积分的基本性质}
每一本高数教材\cite{同济高}\cite{Thomas}都会列出一张长长的定积分性质的表格。这里只列举一些其中的一些。这些定理尽管看起来都\textsl{非常显然}，但在实际做题时往往会带给初学者不少困惑。
\begin{itemize}
\item 仅仅改变积分变量的名称不影响积分的结果。
$$\int^b_a f(x) \dd x = \int^b_a f(t) \dd t~.$$
\item 被积函数可加性。\textsl{注意乘法可没有这么好的性质，不然我们也不需要大费周章地引入各种方法计算积分了！}
$$\int^b_a [f(x)+g(x)] \dd x = \int^b_a f(x)\dd x + \int^b_a g(x)\dd x~.$$
\item 积分区间可加性
$$\int^b_a f(x) \dd x = \int^c_a f(x) \dd x  + \int^b_c f(x) \dd x ~.$$
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/6de706cf46f3b070.pdf}
\caption{积分区间可加性} \label{fig_DefInt_5}
\end{figure}
\item 翻转积分上下限会引入额外的负号 % (某种意义上，这相当于改变积分方向。这条性质其实不是很直观。如果你以“面积”来理解积分的含义的话)
$$\int^b_a f(x) \dd x = -\int^a_b f(x) \dd x~.$$
\item 积分不等式。 m指区间上f的最小值，M指最大值。
$$m(b-a)\le\int^b_a f(x) \dd x \le M(b-a)~.$$
\item 积分中值定理
$$\exists \xi \in [a,b], \int^b_a f(x) \dd x = f(\xi)(b-a)~.$$。或者说，$f(\xi)$就是该区间上定积分的“平均值”。 $ \overline f= f(\xi)=\frac{\int^b_a f(x) \dd x}{b-a}~.$
\end{itemize}

