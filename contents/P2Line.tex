% 点到直线的距离
% keys 点|直线|距离公式
% license Usr
% type Tutor

\begin{issues}
\issueDraft
\end{issues}

一点 $(x_1,y_1)$ 到直线 $ax + by + c = 0$ 的最短距离为
\begin{equation}
\frac{\abs{ax_1 + by_1 + c}}{\sqrt{a^2 + b^2}}~.
\end{equation}
最近点的坐标为
\begin{equation}
\qty(
\frac{b^2x_1 - aby_1 - ac}{a^2 + b^2}, \quad
\frac{a^2y_1 - abx_1 - bc}{a^2 + b^2})~.
\end{equation}

\subsection{推导}

根据\textbf{垂线段最短}，点 $(x_1, y_1)$ 距离直线 $ax + by + c = 0$ 最近的点也位于该直线的垂线上。

过点 $(x_1, y_1)$ 且垂直于直线 $ax+by+c=0$ 的直线方程为

\begin{equation}
bx - ay - bx_1 - ay_1 = 0~.
\end{equation}

它与直线 $ax + by + c = 0$ 的交点 $(x_2, y_2)$ 满足
\begin{equation}
\left\lbrace
\begin{aligned}
ax_2 + by_2 + c &= 0\\
bx_2 - ay_2-bx_1 + ay_1 &= 0
\end{aligned}~.
\right.
\end{equation}

解得
\begin{equation}
\left\lbrace
\begin{aligned}
x_2=\frac{b^2x_1 - aby_1 - ac}{a^2 + b^2}\\
y_2=\frac{a^2y_1 - abx_1 - bc}{a^2 + b^2}
\end{aligned}~.
\right.
\end{equation}

根据两点距离公式得
\begin{equation}
\begin{split}
d&=\sqrt{(x_1-\frac{b^2x_1 - aby_1 - ac}{a^2 + b^2})^2 + (y_1-\frac{a^2y_1 - abx_1 - bc}{a^2 + b^2})^2}\\
&=\frac{1}{a^2 + b^2}\sqrt{(a^2x_1 + aby_1 + ac)^2 + (b^2y_1 + abx_1 + bc)^2}\\
&=\frac{1}{\sqrt{a^2 + b^2}}\sqrt{(ax_1 + by_1 + c)^2}\\[3pt]
&=\frac{\abs{ax_1 + by_1 + c}}{\sqrt{a^2 + b^2}}~.\\
\end{split}
\end{equation}

\subsection{推导 2}

\pentry{几何矢量的内积\nref{nod_Dot}}{nod_cd87}
设直线 $ax + by + c = 0$ 的法向量为 $\bvec n$，则

\begin{equation}
\bvec a \vdot \bvec n = \cos \frac{\pi}{2} = 0~,
\end{equation}
所以 $\bvec n=(a,b)$。其中 $\bvec a=(b,-a)$，称为直线的方向向量。

那么直线的单位法向量（背向原点）为 $\uvec n = (-a/d, -b/d)$， 其中
\begin{equation}
d = \sqrt{a^2 + b^2}~.
\end{equation}
\addTODO{图}

若令原点到直线上任意一点的矢量为 $\bvec r$， 那么直线方程可以表示为
\begin{equation}
\bvec r \vdot \uvec n = \frac{c}{d}~,
\end{equation}
即直线到原点的距离为 $c/\sqrt{a^2 + b^2}$。

令任意一点为 $\bvec r_1 = (x_1, y_1)$， 那么 $\bvec r_1$ 到直线的距离为
\begin{equation}
\abs{(\bvec r_1 - \bvec r)\vdot \uvec n} = \abs{\bvec r_1\vdot \uvec n - \bvec r \vdot \uvec n}
= \frac{\abs{ax_1 + by_1 + c}}{\sqrt{a^2 + b^2}}~.
\end{equation}


 



\addTODO{推导过程配图}



\subsection{高维情形}

\addTODO{预备知识}

我们将\textbf{推导2}拓展到有限维的情况。

考虑一条 $n(n>2)$ 维空间中的直线，它的方程可以表示为
\begin{equation}
\bvec r = \bvec r_0 + \lambda\uvec a~.
\end{equation}
其中 $\bvec r_0$ 是原点到直线上某点的矢量，$\uvec a$ 是直线的单位方向向量（$n$ 维）。$\lambda$ 是一个参数，表示点在直线上的位置。
\addTODO{图}

令任意一点为 $\bvec r_1$。

设与 $\bvec r_1 - \bvec r_0$ 共面的直线的法向量 $\bvec n=k_1 \uvec a + k_2 (\bvec r_1 - \bvec r_0)$，则有下列方程
\begin{equation}
k_1 + k_2 \uvec a \vdot (\bvec r_1 - \bvec r_0) = 0 \quad (\uvec a \vdot \bvec n = 0)~.
\end{equation}

上述方程有无数个解，为了简单化，令 $k_2 = -1$。我们得到
\begin{equation}
\bvec n = [\uvec a \vdot (\bvec r_1 -\bvec r_0)]\uvec a - (\bvec r_1 - \bvec r_0)~.
\end{equation}

点 $\bvec r_1$ 到直线的距离为\footnote{$\abs{\bvec x \vdot \bvec y}\leq \abs{\bvec x}\abs{\bvec y}$。}
\begin{equation}
d=\frac{1}{\abs{\bvec n}}\abs{(\bvec r_1 - \bvec r_0) \vdot \bvec n}=\frac{\abs{\bvec r_1 - \bvec r_0}^2 - [\uvec a \vdot (\bvec r_1 - \bvec r_0)]^2
}{\abs{[\uvec a \vdot (\bvec r_1 - \bvec r_0)]\uvec a - (\bvec r_1 - \bvec r_0)}}~.
\end{equation}

我们可以知道
\begin{equation}
\abs{(\bvec x \vdot \bvec y)\bvec y - \bvec x}^2=(\bvec x \vdot \bvec y)^2 (\abs{\bvec y}^2-2) + \abs{\bvec x}^2~,
\end{equation}

所以
\begin{equation}
d=\abs{[\uvec a \vdot (\bvec r_1 - \bvec r_0)]\uvec a - (\bvec r_1 - \bvec r_0)}~.
\end{equation}

容易证明上述公式与 $\bvec r_0$ 的选取无关，因为 $d$ 是一个几何量。

如果我们取 $\bvec r_1=0$，则上述公式可以简化为
\begin{equation}
d=\abs{\bvec r_0 - (\uvec a \vdot \bvec r_0)\uvec a}~,
\end{equation}
这就是直线到原点的距离。

\addTODO{图}
