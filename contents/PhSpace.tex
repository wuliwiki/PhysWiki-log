% 相空间
% 统计力学|相空间|动量|位置

统计力学的目标是从微观角度看待大量例子构成的系统，从还原论视角看待描述宏观量、宏观现象。统计力学的舞台是“相空间”，相空间的维数很大，空间中的任意一点的坐标分量描述了每一个粒子的运动状态。下面我们将从最简单的模型出发介绍相空间。

\subsection{单个粒子的相空间}

单个粒子（看做质点） 的状态可以由3个位置坐标 $(x,y,z)$ 和三个动量坐标 $(p_x, p_y, p_z)$ 来描述， 为了便于拓展到一般情况， 我们用 $q_1 \equiv x$，   $q_2 \equiv y$， $q_3 \equiv z$   和 $p_1 \equiv p_x$， $p_2 \equiv p_y$， $p_3 \equiv p_z$ 表示。 想象一个由 3 个 $q_i$  坐标和3个 $p_i$  坐标组成的 $6$ 维空间（这就是单个粒子的相空间），体积元定义为
\begin{equation}
\dd{\Omega_1} = \dd{q_1}\dd{q_2}\dd{q_3} \vdot \dd{p_1}\dd{p_2}\dd{p_3}
\end{equation} 
为了方便表示， 简写为  $d{\Omega_1} = \dd[3]{q} \vdot \dd[3]{p}$。 
\begin{equation}
\Omega_1 = \int_{\Omega_1} \dd[3]{q} \dd[3]{p}
\end{equation} 
积分对所有可能的 $q_i$ 和 $p_i$ 进行。 例如粒子若被限制在一个长宽高分别为 $L_x, L_y, L_z$ 的盒子里， 而动量没有限制， 那么上面积分变为
\begin{equation}
\Omega_1 = \int_0^{L_x} \int_0^{L_y} \int_0^{L_z} \int \dd{q_1} \dd{q_2} \dd{q_3} \dd[3]{p} = L_x L_y L_z\int \dd[3]{p} 
\end{equation} 

根据量子力学粒子坐标的不确定度 $\Delta q$ 和与之共轭的动量的不确定度 $\Delta p$ 满足 $\Delta q\Delta p\approx h$，因此一个状态实际上对应着相空间的\textbf{相格}，其体积为 $h^3$，所以（这里只提供一种理解，不是证明）一个小体积元中的微观状态数可以表示为
\begin{equation}
\dd{\Omega}=\frac{1}{h^3}\dd{q_1}\dd{q_2}\dd{q_3} \vdot \dd{p_1}\dd{p_2}\dd{p_3}
\end{equation}

\subsection{相空间}
经典力学中， 对于 $N$ 个粒子（看作质点）的系统， 可以用 $3N$ 个位置坐标和 $3N$ 个动量坐标来完全描述系统的状态。则相空间为 $6N$ 维空间。用 $f$ 表示系统的自由度（在这里 $f=3N$），$q_1,q_2,\cdots,q_f$ 为它的 $N$ 个广义坐标，$p_1,p_2,\cdots,p_f$ 为与其共轭的广义动量，那么以　$q_1,\cdots,q_f,p_1,\cdots,p_f$ 共 $2f$ 个变量为直角坐标构成的 $2f$ 维相空间。

系统在某一时刻的运动状态 $q_1,\cdots,q_f,p_1,\cdots,p_f$ 可用相空间中的一点表示，称为系统运动状态的\textbf{代表点}。

系统的运动状态随时间而变，遵从哈密顿正则方程：
\begin{equation}\label{PhSpace_eq1}
\dot{q_i}=\frac{\partial H}{\partial p_i},\ \dot{p_i}=-\frac{\partial H}{\partial q_i},\ i=1,2,\cdots,f
\end{equation}

其中 $H$ 为系统的哈密顿量。对于保守系统，哈密顿量就是它的能量，包括粒子的动能，粒子相互作用的势能和在保守外场中的势能。它是 $q_1,\cdots,q_f,p_1,\cdots,p_f$ 的函数，当存在外场时还是外场参量的函数，但不是时间 $t$ 的显函数。当系统运动状态随时间变化，\autoref{PhSpace_eq1} 决定了代表点在相空间中的运动轨道。轨道是永不自交的曲线（可能是封闭曲线），不同的轨道也互不相交。

对于孤立系统，能量 $E$ 不随时间改变，那么哈密顿量 $H(q_1,\cdots,q_f;p_1,\cdots,p_f)=E$ 确定了相空间中的一个曲面，称为 \textbf{能量曲面}。

现在考虑由 $N$ 个\textbf{全同粒子}组成的系统，那么在计算微观状态数时我们需要除以 $N!$：
\begin{equation}
\Omega =\frac{1}{N!h^{3N}} \int {\dd}^{3N} q {\dd}^{3N} p 
\end{equation}