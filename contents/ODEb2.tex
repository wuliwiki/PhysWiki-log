% 常系数线性微分方程
% 复数|complex number|微分方程|高阶微分方程|ordinary differential equation|解法|特征方程|欧拉方程

\pentry{指数函数（复数）\upref{CExp}，线性微分方程的一般理论\upref{ODEb1}}

\subsection{实数轴上的复值函数}

首先介绍一个很有用的概念，复值函数．

复值函数和复变函数是不一样的．复变函数中的“变”指变量，因此复变函数是复数域到复数域的映射；但复值函数的自变量还是实数，它只是实数域到复数域的映射而已．

由于任何复数都可以写成$a+\I b$的形式，其中$a, b\in\mathbb{R}$，因此一个复值函数可以看成是两个实值函数的组合．

设$f(x), g(x)$是某给定区间上的连续实值函数，那么复值函数$z(x)=f(x)+\I g(x)$的极限被定义为$\lim\limits_{x\to x_0}z(x)=\lim\limits_{x\to x_0}f(x)+\I\lim\limits_{x\to x_0}g(x)$．进一步，$z(x)$的导函数是$z'(x)=f'(x)+\I g'(x)$．

复数的指数由欧拉公式定义：对于实数$a, b$，有
\begin{equation}
\E^{a+\I b}=\E^a(\cos b+\I\sin b)
\end{equation}

如果$K$是一个常数复数，那么$\E^{Kt}$就是一个关于实变量$t$的复值函数．这个函数继承了实值函数$\E^{at}$的很多优良性质．

\begin{theorem}{}
设$K, K_i$是复常数，$z(t), z_i(t)$是区间$[a, b]$上可导的复值函数，那么我们有：
\begin{itemize}
\item $\frac{\dd }{\dd t}(K_1z_1(t)+K_2z_2(t))=K_1z_1'(t)+K_2z_2'(t)$；
\item $\frac{\dd}{\dd t}(z_1(t)z_2(t))=z'_1(t)z_2(t)+z_1(t)z'_2(t)$；
\item $\E^{(K_1+K_2)t}=\E^{K_1t}\E^{K_2t}$；
\item $\frac{\dd }{\dd t}\E^{Kt}=K\E^{Kt}$．
\end{itemize}
\end{theorem}

另外，如果记$\overline{K}$是复数$K$的共轭\footnote{即如果存在实数$a, b$使$K=a+\I b$，那么$\overline{K}=a-\I b$．}，那么我们还有
\begin{equation}
\E^{\overline{K}}=\overline{\E^K}
\end{equation}

复值函数也可以作常系数常微分方程的解．考虑到常微分方程的全体解构成一个线性空间，复值函数可以看成是把这个解空间拓展为一个复数域上的线性空间．如果$\varphi(x)$、$\phi(x)$是某个常微分方程的实值解，那么$\I\varphi(x)$、$\varphi(x)+\I \phi(x)$也都是同一个方程的解．


\subsection{常系数齐次线性微分方程}

\subsubsection{无重根的特征方程}

由字面意义，可得定义：
\begin{definition}{}
形如
\begin{equation}\label{ODEb2_eq1}
\frac{\mathrm{d}^n}{\dd t^n}x(t)+a_1\frac{\mathrm{d}^{n-1}}{\dd t^{n-1}}x(t)+\cdots+a_{n-1}\frac{\mathrm{d}}{\dd t}x(t)+a_nx(t)=0
\end{equation}
的方程，称为\textbf{常系数齐次线性微分方程}．其中各$a_i$都是常数．
\end{definition}

求导运算中最方便的函数是什么？是$\E^{Kt}$，因为其结果总是正比于原来的函数．假设存在复数$\lambda$，使得$x(t)=\E^{\lambda t}$是\autoref{ODEb2_eq1} 的解，那么我们得到
\begin{equation}\label{ODEb2_eq2}
\E^{\lambda t}\qty(\lambda^n+a_1\lambda^{n-1}+\cdots+a_{n-1}\lambda+a_n)=0
\end{equation}

由于$\E^\lambda t$处处不为$0$，\autoref{ODEb2_eq2} 就可以化为
\begin{equation}\label{ODEb2_eq3}
\lambda^n+a_1\lambda^{n-1}+\cdots+a_{n-1}\lambda+a_n=0
\end{equation}

\autoref{ODEb2_eq3} 就被称为\autoref{ODEb2_eq1} 的\textbf{特征方程（eigenfunction）}．

如果从\autoref{ODEb2_eq3} 中解出$\lambda$\footnote{$\lambda$可以是复数，这就是为什么我们要先介绍复值函数的概念．}，那么$x(t)=\E^{\lambda t}$就是\autoref{ODEb2_eq1} 的一个解．根据预备知识中的\autoref{ODEb1_the1}~\upref{ODEb1}，如果\autoref{ODEb2_eq3} 有$n$个互不相同的解$\lambda_i$，那么$\{\E^{\lambda_i t}\}$就构成了\autoref{ODEb2_eq1} 的一组基解．这样，我们就把解\textbf{常系数齐次线性微分方程}化为解\textbf{代数方程}了．


事实上，由于我们常把高阶求导写成低阶求导的乘积形式，比如$\frac{\mathrm{d}^3}{\dd t^3}=\frac{\dd }{\dd t}\cdot\frac{\dd }{\dd t}\cdot\frac{\dd }{\dd t}$，，因此\autoref{ODEb2_eq3} 形式上相当于将$\frac{\dd }{\dd t}$替换为$\lambda$并消去$x(t)$后的结果．之所以我们可以将$\lambda$视为一个数字去解，也是因为$\E^{\lambda t}$在微分算子作用下的特殊性．


\begin{example}{}
考虑方程
\begin{equation}
\frac{\mathrm{d}^2}{\dd t}x(t)-\frac{\dd }{\dd t}x(t)-2x(t)=0
\end{equation}
其特征方程为
\begin{equation}
(\lambda-2)(\lambda+1)=0
\end{equation}

因此其通解为

\begin{equation}
x(t)=A\E^{2t}+B\E^{-t}
\end{equation}
其中$A, B$是常数．




\end{example}






\subsubsection{有重根的情况}



有的时候，特征方程存在重根，导致无法解出$n$个不同的$\lambda$，这时候该怎么办呢？我们先观察以下例子．

\begin{example}{}\label{ODEb2_ex1}
考虑方程
\begin{equation}\label{ODEb2_eq4}
\frac{\mathrm{d}^2}{\dd t}x(t)-2\frac{\dd }{\dd t}x(t)+x(t)=0
\end{equation}

其特征方程为
\begin{equation}
(\lambda-1)^2=0
\end{equation}

只能解出一个二重根$\lambda=1$．按照之前的讨论，我们只能给出一个基解$\E^{t}$，还有一个解怎么办呢？

尝试把$t\E^{t}$代进\autoref{ODEb2_eq4} 试试，我们发现这也是一个解．这样，我们就有了两个线性无关解，也就解出了\autoref{ODEb2_eq4} ．




\end{example}




为什么\autoref{ODEb2_ex1} 中给出的$t\E^{t}$也构成一个解呢？

我们首先考虑$k$重根里最简单的情况，即这个根为$\lambda_0=0$．这意味着特征方程里有一个因子$\lambda^k$，进而意味着\autoref{ODEb2_eq1} 里有一个因子$\frac{\mathrm{d}^k}{\dd t^k}=\qty(\frac{\dd}{\dd t})^k$，故原方程的形式应为
\begin{equation}
\qty(\frac{\mathrm{d}^n}{\dd t^n}+a_1\frac{\mathrm{d}^{n-1}}{\dd t^{n-1}}+\cdots+a_{n-k}\frac{\mathrm{d}^k}{\dd t^k})x(t)=0
\end{equation}
或更直观地，
\begin{equation}
\begin{aligned}
&\qty(\frac{\dd}{\dd t})^k\qty(\frac{\mathrm{d}^{n-k}}{\dd t^{n-k}}+a_1\frac{\mathrm{d}^{n-k-1}}{\dd t^{n-k-1}}+\cdots+a_{n-k})x(t)\\=&0\\
=&\qty(\frac{\mathrm{d}^{n-k}}{\dd t^{n-k}}+a_1\frac{\mathrm{d}^{n-k-1}}{\dd t^{n-k-1}}+\cdots+a_{n-k})\qty(\frac{\dd}{\dd t})^kx(t)
\end{aligned}
\end{equation}

相当于我们有两个方程
\begin{equation}
\leftgroup{
    &\qty(\frac{\dd}{\dd t})^kx(t)=0\\
    &\qty(\frac{\mathrm{d}^{n-k}}{\dd t^{n-k}}+a_1\frac{\mathrm{d}^{n-k-1}}{\dd t^{n-k-1}}+\cdots+a_{n-k})x(t)=0
}
\end{equation}

事实上，如果将特征方程拆分成$(\lambda-\lambda_1)^{k_1}(\lambda-\lambda_2)^{k_2}\cdots$的形式，原方程实际上就是在解每一个$\qty(\frac{\dd}{\dd t}-\lambda_i)^{k_i}x(t)=0$．因此，我们只需要考虑形如$\qty(\frac{\dd}{\dd t}-\lambda_0)^kx(t)=0$的方程即可．

在最简单情形下，我们要考虑的方程是
\begin{equation}
\qty(\frac{\dd}{\dd t})^kx(t)=0
\end{equation}
易验证它的一个基本解组是$\{1, t, t^2, \cdots, t^{k-1}\}$．这是因为形如$t^m$的多项式函数，能够在$\qty(\frac{\dd}{\dd t})^k$算子作用下变成$0$，其中$k>m$．

那么，对于一般的情况，即
\begin{equation}\label{ODEb2_eq5}
\qty(\frac{\dd}{\dd t}-\lambda_0)^kx(t)=0
\end{equation}
我们要考虑的就是什么样的$x(t)$能被$\qty(\frac{\dd}{\dd t}-\lambda_0)^k$变成$0$．

答案自然是形如$x^m\E^{\lambda_0 t}$的函数．

首先观察到
\begin{equation}
\qty(\frac{\dd}{\dd t}-\lambda_0)x^m\E^{\lambda_0 t}=mx^{m-1}\E^{\lambda_0 t}
\end{equation}
因此每个$\qty(\frac{\dd}{\dd t}-\lambda_0)$算子就像是在单独给$x^m$降阶．

于是
\begin{equation}
\qty(\frac{\dd}{\dd t}-\lambda_0)^mx^m\E^{\lambda_0 t}=m!\E^{\lambda_0 t}
\end{equation}

再作用一次，就得到
\begin{equation}
\qty(\frac{\dd}{\dd t}-\lambda_0)^{m+1}x^m\E^{\lambda_0 t}=0
\end{equation}

因此，对于任意$m<k$，$x^m\E^{\lambda_0 t}$都是\autoref{ODEb2_eq5} 的解．

这样，我们就得到齐次线性微分方程的完整通解了：

\begin{theorem}{齐次线性微分方程的通解}
将齐次线性微分方程\autoref{ODEb2_eq1} 分解为如下形式：
\begin{equation}\label{ODEb2_eq6}
\qty(\frac{\dd}{\dd t}-\lambda_1)^{k_1}\qty(\frac{\dd}{\dd t}-\lambda_2)^{k_2}\cdots\qty(\frac{\dd}{\dd t}-\lambda_r)^{k_r}x(t)=0
\end{equation}

换句话说，就是\autoref{ODEb2_eq1} 的特征方程有根$\lambda_1, \lambda_2, \cdots, \lambda_r$，且$\lambda_i$的重数为$k_i$．

那么\autoref{ODEb2_eq1} 或者说\autoref{ODEb2_eq6} 的基本解组为
\begin{equation}
\{
    \E^{\lambda_i t}, t\E^{\lambda_i t}, \cdots, t^{k_i-1}\E^{\lambda_i t}
\}
\end{equation}
其中$i\in\{1, 2, 3, \cdots, r\}$．



\end{theorem}




\subsection{常系数非齐次线性方程的比较系数法}






