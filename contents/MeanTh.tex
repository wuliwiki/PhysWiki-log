% 微分中值定理
% 拉格朗日中值定理|柯西中值定理|罗尔中值定理|mean value theorem

\pentry{导数\upref{Der}}

\subsection{一点准备}

\begin{definition}{函数极值}
考虑实函数 $f(x)$．如果\textbf{存在}一个实数轴上的开集 $O$，且有 $x_0\in O$，使得对于任意的 $x\in O$，都有 $f(x_0)\geq f(x)$，则称 $f(x_0)$ 是 $f$ 在 $O$ 上的一个\textbf{极大值（maximum）}；如果 $x_0$ 满足的条件改为对于任意的 $x\in O$，都有 $f(x_0)\leq f(x)$，则称 $f(x_0)$ 是 $f$ 在 $O$ 上的一个\textbf{极小值（minimum）}．

极大值和极小值统称为\textbf{极值（extremum）}．

如果 $f(x_0)$ 是一个极大值，那么称 $x_0$ 是一个\textbf{极大值点（maximum point）}；相应地，极小值对应的自变量 $x_0$ 是一个\textbf{极小值点（minimum point）}．极大值点和极小值点统称\textbf{极值点（extremum point）}．
\end{definition}


简单来说，极大值的意思就是，取包含极大值点的足够小的范围，那么范围内的所有函数值都小于等于极大值．极小值则反过来，范围内的函数值都大于等于它．

我们要求“\textbf{存在}一个开集 $O$”，实际上就是在说存在一个范围．

\begin{example}{}\label{MeanTh_ex1}
考虑实函数 $f(x)=x^3-x$，如\autoref{MeanTh_fig1} 所示．

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/MeanTh_1.pdf}
\caption{$f(x)=x^3-x$ 的函数图像．} \label{MeanTh_fig1}
\end{figure}

在 $x=\frac{\sqrt{3}}{3}$ 处，$f$ 取极小值，但显然不是最小值．

在 $x=-\frac{\sqrt{3}}{3}$ 处，$f$ 取极大值，也显然不是最大值．


\end{example}


\begin{theorem}{Fermat定理}\label{MeanTh_the1}
考虑实函数 $f(x)$．如果 $x_0$ 是 $f$ 的一个极值点，且 $f(x)$ 在 $x_0$ 处可导，那么 $f'(x_0)=0$．
\end{theorem}

\textbf{证明}：

假设 $f(x)$ 在 $x_0$ 处可导且取极大值，并\textbf{反设}$f'(x_0)>0$\footnote{取极小值和/或反设 $f'(x_0)<0$ 的情况可以类比，在此不赘述．反设就是指“反过来假设定理不成立”．}．

那么由于可导，$f(x)$ 在 $x_0$ 处的右极限存在且等于导数，即右极限大于零．这样一来，取任意正向接近 $x_0$ 的数列 $\{a_n\}$，则对于任意正整数 $N$，必然总有编号大于 $N$ 的 $a_n$ 使得 $f(a_n)>f(x_0)$\footnote{否则，如果存在一个正整数 $N$ 使得所有编号大于 $N$ 的 $a_n$ 都小于等于 $f(x_0)$，则这些 $a_n$ 计算出的割线斜率 $\frac{f(a_n)-f(x_0)}{a_n-x_0}$ 就小于等于零了，取极限以后，可得 $f'(x_0)\leq 0$，而这和我们反设的“$f'(x_0)<0$”相矛盾．}．又由于 $\lim\limits_{n\to\infty}a_n=0$，故得，对于任意包含 $x_0$ 的开集（范围）$O$（对应编号 $N$），总有 $f(a_n)>f(x_0)$，于是 $f(x_0)$ 就不是极大值了．

结论和假设矛盾，故反设部分不成立．将以上讨论推广到 $f(x_0)$ 取极小值和/或反设 $f'(x_0)<0$ 的情况后，可得最终结论：$f'(x_0)$ 必为零．

\textbf{证毕}．

\autoref{MeanTh_the1} 就可以用来快速计算出\autoref{MeanTh_ex1} 里的两个极值点的位置，即导数为零的地方．


\subsection{三个中值定理}

%缺例图

\begin{definition}{Rolle中值定理}
设 $f(x)$ 在区间 $[a, b]$ 上连续，在 $(a, b)$ 内可导，且 $f(a)=f(b)$，那么存在一个 $x_0\in(a, b)$，使得 $f'(x_0)=0$．
\end{definition}

罗尔微分中值定理可以利用\textbf{费马定理}\autoref{MeanTh_the1} 证明，即对最大值或最小值点处的导数进行分析．如果将函数 $f(x)$ 叠加上一个一次函数 $kx+b$，即满足 $f(b)-f(a)=k(b-a)$，那么就一定存在 $a< \xi <b$ 使得 $f'(\xi)=k$．于是可以得到以下定理

\begin{theorem}{拉格朗日微分中值定理}\label{MeanTh_the2}
若函数 $f(x)$ 在 $[a,b]$ 上连续，在 $(a,b)$ 内可导，则一定存在 $a< \xi <b$，使得
\begin{equation}\label{MeanTh_eq2}
f'(\xi)=\frac{f(b)-f(a)}{b-a}
\end{equation}
\end{theorem}

\begin{exercise}{}
证明勒让德（Legendre）多项式\footnote{这个著名的函数出现在球谐函数中，在学电动力学和量子力学时将会多次用到．}

\begin{equation}
P_n(x)=\frac{1}{2^n n!}\frac{\dd{} ^n}{\dd x^n}[(x^2-1)^n]
\end{equation}

在 $(-1,1)$ 内有 $n$ 个互异的实根．

\textbf{提示：}考察多项式函数 $f(x)=(x^2-1)^n$，它在 $x=\pm 1$ 处分别有 $n$ 重根．如果对它求一次导，由罗尔微分中值定理，$f'(x)$ 在 $(-1,1)$ 内至少有一个根，在 $x=\pm 1$ 处分别有 $n-1$ 重根．根据多项式函数因式分解的性质，$f'(x)$ 在 $(-1,1)$ 上只有一个根．再对它求导，……．以此类推，$f^{(n)}(x)$ 在 $(-1,1)$ 内恰好有 $n$ 个互异的根，在 $x=\pm 1$ 不再是 $f^{(n)}(x)$ 的根．
\end{exercise}
由上例可见，罗尔微分中值定理可以用来分析特殊函数的零点情况．有时我们还会通过构造辅助函数来分析零点．例如若连续函数 $f(x)$ 有两个零点 $x_1,x_2$，那么对任意 $a\in \mathbb{R}$，一定存在 $x_1<\xi<x_2$ 满足 $f'(\xi)-af(\xi)=0$．这可以通过构造函数 $g(x)=f(x)e^{-ax}$ 再利用罗尔微分中值定理即可．

\begin{exercise}{}
$\alpha$ 是大于 $0$ 的一个常数．函数 $f(x)=x^\alpha$ 在 $[0,\infty)$ 上是否一致连续（对 $\alpha$ 分类讨论）？

\textbf{提示：}回顾一致连续的定义，对任意 $\epsilon>0$，总存在 $\delta>0$，使得任取 $|x-y|<\delta(0\le x<y)$，都有 $|f(x)-f(y)|<\epsilon$．可以利用微分中值定理，总是存在 $x< \xi <y$，使得 $|f(x)-f(y)|=f'(\xi)|x-y|<\delta f'(\xi)$ （$f(x)$ 是单调递增函数）．这样一来我们就将一致连续性与导数联系了起来．要注意的是，当 $\alpha<1$ 时 $f(x)$ 在 $0$ 附近导数趋于无穷大，所以要对 $0$ 附近的邻域单独拎出来讨论（例如取区间 $[0,2]$，闭区间上的连续函数一定一致连续）．当 $\alpha\le1$ 时，邻域以外的部分 $f'(\xi)$ 将有上界，因此函数 $f(x)$ 一致连续．当 $\alpha>1$ 时，$f'(x)$ 随 $x$ 的增加而单调增加，趋于正无穷，于是有 $|f(x+\delta)-f(x)|=\delta f'(\xi) \ge\delta f'(x)$，因此 $f(x)$ 不一直连续．
\end{exercise}

\begin{theorem}{柯西微分中值定理}\label{MeanTh_the3}
若函数 $f(x)$ 和 $g(x)$ 在 $[a,b]$ 上连续，在 $(a,b)$ 内可导，而且 $g'(x)\neq 0$，则在 $(a,b)$ 内至少存在一点 $\xi$，使得
\begin{equation}\label{MeanTh_eq1}{}
\frac{f'(\xi)}{g'(\xi)}=\frac{f(b)-f(a)}{g(b)-g(a)}
\end{equation}
\end{theorem}
\begin{exercise}{}
函数 $f(x)$ 在 $(0,\infty)$ 上连续，证明对任意 $0 < a < b$，总是存在 $a < \xi < b, a< \psi <b$，使得
\begin{equation}
\frac{2f'(\xi)}{\xi^2}(a^2+ab+b^2)=\frac{3f'(\psi)}{\psi}(a+b)
\end{equation}
\textbf{提示：}上式经过变形可以写成
\begin{equation}
\frac{f'(\xi)}{3\xi^2}(a^3-b^3)=\frac{f'(\psi)}{2\psi}(a^2-b^2)
\end{equation}
这提示我们利用柯西微分中值定理，总是存在 $a<\xi,\psi<b$，使得
\begin{equation}
\begin{aligned}
\frac{f(a)-f(b)}{a^3-b^3}=\frac{f'(\xi)}{3\xi^2}\\
\frac{f(a)-f(b)}{a^2-b^2}=\frac{f'(\psi)}{2\psi}
\end{aligned}
\end{equation}
\end{exercise}