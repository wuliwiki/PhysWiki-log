% 外同态
% license Xiao
% type Tutor
\pentry{伴随映射\upref{AdjMap}}{nod_1a13}



注：本文参考 Jier Peter 的《代数学基础》。

几何代数有两种运算结构：依赖于二次型的标量积和与二次型无关的外代数形式。外同态既是线性空间的线性映射，亦是保外代数形式不变的同态映射（名副其实的\textbf{外同态}嘛）。
\begin{definition}{}
给定域$\mathbb F$上的几何代数$\mathcal G(V,q)$，$\mathcal G(W,q)$，及线性映射$f:V\rightarrow W$。称$f_{\wedge}:\mathcal G(V,q)\rightarrow \mathcal G(W,p)$为外同态（outermorphism）或者$\wedge$-同态，具有如下性质：
\begin{equation}
\begin{aligned}
f_\wedge(1)&=1,\\
f_\wedge|_V&=1,\\
f_\wedge(x\wedge y)&=f(x)\wedge f(y),\quad\forall x,y\in\mathcal G(V,q)~.
\end{aligned}
\end{equation}
\end{definition}
一般几何代数之间的线性映射指的就是外同态\footnote{外同态一般不保Clifford积。因为$f(ab)=a* b+f(a)\wedge f(b)$}。
由第三条可知，外同态$f_{\wedge}$取决于线性映射$f$。由于$f_{\wedge}|_V=f$，我们可得映射复合的外同态:$(g\circ f)_{\wedge}=g_{\wedge} \circ f_\wedge$。

线性空间的同态有矩阵表示，几何代数的外同态自然也有。
要导出矩阵表示，需要利用定义的三条性质。为了方便，我们在$\mathbb R^3$下讨论。
由于外积与空间是否退化无关，不妨选取标准正交基$\{e_i\}$。现在设$\mathbb R^3$上有线性映射$f$，对应矩阵表示如下：
\begin{equation}
F_b^a=\left(\begin{array}{lll}
a & b & c \\
d & e & f \\
h & i & j
\end{array}\right)~.
\end{equation}
第一列到第三列分别对应的标准正交基为$e_1,e_2,e_3$。
与之对应，可以排列外积的$basis$如下：
$$
\left\{e_{\varnothing}, e_{\{1\}}, e_{\{2\}}, e_{\{3\}}, e_{\{1,2\}}, e_{\{1,3\}}, e_{\{2,3\}}, e_{\{1,2,3\}}\right\}~.
$$
根据第三条，我们可以得到这组基对应的外同态矩阵表示为

\begin{equation}
F_B^A=\left(\begin{array}{cccccccc}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & a & b & c & 0 & 0 & 0 & 0 \\
0 & d & e & f & 0 & 0 & 0 & 0 \\
0 & h & i & j & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & a e-b d & a f-c d & b f-c e & 0 \\
0 & 0 & 0 & 0 & a i-b h & a j-c h & b j-c i & 0 \\
0 & 0 & 0 & 0 & d i-e h & d j-f h & e j-f i & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 0 & \operatorname{det} F_b^a
\end{array}\right) ~.
\end{equation}
具体计算以第五列为例,下标从小到大为排列的正方向：
\begin{equation}
\begin{aligned}
f_\wedge(e_1\wedge e_2)&=f(e_1)\wedge f(e_2)\\
&=(a e-b d)e_1 e_2+(a i-b h)e_1 e_3+ (d i-e h)e_2 e_3~.
\end{aligned}
\end{equation}
因此每行每列的元素对应一个行列式。如果列的基为a,b，行的基为c,d，对应从$F^a_b$矩阵里选第a,b列，c,d行来求行列式。

从矩阵表示里，我们可以清楚看到外同态具有明显的分次结构，保外积使得矩阵为分块对角矩阵，每一块都是行标和列标同次的部分。
\subsubsection{外同态的伴随}
通过定义二次型，任何线性映射都可以导出其伴随映射。外同态是几何代数上的线性映射，本节证明，其导出的伴随映射亦是外同态。也就是说，假设$f:V\rightarrow W$，$f_{\wedge}\,^*$保$W$上的外积不变。更准确来说：$f_{\wedge}\,^*=f^*\,_{\wedge}$。

\begin{theorem}{}
给定线性映射：$f:V\rightarrow W$，令$q,p$分别为$V,W$上的\textbf{非退化对称双线性形式}，关于$q,p$求线性映射的伴随映射$f^*$。则
\begin{equation}
f_{\wedge}\,^*=f^*\,_{\wedge}~.
\end{equation}
\end{theorem}
proof.
回顾伴随映射的定义：设上述线性映射$f$在这两组基下的矩阵为$F^a_b$，伴随映射$f^*$在这两组基下的矩阵为$G^a_b$。那么我们有：$G^a_b =q^{ja}p_{ib}F^i_j$。如果二次型是标准的，上式简化为$G^a_b=q(e_a)p(e_b)F^b_a$。
取标准正交基，使得二次型的对角元要么为$1$，要么为$-1$。那么求矩阵的伴随有两个过程：对部分元素取负及转置。因此该定理可以表述为：

"对$F^a_b$生成外同态，取负，转置”等同于“对$F^a_b$取负，转置，生成外同态”。

这里一共三个操作，所以证明思路包含两步：

1.证明对于同一线性映射，“生成外同态”和“取负”操作可互换。2.证明对于同一线性映射，“生成外同态”和“转置”操作可以互换。

第二步是非常好证明的。
\begin{lemma}{}
给定任意线性映射，矩阵表示为$F^a_b$。如果$G^a_b=F^b_a$，则$G^A_B=F^B_A$。
\end{lemma}
proof.
对于外同态的一次部分，这是显然的。下面看其他分次部分。
由外同态表示可知，$G^A_B$是对一次部分的若干列（A组列）和若干行（B组行）求行列式得到。由于一次部分是转置的结果，因此对应原矩阵的A组行以及B组列，也即$F^B_A$，得证。

接下来我们证明，“先生成外同态，再取负”“等同于先取负，再生成外同态”。
由于一次部分就是$F^a_b$，因此互换没有影响。现在我们讨论其他次部分。

先求外同态，再取负，那么取负结果$G'^A_B=q(e_A)p(e_B)G^A_B$。正如\autoref{eq_clf02_2}~\upref{clf02}所提到的，$q(e_A)=e_Ae_A=
(-1)^{\frac{|A|(|A|-1)}{2}} \prod_{i \in A} q(e_i)$，是基向量组内积的结果。

外同态由分次结构构成，因此$|A|=|B|$。则$G'^A_B$的系数为
\begin{equation}
q(e_A)p(e_B)=\prod_{i \in A} q(e_i)\prod_{j \in B} p(e_j)~.
\end{equation}

接下来我们看先取负再求行列式的情况。
原矩阵的每一个元素$F^i_j$都要乘以系数$q(e_i)p(e_j)$，而$G'^A_B$对应取A向量组为行，B向量组为列后矩阵的行列式。由于行列式的每一项都遍历了行与列，因此有共同系数$\prod_{i \in A} q(e_i)\prod_{j \in B} p(e_j)$，定理得证。


\begin{exercise}{}
给定几何代数$\mathcal G(V,q)$，线性变换$f:V\rightarrow V$保二次型不变。证明$f^*=f^{-1}$，且对于任意$x,y\in\mathcal G(V,q)$有$f_{\wedge}(x)*f_{\wedge}(y)=x*y$
\end{exercise}
