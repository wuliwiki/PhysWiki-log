% 麦克斯韦—玻尔兹曼分布
% 麦克斯韦|玻尔兹曼|速度分布|理想气体|动能|能量分布
\pentry{随机变量的变换\upref{RandCV}， 气体分子的速度分布\upref{VelPdf}， 高斯积分\upref{GsInt}}
\footnote{参考 \cite{新热} 以及维基百科\href{https://en.wikipedia.org/wiki/Maxwell-Boltzmann_distribution}{相关页面}。}理想气体分子的速率分布由\textbf{麦克斯韦—玻尔兹曼}分布来描述
\begin{equation}
f(v) = 4\pi \qty(\frac{m}{2\pi kT})^{3/2} v^2 \exp(-\frac{mv^2}{2kT})
\end{equation}
\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/MxwBzm_1.pdf}
\caption{麦克斯韦—玻尔兹曼速率分布示意图} \label{MxwBzm_fig1}
\end{figure}
这是速度大小的\textbf{概率密度函数}\upref{RandF}， 即速度模长在某个区间 $v \in [v_a, v_b]$ 的概率为
\begin{equation}
P_{ab} = \int_{v_a}^{v_b} f(v) \dd{v}
\end{equation}
假设系统中总分子数为 $N$，则速率在 $v_a$ 到 $v_b$ 范围内的分子个数为 $P_{ab}N$。如果我们对系统中所有分子的速率求平均，则平均速率为
\begin{equation}
\bar v = \int_{0}^\infty v f(v)\dd v= \sqrt{\frac{8kT}{\pi m}}
\end{equation}
速度平方平均值为
\begin{equation}\label{MxwBzm_eq1}
\overline {v^2} = \int_{0}^\infty v^2 f(v)\dd v = \frac{3kT}{m}
\end{equation}
概率最大的位置为（即 $(\dd f(v)/\dd v)|_{v=v_p}=0$）
\begin{equation}
v_p =\sqrt{\frac{2kT}{m}}
\end{equation}
动能分布为
\begin{equation}
f(E) = \frac{2}{kT}\sqrt{\frac{E}{\pi kT}} \exp(-\frac{E}{kT})
\end{equation}

更具体地，我们可以写出分子速度（方向确定）的概率分布函数 $f(\bvec v)=f(v)/(4\pi v^2)$。则速度在 $(v_x\text{~}v_x+\Delta v_x,\ v_y\text{~}v_y+\Delta v_y,\ v_z\text{~}v_z+\Delta v_z)$ 内的分子总数为 $N f(v_x,v_y,v_z)\Delta v_x\Delta v_y\Delta v_z$：

\begin{equation}
\begin{aligned}
&f(v_x,v_y,v_z)=\qty(\frac{m}{2\pi k T})^{3/2}\exp(-\frac{mv^2}{2kT})\\
&=\qty[\frac{m}{2\pi kT}\exp(-\frac{mv_x^2}{2kT})]\qty[\frac{m}{2\pi kT}\exp(-\frac{mv_y^2}{2kT})]\qty[\frac{m}{2\pi kT}\exp(-\frac{mv_z^2}{2kT})]\\
&=g(v_x^2)g(v_y^2)g(v_z^2)
\end{aligned}
\end{equation}
其中 $g(v_x^2)$ 表示分子速度的 $x$ 分量为 $v_x$ 的概率。由于系统是各向同性的，速度的 $y$ 分量概率分布函数、$z$ 分量概率分布函数都是 $g$。三个分量的概率分布是彼此独立的，则 $f(v_x,v_y,v_z)$ 自然是三者的乘积。这里我们用到了一些基本假设，这将在我们下面的推导中起重要作用。

\subsection{麦克斯韦速度分布的推导}
这一部分推导的前置知识是\textbf{气体分子的速度分布}\upref{VelPdf}，并需要读者熟悉多元函数微分学的计算。对于一个理想气体系统，我们基于以下几个基本假设来给出麦克斯韦速度分布。

\begin{enumerate}
\item 各向同性：如果我们任意地旋转系统，单个分子的速度方向改变了，但作为一个整体来说，系统中分子的\textbf{速度分布}不改变。即 $f(v_x,v_y,v_z)$ 是 $v_x^2+v_y^2+v_z^2$ 的函数。可以推出公式 $f(\bvec v)=f(v)/(4\pi v^2)$\footnote{由于 $f$ 是概率分布函数，$f(\bvec v)\dd v_x\dd v_y\dd v_z=f(v)\dd v$。在以 $v_x,v_y,v_z$ 为坐标分量的速度空间中，速率 $v\text{~}v+\dd v$ 占据了体积 $4\pi v^2\dd v$ 的球壳，所以 $\dd v=4\pi v^2 \dd v_x\dd v_y\dd v_z$。由此推出这个公式。}。

\item 方向独立：$f(v_x,v_y,v_z)=g(v_x^2)g(v_y^2)g(v_z^2)$，其中 $f(v_x,v_y,v_z)$ 表示速度的概率分布，$g(v_x^2),g(v_y^2),g(v_z^2)$ 表示速度在一个方向上的分量的概率分布，根据各向同性假设，这个概率分布与方向无关，所以可以都设为函数 $g$。
\end{enumerate}

由以上假设得出的公式如下：
\begin{equation}
\frac{f(v)}{4\pi v^2}=f(v_x,v_y,v_z)=g(v_x)g(v_y)g(v_z)
\end{equation}
设 $F(v^2)=F(v_x^2+v_y^2+v_z^2)=f(v)/(4\pi v^2)$。我们对两侧取对数，可以得到：
\begin{equation}
\ln F(v^2)=\ln g(v_x^2)+\ln g(v_y^2)+\ln g(v_z^2)
\end{equation}
两边对 $v_x^2$ 求导，有
\begin{equation}
\begin{aligned}
&\frac{\partial \ln F(v^2)}{\partial v_x^2}=\frac{\partial \ln g(v_x^2)}{\partial v_x^2}
\\
&\frac{\partial \ln F(v^2)}{\partial v_x^2}=\frac{\partial \ln F(v^2)}{\partial v^2} \frac{\partial v^2}{\partial v_x^2}=\frac{\partial \ln F(v^2)}{\partial v^2}=\frac{\partial \ln g(v_x^2)}{\partial v_x^2}
\end{aligned}
\end{equation}

注意上式中第一第二行 $F$ 之所以能对 $v^2$ 作偏微分，是因为概率分布函数本身就是 $v^2$ 的函数，与 $\bvec v$ 的方向无关。也就是说，这一步用了各向同性假设。

同理，我们可以得到以下等式

\begin{equation}
\frac{\partial \ln F(v^2)}{\partial v^2}=\frac{\partial \ln g(v_x^2)}{\partial v_x^2}=\frac{\partial \ln g(v_y^2)}{\partial v_y^2}=\frac{\partial \ln g(v_z^2)}{\partial v_z^2}
\end{equation}

我们可以控制 $v^2$ 不变，调整 $v_x,v_y,v_z$ 的大小，则上式的值仍然不变。也就是说，上式的值只能是一个常数。于是可以通过积分得到 $g(v_x^2)$：
\begin{equation}
\begin{aligned}
&\frac{\partial \ln g(v_x^2)}{\partial v_x^2} = -a\\
&g(v_x^2)=C\exp(-av_x^2)\\
\end{aligned}
\end{equation}

$g(v_x^2)$ 为高斯分布，由分布函数的归一化条件 $\int_{-\infty}^\infty g(v_x^2)\dd v_x=1$ 可以求得常数 $C$ 和 $a$ 的关系。我们再进一步利用分子平均动能与温度的关系\autoref{PVnRT_eq3}~\upref{PVnRT} （也就是说，分子速度平方的平均值应当满足 \autoref{MxwBzm_eq1} ，$v_x^2$ 的平均值是它的 $1/3$ 倍，推导见\autoref{VelPdf_eq1}~\upref{VelPdf}）求得 $a$。最终得到以下等式

\begin{equation}
g(v_x^2)=\sqrt{\frac{m}{2\pi kT}}\exp(\frac{-mv_x^2}{2kT})
\end{equation}

从而可以得到完整的麦克斯韦速度分布公式
\begin{equation}
f(v_x,v_y,v_z)=g(v_x^2)g(v_y^2)g(v_z^2)=\qty(\frac{m}{2\pi k T})^{3/2}\exp(-\frac{mv^2}{2kT})
\end{equation}
