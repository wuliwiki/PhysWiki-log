% 四象限 Arctan 函数（atan2）
% atan2|反三角函数|反正切|arctan

\pentry{反正切函数}

我们经常会遇到这样一个问题： 已知平面直角坐标系上一点 $P$， 坐标为 $(x, y)$， 求射线 $OP$ 与 $x$ 轴正方向的夹角 $\theta$。%图未完成
首先我们要给这个夹角取一个范围， 一般来说既可以取 $[0, 2\pi)$ 也可以取 $(-\pi, \pi]$， 但如无特殊说明， 我们统一使用后者。

一些教材中直接用 $\theta = \arctan(y/x)$， $\theta \in (-\pi/2, \pi/2)$ 来表示这一关系， 这是不严谨的， 因为只能表示半个圆周。 我们下面来定义一个符合要求的新函数， 记为 $\Arctan(y, x)$。 在许多计算机编程语言中 $\arctan$ 被记为 \lstinline|atan|， $\Arctan$ 被记为 \lstinline|atan2|。 也有一些文献使用 $\opn{Tan}^{-1}$。 其中定义为 $x, y \in \mathbb R$， 即任意实数， 值域为 $(-\pi, \pi]$。

\begin{equation}\label{eq_Arctan_1}
\Arctan(y,x) \equiv 
\begin{cases}
\arctan (y/x) \quad &(x > 0)\\
\arctan (y/x) + \pi  &(x < 0,\,y \geqslant 0)\\
\arctan (y/x) - \pi  &(x < 0,\,y < 0)\\
\pi /2  &(x = 0, \,y > 0)\\
 -\pi /2  &(x = 0, \,y < 0)\\
0 & (x=0,\,y=0)
\end{cases}
\end{equation}
本书统一使用该定义， 但也有一些其他文献将其定义为上式加 $\pi$， 使值域为 $(0, 2\pi]$， 或者认为 $x = 0, y = 0$ 无定义（不属于定义域）。

\subsection{偏导数}
\pentry{偏导数\upref{ParDer}}
函数在除了在原点和 $x$ 轴的负半轴， 在其它定义域都是连续且光滑的， 即存在连续的无穷阶偏导\upref{ParDer}。 一阶偏导为
\begin{equation}
\pdv{x} \Arctan(y, x) = \frac{-y}{x^2 + y^2} \qquad
\pdv{y} \Arctan(y, x) = \frac{x}{x^2 + y^2}~.
\end{equation}
