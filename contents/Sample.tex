% 词条示例
% 小时百科|词条编辑|latex|宏包

\begin{issues}
\issueOther{用 issues 环境列出文章存在的所有问题。}
\issueDraft       %本词条处于草稿阶段
\issueTODO        %本词条存在未完成的内容
\issueMissDepend  %本词条缺少预备知识，初学者可能会遇到困难
\issueAbstract    %本词条需要更多讲解，便于帮助理解
\issueNeedCite    %本词条需要更多参考文献
\end{issues}

\pentry{二项式定理\upref{BiNor}， LaTeX 结构简介\upref{latxIn}}

本词条需要与 LaTeX 源码对照阅读， 请使用\href{https://wuli.wiki/editor}{在线编辑器}打开 Sample.tex。

\subsection{蓝色的小节标题}
这是正文。
\subsubsection{黑色的子节标题}
正文的任何地方可以用 \verb|\addTODO{}| 命令插入未完成提示。
\addTODO{这里可以填写未完成提示}

\subsection{正文}\label{sub_Sample_16}
正文必须使用中文的括号，逗号，引号，冒号，分号，问号，感叹号，以及空心句号\footnote{《GB\_T15834\_2011 中华人民共和国国家标准标点符号用法》标准中允许科技文献中使用实心句号， 但 GB\_T15834\_2011 版的新标准规定都用空心。}， 禁止使用英文标点。 但为了打字方便， 行间公式最后仍允许英文逗号和句号， 注意要在前面加 \verb|~|， 且逗号后面需要有足够的空白（\verb|\quad| 或者 \verb|\qquad|）， 例如
\begin{equation}\label{eq_Sample_2}
a + b = c~, \quad d + e = f~.
\end{equation}

像 “牛顿—莱布尼兹公式” 中的横线必须用中文单破折号。 所有的标点符号前面不能有空格， 后面尽量有空格。 正文粗体如\textbf{粗体}。 正文中禁止使用 \verb|\\| 换行， 以及 \verb|\noindent|， \verb|\phantom| 等命令强制修改格式。

引用 subsection 如\autoref{sub_Sample_16}， 又如\autoref{sub_BiNor_5}~\upref{BiNor}。

\subsection{公式}
行内公式用 \verb|$...$| 或者 \verb|\(...\)|， 两边需要有空格， 例如 $a^2+b^2=c^2$， 后面有标点符号的除外。 行间公式如
\begin{equation}\label{eq_Sample_1}
(a+b)^n = \sum_{i=0}^n C_n^i a^i b^{n-i} \quad (\text{$n$ 为整数})~.
\end{equation}

行间公式的 label （标签）必须要按照 \verb|词条标签_eq编号| 的格式， 只有需要引用的公式才加标签， 标签编号无需和编译后的编号相同， 保证标签不重复即可。 图、表的标签分别把 \verb|eq| 改成 \verb|fig| 和 \verb|tab| 即可，例题用 \verb|ex|， 习题用 \verb|exe|。但凡是有 \verb|\caption| 命令的，\verb|\label| 需要紧接其后。 事实上标签不建议手动添加， 可以用菜单栏上的按钮在引用时同时自动插入 \verb|\label| 和 \verb|\autoref|， 详见编辑器使用说明\upref{editor}。

行间公式如果不需要编号， 可以用 \verb|$$...$$| 或者 \verb|\[...\]|。


单个参数的命令若只有一个字符， 那么不需要加花括号， 例如 $\mathrm a$ 等效于 $\mathrm{a}$。 如果参数是数字甚至也不需要空格， 例如 $\frac12$。

公式中的空格从小到大如 $a\, b\; c\quad d\qquad e$。 公式中三点省略号用 $\dots$， 如果要强制在下方， 用 $\ldots$。 实部和虚部如 $\Re[z], \Im[z]$。 双重极限如
\begin{equation}
\lim_{\substack{\Delta x_i\to 0\\ \Delta y_i\to 0}} \sum_{i, j} f(x_i,y_i) \Delta x_i \Delta y_j~.
\end{equation}
注意行内公式的 \verb|\lim| 和 \verb|\sum| 如果要在正上方或正下方写东西， 需要加 \verb|\limits|， 如 $\lim\limits_{x\to 0}$。 但是 \verb|\limits| 只能给算符使用， 如果要对任意符号使用可以用 \verb|\underset| 或者 \verb|\overset|， 例如 $\underset{i \ge 0}{\bigcup}$。

上下方的花括号例如
\begin{equation}
\overbrace{n(n-1)(n-2)\dots}^{\text{共 $m$ 项}} \qquad \underbrace{n(n-1)(n-2)\dots}_{\text{共 $m$ 项}}~
\end{equation}
方括号用 \verb|\overbracket| 和 \verb|\underbracket|。

如果要强制分式正常大小显示， 用 \verb|\dfrac| 命令， 如果 \verb|\frac| 后面只有两个字符的代码，可以写成如 \verb|\frac12|， \verb|\frac ab|， \verb|\frac1a| 等。 斜分数线后面若多于一个变量需要加括号， 如 $ab/(cd)$。

行内分式如 $a/b$， 不允许行内用立体分式。 几何矢量如 $\bvec a$， 不要使用带箭头的矢量如 $\vec a$。 

行间公式换行及对齐用 aligned 环境（可以选中一段公式代码然后按菜单的 “对齐” 按钮）， 注意该环境可嵌套。
\begin{equation}
\begin{aligned}
(a-b)^2 &= a^2+b^2 - 2ab \\
& = a^2+b^2+2ab-4ab\\
& = (a+b)^2-4ab~.
\end{aligned}
\end{equation}

用 \verb|\begin{enumerate}[resume]|  来继续上一个 enumerate 的编号。

可变化尺寸的斜分数线如下
\begin{equation}
\left. \pdv[2]{X}{x} \middle/ X + \pdv[2]{Y}{y} \middle/ Y + \pdv[2]{Z}{z} \middle/ Z  = \frac{1}{c^2}  \pdv[2]{T}{t} \middle/ T\right.~.
\end{equation}
左大括号用 \verb|cases| 环境， 如
\begin{equation}
\begin{cases}
d+e+f = \int \frac{a}{b} \dd{x} &(a > 0)\\
a+b = c &(b > 0)~.
\end{cases}
\end{equation}
但是注意 \verb|cases| 环境里面的符号都是小尺寸的（与行内公式相同）， 且每行只能用一次 \verb|&|。 若需要全尺寸公式可以用下文定义的 \verb|\leftgroup| 命令。

反斜杠有两种形式：$\backslash$和$\setminus$。前者在一般需要斜杠时用，而集合减法应该用后者。使用实例：$A\backslash B$，$A\setminus B$。

希腊字母如下
\begin{equation}
\begin{aligned}
&\alpha (a), \beta (b), \chi (c), \delta (d), \epsilon/\varepsilon (e), \phi (f), \gamma (g),
\eta (h), \iota (i), \varphi (j), \kappa (k), \lambda (l), \mu (m),\\
& \nu (n), o (o), \pi (p), \theta (q), \rho (r), \sigma (s), \tau (t), \upsilon (u), \varpi (v), \omega (w), \xi (x), \psi (y), \zeta (z)~.
\end{aligned}
\end{equation}
普朗克常数为 $\hbar$。 另外我们自定义了 $\lambdabar$， 相当于 $\mkern-0.25mu {\bar{\phantom{a}}} \mkern -10.2mu\lambda$。

双线字母如下
\begin{equation}
\begin{aligned}
&\mathbb{a\, b\, c\, d\, e\, f\, g\, h\, i\, j\, k\, l\, m\, n\, o\, p\, q\, r\, s\, t\, u\, v\, w\, x\, y\, z}~,\\
&\mathbb{A\, B\, C\, D\, E\, F\, G\, H\, I\, J\, K\, L\, M\, N\, O\, P\, Q\, R\, S\, T\, U\, V\, W\, X\, Y\, Z}~,
\end{aligned}
\end{equation}
几种花体字母如下
\begin{equation}
\mathcal{A\, B\, C\, D\, E\, F\, G\, H\, I\, J\, K\, L\, M\, N\, O\, P\, Q\, R\, S\, T\, U\, V\, W\, X\, Y\, Z}~,
\end{equation}
\begin{equation}
\begin{aligned}
&\mathscr{a\, b\, c\, d\, e\, f\, g\, h\, i\, j\, k\, l\, m\, n\, o\, p\, q\, r\, s\, t\, u\, v\, w\, x\, y\, z}~,\\
&\mathscr{A\, B\, C\, D\, E\, F\, G\, H\, I\, J\, K\, L\, M\, N\, O\, P\, Q\, R\, S\, T\, U\, V\, W\, X\, Y\, Z}~,
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
&\mathfrak{a\, b\, c\, d\, e\, f\, g\, h\, i\, j\, k\, l\, m\, n\, o\, p\, q\, r\, s\, t\, u\, v\, w\, x\, y\, z}~,\\
&\mathfrak{A\, B\, C\, D\, E\, F\, G\, H\, I\, J\, K\, L\, M\, N\, O\, P\, Q\, R\, S\, T\, U\, V\, W\, X\, Y\, Z}~.
\end{aligned}
\end{equation}

\subsection{使用 physics 宏包}
MathJax 本身不支持 physics 宏包， 我们进行了一定的改进\footnote{后台程序在把 tex 文件翻译成 html 页面时， 把 physics 宏包或者我们自定义的命令翻译成了 MathJax 兼容的代码。 如果对 html 的公式点击右键获取公式代码， 得到的仍然是兼容 MathJax 的代码。}。 Physics 宏包的文档见\href{http://mirrors.ibiblio.org/CTAN/macros/latex/contrib/physics/physics.pdf}{这里}， 目前仅支持 Physics 宏包的以下命令。

绝对值如 $\abs{a}$ （自动尺寸， 下同）， 微分符号如 $\dd{x}$， 可变尺寸的小中大括号可以用 \verb|\qty|， 如
\begin{equation}
\qty(\frac ab)^2~, \qquad \qty[\frac ab]^2~, \qquad \qty{ \frac ab}~.
\end{equation}
矢量内积如 $\bvec A \vdot \bvec B$ （\verb|\vdot| 不可省略， 不要用 \verb|\cdot|），矢量叉乘如 $\bvec A\cross\bvec B$。

常用三角函数和对数函数后面的小括号会自动改变尺寸（中括号不可以），若要给他们加幂，用中括号
\begin{equation}
\sin(\frac ab)~, \qquad \sin[2](\frac ab)~.
\end{equation}
自然指数后面的小括号和中括号都可以自动尺寸
\begin{equation}
\exp(\frac12)~, \qquad \exp[\frac12]~.
\end{equation}

导数和偏导可以用
\begin{equation}
\dv{x}~, \quad \dv{f}{x}~, \quad \dv[2]{f}{x}~, \quad \dv*[2]{f}{x}~, \quad
\pdv{x}~, \quad \pdv{f}{x}~, \quad \pdv[2]{f}{x}~, \quad \pdv{f}{x}{y}~, \quad \pdv*[2]{f}{x}~.
\end{equation}
要写到行内可以加 \verb|*|， 如 $\pdv*[2]{f}{x}$。

定积分求值如 $\eval{x^2}_0^1$ （自动尺寸）。

对易算符如 $\comm{\Q A}{\Q B}$ 或 $\comm*{\Q A}{\Q B}$， 前者自动尺寸， 后者强制小尺寸。 泊松括号同理： $\pb{\frac12}{B}$， $\pb*{\frac12}{B}$。

梯度散度旋度拉普拉斯如 $\grad V$，$\div\bvec A$， $\curl\bvec A$， $\laplacian V$。

狄拉克符号（加 \verb|*| 号强制小尺寸）如 $\bra{a}, \ket{b}, \braket{a}, \braket{a}{b}, \mel{a}{Q}{b}$。 平均值（加 \verb|*| 号强制小尺寸）如 $\ev*{Q}, \ev{Q}{\psi}$。 同理也有 $\ketbra*{a}{b}$， $\ketbra{a}{b}$， $\ketbra{a}$。


\subsection{自定义的命令}
小时百科和云笔记的模板的自定义的命令如下， 如果不使用， 要保证编译后效果相同。 如果想新添加定义， 请联系管理员。

引用公式和图表都统一使用 \verb|\autoref| 命令， \verb|\autoref| 和 \verb|\label| 都无需手动插入， 可以用在线编辑器菜单栏中的 “内部引用” 和 “外部引用” 按钮（实心和空心的双引号图标）。 注意 \verb|\autoref{}| 前面不加空格后面要加空格（后面是标点符号除外）， 例如\autoref{eq_Sample_1}。 如果要引用其他词条中的公式，可以引用 “其他词条\upref{BiNor}” 的\autoref{eq_BiNor_1} 也可以用 “\autoref{eq_BiNor_1}~\upref{BiNor}”， 为了区分内部和外部引用 \verb|\upref| 不能忽略。 在 pdf 上， \verb|\upref{}| 会显示为页码。

科学计数法如 $1.2\e3$ 或 $1.2\e{34}$， 单位矢量如 $\uvec a$， 自然对数底如 $\E$， 复数如 $u+\I v$ 虚数单位不能用斜体 $i$，复共轭如 $z\Cj$。

定义 \verb|\opn{}| 和 \verb|\operatorname{}| 等效。 自定义的 operator 或者函数名（如 \verb|\sinc| 相当于 \verb|\operatorname{sinc}| 或者 \verb|\opn{sinc}|）有： \verb|\Arctan|, \verb|\sinc|，\verb|\erf|，\verb|\erfi|， \verb|\Im|， \verb|\Re|。

写量纲用 \verb|\Si{}| 命令， 如 $100\Si{m/s^2}$， 这个命令只能出现在公式环境内。 着相当于 \verb|\mathrm{}|。

矩阵 $\mat A$， 转置 $\mat A\Tr$， 厄米共轭用 $\mat A\Her$。 常见的几种矩阵括号如
\begin{equation}
\pmat{1&2\\3&4}~, \qquad
\vmat{1&2\\3&4}~, \qquad 
\bmat{1&2\\3&4}~, \qquad
\Bmat{1&2\\3&4}~, \qquad
\pmat{1&2\\3&4}\Tr~, \qquad
\pmat{1&2\\3&4}\Her~.
\end{equation}
行内的列矢量用行矢量的转置表示，如 $\pmat{1& 2& 3& \dots}\Tr$。 张量如 $\ten T$， 效果同 \verb|\mat|。

单独一个粗体的 $\nabla$ 用 $\Nabla$。

自定义的 \verb|\leftgroup{}| 命令， 相当于 \verb|\left\{\begin{aligned}... \end{aligned}\right.|
\begin{equation}
\leftgroup{
&d+e+f = \int \frac{a}{b} \dd{x} &&(a > 0)\\
&a+b = c &&(b > 0)~.
}
\end{equation}
这相当于一个可变尺寸的 \verb|{| 加上 \verb|aligned| 环境
\begin{equation}
\left\{
\begin{aligned}
&d+e+f = \int \frac{a}{b} \dd{x} &&(a > 0)\\
&a+b = c &&(b > 0)~.
\end{aligned}
\right.
\end{equation}

表格中若用 \verb|\dfrac|， 需要在行首加上 \verb|\dfracH| 命令。% 未完成： 为什么？

量子力学算符如 $\Q a$（一般可以不加， 只有必要的时候加）， 矢量量子算符如 $\Qv p$ （效果同 \verb|\uvec|）。

\subsection{图表}

位图必须使用 png 格式， 矢量图（推荐）必须以 pdf 和 svg 格式\footnote{pdf 格式用于 pdf 版的百科， svg 用于网页显示}放在 figures 文件夹中。 文件名是词条 label 加下划线以及图片序号， 如 \verb|da8815a7f79f2f52.pdf|。 即使只有一张图片也要加上 \verb|_1|。 生成 svg 时， 字体一律用 outline， 更多选项中保留 7 位小数， 如果矢量图中包含位图， 要把 Image Location 选成 embed。 pdf 图片用于 latex 的 figure 环境， svg 图片用于 html 网页。图片宽度一律用 cm 为单位。 注意当前图片最大尺寸只能是 14.25cm， 对应 33 个汉字。 这个比例在 pdf 和 html 中都必须保持一致， 否则图中的文字大小可能会不协调。 由于 pdf 每行字数只有 33 个， 所以 html 中的图片不可能把页面占满。
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/da8815a7f79f2f52.pdf}
\caption{一二三四五六七八九十一二三四五六七八九十一二三四五六七八九十一二三口口口} \label{fig_Sample_1}
\end{figure}
引用图片如\autoref{fig_Sample_1}。 在 \verb|figure| 环境中， 必须用 \verb|\caption{}| 指定标题， \verb|\label{}| 只能放在 caption 的后面，否则编号会出错。由于在 pdf 中图片是浮动的，避免使用“上图”，“下图”等词。

再来看一个表格，如\autoref{tab_Sample_1}。 注意 \verb|\label| 同样要放在 \verb|\caption| 后面。
\begin{table}[ht]
\centering
\caption{极限 $\E$ 数值验证}\label{tab_Sample_1}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$x$ & ${10^{ - 1}}$ & ${10^{ - 2}}$ & ${10^{ - 3}}$ & ${10^{ - 4}}$ & ${10^{ - 5}}$ & ${10^{ - 6}}$ \\
\hline
$(1 + x)^{1/x}$ & 2.59374 & 2.70481 & 2.71692 & 2.71815 & 2.71827 & 2.71828 \\
\hline
\end{tabular}
\end{table}

定义如\autoref{def_Sample_1}。
\begin{definition}{名称（可省略）}\label{def_Sample_1}
定义导数为
\begin{equation}
f'(x) = \lim_{h \to 0} \frac{f(x + h) - f(x)}{h}~.
\end{equation}
\end{definition}

引理如\autoref{lem_Sample_1}。
\begin{lemma}{名称（可省略）}\label{lem_Sample_1}
三角形内角和为 $\pi$
\end{lemma}

定理如\autoref{the_Sample_1}。
\begin{theorem}{名称（可省略）}\label{the_Sample_1}
内错角相等
\end{theorem}

推论如\autoref{cor_Sample_1}
\begin{corollary}{名称（可省略）}\label{cor_Sample_1}
1 + 2 = 3
\end{corollary}

例子如\autoref{ex_Sample_1}。 
\begin{example}{名称（可省略）}\label{ex_Sample_1}
在例子中，我们的字体可以自定义，包括公式的字号会保持与内容一致。
\begin{equation}
(a+b)^n = \sum_{i=0}^n C_n^i a^i b^{n-i} \quad (\text{$n$ 为整数})~.
\end{equation}
\end{example}

习题如\autoref{exe_Sample_1}。 
\begin{exercise}{名称（可省略）}\label{exe_Sample_1}
已知 $b$ 和 $c$， 求 $a^2 + b^2 = c^2$。
\end{exercise}

\subsection{代码}
在行内显示代码用 \verb|\verb| 命令。 注意这个命令比较特殊， 可以用任何两个相同的符号作为定界符（星号 \verb|*| 除外）， 如 \verb+\verb?some|code?+ 会显示为 \verb?some|code?。 注意定界符必须是代码中没有的字符。

自动高亮的代码块使用 \verb|lstlisting| 环境（禁止用 \verb|\lstinputlisting| 从文件输入）
\begin{lstlisting}[language=matlabC]
s = 'abc'; % 一些评论
A =
     1     1    -1     1     3
     2     2    -2     1     7
     1     1     0     2     3
     2     2    -1     5     4

% 测试自定义关键字（必须是高亮）
matlabCTestKeyWord;
\end{lstlisting}

如果 lstlisting 标明了文件名（下划线需要用 \verb|\_| 转义）， 代码文件夹中就会自动生成该文件。 较长的代码文件必须含文件名， 文件名需要反映代码的内容而不是与词条 label 同名。
\addTODO{未完成： 后台处理 lstlisting 的 caption 时不应该在 html 显示空格转义的反斜杠}
\addTODO{未完成： 后台是否还不支持 lstlisting 环境的 label 以及引用。}

\begin{lstlisting}[language=matlab, caption=sample\_code.m]
% 验证二项式定理(非整数幂)
u = -3.5;
x = 0.6; % |x|<1 使级数收敛
N = 100; % 求和项数
Coeff = 1; % x^ii 项前面的系数
result = 1; % 求和结果
for ii = 1:N
    Coeff = Coeff*(u-ii+1) / ii;
    result = result + Coeff * x^(ii);
end
disp('直接计算结果为');
format long; % 显示全部小数位
disp((1+x)^u);
disp('求和结果为');
disp(result);
format short; % 恢复默认显示

% 测试自定义关键字（必须是高亮）
matlabTestKeyWord;

% 测试函数颜色（必须是黑色）
tan; cot; asin; acos; atan; arg; real; imag; sum;
mean; diff; floor; ceil; mod; sinh; cosh; round;
tanh; zeros; ones; rand; randn; eye; magic;
\end{lstlisting}

C++ 代码例如
\begin{lstlisting}[language=cpp]
template <class T, class T1, class T2,
MY_IF(is_scalar<T>() && is_scalar<T1>() && is_scalar<T2>())>
void Plus(T &v, const T1 &v1, const T2 &v2)
{ v = v1 + v2; }
\end{lstlisting}

Python 代码例如
\begin{lstlisting}[language=python]
def: fun1
	return 'hello'
\end{lstlisting}

Mathematica 代码如
\begin{lstlisting}[language=mma]
(* 定义库仑函数 *)
CoulombF[l_, η_, ρ_] := 2^l E^(-π η/2) \
    Abs[Gamma[l + 1 + I η]]/(2 l + 1)! ρ^(l + 1) E^(-I ρ) \
    Hypergeometric1F1[l + 1 - I η, 2 l + 2, 2 I ρ]
\end{lstlisting}

Julia 代码如
\begin{lstlisting}[language=julia]
2^l *exp(-π η/2) (2 l + 1)! ρ^(l + 1) E^(-I ρ)
\end{lstlisting}

Makefile 代码如
\begin{lstlisting}[language=Makefile]
goal:
    g++ -O3 main.cpp -o main.x
\end{lstlisting}

LaTeX 代码如
\begin{lstlisting}[language=latex]
\begin{equation}
a^2 + b^2 = c^2
\end{equation}
\end{lstlisting}

Bash 代码如
\begin{lstlisting}[language=bash]
echo good > 123.txt
\end{lstlisting}

JavaScript 代码如
\begin{lstlisting}[language=js]
var a = 3
\end{lstlisting}

其他不支持高亮的代码都可以暂时用 \verb|none| 语言， 并注释实际的语言
% 未完成： [language=abcde]
\begin{lstlisting}[language=none]
abcde = 2^l E^(-π η/2)
\end{lstlisting}

\subsection{Unicode 支持}
正文中的 unicode 支持如 mäthμ≥≤， 代码中的 unicode 支持如 \verb|mathμ≤|， \lstinline|mäthμ≥≤|， 以及
\begin{lstlisting}[language=none]
mäthμ≥≤
\end{lstlisting}

% 测试正文中的支持的所有 unicode 字符：% 在 unicodechars.sty 中实现
% \addoTODO{这个还是编程实现比较好}

\subsection{文献引用}
目前整个百科公用一个参考文献列表的词条。 词条中引用文献格式如 \cite{PhysWiki}， 引用缺失如 “地球是圆的\needCite”。 但是由于 PhysWikiScan 还为实现该命令， 目前还是应该使用脚注。
\addTODO{needCite 还不能正常在 html 中显示}

网址的超链接如\href{https://wuli.wiki}{本书网站}。 注意 \verb|\href| 命令中的网址如果存在百分号， 需要在前面加反斜杠， 否则会被当做注释。

\subsection{付费内容}
付费内容仅限百科， 测试见 test.tex\upref{test}。 用 \verb|\pay| 和 \verb|\paid| 包围付费内容即可， 若首行需要分段则要在 \verb|\pay| 后面空一行。 编辑器预览显示会员版本， 发布到 \verb|online| 目录后显示非会员的版本。
