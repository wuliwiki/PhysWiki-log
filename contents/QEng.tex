% 电势、电势能
% 电势|电势能|电荷|电场|做功

% 推导 1/r 势能， 计算连续电荷的势能， 例如带电球壳的势能
\pentry{力场 势能\upref{V}， 电场\upref{Efield}}

\subsection{电场做功}
如果空间中存在某种分布的静电场（关于位置的矢量函数） $\bvec E(\bvec r)$， 一个电荷为 $q$ 的点电荷在任意位置 $\bvec r$ 都会受到电场力
\begin{equation}
\bvec F(\bvec r) = q \bvec E(\bvec r)~.
\end{equation}
这样我们就得到了一个由电场力构成的力场， 与电场处处成正比。 

从某点 $\bvec r_1$ 沿着某个路径移动到另一点 $\bvec r_2$， 电场对它做功为（\autoref{eq_Fwork_1}~\upref{Fwork}）
\begin{equation}\label{eq_QEng_4}
W = \int_{\bvec r_1}^{\bvec r_2} \bvec F(\bvec r) \vdot \dd{\bvec r} = q \int_{\bvec r_1}^{\bvec r_2} \bvec E(\bvec r) \vdot \dd{\bvec r}~.
\end{equation}

\subsubsection{势能与保守场}
要讨论势能或者电势的概念， 我们首先需要确保力场 $\bvec F(\bvec r)$ 或电场 $\bvec E(\bvec r)$ 是一个保守场， 即只有上式的结果只与初末位置有关而与路径无关时才可能存在一个势能函数。 以后我们会看到电场可以分为两类： 由电荷直接产生的电场是无旋的， 即保守场， 而由变化磁场产生的电场是有旋的， 即非保守场（见 “力场 势能\upref{V}”， “旋度 斯托克斯定理\upref{Curl}”）。

这个问题有两种解决方法， 第一是要求净电荷分布不随时间变化， 且电流保持恒定\footnote{注意有电流就意味着有电荷在移动， 所以我们强调的是 “净” 电荷保持静止}， 这类问题称为\textbf{静电学（electrostatics）}。 在静电学问题中， 空间中没有变化的磁场， 所以所有的电场都是由净电荷产生的无旋场， 总可以定义电势。

第二种方法是， 在非静电学的情况下， 我们将电场中的保守场部分分离出来定义电势（能）， 即在\autoref{eq_QEng_4} 的积分中， $\bvec E(\bvec r)$ 并不取总电场， 而是取其中的无旋部分\footnote{任何一个矢量场总可以分解成无散合无旋两部分， 见 “亥姆霍兹分解\upref{HelmTh}”}。 例如电路中的电压（电势差）\upref{Voltag}就是通过这种方法定义的。 因为一般来说电路不满足静电学的条件， 例如电路中的线圈可能存在电磁感应。

\subsection{电势能}
记\textbf{电势能（electric potential energy）}函数（关于位置的实函数）为 $E_p(\bvec r)$， 就有 “力场对物体做功等于势能减少”， 或者 “势能增加等于力场做的负功” 即
\begin{equation}\label{eq_QEng_5}
E_p(\bvec r_2) - E_p(\bvec r_1) = -W = -q \int_{\bvec r_1}^{\bvec r_2} \bvec E(\bvec r) \vdot \dd{\bvec r}~.
\end{equation}

根据上式， 我们只能判断两点之间的势能差， 若要完全确定势能函数， 还需要指定\textbf{零势点}的位置 $\bvec r_0$ （可以取无穷远）使得 $E_p(\bvec r_0) = 0$ （类比万有引力势能\upref{Gravty}）。 于是任意一点的势能为
\begin{equation}\label{eq_QEng_3}
E_p(\bvec r) = -q \int_{\bvec r_0}^{\bvec r} \bvec E(\bvec r') \vdot \dd{\bvec r'}~.
\end{equation}
微分关系为
\begin{equation}\label{eq_QEng_12}
\bvec F = q\bvec E(\bvec r) = -\grad E_p~.
\end{equation}

\begin{example}{匀强电场}
假设空间中存在匀强电场 $\bvec E = E_x \uvec x + E_y \uvec y + E_z \uvec z$， 即电场矢量与位置无关。 以原点为零势点 $\bvec r_0$， 求点电荷 $q$ 在空间中任意一点 $\bvec r$ 的电势能。

根据\autoref{eq_QEng_3}， 取积分路径为原点到 $\bvec r$ 的线段， 则
\begin{equation}
E_p(\bvec r) = -q \bvec E \int_{\bvec 0}^{\bvec r} \dd{\bvec r'} = -q \bvec E \vdot \bvec r~.
\end{equation}
当 $\bvec r$ 和 $\bvec E$ 同方向时， 就得到了高中所学的 $-qEr$。
\end{example}

\subsection{电势}
注意以上公式中， 无论是做功还是势能都与电荷量 $q$ 有关（成正比）。 为了更直接地描述电场本身的性质， 我们可以把这些公式两边都除以 $q$。 若定义\textbf{电势} $V(\bvec r)$ 满足
\begin{equation}\label{eq_QEng_14}
E_p(\bvec r) = q V(\bvec r)~,
\end{equation}
则\autoref{eq_QEng_5} 和\autoref{eq_QEng_3} 就变为
\begin{equation}\label{eq_QEng_1}
V(\bvec r_2) - V(\bvec r_1) = - \int_{\bvec r_1}^{\bvec r_2} \bvec E(\bvec r) \vdot \dd{\bvec r}~.
\end{equation}
\begin{equation}\label{eq_QEng_9}
V(\bvec r) = -\int_{\bvec r_0}^{\bvec r} \bvec E(\bvec r) \vdot \dd{\bvec r}~.
\end{equation}
同样， 该积分只与初末位置有关而与路径无关。 这样一来， 电势就只是电场的属性而与电荷量无关了。 微分关系为
\begin{equation}\label{eq_QEng_13}
\bvec E(\bvec r) = -\grad V(\bvec r)~,
\end{equation}
这相当于\autoref{eq_QEng_12} 两边除以 $q$。

\subsection{两个点电荷的电势}
假设空间中有两个点电荷， $q_1$ 产生的电场可以根据\autoref{eq_Efield_3}~\upref{Efield} 计算， 现在考虑 $q_2$ 在该场中的势能， 取无穷远处为零势点， 使用\autoref{eq_QEng_3} 可以计算 $q_2$ 的势能为（这个过程可以类比万有引力势能\upref{Gravty}的推导过程）
\begin{equation}
E_{p2} = -q_2 \int_{\infty}^{\bvec r_1} \frac{1}{4\pi\epsilon_0} \frac{q_1}{r_{12}^3}\bvec r_{12} \vdot \dd{\bvec r}
= \frac{1}{4\pi\epsilon_0} \frac{q_1 q_2}{r_{12}}~.
\end{equation}
有趣的是， 计算 $q_1$ 在 $q_2$ 产生的电场中的势能结果也是一样的。 事实上， 电势能不储存于任何一个电荷中而是储存于电场中。 以后我们会学习如何直接从总电场分布来计算势能， 结果还是和上式一样。 % 链接未完成 0.5 \epsilon E^2
所以以后我们对这两种情况不加区分， 都记为
\begin{equation}\label{eq_QEng_2}
E_p(r) = \frac{1}{4\pi\epsilon_0} \frac{q_1 q_2}{r_{12}}~.
\end{equation}
注意当两电荷异号时， $q_1 q_2$ 为负数， 此时与万有引力一样， 距离越近， 势能越小。 两电荷同号时 $q_1 q_2$ 为正， 距离越远势能越小。

\begin{example}{}
两个电荷量为 $Q$ 的电荷分别被固定在 $(-c, 0)$ 和 $(c, 0)$ 两点处， 另一质量为 $m$ 电荷量为 $q$ 的点电荷从 $(0, a)$ 延直线移动到 $(0, b)$， 试问它的动能增加了多少？

解： 由\autoref{eq_QEng_2} 可知， 点电荷 $q$ 在 $(0, y)$ 处的电势能为
\begin{equation}
E_p = \frac{1}{4\pi\epsilon_0}\frac{2Qq}{\sqrt{y^2 + c^2}}~.
\end{equation}
所以动能增加等于势能减少， 即
\begin{equation}
\Delta E_k = V_a - V_b = \frac{Qq}{2\pi\epsilon_0}  \qty(\frac{1}{\sqrt{a^2 + c^2}} - \frac{1}{\sqrt{b^2 + c^2}})~.
\end{equation}
\end{example}

\subsection{点电荷的电势能}
由\autoref{eq_QEng_2} 两边除以 $q_2$ （或直接用\autoref{eq_QEng_9} ）得 $\bvec r_1$ 处单个点电荷在 $\bvec r$ 处产生的电势为
\begin{equation}
V(\bvec r) = \frac{1}{4\pi\epsilon_0} \frac{q}{\abs{\bvec r - \bvec r_1}}~.
\end{equation}
由于电场可以矢量叠加， 易证电势和电势能也可以叠加
\begin{equation}
V(\bvec r) = \frac{1}{4\pi\epsilon_0} \sum_i \frac{q_i}{\abs{\bvec r - \bvec r_i}}~.
\end{equation}

\subsection{多个点电荷的电势能}
 当空间中存在 $N$ 个点电荷， 取无穷远处电势为零， 那么第 $i$ 个点电荷在剩下 $N-1$ 个点电荷产生的电场中的电势就是
\begin{equation}\label{eq_QEng_6}
V_i(\bvec r_i) = \frac{1}{4\pi\epsilon_0} \sum_j^{(j\ne i)} \frac{q_j}{\abs{\bvec r_j - \bvec r_i}}~,
\end{equation}
电势能为 $E_{pi}(\bvec r_i) = q_i V_i(\bvec r_i)$。 这个能量的意义是： 保持其他电荷位置不变， 把点电荷 $q_i$ 从无穷远处移动到 $\bvec r_i$ 处需要克服电场力所做的功。

如果要计算 $N$ 个电荷的总电势能， 我们需要假设开始时这些点电荷两两间距离都是无穷远， 然后把他们依次移动到 $\bvec r_i$ 处所需要的总功： 移动第 $q_1$ 个不需要做功， 移动 $q_2$ 需要客服 $q_1$ 的电场力做功， 移动第 $j$ 个电荷需要克服前 $j-1$ 个电荷的电场做功。 所以
\begin{equation}\label{eq_QEng_10}
E_p = \frac{1}{4\pi\epsilon_0} \sum_{i,j}^{(i < j)} \frac{q_i q_j}{\abs{\bvec r_j - \bvec r_i}}~,
\end{equation}
其中小于号是为了在求和过程中不重复计算同一对电荷两次。 如果不要求小于， 则需要把结果除以 2
\begin{equation}
E_p = \frac{1}{8\pi\epsilon_0} \sum_{i, j}^{(j\neq i)} \frac{q_i q_j}{\abs{\bvec r_j - \bvec r_i}}~.
\end{equation}
将\autoref{eq_QEng_6} 代入该式得
\begin{equation}\label{eq_QEng_7}
E_p = \frac12 \sum_i q_i V_i(\bvec r_i)~,
\end{equation}
显然以上三种对电势能的定义是等效的。

\subsection{连续电荷分布的情况}
将\autoref{eq_QEng_6} 拓展到连续电荷分布的情况， 令电荷密度分布为 $\rho(\bvec r)$， 则某点的电势可以通过对整个空间体积分得到
\begin{equation}\label{eq_QEng_11}
V(\bvec r) = \frac{1}{4\pi\epsilon_0} \int \frac{\rho(\bvec r)}{\abs{\bvec r - \bvec r'}} \dd[3]{r'}~.
\end{equation}

\begin{example}{求有限长细导体棒的电势分布}

设带电直导线长为 $L$，线电荷密度为 $\lambda$。以导体棒中点为坐标原点，建立 $xOy$ 坐标系。现考虑导体棒的中垂线上与其距离为 $d$ 的 $P$ 点的电势。如下图所示。

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/1a23b5a7e7f9acf6.png}
\caption{有限长导体棒中轴线上的电势} \label{fig_QEng_2}
\end{figure}

对导线上的某一电荷微元，有 $\dd q=\lambda \dd x$，该电荷微元到导线点 $P$ 的距离为 $r=\sqrt{x^2+d^2}$，该电荷微元对点 $P$ 贡献的电势为
\begin{equation}
\dd V=\frac{1}{4\pi \epsilon_0}\frac{\dd q}{r}=\frac{1}{4\pi \epsilon_0}\frac{\lambda \dd x}{\sqrt{x^2+d^2}}~.
\end{equation}

那么整段细导体棒对 $P$ 点的电势的贡献为

\begin{equation}
\begin{aligned}
V &=\frac{\lambda }{4 \pi \epsilon_{0}}\int_{-\frac{L}{2}}^{\frac{L}{2}}\frac{\mathrm{d} x}{\sqrt{x^{2}+d^{2}}}\\
&=\frac{\lambda }{4 \pi \epsilon_{0}}\ln_{}{(x+\sqrt{x^2+d^2})}\mid_{-\frac{L}{2}}^{\frac{L}{2}}\\
&=\frac{\lambda }{4 \pi \epsilon_{0}}\ln_{}{\frac{\sqrt{L^2+4d^2}+L}{\sqrt{L^2+4d^2}-L}}\\
&=\frac{\lambda }{4 \pi \epsilon_{0}}\ln_{}{\frac{(\sqrt{L^2+4d^2}+L)^2}{2d}}\\
&=\frac{\lambda }{2 \pi \epsilon_{0}}\ln_{}{\frac{\sqrt{L^2+4d^2}+L}{2d}}~.
\end{aligned}
\end{equation}


要注意的是，上述推导是以无穷远处为势能零点。若令棒长 $L\rightarrow \infty$，将得出任意位置的电势为无穷大的错误结论，此时以离无限长导体棒有限长度的位置为电势零点较为合适。

（未完成， 使用\autoref{eq_QEng_11} ， 对比\autoref{ex_Efield_1}~\upref{Efield} 的结论）

\end{example}

\begin{example}{求均匀带电圆盘轴线上的电势}
设圆盘半径为 $R$，圆盘的电荷面密度为 $\sigma$. 以圆盘中心为坐标原点，并在过原点且与圆盘垂直的方向上建立 $x$ 轴。令无穷远处为零势点。参考图如下
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/5b8737ea2d87c556.png}
\caption{均匀带电圆盘轴线上的电势} \label{fig_QEng_1}
\end{figure}

用极坐标把圆盘平面分成许多面元，则坐标为 $r$、$\varphi$ 的面元的面积为 $\dd S=r\dd \varphi \dd r$，相应的电荷量为 $\dd q=\sigma\dd S=\sigma r\dd \varphi \dd r$. 那么，该电荷微元对 $P$ 点的电势贡献为

\begin{equation}
\dd V =\frac{1}{4 \pi \varepsilon_{0}}\frac{\dd q }{r}=\frac{\sigma}{4 \pi\varepsilon_{0} }\frac{r \dd \varphi \dd r}{ \sqrt{r^{2}+x^{2}}}~.
\end{equation}

对 $\dd V$ 积分，有

\begin{equation}
\begin{aligned}
V & =\frac{1}{4 \pi \varepsilon_{0}}\iint \frac{\dd q }{r}\\
& =\frac{\sigma }{4 \pi \varepsilon_{0}}\iint \frac{r \dd \varphi \dd r}{ \sqrt{r^{2}+x^{2}}}\\
& = \frac{\sigma}{4 \pi \varepsilon_{0}} \int_{0}^{2 \pi} \mathrm{d} \varphi \int_{0}^{R} \frac{r}{\sqrt{r^{2}+x^{2}}}\dd r\\ 
& = \frac{\sigma}{2 \varepsilon_{0}}\left(\sqrt{R^{2}+x^{2}}-x\right)~.
\end{aligned}
\end{equation}


（未完成， 使用\autoref{eq_QEng_11} ， 对比\autoref{ex_Efield_2}~\upref{Efield} 的结论）
\end{example}

\begin{example}{求均匀带电球内外的电势分布}
设电荷面密度为 $\sigma$， 令无穷远处为零势点

（未完成， 使用\autoref{eq_QEng_11} ， 对比\autoref{ex_Efield_2}~\upref{Efield} 的结论）
\end{example}

我们也可以类比\autoref{eq_QEng_7}， 写出连续电荷分布的电势能为
\begin{equation}\label{eq_QEng_8}
E_p = \frac 12 \int V(\bvec r) \rho(\bvec r) \dd[3]{r}~.
\end{equation}

% 是否考虑加一道例题？ 带电球好了。
