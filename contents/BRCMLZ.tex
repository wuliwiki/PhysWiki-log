% 玻尔兹曼因子（综述）
% license CCBYNCSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Boltzmann_distribution}{相关文章}。

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/556def39d7c3b07d.png}
\caption{玻尔兹曼分布是一个指数分布。} \label{fig_BRCMLZ_1}
\end{figure}
在统计力学和数学中，玻尔兹曼分布（也称为吉布斯分布\(^\text{[1]}\)）是一种概率分布或概率测度，用于描述一个系统处于某一状态的概率，它是该状态能量和系统温度的函数。该分布的形式为：
\[
p_i \propto \exp\left(-\frac{\varepsilon_i}{kT}\right)~
\]
其中：\( p_i \)是系统处于状态\( i \)的概率；\( \exp \)是指数函数；\( \varepsilon_i \)是该状态的能量；常数\( kT \)是玻尔兹曼常数\( k \)与热力学温度\( T \)的乘积。符号\( \propto \)表示成比例关系（关于比例常数的具体内容，见“分布”一节）。
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/8004dbd192bc36f7.png}
\caption{玻尔兹曼因子\( \frac{p_i}{p_j} \)（纵轴）作为温度 T 的函数，针对几个能量差\( \epsilon_i - \epsilon_j \)。”} \label{fig_BRCMLZ_2}
\end{figure}
这里的“系统”一词具有广泛的含义；它可以指从“足够数量”的原子或单个原子\(^\text{[1]}\)到像天然气储罐这样的宏观系统。因此，玻尔兹曼分布可以用于解决各种各样的问题。该分布表明，能量较低的状态总是具有更高的被占据的概率。

两个状态的概率之比被称为玻尔兹曼因子，其特征是仅依赖于这两个状态的能量差：
\[
\frac{p_i}{p_j} = \exp\left(\frac{\varepsilon_j - \varepsilon_i}{kT}\right)~
\]
玻尔兹曼分布以路德维希·玻尔兹曼的名字命名，他最早于1868年在研究热平衡状态下气体的统计力学时提出了这一分布。\(^\text{[2]}\)玻尔兹曼的统计工作体现在他的论文《论机械热理论的第二基本定理与关于热平衡条件的概率计算之间的关系》中。\(^\text{[3]}\)之后，约西亚·威拉德·吉布斯于1902年在其现代通用形式上对该分布进行了深入研究。\(^\text{[4]}\)

玻尔兹曼分布不应与麦克斯韦–玻尔兹曼分布或麦克斯韦-玻尔兹曼统计混淆。玻尔兹曼分布给出了系统处于某一状态的概率，作为该状态能量的函数[5]，而麦克斯韦-玻尔兹曼分布给出了理想气体中粒子速度或能量的概率。然而，一维气体中的能量分布确实遵循玻尔兹曼分布。
\subsection{分布}  
玻尔兹曼分布是一种概率分布，它给出了某一状态的概率，作为该状态能量和分布所应用的系统的温度的函数\(^\text{[6]}\)。它的表达式为：
\[
p_i = \frac{1}{Q} \exp\left(-\frac{\varepsilon_i}{kT}\right) = \frac{\exp\left(-\frac{\varepsilon_i}{kT}\right)}{\sum _{j=1}^{M}\exp\left(-\frac{\varepsilon_j}{kT}\right)}~
\]
其中：
\begin{itemize}
\item exp() 是指数函数，  
\item \(p_i\)是状态\(i\)的概率，  
\item \(\varepsilon_i\)是状态\(i\)的能量，  
\item \(K\)是玻尔兹曼常数，  
\item \(T\)是系统的绝对温度，  
\item \(M\)是系统可达的所有状态的数量，[6][5]  
\item \(Q\)某些作者用\(z\)表示）是归一化分母，即经典配分函数  
\end{itemize} 
\[{\displaystyle Q=\sum _{j=1}^{M}\exp \left(-{\tfrac {\varepsilon _{j}}{kT}}\right)}~\]
这来自于所有可达状态的概率必须加起来等于 1 的约束。

使用拉格朗日乘子法，可以证明玻尔兹曼分布是最大化熵的分布：
\[
S(p_1, p_2, \cdots, p_M) = -\sum_{i=1}^{M} p_i \log_2 p_i~
\]
在归一化约束条件下，即\(\sum p_i = 1\)以及约束条件下，即\(\sum p_i \varepsilon_i\)等于一个特定的平均能量值，除了两种特殊情况。（这些特殊情况出现在平均值是能量\(\varepsilon_i\)的最小值或最大值时。在这些情况下，最大化熵的分布是玻尔兹曼分布的极限，其中\(T\)分别从上方或下方趋近于零。）

如果我们知道系统可达状态的能量，分配函数就可以计算出来。对于原子，分配函数的值可以在NIST原子光谱数据库中找到。\(^\text{[7]}\)

该分布表明，能量较低的状态总是比能量较高的状态具有更高的占据概率。它还可以为我们提供两种状态被占据的概率之间的定量关系。状态 i 和 j 的概率比率可以表示为：
\[
\frac{p_i}{p_j} = \exp \left( \frac{\varepsilon_j - \varepsilon_i}{kT} \right)~
\]
其中：
\begin{itemize}
\item \( p_i \)是状态\(i\)的概率，  
\item \( p_j \)是状态\(j\)的概率，  
\item \( \varepsilon_i \)是状态\(i\)的能量，  
\item \( \varepsilon_j \)是状态\(j\)的能量。
\end{itemize}
能量级别的人口比率还必须考虑它们的简并度。

玻尔兹曼分布常用于描述粒子（如原子或分子）在其可达的束缚态上的分布。如果我们有一个由许多粒子组成的系统，粒子处于状态\(i\)的概率实际上是这样的概率：如果我们从该系统中随机挑选一个粒子并检查它处于什么状态，那么我们发现它处于状态\(i\)。这个概率等于状态\(i\)中的粒子数除以系统中粒子的总数，也就是占据状态\(i\)的粒子的比例。
\[
p_i = \frac{N_i}{N}~
\]
其中\( N_i \)是状态\(i\)中的粒子数，\( N \)是系统中粒子的总数。我们可以使用玻尔兹曼分布来求得这个概率，即我们已经看到的，它等于处于状态 i 的粒子的比例。因此，给出状态\(i\)中粒子比例的方程是\(^\text{[5]}\)：
\[
\frac{N_i}{N} = \frac{\exp \left( -\frac{\varepsilon_i}{kT} \right)}{\sum_{j=1}^{M} \exp \left( -\frac{\varepsilon_j}{kT} \right)}~
\]
这个方程对于光谱学非常重要。在光谱学中，我们观察原子或分子从一种状态到另一种状态的跃迁所产生的光谱线。\(^\text{[5][8]}\)为了使这一过程成为可能，必须有一些粒子处于初始状态以进行跃迁。我们可以通过计算处于初始状态的粒子比例来判断这个条件是否成立。如果比例微不足道，那么在该温度下进行计算时，跃迁很可能不会被观察到。一般来说，初始状态中分子比例越大，跃迁到第二状态的数量就越多。\(^\text{[9]}\)这会产生更强的光谱线。然而，还有其他因素会影响光谱线的强度，例如它是否由允许的跃迁或禁止的跃迁引起。

在机器学习中常用的 softmax 函数与玻尔兹曼分布有关：
\[
(p_1, \ldots, p_M) = \operatorname{softmax} \left[ -\frac{\varepsilon_1}{kT}, \ldots, -\frac{\varepsilon_M}{kT} \right]~
\]
\subsection{广义玻尔兹曼分布}
形式为
\[
\Pr \left(\omega \right) \propto \exp \left[ \sum_{\eta =1}^{n} \frac{X_{\eta} x_{\eta}^{(\omega)}}{k_B T} - \frac{E^{(\omega)}}{k_B T} \right]~
\]
被一些作者称为广义玻尔兹曼分布。\(^\text{[10]}\)

玻尔兹曼分布是广义玻尔兹曼分布的一个特例。广义玻尔兹曼分布在统计力学中用于描述经典系综、大系综和等温等压系综。广义玻尔兹曼分布通常是从最大熵原理推导出来的，但也有其他的推导方法。\(^\text{[10][11]}\)

广义玻尔兹曼分布具有以下特性：
\begin{itemize}
\item 它是唯一一个使得根据吉布斯熵公式定义的熵与经典热力学中定义的熵相匹配的分布。\(^\text{[10]}\)
\item 它是唯一一个在数学上与基本热力学关系一致的分布，其中状态函数通过系综平均描述。\(^\text{[11]}\)
\end{itemize}
\subsection{在统计力学中}  
玻尔兹曼分布出现在统计力学中，当考虑处于热平衡（即能量交换平衡）的固定组成的封闭系统时。最一般的情况是正则系综的概率分布。一些特殊情况（可从正则系综推导出）展示了玻尔兹曼分布的不同方面：

\textbf{正则系综（一般情况）}  

正则系综给出了处于热平衡、与热库接触的固定体积封闭系统的各种可能状态的概率。正则系综具有玻尔兹曼形式的状态概率分布。  

\textbf{子系统状态的统计频率（在非相互作用集合中）}  

当研究的系统是由许多非相互作用的较小子系统组成的集合时，有时需要找到给定子系统状态在整个集合中的统计频率。正则系综在应用于此类集合时具有可分性特性：只要非相互作用的子系统具有固定的组成，那么每个子系统的状态都是独立的，并且也由正则系综来描述。因此，子系统状态的预期统计频率分布具有玻尔兹曼形式。  

\textbf{经典气体的麦克斯韦–玻尔兹曼统计（非相互作用粒子系统）}  

在粒子系统中，许多粒子共享同一空间，并且定期交换位置；它们占据的单粒子状态空间是共享的。\textbf{麦克斯韦–玻尔兹曼统计}给出了在热平衡下，非相互作用粒子的经典气体中，给定单粒子状态中粒子的预期数目。这一预期数目分布具有玻尔兹曼形式。

尽管这些情况有很强的相似性，但区分它们仍然很有帮助，因为当关键假设发生变化时，它们的推广方式不同：
\begin{itemize}
\item 当一个系统在能量交换和粒子交换方面都处于热力学平衡时，固定组成的要求被放宽，从而得到的是广义正则系综，而不是正则系综。另一方面，如果组成和能量都固定，那么则适用微正则系综。  
\item 如果集合中的子系统之间存在相互作用，那么子系统状态的预期频率将不再遵循玻尔兹曼分布，甚至可能没有解析解。然而，正则系综仍然可以应用于整个系统的集体状态，只要整个系统处于热平衡状态。  
\item 在热平衡下的非相互作用粒子的量子气体中，给定单粒子状态中发现的粒子数不再遵循麦克斯韦–玻尔兹曼统计，而且量子气体在正则系综中没有简单的闭式表达式。在广义正则系综中，量子气体的状态填充统计由费\textbf{米–狄拉克统计}或\textbf{玻色–爱因斯坦统计}描述，具体取决于粒子是费米子还是玻色子。 
\end{itemize} 
\subsection{在数学中}
\begin{itemize}
\item 在更一般的数学设置中，玻尔兹曼分布也被称为吉布斯测度。  
\item 在统计学和机器学习中，它被称为对数线性模型。  
\item 在深度学习中，玻尔兹曼分布用于随机神经网络的采样分布，如玻尔兹曼机、限制玻尔兹曼机、能量基模型和深度玻尔兹曼机。在深度学习中，玻尔兹曼机被视为一种无监督学习模型。在深度学习中设计玻尔兹曼机时，随着节点数量的增加，实时应用中的实现难度变得至关重要，因此引入了一种不同类型的架构，称为限制玻尔兹曼机。
\end{itemize}
\subsection{在经济学中}  
玻尔兹曼分布可以用于分配排放交易中的许可证。\(^\ten{[13][14]}\)使用玻尔兹曼分布的新分配方法可以描述多国之间排放许可证的最可能、自然和无偏分配。

玻尔兹曼分布与多项式对数选择模型具有相同的形式。作为一种离散选择模型，这在经济学中非常著名，因为丹尼尔·麦克法登将其与随机效用最大化联系了起来。\(^\ten{[15]}\)
\subsection{参见}  
\begin{itemize}
\item 玻色–爱因斯坦统计  
\item 费米–狄拉克统计  
\item 负温度  
\item Softmax函数
\end{itemize}
\subsection{参考文献}  
\begin{enumerate}
\item Landau, Lev Davidovich & Lifshitz, Evgeny Mikhailovich (1980) [1976]. *统计物理学* (理论物理学课程，第5卷，第3版)。牛津：Pergamon Press. ISBN 0-7506-3372-7. 由 J.B. Sykes 和 M.J. Kearsley 翻译。见第28节  
\item Boltzmann, Ludwig (1868). "Studien über das Gleichgewicht der lebendigen Kraft zwischen bewegten materiellen Punkten" [关于运动物质点之间生力平衡的研究]。维也纳报告，58: 517–560.  
\item "Archived copy" (PDF). 2021-03-05 从原文存档（PDF）。于2017-05-11检索。  
\item Gibbs, Josiah Willard (1902). *统计力学中的基本原理*。纽约：Charles Scribner's Sons.  
\item Atkins, P. W. (2010). *量子*，W. H. Freeman and Company，纽约。  
\item McQuarrie, A. (2000). *统计力学*。加利福尼亚州索萨利托：University Science Books. ISBN 1-891389-15-7.  
\item NIST 原子光谱数据库 级别表格，来自nist.gov  
\item Atkins, P. W.; de Paula, J. (2009). *物理化学* (第9版)。牛津：Oxford University Press. ISBN 978-0-19-954337-3.  
\item Skoog, D. A.; Holler, F. J.; Crouch, S. R. (2006). *仪器分析原理*。马萨诸塞州波士顿：Brooks/Cole. ISBN 978-0-495-12570-9.
\item Gao, Xiang; Gallicchio, Emilio; Roitberg, Adrian (2019). "广义玻尔兹曼分布是唯一使吉布斯-香农熵等于热力学熵的分布"。《化学物理学杂志》，151(3): 034113. arXiv:1903.02121. Bibcode:2019JChPh.151c4113G. doi:10.1063/1.5111333. PMID 31325924. S2CID 118981017.  
\item Gao, Xiang (2022年3月). "系综理论的数学"。《物理学结果》，34: 105230. arXiv:2006.00485. Bibcode:2022ResPh..3405230G. doi:10.1016/j.rinp.2022.105230. S2CID 221978379.  
\item 一个经典的例子是磁性有序。非相互作用自旋的系统表现出可以通过单粒子正则系综理解的顺磁行为（得到布里渊函数）。相互作用的自旋系统则可能表现出更复杂的行为，如铁磁性或反铁磁性。  
\item Park, J.-W., Kim, C. U. 和 Isard, W. (2012). 使用玻尔兹曼分布进行排放交易中的许可证分配。《物理学A》，391: 4883–4890.
\item 《公平分配的棘手问题》。技术评论博客。2011年8月17日。引用并总结了Park、Kim和Isard（2012）的内容。  
\item Amemiya, Takeshi (1985). "多项式对数选择模型"。《高级计量经济学》。牛津：Basil Blackwell. 第295-299页。ISBN 0-631-13345-3.
\end{enumerate}