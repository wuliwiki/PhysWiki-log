% 一阶线性微分方程
% keys 微积分|微分方程|常微分方程|一阶线性微分方程|齐次|常数易变法
% license Xiao
% type Tutor

\begin{issues}
\issueNeedCite
\issueOther{需要补充例子}
\end{issues}

\pentry{常微分方程\upref{ODE}}{nod_1a4b}

\footnote{本文参考 Wikipedia \href{https://en.wikipedia.org/wiki/Ordinary_differential_equation}{相关页面}和 \cite{同济高}}具有以下形式的微分方程叫做\textbf{一阶线性微分方程（first order linear differential equation）}
\begin{equation}\label{eq_ODE1_1}
\dv{y}{x} + p(x)y = f(x)~,
\end{equation}
其中函数 $p(x)$ 和 $f(x)$ 是已知的， 函数 $y(x)$ 是未知的， 称为方程的解。 这三个函数的自变量都是实数， 函数值可以是实数或者复数。 若 $f(x) \equiv 0$， 则称方程为\textbf{齐次的（homogeneous）}， 否则就是\textbf{非齐次的（inhomogeneous）}。 所以 $f(x)$ 叫做方程的\textbf{非齐次项（inhomogeneous term）}。

\subsection{线性}
若干函数 $y_1(x), y_2(x), \dots$ 的线性组合\footnote{线性组合是线性代数中的概念， 线性代数中， 线性空间都可以做线性组合， 例如几何矢量（\autoref{eq_GVecOp_1}~\upref{GVecOp}）。 特定函数的集合可以看作线性空间（\autoref{ex_LSpace_2}~\upref{LSpace}）。}定义为他们分别乘以一个常数再相加
\begin{equation}
c_1 y_1(x) + c_2 y_2(x) + \dots~
\end{equation}
由于求导操作是线性（\autoref{eq_DerRul_1}~\upref{DerRul}）的， 容易证明若 $y_i(x)$ （$i = 1, 2,\dots$）都是齐次方程的解， 那么它们的线性组合也必定是齐次方程的解。 微分方程的这种性质就叫做\textbf{线性（linear）}。

\subsection{一阶常系数齐次线性微分方程}
当\autoref{eq_ODE1_1} 中的 $p(x) \equiv b$ 是常数时， 我们说\autoref{eq_ODE1_1} 的方程是常系数的。 先来看齐次的情况， 方程为
\begin{equation}\label{eq_ODE1_3}
\dv{y}{x} + by = 0~.
\end{equation}
也就是说我们想要求一个函数 $y(x)$， 使得它的导数和 $y(x)$ 自己成正比。 一个最显然的解就是 $y(x) \equiv 0$， 但它太简单了没什么意义， 我们说这个解是\textbf{平凡的（trivial）}。 对于非零解， 一个直接的猜测就是自然指数函数 $y(x) = \E^{ax}$ 其中 $a$ 为常数。 把它代入\autoref{eq_ODE1_3} 得
\begin{equation}
ay(x) + by(x) = 0~,
\end{equation}
所以消去 $y(x)$ 得 $b = -a$。 再考虑到方程的线性， 所以我们把这个解乘以任意常数 $C$ 同样是方程的解， 所以\autoref{eq_ODE1_3} 的通解为
\begin{equation}\label{eq_ODE1_5}
y(x) = C\E^{-bx}~.
\end{equation}

\begin{example}{稀释酒精}
一个容器中装有质量为 $M$ （千克）的酒精， 从某时刻开始以速率 $I$ （千克每秒）加水， 并以同样的速率从底部排水， 保持容器中液体的总质量不变。 假设容器中有某种快速搅拌装置， 使两种液体时刻保持充分混合， 求容器中酒精浓度 $x$（酒精质量比总质量）随时间的变化关系。

解：令容器中酒精的质量为 $m_1$， 水的质量为 $M - m_1$。 流出容器的液体速率可以分为两部分： 流出酒精的速率为 $xI$， 流出水的速率为 $I - xI$。 所以容器中酒精质量的变化率为
\begin{equation}
m'_1 = -xI~.
\end{equation}
酒精浓度定义为 $x = m_1/M$， $M$ 是常数， 所以
\begin{equation}
x' = \qty(\frac{m_1}{M})' = \frac{m'_1}{M} = -\frac{I}{M}x~.
\end{equation}
该微分方程符合\autoref{eq_ODE1_3} 的结构， 可以直接写出方程的解为
\begin{equation}
x(t) = C\E^{-It/M}~.
\end{equation}
但这里的 $C$ 到底是什么呢？ 如果我们令开始的时间为 $t = 0$， 那么根据题目条件必须满足 $x(0) = 1$， 代入得 $C = 1$。
\end{example}

\subsection{一阶常系数非齐次线性微分方程}
%\addTODO{非齐次， 常数变易法。}
现在，来看 $p(x) \equiv b$ 是常数时非齐次的情况，方程为
\begin{equation}\label{eq_ODE1_4}
\dv{y}{x} + by = f(x)~,
\end{equation}
通解为
\begin{equation}\label{eq_ODE1_13}
y(x)=C\E^{-bx}+\E^{-bx}\int f(x)\E^{bx}\dd x~.
\end{equation}

\subsubsection{推导}
我们用所谓的常数变易法来求常系数非齐次线性方程\autoref{eq_ODE1_4} 的通解。这方法是把\autoref{eq_ODE1_5} 的通解中的 $C$ 换为 $x$ 的未知函数 $u(x)$，即作变换
\begin{equation}\label{eq_ODE1_7}
y(x)=u\E^{-bx}~,
\end{equation}
于是
\begin{equation}\label{eq_ODE1_8}
\dv{y}{x}=u'\E^{-bx}-bu\E^{-bx}~.
\end{equation}
\autoref{eq_ODE1_7} 和\autoref{eq_ODE1_8} 代入\autoref{eq_ODE1_4} 得
\begin{equation}
u'\E^{-bx}=f(x)~,
\end{equation}
即
\begin{equation}
\dd u=f(x)\E^{bx}\dd x~,
\end{equation}
两边积分，得
\begin{equation}\label{eq_ODE1_9}
u(x)=\int f(x)\E^{bx}\dd x+C~.
\end{equation}
\autoref{eq_ODE1_9} 代入\autoref{eq_ODE1_7} ，便得常系数非齐次线性方程\autoref{eq_ODE1_4} 的通解
\begin{equation}\label{eq_ODE1_12}
y(x)=\E^{-bx}\qty[\int f(x)\E^{bx}\dd x+C]~.
\end{equation}

将上式写成两项之和， 就得到了\autoref{eq_ODE1_13}
\begin{equation}
y(x)=C\E^{-bx}+\E^{-bx}\int f(x)\E^{bx}\dd x~.
\end{equation}
右端第一项对应常系数齐次线性方程\autoref{eq_ODE1_3} 的通解，第二项则是常系数非齐次线性方程\autoref{eq_ODE1_4} 的一个特解（在通解\autoref{eq_ODE1_12} 中取 $C=0$ 便得 ）。由此可知，一阶常系数非齐次线性方程的通解等于对应的齐次方程的通解与非齐次方程的一个特解之和。

\subsection{一般情况}
我们先来看\autoref{eq_ODE1_1} 对应的齐次方程
\begin{equation}\label{eq_ODE1_2}
\dv{y}{x} + p(x)y = 0~.
\end{equation}
这是一个可分离变量的方程% 未完成：什么是分离变量？
， 分离变量得
\begin{equation}
\frac{\dd{y}}{y} = -p(x) \dd{x}~,
\end{equation}
两边积分得
\begin{equation}
\ln\abs{y} = -\int p(x) dx + C~.
\end{equation}
两边取自然指数得
\begin{equation}
y = \pm \E^C \E^{-\int p(x) \dd{x}}~.
\end{equation}
把 $\pm \E^C $ 整体看做一个任意常数 $C$， 上式变为。
\begin{equation}\label{eq_ODE1_6}
y = C \E^{-\int p(x) \dd{x}}~.
\end{equation}
这就是一阶线性齐次微分方程\autoref{eq_ODE1_2} 的通解， 也叫\autoref{eq_ODE1_1} 的\textbf{齐次解}。

\subsection{常数变易法}

现在我们用\textbf{常数变易法}来解非齐次方程\autoref{eq_ODE1_1}。 为书写方便， \autoref{eq_ODE1_6} 中令 $y_0(x) = \exp(-\int p(x) \dd{x})$。 假设上式中的 $C$ 是一个函数 $C(x)$ 而不是常数， 代入\autoref{eq_ODE1_1} 得
\begin{equation}
C'y_0 + C[y_0' + p(x)y_0] = f(x)~.
\end{equation}
由于 $y_0$ 是齐次解， 上式方括号中求和为 0， 分离变量得
\begin{equation}
\dd{C}= \frac{f(x)}{y_0} \dd{x}~,
\end{equation}
两边积分得
\begin{equation}
C(x) = \int \frac{f(x)}{y_0} \dd{x}~,
\end{equation}
所以一阶线性非齐次微分方程的通解为
\begin{equation}\label{eq_ODE1_10}
y = y_0  \int \frac{f(x)}{y_0} \dd{x}~,
\end{equation}
其中
\begin{equation}\label{eq_ODE1_11}
y_0(x) = \E^{-\int p(x) \dd{x}}~.
\end{equation}
注意待定常数包含在\autoref{eq_ODE1_10} 的不定积分中， \autoref{eq_ODE1_11} 中的不定积分产生的待定常数在代入\autoref{eq_ODE1_10} 后可消去。
