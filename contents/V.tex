% 力场、保守场、势能
% keys 势能|力场|矢量场|做功|引力|重力
% license Xiao
% type Tutor

\pentry{矢量场\upref{Vfield}， 功\upref{Fwork}， 牛顿—莱布尼兹公式\upref{NLeib}}

\subsection{力场}
高中物理中我们已经学过一些场的概念，即质点受场的力取决于质点在场中的位置。 例如地球表面局部的引力场可以近似看做一个恒力场（ 称为为\textbf{重力场}）， 即在一定区域内， 质点总受向下的，大小恒为 $mg$ 的重力（矢量式 $\bvec F = m\bvec g$）。 又例如水平面上一根原长忽略不计的弹簧，一端固定在原点，另一端连接质点，那么质点受力总指向原点，大小等于劲度系数和位矢模长的之积 $kr$。 用矢量的方法表示，就是 $\bvec F = -k\bvec r$。

总结到一般情况，\textbf{力场}可以用场对质点施加的力（矢量）关于质点位置（即位矢\upref{Disp}）的矢量函数表示， 所以力场是一种矢量场。


\begin{example}{引力场}\label{ex_V_1}
球坐标原点处质量为 $M$ 的质点在周围造成的引力场为
\begin{equation}
\bvec F(\bvec r) =  - G\frac{M}{r^2}\,\uvec r~.
\end{equation} 
若位矢用 $\bvec r$ 来表示（ $\bvec r = r\,\uvec r$）， 则
\begin{equation}
\bvec F(\bvec r) =  - G\frac{M}{r^3}\,\bvec r~.
\end{equation}
现在变换到直角坐标系中，有
\begin{equation}
\begin{cases}
\bvec r = x\,\uvec x + y\,\uvec y + z\,\uvec z\\
r = \sqrt{x^2 + y^2 + z^2} ~.
\end{cases}
\end{equation} 
代入上式，展开得
\begin{equation}
\bvec F(\bvec r) =  - \frac{GMx}{(x^2+y^2+z^2)^{3/2}}\uvec x - \frac{GMy}{(x^2 +y^2+z^2)^{3/2}}\uvec y - \frac{GMz}{(x^2+y^2+z^2)^{3/2}}\uvec z ~.
\end{equation} 

显然球坐标系中的引力场表达式比直角坐标系中的要简洁得多。由此可见，对不同的矢量场选择适当的坐标系往往可以简化问题。
\end{example}

若质点从场的一点移动到另一点的过程中， 力场对质点做的功\upref{Fwork} 只与初末位置有关，而与质点移动的路径无关， 那么这个力场就是一个\textbf{保守场}。 这时我们可以给该质点定义一个\textbf{势能函数}， 势能函数是一个关于位矢的标量函数，一般记为 $V(\bvec r)$， 具有能量量纲。 当质点从一点以任意路径移动到另一点时，场对质点做的功等于质点初位置的势能减末位置的势能， 即
\begin{equation}\label{eq_V_1}
\int_{\bvec r_1}^{\bvec r_2} \bvec F(\bvec r) \vdot \dd{\bvec r} = V(\bvec r_1)-V(\bvec r_2)~.
\end{equation}
那么如何判断一个力场是否是保守场呢？ 我们分一维和多维空间进行讨论。

\subsection{一维势能函数}

现在先假设质点只能沿一条直线运动， 且力也始终与直线平行。 显然质点从一点到另一点的路径只可能有一条， 所以任何一维力场都是保守场。 若给直线定义一个正方向， 单位矢量为 $\uvec x$， 任何一维力场可以记为
\begin{equation}\label{eq_V_2}
\bvec F(x) = F(x) \uvec x~,
\end{equation}
质点的位置矢量可记为 $\bvec r = x \uvec x$。 由于 $\uvec x \vdot \uvec x = 1$， 质点从 $x = a$ 移动到 $x=b$ 过程中场做的功为
\begin{equation}
\int_{\bvec r_1}^{\bvec r_2} \bvec F(\bvec r) \vdot \dd{\bvec r}
= \int_a^b F(x) \dd{x}~.
\end{equation}
根据势能的定义， 对任意的 $a$ 和 $b$， 上式应该等于 $V(a) - V(b)$。 根据牛顿—莱布尼兹公式\upref{NLeib}， 势能函数恰好就是 $F(x)$ 的负原函数， 所以 $F(x)$ 是 $V(x)$ 负导函数。
\begin{equation}\label{eq_V_8}
V(x) = -\int F(x) \dd{x}~,
\qquad
F(x) = -\dv{V(x)}{x}~.
\end{equation}

需要注意的是， 由于原函数有无穷多个（由不定积分中任意常数的取值决定）， 所以势能函数也存在无穷多个， 且都相差一个常数。 为了确定势能函数， 我们需要指定场中某一点的势能值， 如果令某点势能为零， 那么这点就叫做\textbf{零势点}。

\begin{example}{弹簧的势能}
一个原长可忽略的轻弹簧劲度系数为 $k$， 一端固定在原点， 另一端连接质点。 质点只能沿 $\uvec x$ 方向运动， 规定质点在原点时势能为 $0$， 求弹簧的势能关于质点位置坐标 $x$ 的函数。 

由题意，\autoref{eq_V_2} 中 $F(x) = -kx$， 不定积分并取负值得到含有待定常数的势能函数
\begin{equation}
V(x) = -\int (-kx) \dd{x} = \frac12 k x^2 - C~.
\end{equation}
为了确定待定常数， 代入 $V(0) = 0$， 解得 $C = 0$。 所以所求势能为
\begin{equation}
V(x) =  \frac12 k x^2~.
\end{equation}
\end{example}

\subsection{二维和三维函数}
\pentry{梯度定理\upref{Grad}， 斯托克斯定理\upref{Stokes}}
在二维（平面）或三维空间中， 矢量场不一定是保守场， 那么应该如何判断一个场是否是保守场？ 事实上 “线积分结果与路径无关” 有一个充要条件就是 “延任意闭合曲线的环积分结果为零”。 而根据斯托克斯定理\upref{Stokes}， 这就要求矢量场的旋度处处为零， 即它是一个\textbf{无旋场}。
\addTODO{画图说明 “线积分结果与路径无关” 的等效条件是 “延任意闭合曲线的环积分结果为零”}

假设力场 $\bvec F(\bvec r)$ 是平面或三维空间中的保守场， 对应势能为 $V(\bvec r)$， 初始点为 $\bvec r_i$， 终点为 $\bvec r_f$。 对 $-V(\bvec r)$ 使用梯度定理\upref{Grad} 得
\begin{equation}
\int_{\bvec r_i}^{\bvec r_f} \grad [-V(\bvec r)] \vdot \dd{\bvec l} = V(\bvec r_i) - V(\bvec r_f)~.
\end{equation}
我们把该式与\autoref{eq_V_1} 比较， 不难发现力场是势能函数的负梯度
\begin{equation}
\bvec F(\bvec r) = - \grad V(\bvec r)~.
\end{equation}
即在保守场的某点中， 力的方向是势能下降最快的方向， 大小是该方向的负方向导数。 由梯度的定义， 力场的各个分量分别为对应方向的负偏导数
\begin{equation}\label{eq_V_9}
F_x(\bvec r) = -\pdv{V(\bvec r)}{x} \quad F_y(\bvec r) = -\pdv{V(\bvec r)}{y} \quad \ldots~
\end{equation}

\begin{example}{二维简谐振子}
若已知二维的势能函数为 $V(x,y) = k_1 (x+y)^2/2 + k_2 (x-y)^2/2$， 求力场。 若已知场函数求势能函数， 又该如何求？

把势能函数代入\autoref{eq_V_9} 中， 求偏导， 得场为
\begin{equation}\ali{
\bvec F(\bvec r) &= -\pdv{V}{x} \uvec x - \pdv{V}{y} \uvec y\\
&= -[(k_1 + k_2) x  + (k_1-k_2) y] \uvec x - [(k_1-k_2)x + (k_1+k_2)y] \uvec y~.
}\end{equation}

现在我们根据“梯度定理\upref{Grad}”中的\autoref{eq_Grad_23} 从场逆推势能。 首先对力场的 $x$ 分量和 $y$ 分量分别关于 $x$ 和 $y$ 做不定积分得到任意两个原函数并记为 $G_x$ 和 $G_y$ 得
\begin{equation}
G_x(x,y) = - \frac12 (k_1 + k_2) x^2 -  (k_1-k_2) xy~,
\end{equation}
\begin{equation}
G_y(x,y) =  - (k_1 - k_2) xy - \frac12 (k_1+k_2) y^2~,
\end{equation}
代入得（注意这里的场是势能函数的的负梯度而不是梯度，另外注意下式中的常数项都并入 $C$ 中）
\begin{equation}\ali{
V(x,y) &= -G_y(x,y) + G_y(x,y_0) - G_x(x,y_0) + C\\
&= \frac12 (k_1 + k_2) x^2 + (k_1-k_2)xy + \frac12 (k_1+k_2) y^2 + C\\
&= \frac12 k_1 (x+y)^2 +\frac12 k_2 (x-y)^2 + C~.
}\end{equation}
若规定零势点 $V(0,0) = 0$， 代入上式得 $C=0$。
\end{example}

\subsection{两质点间的势能}

如果两质点 $A$ 和 $B$ 的位矢分别为 $\bvec r_A$ 和 $\bvec r_B$， 相对位移为 $\bvec R = \bvec r_B - \bvec r_A$， 两质点距离为 $R = \abs{\bvec R}$。 且 $A$ 对 $B$ 的作用力为 $\bvec F = F(R) \uvec R$， $B$ 对 $A$ 的反作用力为 $-\bvec F$。现在考虑一个过程中力对两质点做的总功。

在一段微小时间 $\dd{t}$ 内， 两质点分别移动了 $\dd{\bvec r_A}$， 和 $\dd{\bvec r_B}$， 则相互作用力对二者做功为
\begin{equation}
\dd{W} = \bvec F \vdot \dd{\bvec r_B} + (- \bvec F) \vdot \dd{\bvec r_A} = \bvec F \vdot \dd{\bvec R}
= F(R)\uvec R\vdot \dd{\bvec R} = F(R) \dd{R}~,
\end{equation}
（最后一步的证明见“位置矢量\upref{Disp}”中的\autoref{ex_Disp_1}）定积分得
\begin{equation}
W = \int_{R_1}^{R_2}  F(R) \dd{R}~.
\end{equation}
现在我们借用一维势能的定义\autoref{eq_V_8} 来定义势能函数为 $F(R)$ 的负原函数， 则力在一段时间内对两质点做的总功就等于末势能减初势能
\begin{equation}\label{eq_V_20}
W = V(R_2) - V(R_1)~.
\end{equation}

\subsection{三维以上的势能}
虽然牛顿力学仅限于三维空间以内， 但曲线积分在任意维度都有定义， 对于 $N$ （$N > 3$） 维空间， 把坐标记为 $x_1, x_2, \dots, x_N$ 矢量场 $\bvec F$ “延任意闭合曲线的环积分结果为零”， 即存在势能函数的充分必要条件是对所有 $i,j \in \qty{1,\dots, N}$ 都有
\begin{equation}
\pdv{F_j}{x_i} - \pdv{F_i}{x_j} = 0 \qquad (i\ne j)~,
\end{equation}
势能函数的计算同理可得。

\subsection{含时势能}
以上的讨论中， 我们默认力场的分布不随时间变化， 所得势能显然也不随时间变化。 但在一些情况下， 我们也可以定义随时间变化的势能。
\addTODO{……}
%未完成

%例如\autoref{ex_V_1} 中如果中心天体随时间变化， 那么力场

%把这种假想的位移叫做虚位移

%这个偏导可以理解为
