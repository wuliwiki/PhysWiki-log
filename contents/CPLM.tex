% 条件极值问题与拉格朗日方法
% keys 条件极值|拉格朗日方法
% license Xiao
% type Tutor

\footnote{拉弗林契业夫,变分学教程}在前面的讨论中，我们以连接二定点或连接二给定曲线上的点的空间曲线全体为可取曲线族（\autoref{sub_DesCur_1}~\upref{DesCur}），来研究泛函的极值。然而，还有很多的问题，可取曲线在已知的曲面上，或者在多个未知函数的情形，可取曲线在某个流形上。对应的变分问题称为\textbf{条件极值问题}。为解决该问题，拉格朗日提供了所谓的未定函数因子法。
\subsection{条件极值问题}
设 $\varphi(x,y,z)=0$ 是给定的曲面，$A,B$ 是其上的两点。要在连接 $A,B$ 的曲面$\varphi(x,y,z)=0$ 上的一切曲线 $y=y(x),z=z(x)$ 中，确定某曲线，使积分
\begin{equation}\label{eq_CPLM_1}
J=\int_{x_0}^{x_1}F(x,y,z,y',z')\dd x~
\end{equation}
沿着它取极值。其中 $x_0,x_1$ 分别是起止点 $A,B$ 的 $x$ 坐标。
\subsection{拉格朗日方法}
拉格朗日方法可以描述为下面的定理
\begin{theorem}{拉格朗日方法}
如果曲线 $y=y(x),z=z(x)$ 给出积分 $J$（\autoref{eq_CPLM_1} ）的条件极值，则有一个因子 $\lambda(x)$ 存在，使得这曲线是积分
\begin{equation}\label{eq_CPLM_4}
J_1=\int_{x_0}^{x_1}\phi \dd x,\qquad \phi(x,y,z,y',z')=F+\lambda(x)\varphi~
\end{equation}
的无条件极值问题的极端曲线\upref{ExtCur}。
\end{theorem}
\textbf{证明：}
不失一般性，设极值是极小值。若 $\bar y=\bar y(x),\bar z=\bar z(x)$ 是另一可取曲线，则
\begin{equation}
\begin{aligned}
&\varphi(x,y,z)=\varphi(x,\bar y,\bar z)=0,\\
&\Delta J=J(\bar y,\bar z)-J(y,z)\geq0~.
\end{aligned}
\end{equation}
设 $\delta y(x)=\bar y(x)-\bar z(x),\quad\delta z(x)=\bar z(x)-z(x)$ 仅仅在点 $x'\in (x_0,x_1)$ 处不为0。令
\begin{equation}
\sigma_1=\int_{x_0}^{x_1}\delta y\dd x,\quad \sigma_2=\int_{x_0}^{x_1}\delta z\dd x~.
\end{equation}
于是
\begin{equation}
\begin{aligned}
0&=\int_{x_0}^{x_1}[\varphi(x,\bar y,\bar z)-\varphi(x,y,z)]\dd x\\
&=\int_{x_0}^{x_1}(\bar\varphi'_y\delta y+\bar\varphi'_z\delta z)\dd x\\
&=\varphi'_y|_{x=x'}\sigma_1+\varphi'_z|_{x=x'}\sigma_2+\epsilon~.
\end{aligned}
\end{equation}
其中，$\bar\varphi$表示在 $(x,y+\theta_1\delta y,z+\theta_2\delta z),\quad \abs{\theta_i}\leq 1$ 处取的值，$\epsilon$ 是比 $\abs{\sigma_1},\abs{\sigma_2}$ 中最大一个更高阶的无穷小量。设 $\varphi'_z\neq0$，则
\begin{equation}\label{eq_CPLM_2}
\sigma_2=-\frac{\varphi'_y}{\varphi'_z}\Big|_{x=x'}\cdot\sigma_1+\epsilon_1~.
\end{equation}
进而得
\begin{equation}\label{eq_CPLM_3}
\begin{aligned}
\Delta J&=\int_{x_0}^{x_1}\qty(F'_y-\dv{}{x}F'_{y'})\delta y\dd x+\int_{x_0}^{x_1}\qty(F'_z-\dv{}{x}F'_{z'})\delta z\dd x\\
&=\qty(F'_y-\dv{}{x}F'_{y'})_{x=x'}\cdot\sigma_1+\qty(F'_z-\dv{}{x}F'_{z'})_{x=x'}\cdot\sigma_2+\epsilon_2\geq0~.
\end{aligned}
\end{equation}
\autoref{eq_CPLM_2} 带入\autoref{eq_CPLM_3} 得
\begin{equation}
\qty[\qty(F'_y-\dv{}{x}F'_{y'})\cdot\sigma_1-\qty(F'_z-\dv{}{x}F'_{z'})\cdot\frac{\varphi'_y}{\varphi'_z}]_{x=x'}\cdot\sigma_1+\epsilon_3\geq0~.
\end{equation}
上式对任意充分小的 $\sigma_1$ 都成立，而 $\epsilon_3$ 比 $\sigma_1$ 更快趋于0，于是由\autoref{lem_PolReq_1}~\upref{PolReq}，得
\begin{equation}
\qty(F'_y-\dv{}{x}F'_{y'})\cdot\sigma_1-\qty(F'_z-\dv{}{x}F'_{z'})\cdot\frac{\varphi'_y}{\varphi'_z}=0~.
\end{equation}
上式可写成
\begin{equation}
\frac{F'_y-\dv{}{x}F'_{y'}}{\varphi'_y}=\frac{F'_z-\dv{}{x}F'_{z'}}{\varphi'_z}~.
\end{equation}
设上式等于 $-\lambda(x)$，于是
\begin{equation}
\begin{aligned}
F'_y+\lambda\varphi'_y-\dv{}{x}F'_{y'}=0~,\\
F'_z+\lambda\varphi'_z-\dv{}{x}F'_{z'}=0~.
\end{aligned}
\end{equation}
这便是\autoref{eq_CPLM_4} 的无条件问题的极端曲线满足的欧拉微分方程（\autoref{eq_ElueEV_1}~\upref{ElueEV}）。



\textbf{证毕！}
