% 偏导数（数学分析）
% keys 多元微积分|导数|偏导数|混合偏导|数学分析
% license Xiao
% type Tutor

\pentry{导数（数学分析）\nref{nod_Der2}，偏导数（简明微积分）\nref{nod_ParDer}}{nod_3c9a}
\subsection{从导数到偏导数}
导数的几何意义是一元函数在某一点处的斜率，而我们可以将这个概念推广到多元函数。$n$ 元实函数是指从 $\mathbb{R} ^n$ 的一个子集 $U$ 到 $\mathbb{R}$ 的映射：
\begin{equation}
\begin{aligned}
f:U\subset \mathbb{R} ^n&\rightarrow \mathbb{R}~,\\
(x_1,x_2,\cdots,x_n)&\mapsto f(x_1,x_2,\cdots,x_n)~.
\end{aligned}
\end{equation}
我们定义 $f$ 对 $x_i$ 的\textbf{偏导数}为
\begin{equation}
\lim\limits_{x'_i\rightarrow x_{i}}\frac{f(x_1,\cdots,x'_i,\cdots,x_n)-f(x_1,\cdots,x_i,\cdots,x_n)}{x'_i-x_i}~.
\end{equation}
如果该极限存在，那么函数在 $\bvec x_0=(x_1,\cdots,x_n)$ 处对 $x_i$ 的偏导数存在，记为
\begin{equation}
\frac{\partial f(x_1,\cdots,x_n)}{\partial x_i}=\left.\frac{\partial f}{\partial x_i}\right|_{(x_1,\cdots,x_n)}=f'_{x_i}(x_1,\cdots,x_n)~.
\end{equation}

在讨论多元函数时，我们约定用粗体字（例如 $\bvec x$）来表示 $\mathbb{R}^n$ 中的一个向量。对于给定的 $\bvec x_0=(x_1,\cdots,x_n)$，如果构造一元函数 $g(x)=f(x_1,\cdots,x_{i-1},x,x_{i+1},\cdots,x_n)$，那么根据一元函数导数的定义，容易发现
\begin{equation}
\left.\frac{\partial f}{\partial x_i}\right|_{\bvec x_0}=\left.\frac{\dd g}{\dd x}\right|_{x_i}~,
\end{equation}
因此我们可以使用一元函数的求导公式来进行偏导数的计算。固定其他 $x_j(j\neq i)$ 不动，对 $x_i$ 求导，得到的结果就是我们要求的偏导数。

如果多元函数 $f(\bvec x)$ 在开集 $U$ 上有定义，且在 $U$ 上每一点处都有对 $x_i$ 的偏导数，那么偏导数就是一个新的 $n$ 元函数：
\begin{equation}
\begin{aligned}
\frac{\partial f}{\partial x_i}: U&\rightarrow \mathbb{R}~,\\
\bvec x&\mapsto \frac{\partial f(\bvec x)}{\partial x_i}~.
\end{aligned}
\end{equation}
因此我们可以定义二阶偏导数（如果存在的话），甚至更高阶的偏导数。例如，如果再对 $\partial f/\partial x_i$ 求对 $x_j$ 的偏导数，则可以记为
\begin{equation}
\left.\frac{\partial}{\partial x_j} \frac{\partial f(\bvec x)}{\partial x_i}\right|_{\bvec x_0}=\left.\frac{\partial^2 f}{\partial x_j\partial x_i }\right|_{\bvec x_0}~.
\end{equation}

有时对于性质较好的函数 $f(\bvec x)$（例如 $f$ 是 $n$ 元连续函数），可以将它想象成欧几里德空间 $\mathbb{R}^{n+1}$ 中的一个曲面，曲面上的点 $(x_1,\cdots,x_n,x_{n+1})$ 意味着 $x_{n+1}=f(x_1,\cdots,x_n)$。那么偏导数的几何意义就是曲面在某一个方向上的斜率 $\dd x_{n+1}/\dd x_i$。$n$ 个偏导数 $\partial f/\partial x_1,\cdots,\partial f/\partial x_n$ 代表了曲面在 $n$ 个平行于坐标轴的方向上的斜率。

\subsection{方向导数}
偏导数的几何意义是在 $n$ 个平行于坐标轴的方向上的斜率，可以将它推广至任意方向上的斜率。从原点出发的一条射线与 $n$ 维球面 $S_n=\{(x_1,\cdots,x_n):x_1^2+\cdots+x_n^2=1\}$ 的交点可以代表一个方向，设 $\bvec v=(\cos \theta_1,\cos\theta_2,\cdots,\cos\theta_n)$ 为球面上一点，那么该方向与 $x_i$ 轴的夹角为 $\theta_i$。
\begin{definition}{方向导数}
设函数 $f(\bvec x)$ 在区域 $D$ 上有定义，$x_0\in D$，$\bvec v=(\cos \theta_1,\cdots,\cos\theta_n)$ 为某一个方向。如果极限
\begin{equation}
\lim\limits_{t\rightarrow 0^+}\frac{f(\bvec x_0+t\bvec v)-f(\bvec x_0)}{t}~
\end{equation}
存在\footnote{注意这里 $t\rightarrow 0^+$，表示关于 $t$ 的函数的右极限，即在 $t>0$ 的情况下趋于 $0$。}，那么称该极限为 $f(\bvec x)$ 在 $\bvec x_0$ 处沿 $\bvec v$ 的方向导数。记为
\begin{equation}
\left.\frac{\partial f(\bvec x)}{\partial \bvec v}\right|_{\bvec x_0}~.
\end{equation}
\end{definition}

方向导数的几何意义明显，可以证明它不依赖于坐标系的选取。要注意的是，函数 $f(\bvec x)$ 在 $\bvec x_0$ 处，沿 $\bvec v$ 的方向导数不一定是沿 $-\bvec v$ 的方向导数的相反数。以函数 $f(x,y)=\sqrt{x^2+y^2}$ 为例，它在原点 $(0,0)$ 处沿 $\bvec v=(1,0)$ 的方向导数为 $1$，沿 $-\bvec v=(-1,0)$ 的方向导数也为 $1$，两者并不互为相反数。事实上 $f(x,y)$ 在 $(0,0)$ 处并不存在偏导数，但它沿任意方向都有方向导数。

下面我们将看到，对于连续可微函数，只要知道它的所有偏导数，就能计算出它的所有方向导数。
\subsection{可微性与偏导数}
\begin{definition}{多元函数的可微}
设函数 $f(\bvec x)$ 在区域 $D$ 上有定义，$\bvec x_0=(x_1,\cdots,x_n)\in D$。记 $\Delta \bvec x=(\Delta x_1,\cdots,\Delta x_n)$ 为函数的自变量的\textbf{全增量}，且 $\bvec x_0+\Delta\bvec x\in D$。如果存在常数 $A_1,\cdots,A_n$（这些常数只与 $\bvec x_0$ 有关，不与全增量有关），
满足
\begin{equation}
\Delta f=f(\bvec x_0+\Delta \bvec x)-f(\bvec x_0)=\sum_{i=1}^n A_i \Delta x_i+o(|\Delta \bvec x|),\ |\Delta \bvec x|\rightarrow 0~.
\end{equation}
那么称 $f(\bvec x)$ 在 $\bvec x_0$ 处\textbf{可微}，并称 $\sum_{i=1}^n A_i \Delta x_i$ 为 $f(\bvec x)$ 在 $\bvec x_0$ 处的全微分，记为：
\begin{equation}
\dd f(\bvec x_0)=\sum_{i=0}^n A_i\dd x_i~,
\end{equation}
如果 $f(\bvec x)$ 在 $D$ 内每一个点处都可微，就称 $f(\bvec x)$ 为 $D$ 上的\textbf{可微函数}。
\end{definition}
