% 厄米矩阵的本征问题
% keys 线性代数|厄米矩阵|本征值|正交归一|本征矢|本征方程
% license Xiao
% type Tutor
% 未完成： 先把这篇文章完成， 然后复制粘贴到对称矩阵文章里面， 符号替换一下就行

\begin{issues}
\issueDraft
\end{issues}

\pentry{厄米矩阵\nref{nod_HerMat}， 矩阵的本征方程\nref{nod_MatEig}， 正交子空间\nref{nod_OrthSp}}{nod_5ff0}

本文将 “对称矩阵的本征值问题\upref{SymEig}” 拓展到厄米矩阵， 结论和过程都相似。 我们来证明 $N$ 维厄米矩阵 $\mat H$ 存在 $N$ 个两两正交归一的本征矢 $\bvec v_1, \dots, \bvec v_N$。
\addTODO{需要把以下结论用定理的形式列出来}

% 未完成： 举例最重要
% 未完成： 参考 docx 版本

\begin{theorem}{}
$N$ 为厄米矩阵的本征向量和本征值具有以下性质
\begin{enumerate}
\item 本征值为实数
\item 本征值不同的本征矢正交
\item 存在一组本征矢构成的正交归一基底
\end{enumerate}
\end{theorem}

从正交子空间的角度来转述 2,3 条就是： 所有本征子空间（\autoref{sub_MatEig_1}~\upref{MatEig}） $V_1 \dots V_N$ 互补且两两正交\upref{OrthSp}， 即
\begin{equation}
V_i\bot V_j \qquad (i, j = 1,\dots, N, i \ne j)~
\end{equation}
\begin{equation}
V_1\oplus V_2 \oplus\dots \oplus V_N = V~.
\end{equation}

\addTODO{对角线加上常数则本征值也加上相同常数， 本征矢不变。}

\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/a3501c8ee4446206.pdf}
\caption{厄米矩阵本征方程解集的结构： 图中箭头代表一维子特正空间（非简并）， 三角形代表多维子空间（简并）} \label{fig_HerEig_1}
\end{figure}

% 该例题可作为块对角厄米矩阵本征问题中的例题
% \begin{example}{计算对易厄米矩阵的共同本征矢}
% 已知两个对易的厄米矩阵 $\bvec{A,B}$ 如下
% \begin{equation}
% \bvec{A} = \begin{pmatrix}
% 1 & 0 & 0&0&0\\
% 0&1&2&0&0\\
% 0&2&1&0&0\\
% 0&0&0&0&-\I\\
% 0&0&0&\I&0
% \end{pmatrix}
% \qquad
% \bvec{B} = \begin{pmatrix}
% 2 & 0 & 0&0&0\\
% 0&1&0&0&0\\
% 0&0&1&0&0\\
% 0&0&0&2&-\I\\
% 0&0&0&\I&2
% \end{pmatrix}
% \end{equation}
% 试计算它们的共同本征矢。

% \textbf{解：}我们按照上面的具体计算步骤来演示：

% 1。求 $\bvec{A}$ 的正交归一化本征列矢量：矩阵 $\bvec{A}$ 的本征方程为
% \begin{equation}\label{eq_Commut_1}
% \vmat{\bvec{A}-\lambda}=
% \vmat{
% 1-\lambda & 0 & 0&0&0\\
% 0&1-\lambda&2&0&0\\
% 0&2&1-\lambda&0&0\\
% 0&0&0&0-\lambda&-\I\\
% 0&0&0&\I&0-\lambda
% }=0
% \end{equation}

% 由于 $\bvec{A}$ 为块对角矩阵 $\bvec{A}=\pmat[\bvec{A_1},\bvec{A_2},\bvec{A_3}]$，其中
% \begin{equation}
% \bvec{A_1}=\pmat{1}\quad ,\bvec{A_2}=\pmat{1&2\\2&1}\quad
% \bvec{A_3}=\pmat{0&-\I\\\I&0}
% \end{equation}
% 由分块矩阵的计算法则，\autoref{eq_Commut_1} 可写成
% \begin{equation}
% \vmat{\bvec{A_1}-\lambda\bvec{E}}\cdot \vmat{\bvec{A_2}-\lambda\bvec{E}}\cdot\vmat{\bvec{A_3}-\lambda\bvec{E}}=0
% \end{equation}


% 解得 $\bvec{A}$ 的本征值为： $\lambda_1=\lambda_2=1,\lambda_3=\lambda_4=-1,\lambda_5=3$

% a.对 $\lambda_1=\lambda_2=1$ ，解 $(\bvec{A}-2\bvec{E})\bvec{x}=\bvec{0}$，得基础解系：
% \begin{equation}
% \bvec{\xi_1}=\pmat{1\\0\\0\\0\\0},\quad
% \bvec{\xi_2}=\pmat{0\\0\\0\\-\I\\1}
% \end{equation}
% 经正交归一化得
% \begin{equation}
% \bvec{\eta_1}=\frac{1}{\sqrt{2}}\pmat{\sqrt{2}\\0\\0\\0\\0},\quad
% \bvec{\eta_2}=\frac{1}{\sqrt{2}}\pmat{0\\0\\0\\-\I\\1}
% \end{equation}

% b.对 $\lambda_3=\lambda_4=-1$ ，解 $(\bvec{A}-2\bvec{E})\bvec{x}=\bvec{0}$，得基础解系：
% \begin{equation}
% \bvec{\xi_3}=\pmat{0\\1\\-1\\0\\0},\quad
% \bvec{\xi_4}=\pmat{0\\0\\0\\\I\\1}
% \end{equation}
% 经正交归一化得
% \begin{equation}
% \bvec{\eta_3}=\frac{1}{\sqrt{2}}\pmat{0\\1\\-1\\0\\0},\quad
% \bvec{\eta_4}=\frac{1}{\sqrt{2}}\pmat{0\\0\\0\\\I\\1}
% \end{equation}
% c.对 $\lambda_5=3$ ，解 $(\bvec{A}-2\bvec{E})\bvec{x}=\bvec{0}$，得基础解系:
% \begin{equation}
% \bvec{\xi_5}=\pmat{0\\1\\1\\0\\0}
% \end{equation}
% 经正交归一化得
% \begin{equation}
% \bvec{\eta_5}=\frac{1}{\sqrt{2}}\pmat{0\\1\\1\\0\\0}
% \end{equation}

% 组成酉矩阵 $\mat P$， 把本征值相同的列放在一起:
% \begin{equation}
% \bvec{P}=\frac{1}{\sqrt{2}}\begin{pmatrix}
% \sqrt{2}&0&0&0&0\\0&0&1&0&1\\0&0
% &-1&0&1\\0&-\I&0&\I&0\\0&1&0&1&0
% \end{pmatrix}
% \end{equation}

% 2.计算 $\mat B_1 = \mat P^{-1} \mat B\mat P$ 得块对角矩阵:
% \begin{equation}
% \bvec{P^{-1}}=\frac{1}{\sqrt{2}}\left(
% \begin{array}{ccccc}
%  \sqrt{2} & 0 & 0 & 0 & 0 \\
%  0 & 0 & 1 & 0 & 1 \\
%  0 & 0 & -1 & 0 & 1 \\
%  0 & -\I & 0 & \I & 0 \\
%  0 & 1 & 0 & 1 & 0 \\
% \end{array}
% \right)
% \end{equation}

% \begin{equation}
% \mat B_1=\mat P^{-1} \mat B\mat P=\left(
% \begin{array}{ccccc}
%  2 & 0 & 0 & 0 & 0 \\
%  0 & 3 & 0 & 0& 0 \\
%  0 & 0 & 1 & 0 & 0 \\
%  0 & 0 & 0 & 1 & 0 \\
%  0 & 0 & 0 & 0 & 1 \\
% \end{array}
% \right)
% \end{equation}
% 显然，$\bvec{B}$ 已经由酉矩阵 $\bvec{P}$ 对角化，即 $\bvec{P}$ 的每一列是 $\bvec{A,B}$ 的共同本征矢。 
% \end{example}

\subsection{证明}
\subsubsection{本征值为实数}
本征方程为
\begin{equation}
\mat H \bvec v_i = \lambda_i \bvec v_i~.
\end{equation}
将本征方程左边乘以 $\bvec v_i\Her$ 得
\begin{equation}
\bvec v_i\Her \mat H \bvec v_i = \lambda_i \bvec v_i\Her \bvec v_i~.
\end{equation}
将等式两边取厄米共轭（注意矢量也可以看成矩阵）， 由\autoref{eq_HerMat_2}~\upref{HerMat} 和\autoref{eq_HerMat_1}~\upref{HerMat} 可得
\begin{equation}
\bvec v_i\Her \mat H\Her \bvec v_i = \bvec v_i\Her \mat H \bvec v_i = \lambda_i^* \bvec v_i\Her \bvec v_i~.
\end{equation}
对比两式， 得 $\lambda_i = \lambda_i^*$， 所以 $\lambda_i$ 必为实数。

\subsubsection{本征矢的正交性}
下面来证明不同本征值对应的本征矢正交， 即
\begin{equation}\label{eq_HerEig_1}
\bvec v_i\Her \bvec v_j = 0 \qquad (a_i \ne a_j)~.
\end{equation}
首先令
\begin{equation}
s = \bvec v_i\Her (\mat H \bvec v_j) = \bvec v_i\Her (\lambda_j \bvec v_j) = \lambda_j \bvec v_i\Her \bvec v_j~.
\end{equation}
使用矩阵乘法结合律\autoref{eq_Mat_1}~\upref{Mat} 以及\autoref{eq_HerMat_2}~\upref{HerMat} 得
\begin{equation}
s = (\mat H \bvec v_i)\Her \bvec v_j = \lambda_i^* \bvec v_i\Her \bvec v_j = \lambda_i \bvec v_i\Her \bvec v_j~.
\end{equation}
以上两式相减得 % 简并空间内， 我们可以认为地指定正交归一基底， 所以只需要
\begin{equation}
(\lambda_j - \lambda_i)\bvec v_i\Her \bvec v_j = 0~,
\end{equation}
因为 $\lambda_i \ne \lambda_j$， 所以 $\bvec v_i\Her \bvec v_j = 0$。

\subsection{对角化}
\addTODO{把 “相似变换和相似矩阵\upref{MatSim}” 中的内容搬运过来。}

\subsection{简并}\label{sub_HerEig_1}
在 “矩阵的本征方程\upref{MatEig}” 中， 我们定义若令 $\lambda_i$ 的本征矢空间的维数是 $n_i$， 当 $n_i = 1$， 我们说 $\lambda_i$ 是\textbf{非简并（non-degenerate）}的， 当 $n_i > 1$ 就说 $\lambda_i$ 是 $n_i$ 重\textbf{简并（degenerate）}的， 把 $n_i$ 叫做\textbf{简并数（degeneracy）}。

根据\autoref{eq_HerEig_1}， 对于厄米矩阵， 所有不同的 $\lambda_i$ 对应的\textbf{本征子空间}是两两正交的， 且 $\sum_i n_i = N$， 所以所有这些子空间的直和就是 $\mat A$ 的定义域空间， 即他们互为正交补\upref{OrthSp}。
\addTODO{如何证明 $\sum_i n_i = N$ 呢？估计要证明 $m$ 重跟可以使得行稀疏矩阵的秩为 $N-m$。}

\subsection{完备正交基底}
对任意的 $N$ 维厄米矩阵 $\mat H$ 都能得到由本征矢构成的 $N$ 个正交归一基底。
\begin{itemize}
\item 如果不存在简并， 这组基底是唯一的， 且它们的本征值各不相同。
\item 如果存在简并， 每个子空间中可以选出 $n_i$ 个正交归一基底， 将他们放在一起就得到总空间中的 $N$ 个正交归一基底。 注意每个简并子空间中的正交归一基底的选取都是任意的。
\end{itemize}
\addTODO{举一个综合的例子，包含简并的}

\subsection{块对角厄米矩阵的本征问题}\label{sub_HerEig_2}
特殊地， 如果厄米矩阵 $\mat H$ 是一个块对角矩阵，且每个对角块 $\mat H_i$ 都是方阵， 那么只需要分别求解每个块的本征矢矩阵 $\mat P_i$， 再按顺序拼成块对角矩阵就是 $\mat H$ 的本征矢矩阵。 若每个 $\mat P_i$ 的本征值对角矩阵为 $\mat \Lambda_i$， 那么按顺序拼接后得到 $\mat H$ 的本征值对角矩阵。

\textbf{证明}： 若 $\mat H$ 从左上到右下的对角块分别为 $\mat H_1, \mat H_2, \dots$， 令 $\mat H_i$ 的列本征矢矩阵为 $\mat P_i$， 本征值的对角矩阵为 $\mat\Lambda_i$， 那么有 $\mat H_i \mat P_i = \mat P_i \mat \Lambda_i$。 考虑到两个块对角矩阵相乘就是每个对角块分别相乘， 就有 $\mat H \mat P = \mat P \mat \Lambda$。
