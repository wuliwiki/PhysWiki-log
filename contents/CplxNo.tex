% 复数
% keys 矢量|虚数|复数|三角恒等式|共轭
% license Xiao
% type Tutor

\pentry{集合（高中）\nref{nod_HsSet}}{nod_abec}

\begin{definition}{复数}
\textbf{复数（complex number）} 是一对满足以下运算的有序实数 $(x,y)$。\footnote{一些教材先定义虚数单位 $\I = \sqrt{-1}$ 或 $\I^2 = -1$， 这种定义往往不易理解。 我们这里直接将复数定义为服从某种运算规则的实数对 $(x,y)$，然后定义 $\I$ 不过为了方便表示 $(0,1)$ 的一个简写，更能揭示复数的代数结构\cite{Rudin}。} 令 $z$ 为复数， 即 $z = (x, y)$， 则 $x$ 称为复数 $z$ 的\textbf{实部（real part）}， $y$ 称为\textbf{虚部（imaginary part）}， 可以记为 $\Re[z]$ 和 $\Im[z]$。

特殊地， 我们把复数 $(0, 1)$ 称为\textbf{虚数单位}， 用 $\I$ 表示\footnote{为了与变量 $i$ 区分， 小时百科中虚数单位使用正体的 $\I$。}。

最后我们把虚部为零的复数 $(x, 0)$ 等同于实数 $x$。 把所有复数的\enref{集合}{Set}记为 $\mathbb C$， 那么全体实数的集合 $\mathbb R$ 就是 $\mathbb C$ 的一个\enref{真子集}{Set}，即 $\mathbb R \subset \mathbb C$。
\end{definition}

\begin{definition}{复数的简单运算}
定义两个复数的加法为实部和虚部分别相加
\begin{equation}\label{eq_CplxNo_1}
(x_1, y_1) + (x_2, y_2) = (x_1+ x_2,\ y_1 + y_2)~.
\end{equation}
定义复数和实数 $s$ 相乘为（满足交换律）（一般省略乘号）
\begin{equation}\label{eq_CplxNo_4}
s(x, y) = (x, y)s = (sx, sy)~.
\end{equation}
\end{definition}

可见任意一个复数可以表示为一个加法和一个乘法： $(x, y) = (x, 0) + y(0, 1)$， 即熟悉的
\begin{equation}
z = x + \I y~.
\end{equation}

\subsection{复平面}
\pentry{几何矢量的运算\nref{nod_GVecOp}， 四象限 Arctan 函数\nref{nod_Arctan}}{nod_2998} % \addTODO{Arctan 只需要第一个 node}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/30d6ec41da6d561c.pdf}
\caption{复平面与复数} \label{fig_CplxNo_1}
\end{figure}

由此可以看到， 复数跟二维平面上的\enref{几何矢量}{GVec}是十分相似的。 如\autoref{fig_CplxNo_1}， 一个复数可以看做\textbf{复平面}上的一个点（或矢量）， 该矢量在复平面的\textbf{实轴}和\textbf{虚轴}方向的分量分别等于其实部和虚部。 复数的\textbf{模}定义为对应矢量的模， 即
\begin{equation}
\abs{z} = \sqrt{\Re[z]^2 + \Im[z]^2}~.
\end{equation}
另外我们把矢量与实轴的夹角称为\textbf{辐角}， 记为 $\arg(z)$。 我们可以通过 $\Arctan$ 函数（\autoref{eq_Arctan_1}~\upref{Arctan}）计算辐角
\begin{equation}\label{eq_CplxNo_5}
\arg(z) = \Arctan(\Im[z], \Re[z])
\qquad (\arg z \in (-\pi, \pi])~,
\end{equation}
也可以通过模和辐角来计算实部与虚部
\begin{equation}
\Re[z] = \abs{z}\cos(\arg z)~, \qquad \Im[z] = \abs{z}\sin(\arg z)~.
\end{equation}
在“\enref{指数函数（复数）}{CExp}” 中我们将看到， 任意复数也可以通过欧拉公式表示为以下形式
\begin{equation}
z = A(\cos\theta + \I\sin\theta) = A\E^{\I\theta}~.
\end{equation}
其中 $A = \abs{z}$， $\theta = \arg z$。

\subsection{基本运算}
\begin{definition}{共轭}
一个复数的共轭等于与其实部相同，虚部相反的复数\footnote{一些教材也使用 $\bar z$ 表示 $z$ 的共轭。}
\begin{equation}\label{eq_CplxNo_6}
z\Cj = \Re[z] - \I\, \Im[z]~.
\end{equation}
\end{definition}
所以共轭运算不改变复数的模， 但将其辐角变为相反数。 在复平面上， 这相当于把一个点关于 $x$ 轴取镜像对称。

\autoref{eq_CplxNo_1} 中已经定义了加法，与实数一样， 可以用加法来定义减法：
\begin{definition}{复数的减法}
\begin{equation}
z_1 - z_2 = z_1 + (-1)z_2~.
\end{equation}
\end{definition}
写成实部和虚部，就是
\begin{equation}
(x_1 + \I y_1) \pm (x_2 + \I y_2) = (x_1 \pm x_2) + \I (y_1 \pm y_2)~.
\end{equation}
在复平面上， 这相当于把两个复数对应的矢量进行\enref{矢量相加减}{GVecOp}。显然， 复数的加法满足\textbf{交换律}， \textbf{分配律}和\textbf{结合律}。

特殊地， 将一个复数与其复共轭加减可得其实部和虚部
\begin{equation}\label{eq_CplxNo_3}
\Re[z] = \frac{z + z\Cj}{2} ~,\qquad
\Im[z] = \frac{z - z\Cj}{2\I}~.
\end{equation}

\begin{definition}{复数的乘法}
两个复数相乘定义为（注意\autoref{eq_CplxNo_4} 是该定义的一种特殊情况）
\begin{equation}
z_1z_2 = (x_1 + \I y_1)(x_2 + \I y_2) = (x_1 x_2 - y_1 y_2) + \I (x_1 y_2 + x_2 y_1)~.
\end{equation}
\end{definition}

\begin{theorem}{复数乘法的几何意义}\label{the_CplxNo_2}
两复数相乘，就是把它们的模相乘，辐角相加
\begin{equation}\label{eq_CplxNo_10}
\abs{z_1 z_2} = \abs{z_1}\abs{z_2}~,
\end{equation}
\begin{equation}
\arg(z_1 z_2) = \arg(z_1) + \arg(z_2)~.
\end{equation}
\end{theorem}
证明见\autoref{sub_CplxNo_1}。

不难证明复数的乘法满足\textbf{交换律}和\textbf{结合律}。 容易证明，一个复数模的平方可以用它和复共轭的乘积表示。
\begin{equation}\label{eq_CplxNo_2}
\abs{z}^2 = z z\Cj~.
\end{equation}

若把两个复数 $z_1, z_2$ 看作复平面上的两个矢量， 由定义容易证明它们的点乘（内积）为（\autoref{eq_Dot_5}~\upref{Dot}）
\begin{equation}\label{eq_CplxNo_11}
\begin{aligned}
&\quad \Re[z_1] \Re[z_2] + \Im[z_1]\Im[z_2]\\
&= \abs{z_1}\abs{z_2}\cos(\arg z_2 - \arg z_1)\\
&= \Re[z_1^* z_2] = \Re[z_1 z_2^*]\\
&= \frac{z_1^* z_2 + z_1 z_2^*}{2}~,
\end{aligned}
\end{equation}
最后使用了\autoref{eq_CplxNo_3}。

任意个复数相乘再取共轭等于它们分别共轭再相乘
\begin{equation}
(z_1z_2\dots z_n)^* = z_1^*z_2^*\dots z_n^*~
\end{equation}
证明： 对一个复数取共轭相当于把它的辐角

\begin{definition}{复数的逆}
可以证明每个不为零的复数 $z$， 运算中都存在\textbf{唯一}的\textbf{乘法逆元}（简称\textbf{逆}）， 记为 $z^{-1}$， 使得
\begin{equation}\label{eq_CplxNo_9}
zz^{-1} = z^{-1}z = 1 \qquad (z \ne 0)~.
\end{equation}
且逆元的计算公式为
\begin{equation}\label{eq_CplxNo_8}
z^{-1} = \frac{z^*}{\abs{z}^2} \qquad (z \ne 0)~.
\end{equation}
\end{definition}
\textbf{证明}： 把\autoref{eq_CplxNo_8} 代入\autoref{eq_CplxNo_9}， 再使用\autoref{eq_CplxNo_2} 即可。 要证明逆元的唯一性， 假设 $z$ 的任意两个逆元分别为 $z_1, z_2$， 有 $zz_1 = 1 = zz_2$, 两边左乘 $z^{-1}$， 使用结合律得 $z_1 = z_2$。 \textbf{证毕}。

现在就可以通过逆， 来定义除法：
\begin{definition}{复数的除法}
令 $x_i,y_i$ 分别是 $z_i$ （$i=1,2$）的实部和虚部，那么复数的除法定义为
\begin{equation}\label{eq_CplxNo_7}
\frac{z_1}{z_2} = z_1z_2^{-1} = \frac{z_1z_2^*}{\abs{z_2}^2} = \frac{x_1 x_2 + y_1 y_2}{x_2^2 + y_2^2} + \I \frac{x_2 y_1 - x_1 y_2}{x_2^2 + y_2^2} \qquad (z_2 \ne 0)~.
\end{equation}
\end{definition}
根据该定义， $1/z = z^{-1}$， 可见逆元就是所谓的倒数。 和实数一样，易证 $z_1z_2 = z_3$， $z_1 = z_3/z_2$， $z_2 = z_3/z_1$ 是等价的，所以通俗来说复数除法是复数乘法的逆运算。 所以自然地，可以得到：

\begin{corollary}{复数除法的几何意义}
两个复数相除就是把它们的模相除， 辐角相减， 即
\begin{equation}
\abs{z_1/z_2} = \abs{z_1}/\abs{z_2}~,
\end{equation}
\begin{equation}
\arg(z_1/z_2) = \arg(z_1) - \arg(z_2)~.
\end{equation}
\end{corollary}

\begin{theorem}{}\label{the_CplxNo_1}
两个复数进行任意次加减乘除后再取共轭， 等于它们分别取共轭后再进行运算。
\end{theorem}
根据定义易证（留做习题）。 例如
\begin{equation}
\qty[\frac{2 z_1 z_2}{(z_3 + z_4)^2}]^* = \frac{2 z_1^* z_2^*}{(z_3^* + z_4^*)^2}~.
\end{equation}

\subsection{余弦定理}
根据\autoref{eq_CplxNo_2}， \autoref{eq_CplxNo_11}  和\autoref{the_CplxNo_1} 易得
\begin{equation}
\begin{aligned}
\abs{z_1 + z_2}^2 &= (z_1 + z_2)(z_1 + z_2)^*\\
&= z_1z_1^* + z_2z_2^* + z_1^* z_2 + z_1 z_2^*\\
&= \abs{z_1}^2 + \abs{z_2}^2 + 2\Re[z_1^* z_2]\\
&= \abs{z_1}^2 + \abs{z_2}^2 + 2\abs{z_1}\abs{z_2}\cos(\arg z_2 - \arg z_1)~.
\end{aligned}
\end{equation}
在复平面中， 该式可以表示余弦定理（\autoref{eq_CosThe_2}~\upref{CosThe}）， 即计算两矢量之和的模。 上式最后的第三项就是两矢量的点乘。


\subsection{证明}\label{sub_CplxNo_1}
\pentry{三角恒等式\nref{nod_TriEqv}}{nod_84fd}

\autoref{the_CplxNo_2} 的证明：

令 $A_i = \abs{z_i}$， $\theta_i = \arg z_i$， 则
\begin{equation}\ali{
z_1 z_2 &= (A_1 \cos\theta_1 + \I A_1 \sin\theta_1)(A_2 \cos\theta_2 + \I A_2 \sin\theta_2)\\
&= A_1 A_2 (\cos\theta_1\cos\theta_2 - \sin\theta_1\sin\theta_2)\\
&\qquad + \I A_1 A_2 (\cos\theta_1\sin\theta_2 + \cos\theta_2\sin\theta_1)\\
&= A_1 A_2 [\cos(\theta_1 + \theta_2) + \I \sin(\theta_1 + \theta_2)]~,
}\end{equation}
其中最后一步用到了两角和公式（\autoref{eq_TriEqv_1}~\upref{TriEqv}）。 容易看出， 最后得到的是一个模为 $A_1 A_2$， 辐角为 $\theta_1 + \theta_2$ 的复数。

\textbf{证毕}。
