% 正交曲线坐标系中的重积分
% keys 多元微积分|积分|重积分|曲线坐标系|正交曲线坐标系|极坐标系|面积法|体积分
% license Xiao
% type Tutor

\pentry{正交曲线坐标系\nref{nod_CurCor}， 重积分\nref{nod_IntN}}{nod_cb65}
在计算一些多重积分时， 选取合适的坐标系往往可以大大化简问题。
\addTODO{需要给出一般正交曲线坐标系的体积元公式}

\subsection{极坐标系中的二重积分}
 
\begin{figure}[ht]
\centering
\includegraphics[width=4cm]{./figures/013b0ce91c0c290a.pdf}
\caption{极坐标中的面积元} \label{fig_CrIntN_1}
\end{figure}

我们来看如何在\enref{极坐标系}{Polar}中进行二重积分。 我们先把积分区域划分为无数个小\textbf{面积元}， 点 $\bvec r$ 处面元的形状如\autoref{fig_CrIntN_1} 所示， 即把两个坐标 $r, \theta$ 坐标分别在原来的基础上增加一个微小值，并围成一块小区域。 由于 $\dd{r}, \dd{\theta}$ 都是无穷小， 该面元的形状趋近于长方形， 其面积为两边长相乘
\begin{equation}\label{eq_CrIntN_4}
\dd{s} = \dd{r}\cdot r\dd{\theta} = r\dd{r}\dd{\theta}~.
\end{equation}
类比\autoref{ex_IntN_1}~\upref{IntN}， 我们可以将 $f(r, \theta)$ 的面积分记为
\begin{equation}\label{eq_CrIntN_2}
\iint_{\mathcal S} f(r, \theta) r\dd{r}\dd{\theta} = \int_{\theta_1}^{\theta_2} \dd{\theta}\int_{r_1(\theta)}^{r_2(\theta)} \dd{r}\ r f(r, \theta)~,
\end{equation}
其中 $r_1(\theta)$ 与 $r_2(\theta)$ 是区域 $\mathcal S$ 的两条边界（类比\autoref{eq_IntN_7}~\upref{IntN} 中的 $y_1(x), y_2(x)$）。

\autoref{eq_CrIntN_4} 也是\enref{柱坐标系}{Cylin}中 $r$、$\theta$ 曲坐标面上的面积元。 对于球坐标， 我们可得到 $\theta$、 $\phi$ 曲坐标面上的面积元
\begin{equation}
\dd s=r^2\sin\theta\dd\theta\dd\phi~.
\end{equation}


\begin{example}{}
求 $f(r,\theta) = ar$ 在内外半径为 $R_1, R_2$ 的圆环区域的面积分。 

先来看积分上下限， 对于圆环区域， 显然有 $r_1(\theta) = R_1$， $r_2(\theta) = R_2$， $\theta_1 = 0$， $\theta_2 = 2\pi$。 直接使用\autoref{eq_CrIntN_2} 得
\begin{equation}\ali{
\iint_{\mathcal S} f(r, \theta) r\dd{r}\dd{\theta} &= \int_0^{2\pi} \qty[\int_{R_1}^{R_2} ar^2 \dd{r}] \dd{\theta}
= \int_0^{2\pi} \frac a3 (R_2^3 - R_1^3) \dd{\theta}\\
&= \frac{2\pi a}{3} (R_2^3 - R_1^3)~.
}\end{equation}

如果使用直角坐标系计算该积分， 过程将会变得更加复杂。
\end{example}

\begin{example}{球面积分}\label{ex_CrIntN_1}
\addTODO{球面的面积、 函数在球面上积分}
\end{example}

\subsection{曲线坐标系中的体积分}
在曲线坐标系中， 令
\begin{equation}\label{eq_CrIntN_7}
\pdv{\bvec r}{x_i} \equiv f_i(\bvec r)\uvec x_i \quad (i = 1,2,3)~.
\end{equation}
则位矢的全微分为
\begin{equation}\label{eq_CrIntN_8}
\dd{\bvec r} = \sum_{i = 1}^3 f_i(\bvec r)\dd{x_i}\uvec x_i~.
\end{equation}
所以空间中的一个\textbf{体积元}（每个 $x_i$ 都分别增加 $\dd{x_i}$ 所围成的长方体）可以表示为
\begin{equation}
\dd{V} = f_1(\bvec r)f_2(\bvec r)f_3(\bvec r)\dd{x_1}\dd{x_2}\dd{x_3}~.
\end{equation}
这是因为根据\autoref{eq_CrIntN_8}， 单独将坐标 $x_i$ 增加 $\dd{x_i}$ 会导致 $\bvec r$ 在 $\uvec x_i$ 方向增加 $f_i(\bvec r)\dd{x_i}$， 这相当于长方体在 $\uvec x_i$ 方向的边长， 而长方体的体积等于三条边长之积。 为了方便书写我们以后将 $\dd{x_1}\dd{x_2}\dd{x_3}$ 记为 $\dd[3]{x}$ 或 $\dd[3]{r}$。
\begin{figure}[ht]
\centering
\includegraphics[width=9.5cm]{./figures/3e336a5fe07930f7.pdf}
\caption{柱坐标（左）和球坐标（右）中的体积元} \label{fig_CrIntN_2}
\end{figure}

我们已知直角坐标系中 $\pdv*{\bvec r}{x_i} = 1$， 所以体积元为 $\dd[3]{r} = \dd{x}\dd{y}\dd{z}$。 对于柱坐标系（\autoref{fig_CrIntN_2} 左）， 由\autoref{eq_CylNab_5}~\upref{CylNab} 得体积元为
\begin{equation}\label{eq_CrIntN_1}
\dd{V} = \dd{r}\cdot r\dd{\theta} \cdot \dd{z} = r\dd{r}\dd{\theta}\dd{z}~.
\end{equation}
类似地， 对于球坐标系（\autoref{fig_CrIntN_2} 右）， 由%\addTODO{链接}
得体积元为
\begin{equation}\label{eq_CrIntN_3}
\dd{V} = \dd{r} \cdot r\dd{\theta} \cdot r\sin\theta\dd{\phi} = r^2\sin\theta\dd{r}\dd{\theta}\dd{\phi}~.
\end{equation}

\begin{example}{球体的体积}
在\autoref{ex_DefInt_4}~\upref{DefInt} 中我们用一元函数的定积分得到了球体的体积， 现在我们也可以直接在球坐标中由体积分得到。
\begin{equation}\ali{
V &= \int 1 \dd[3]{r} = \int_0^{2\pi} \int_0^\pi \int_0^R   r^2\sin\theta \dd{r} \dd{\theta} \dd{\phi}\\
&= \int_0^{2\pi} \dd{\phi} \int_0^\pi \sin\theta \dd{\theta} \int_0^R   r^2 \dd{r}\\
&= 2\pi \cdot 2 \cdot \frac 13 R^3 = \frac 43 \pi R^3~.
}\end{equation}
\end{example}
