% 洛必达法则
% 洛必达法则|导数|微分中值定理

\begin{theorem}{\textbf{$\left(\frac{0}{0}\right)$ 型} 洛必达法则}
设函数 $f(x),g(x)$ 在 $a$ 点的某一去心邻域 $U_0(a,\delta)$ 上可导，而且满足：
\begin{enumerate}
\item $\lim\limits_{x\rightarrow a} f(x)=\lim\limits_{x\rightarrow a}g(x)=0$;
\item $g'(x)\neq 0,\forall x\in U_0(a,\delta)$;
\item $\lim\limits_{x\rightarrow a} \frac{f'(x)}{g'(x)}=l$($l$ 为有限数或 $+\infty$ 或 $-\infty$);
\end{enumerate}
则有
\begin{equation}
\lim\limits_{x\rightarrow a}\frac{f(x)}{g(x)}=\lim\limits_{x\rightarrow a}\frac{f'(x)}{g'(x)}=l.
\end{equation}
上面的 $a$ 也可以取为 $+\infty$ 或 $-\infty$，定理仍然成立。
\end{theorem}
洛必达法则可以通过柯西中值定理证明。
\addTODO{证明补充}

对于其中的一种特殊情况 $sf=\lim\limits_{x\rightarrow a}f'(x),sg=\lim\limits_{x\rightarrow a}g'(x)$ 存在且 $sg\neq 0$，可以通过函数的一阶近似式来理解：$f(x)=sf\cdot (x-a)+o(x-a),g(x)=sg\cdot (x-a)+o(x-a)$，于是 $\lim\limits_{x\rightarrow a}f(x)/g(x)=sf/sg=\lim\limits_{x\rightarrow a}f'(x)/g'(x)$。利用泰勒展开公式作近似或者直接用洛必达法则，是求解分式函数极限问题的常用方法。

\begin{theorem}{\textbf{$\left(\frac{\infty}{\infty}\right)$ 型} 洛必达法则}
设函数 $f(x),g(x)$ 在 $a$ 点的某一去心邻域 $U_0(a,\delta)$ 上可导，而且满足：
\begin{enumerate}
\item $\lim\limits_{x\rightarrow a} g(x)=\infty$;
\item $g'(x)\neq 0,\forall x\in U_0(a,\delta)$;
\item $\lim\limits_{x\rightarrow a} \frac{f'(x)}{g'(x)}=l$($l$ 为有限数或 $\pm\infty,\infty$);
\end{enumerate}
则有
\begin{equation}
\lim\limits_{x\rightarrow a}\frac{f(x)}{g(x)}=\lim\limits_{x\rightarrow a}\frac{f'(x)}{g'(x)}=l~.
\end{equation}
上面的 $a$ 也可以取为 $+\infty$ 或 $-\infty$，定理仍然成立。
\end{theorem}
\begin{exercise}{}
计算 $\lim\limits_{x\rightarrow 0}\frac{\sin x}{x}$。
\end{exercise}
直接对分子分母同时求导就可以求得：
\begin{equation}
    \lim\limits_{x\rightarrow 0}\frac{\sin x}{x}=\lim\limits_{x\rightarrow 0}\frac{\cos x}{1}=1~,
\end{equation}
这告诉我们 $\sin x$ 和 $x$ 在 $x\rightarrow 0$ 时是等价无穷小量（需引用词条）。

\begin{exercise}{}
计算 $\lim\limits_{x\rightarrow 0}\frac{e^x-1-\sin x}{e^{\sin x} - \cos x - x}$。
\end{exercise}
提示：用洛必达法则，对分子和分母同时求两次导，答案为 $0.5$。

这里我们也可以通过对分子分母作二阶近似来计算。利用 $e^x=1+x+x^2/2+o(x^2),\sin x=x+o(x^2),\cos x=1-x^2/2+o(x^2)$ 对原式进行化简：
\begin{equation}
\begin{aligned}
&e^{\sin x}=e^{x+o(x^2)}=1+x+x^2/2+o(x^2)~,\\
&\lim\limits_{x\rightarrow 0}\frac{e^x-1-\sin x}{e^{\sin x} - \cos x - x}=\lim\limits_{x\rightarrow 0}\frac{x^2/2+o(x^2)}{x^2+o(x^2)}=\frac{1}{2}~.
\end{aligned}
\end{equation}

在这个例子中，用一次洛必达法则不再能满足我们的要求，于是我们用了第二次洛必达法则，对分子分母再次求导。这对应着将分子分母的函数用关于 $x$ 的二阶近似公式来表示。从这里我们能看出洛必达法则与泰勒展开公式的联系。事实上，带皮亚诺余项的泰勒展开式可以轻易地由洛必达法则得到。