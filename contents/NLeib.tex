% 牛顿—莱布尼兹公式（简明微积分）
% 微积分|积分|不定积分|定积分|牛顿-莱布尼兹公式

\pentry{不定积分\upref{Int}，定积分\upref{DefInt}， 一元函数的微分（简明微积分）\upref{Diff}}

牛顿—莱布尼兹公式描述了定积分和不定积分的关系。我们已知不定积分是求导的逆运算，而定积分是函数曲线与 $x$ 轴之间的面积，二者乍看起来没什么联系，但牛顿—莱布尼兹公式却揭示了了二者之间的重要关系。

若 $F(x)$ 是 $f(x)$ 的一个原函数\upref{Int}，则
\begin{equation}\label{eq_NLeib_1}
\int_a^b f(x) \dd{x}  = F(b) - F(a)~.
\end{equation}

\subsection{推导}
\begin{figure}[ht]
\centering
\includegraphics[width=13cm]{./figures/192b25268a733ab9.pdf}
\caption{右图中 $f(x)$ 的原函数为左图中的 $F(x)$， 当步长趋近0时，右图中的长方形面积趋近于左图中小竖线的长度。}\label{fig_NLeib_1}
\end{figure}

如\autoref{fig_NLeib_1}， 根据定积分\upref{DefInt} 的定义，有\footnote{这里假设极限存在。}
\begin{equation}
\int_a^b f(x) \dd{x}= \lim_{\Delta x_i\to 0}\sum_i f(x_i)\Delta x_i~.
\end{equation}
其中 $f(x_i)\Delta x_i$ 可看成是右图中第 $i$ 个小矩形的面积，求和是对从 $a$ 到 $b$ 的所有小矩形求和。现在不妨把 $x_i$ 设为第 $i$ 个小矩形左端的 $x$ 坐标。 考虑到求导是不定积分的逆运算，有 $f(x_i)=F'(x_i)$， 所以小矩形的面积变为
\begin{equation}
f(x_i)\Delta x_i = F'(x_i)\Delta x_i \approx \Delta F_i = F(x_{i+1})-F(x_i)~,
\end{equation}
其中的约等号使用了微分近似（\autoref{sub_Diff_1}~\upref{Diff}）。 该式可以理解成，右图中的小矩形面积约等于左图中的小竖线长度，即原函数 $F(x)$ 在 $x_i$ 到 $x_{i+1}$ 间的增量。当取极限 $\Delta x_i \to 0$ 时，上式取等号。代回\autoref{eq_NLeib_1}， 有
\begin{equation}
\int_a^b f(x) \dd{x}= \lim_{\Delta x_i\to 0}\sum_i [F(x_{i+1})-F(x_i)] = F(b)-F(a)~.
\end{equation}
该式可理解为，如果把左图中每一段 $\Delta x_i$ 所对应的微小增量 $\Delta F_i$ 都加起来，再取极限 $\Delta x_i \to 0$， 就是 $F(x)$ 从 $a$ 到 $b$ 的总增量。 在计算定积分的过程中， 为了书写简洁， 我们往往将上式中的 $F(b) - F(a)$ 记为 $\eval{F(x)}_a^b$。

\begin{example}{计算定积分}
\begin{equation}
\int_{-l}^l \sin[2](\frac{n\pi}{l} x) \dd{x}~.
\end{equation}

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/c4cbd8290da00853.pdf}
\caption{$y = \sin[2](\pi x/l)$ 的定积分， 阴影面积恰好是长方形的一半。}\label{fig_NLeib_2}
\end{figure}

先计算对应的不定积分。由积分表\upref{ITable} 中的\autoref{eq_ITable_13} 结合\autoref{eq_ITable_1} 得不定积分为
\begin{equation}
\int\sin[2](\frac{n\pi}{l} x) \dd{x} = \frac{l}{2n\pi} \qty[\frac{n\pi}{l} x - \sin(\frac{n\pi}{l} x)\cos(\frac{n\pi}{l} x)]~,
\end{equation}
再利用牛顿—莱布尼兹公式求定积分结果为 $l$。 计算该定积分还有另一种更简单的几何方法（见\autoref{fig_NLeib_2}），由于被积函数的对称性，函数曲线可将区间 $[-l,l]$ 内高为 1 的长方形（面积为 $2l$ ）划分成等面积的上下两部分，曲线下方的面积 $l$ 就是定积分的结果。
\end{example}

\begin{example}{圆的面积}\label{ex_NLeib_2}
现在我们可以用\autoref{ex_DefInt_2}~\upref{DefInt} 中列出的两个定积分计算圆的面积。 先看第一个定积分， 由积分表\autoref{eq_ITable_14}~\upref{ITable} 得
\begin{equation}
\int \sqrt{R^2 - x^2} \dd{x} = \frac12 \qty(x\sqrt{R^2 - x^2} + R^2\arcsin\frac{x}{R}) + C~.
\end{equation}
由牛顿—莱布尼兹公式， $-R$ 到 $R$ 的定积分为 $\pi R^2/2$， 所以圆的面积为 $\pi R^2$。

第二个定积分要简单得多， 由幂函数的积分\autoref{eq_ITable_2}~\upref{ITable} 和牛顿—莱布尼兹公式得
\begin{equation}
\int_0^R 2\pi r \dd{r} = \pi \eval{r^2}_0^R = \pi R^2~.
\end{equation}
\end{example}

\begin{example}{球壳与球盖的面积}\label{ex_NLeib_3}
现在我们可以直接求\autoref{ex_DefInt_3}~\upref{DefInt} 中的积分
\begin{equation}
S = 2\pi R^2 \int_0^{\pi} \sin\theta \dd{\theta} = 2\pi R^2 \eval{(-\cos\theta)}_0^\pi = 4\pi R^2~.
\end{equation}
我们还可以将积分上下限任意改变， 得到球面上一个环形曲面的面积
\begin{equation}
S = 2\pi R^2 \int_{\theta_1}^{\theta_2} \sin\theta \dd{\theta} = 2\pi R^2 (\cos{\theta_1} - \cos{\theta_2})~.
\end{equation}
当 $\theta_1 = 0$ 且 $\theta_2 = \alpha$ 时， 我们就得到了球盖的面积
\begin{equation}
S = 2\pi R^2 (1 - \cos\alpha)~.
\end{equation}
\end{example}

\subsection{对定积分上下限求导}
有时候我们会需要对定积分的上下限求导， 例如
\begin{equation}
\dv{x} \int_a^x f(t) \dd{t}~.
\end{equation}
我们可以先对定积分用牛顿莱布尼兹公式， 令原函数为 $F(x)$， 有
\begin{equation}\label{eq_NLeib_10}
\dv{x} \int_a^x f(t) \dd{t} = \dv{x} \qty[F(x) - F(a)] = f(x)~.
\end{equation}

类似地， 对积分下限求导如
\begin{equation}
\dv{x} \int_x^a f(t) \dd{t} = \dv{x} \qty[F(a) - F(x)] = -f(x)~.
\end{equation}
或者对上下限同时求导如
\begin{equation}
\dv{x} \int_{-x}^{x} f(t) \dd{t} = \dv{x} \qty[F(x) - F(-x)] = f(x) + f(-x)~.
\end{equation}

% 未完成：若不使用不定积分， 我们也可以从积分的几何意义和导数的定义来求解。 还是以积分上限的求导为例， 两个定积分的差为函数曲线在 $[x, x+h]$ 所围的面积， $h$ 很小时可近似看做长方形， 除以 $h$ 后就得到长方形的高， 即 $f(x)$
