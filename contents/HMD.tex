% 哈密顿力学（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Hamiltonian_mechanics}{相关文章}）

\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/7110c2a74929e25b.png}
\caption{威廉·罗恩·哈密顿爵士} \label{fig_HMD_1}
\end{figure}
在物理学中，哈密顿力学是拉格朗日力学的重新表述，起源于1833年。由威廉·罗恩·哈密顿爵士提出【1】，哈密顿力学用（广义）动量替代了拉格朗日力学中使用的（广义）速度 \( \dot{q}^i \)。这两种理论都提供了对经典力学的解释，并描述了相同的物理现象。

哈密顿力学与几何学（特别是辛几何和泊松结构）有密切关系，并且作为经典力学与量子力学之间的纽带。
\subsection{概述}  
\subsubsection{相空间坐标 \( (p, q) \) 和哈密顿量 \( H \)}  
设 \( (M, \mathcal{L}) \) 为一个具有构型空间 \( M \) 和光滑拉格朗日量 \( \mathcal{L} \) 的力学系统。选择 \( M \) 上的标准坐标系 \( (\boldsymbol{q}, \boldsymbol{\dot{q}}) \)。量 \( p_i(\boldsymbol{q}, \boldsymbol{\dot{q}}, t) \stackrel{\text{def}}{=} \partial \mathcal{L} / \partial \dot{q}^i \) 称为动量（也称为广义动量、共轭动量或正则动量）。对于时间瞬间 \( t \)，拉格朗日量 \( \mathcal{L} \) 的勒让德变换定义为映射 \( (\boldsymbol{q}, \boldsymbol{\dot{q}}) \to (\boldsymbol{p}, \boldsymbol{q}) \)，假设其具有光滑逆映射 \( (\boldsymbol{p}, \boldsymbol{q}) \to (\boldsymbol{q}, \boldsymbol{\dot{q}}) \)。对于具有 \( n \) 个自由度的系统，拉格朗日力学定义了能量函数
\[
E_{\mathcal{L}}(\boldsymbol{q}, \boldsymbol{\dot{q}}, t) \stackrel{\text{def}}{=} \sum_{i=1}^{n} \dot{q}^i \frac{\partial \mathcal{L}}{\partial \dot{q}^i} - \mathcal{L} ~.
\]
拉格朗日量 \( \mathcal{L} \) 的勒让德变换将 \( E_{\mathcal{L}} \) 转化为称为哈密顿量的函数 \( \mathcal{H}(\boldsymbol{p}, \boldsymbol{q}, t) \)。哈密顿量满足：
\[
\mathcal{H}\left(\frac{\partial \mathcal{L}}{\partial \boldsymbol{\dot{q}}}, \boldsymbol{q}, t\right) = E_{\mathcal{L}}(\boldsymbol{q}, \boldsymbol{\dot{q}}, t)~
\]
这意味着：
\[
\mathcal{H}(\boldsymbol{p}, \boldsymbol{q}, t) = \sum_{i=1}^{n} p_i \dot{q}^i - \mathcal{L}(\boldsymbol{q}, \boldsymbol{\dot{q}}, t),~
\]
其中速度 \( \boldsymbol{\dot{q}} = (\dot{q}^1, \dots, \dot{q}^n) \) 从 \( \boldsymbol{p} = \partial \mathcal{L} / \partial \boldsymbol{\dot{q}} \) （一个 \( n \) 维方程组）中得出，假设它对于 \( \boldsymbol{\dot{q}} \) 的解是唯一的。\( ( \boldsymbol{p}, \boldsymbol{q} ) \)（一个 \( 2n \) 维对）称为相空间坐标（也称为正则坐标）。
\subsubsection{从欧拉-拉格朗日方程到哈密顿方程 } 
在相空间坐标 \( (\boldsymbol{p}, \boldsymbol{q}) \) 中，\( n \) 维的欧拉-拉格朗日方程
\[
\frac{\partial \mathcal{L}}{\partial \boldsymbol{q}} - \frac{d}{dt} \frac{\partial \mathcal{L}}{\partial \boldsymbol{\dot{q}}} = 0~
\]
变为 \( 2n \) 维的哈密顿方程：
\[
\frac{d \boldsymbol{q}}{dt} = \frac{\partial \mathcal{H}}{\partial \boldsymbol{p}}, \quad \frac{d \boldsymbol{p}}{dt} = -\frac{\partial \mathcal{H}}{\partial \boldsymbol{q}}.~
\]
\textbf{证明}  

哈密顿量 \( \mathcal{H}(\boldsymbol{p}, \boldsymbol{q}) \) 是拉格朗日量 \( \mathcal{L}(\boldsymbol{q}, \boldsymbol{\dot{q}}) \) 的勒让德变换，因此有：
\[
\mathcal{L}(\boldsymbol{q}, \boldsymbol{\dot{q}}) + \mathcal{H}(\boldsymbol{p}, \boldsymbol{q}) = \boldsymbol{p} \cdot \boldsymbol{\dot{q}}~
\]
因此
\[
\partial \mathcal{H}/\partial \boldsymbol{p} = \boldsymbol{\dot{q}}, \quad \partial \mathcal{L}/\partial \boldsymbol{q} = -\partial \mathcal{H}/\partial \boldsymbol{q}.~
\]
此外，由于 \( \boldsymbol{p} = \frac{\partial \mathcal{L}}{\partial \boldsymbol{\dot{q}}} \)，欧拉-拉格朗日方程给出
\[
d \boldsymbol{p}/dt = \partial \mathcal{L}/\partial \boldsymbol{q} = -\partial \mathcal{H}/\partial \boldsymbol{q}.~
\]
\subsubsection{从驻定作用量原理到哈密顿方程 } 
设 \( \mathcal{P}(a, b, \boldsymbol{x}_a, \boldsymbol{x}_b) \) 为满足 \( \boldsymbol{q}(a) = \boldsymbol{x}_a \) 和 \( \boldsymbol{q}(b) = \boldsymbol{x}_b \) 的光滑路径集合 \( \boldsymbol{q}: [a, b] \to M \)。作用泛函 \( \mathcal{S}: \mathcal{P}(a, b, \boldsymbol{x}_a, \boldsymbol{x}_b) \to \mathbb{R} \) 定义为
\[
\mathcal{S}[\boldsymbol{q}] = \int_a^b \mathcal{L}(t, \boldsymbol{q}(t), \dot{\boldsymbol{q}}(t)) \, dt = \int_a^b \left(\sum_{i=1}^n p_i \dot{q}^i - \mathcal{H}(\boldsymbol{p}, \boldsymbol{q}, t)\right) \, dt,~
\]
其中 \( \boldsymbol{q} = \boldsymbol{q}(t) \)，且 \( \boldsymbol{p} = \partial \mathcal{L} / \partial \boldsymbol{\dot{q}} \)（见上文）。若路径 \( \boldsymbol{q} \in \mathcal{P}(a, b, \boldsymbol{x}_a, \boldsymbol{x}_b) \) 为 \( \mathcal{S} \) 的驻点（因此满足运动方程），则相空间坐标 \( (\boldsymbol{p}(t), \boldsymbol{q}(t)) \) 必须满足哈密顿方程。
\subsubsection{基本物理解释}  
对哈密顿力学的简单解释来自其在由质量为 \( m \) 的单个非相对论粒子组成的一维系统中的应用。此情况下，哈密顿量 \( H(p, q) \) 的值是系统的总能量，即动能和势能之和，分别传统地表示为 \( T \) 和 \( V \)。其中 \( p \) 是动量 \( mv \)，而 \( q \) 是空间坐标。则有：
\[
\mathcal{H} = T + V, \quad T = \frac{p^2}{2m}, \quad V = V(q)~
\]
动能 \( T \) 仅为 \( p \) 的函数，而势能 \( V \) 仅为 \( q \) 的函数（即 \( T \) 和 \( V \) 是非时间依赖的）。

在此示例中，\( q \) 的时间导数是速度，因此第一哈密顿方程意味着粒子的速度等于其动能对动量的导数。动量 \( p \) 的时间导数等于牛顿力，因此第二哈密顿方程意味着力等于势能的负梯度。
\subsection{示例}   
球面摆由一个质量为 \( m \) 的物体组成，其在球面上无摩擦地运动。作用在该质量上的唯一力是球面的反作用力和重力。使用球坐标 \( (r, \theta, \phi) \) 来描述该质量的位置，其中 \( r \) 是固定的，\( r = \ell \)。
\begin{figure}[ht]
\centering
\includegraphics[width=7cm]{./figures/d809868bb20c7be5.png}
\caption{球面摆：角度和速度。} \label{fig_HMD_2}
\end{figure}
该系统的拉格朗日量为【2】：
\[
L = \frac{1}{2}m\ell^2\left(\dot{\theta}^2 + \sin^2 \theta \, \dot{\varphi}^2\right) + mg\ell \cos \theta.~
\]
因此，哈密顿量为
\[
H = P_{\theta} \dot{\theta} + P_{\varphi} \dot{\varphi} - L~
\]
其中
\[
P_{\theta} = \frac{\partial L}{\partial \dot{\theta}} = m\ell^2 \dot{\theta}~
\]
和
\[
P_{\varphi} = \frac{\partial L}{\partial \dot{\varphi}} = m\ell^2 \sin^2 \theta \, \dot{\varphi}.~
\]
用坐标和动量表示时，哈密顿量为
\[
H = \underbrace{\left[\frac{1}{2}m\ell^2 \dot{\theta}^2 + \frac{1}{2}m\ell^2 \sin^2 \theta \, \dot{\varphi}^2 \right]}_{T} + \underbrace{\left[-mg\ell \cos \theta \right]}_{V} = \frac{P_{\theta}^2}{2m\ell^2} + \frac{P_{\varphi}^2}{2m\ell^2 \sin^2 \theta} - mg\ell \cos \theta.~
\]
哈密顿方程给出了坐标和共轭动量的时间演化，这些是一组四个一阶微分方程：
\[
\begin{aligned}
\dot{\theta} &= \frac{P_{\theta}}{m\ell^2}, \\
\dot{\varphi} &= \frac{P_{\varphi}}{m\ell^2 \sin^2 \theta}, \\
\dot{P_{\theta}} &= \frac{P_{\varphi}^2}{m\ell^2 \sin^3 \theta} \cos \theta - mg\ell \sin \theta, \\
\dot{P_{\varphi}} &= 0.
\end{aligned}~
\]
动量 \( P_{\varphi} \) 对应于角动量的垂直分量 \( L_z = \ell \sin \theta \times m\ell \sin \theta \, \dot{\varphi} \)，是一个守恒量。这是系统围绕垂直轴旋转对称性的结果。由于方位角 \( \varphi \) 不出现在哈密顿量中，因此它是一个循环坐标，这意味着其共轭动量守恒。
\subsection{推导哈密顿方程}  
哈密顿方程可以通过拉格朗日量 \( \mathcal{L} \)、广义位置 \( q^i \) 和广义速度 \( \dot{q}^i \) 的计算推导出来，其中 \( i = 1, \ldots, n \)【3】。这里我们在“非壳”情况下工作，意味着 \( q^i \)、\( \dot{q}^i \)、\( t \) 是相空间中的独立坐标，不受任何运动方程的约束（特别是 \( \dot{q}^i \) 不是 \( q^i \) 的导数）。拉格朗日量的全微分为：
\[
\mathrm{d} \mathcal{L} = \sum_{i} \left( \frac{\partial \mathcal{L}}{\partial q^i} \, \mathrm{d} q^i + \frac{\partial \mathcal{L}}{\partial \dot{q}^i} \, \mathrm{d} \dot{q}^i \right) + \frac{\partial \mathcal{L}}{\partial t} \, \mathrm{d} t.~
\]
广义动量坐标定义为 \( p_i = \frac{\partial \mathcal{L}}{\partial \dot{q}^i} \)，因此我们可以将方程改写为：
\[
\mathrm{d} \mathcal{L} = \sum_{i} \left( \frac{\partial \mathcal{L}}{\partial q^i} \, \mathrm{d} q^i + p_i \, \mathrm{d} \dot{q}^i \right) + \frac{\partial \mathcal{L}}{\partial t} \, \mathrm{d} t = \sum_{i} \left( \frac{\partial \mathcal{L}}{\partial q^i} \, \mathrm{d} q^i + \mathrm{d} (p_i \dot{q}^i) - \dot{q}^i \, \mathrm{d} p_i \right) + \frac{\partial \mathcal{L}}{\partial t} \, \mathrm{d} t.~
\]
重新排列后得到：
\[
\mathrm{d} \left(\sum_{i} p_i \dot{q}^i - \mathcal{L}\right) = \sum_{i} \left( -\frac{\partial \mathcal{L}}{\partial q^i} \, \mathrm{d} q^i + \dot{q}^i \, \mathrm{d} p_i \right) - \frac{\partial \mathcal{L}}{\partial t} \, \mathrm{d} t.~
\]
左侧括号中的项即为之前定义的哈密顿量 \( \mathcal{H} = \sum p_i \dot{q}^i - \mathcal{L} \)，因此：
\[
\mathrm{d} \mathcal{H} = \sum_{i} \left( -\frac{\partial \mathcal{L}}{\partial q^i} \, \mathrm{d} q^i + \dot{q}^i \, \mathrm{d} p_i \right) - \frac{\partial \mathcal{L}}{\partial t} \, \mathrm{d} t.~
\]
也可以计算哈密顿量 \( \mathcal{H} \) 相对于坐标 \( q^i \)、\( p_i \)、\( t \) 的全微分，而不是相对于 \( q^i \)、\( \dot{q}^i \)、\( t \)，得到：
\[
\mathrm{d} \mathcal{H} = \sum_{i} \left( \frac{\partial \mathcal{H}}{\partial q^i} \, \mathrm{d} q^i + \frac{\partial \mathcal{H}}{\partial p_i} \, \mathrm{d} p_i \right) + \frac{\partial \mathcal{H}}{\partial t} \, \mathrm{d} t.~
\]
现在，可以将 \( \mathrm{d}\mathcal{H} \) 的两个表达式等式化，一个关于 \( \mathcal{L} \)，另一个关于 \( \mathcal{H} \)：
\[
\sum_{i} \left( -\frac{\partial \mathcal{L}}{\partial q^i} \, \mathrm{d} q^i + \dot{q}^i \, \mathrm{d} p_i \right) - \frac{\partial \mathcal{L}}{\partial t} \, \mathrm{d} t = \sum_{i} \left( \frac{\partial \mathcal{H}}{\partial q^i} \, \mathrm{d} q^i + \frac{\partial \mathcal{H}}{\partial p_i} \, \mathrm{d} p_i \right) + \frac{\partial \mathcal{H}}{\partial t} \, \mathrm{d} t.~
\]
由于这些计算是在“非壳”情况下完成的，可以将等式两边的 \( \mathrm{d} q^i \)、\( \mathrm{d} p_i \)、\( \mathrm{d} t \) 的系数分别相等，得到：
\[
\frac{\partial \mathcal{H}}{\partial q^i} = -\frac{\partial \mathcal{L}}{\partial q^i}, \quad \frac{\partial \mathcal{H}}{\partial p_i} = \dot{q}^i, \quad \frac{\partial \mathcal{H}}{\partial t} = -\frac{\partial \mathcal{L}}{\partial t}.~
\]
在“壳”上，替换参数化函数 \( q^i = q^i(t) \) 来定义相空间中的轨迹，其速度为 \( \dot{q}^i = \frac{d}{dt} q^i(t) \)，满足拉格朗日方程：
\[
\frac{d}{dt} \frac{\partial \mathcal{L}}{\partial \dot{q}^i} - \frac{\partial \mathcal{L}}{\partial q^i} = 0.~
\]
重新排列并用“壳”上的 \( p_i = p_i(t) \) 表示得到：
\[
\frac{\partial \mathcal{L}}{\partial q^i} = \dot{p}_i.~
\]
因此，拉格朗日方程等价于哈密顿方程：
\[
\frac{\partial \mathcal{H}}{\partial q^i} = -\dot{p}_i, \quad \frac{\partial \mathcal{H}}{\partial p_i} = \dot{q}^i, \quad \frac{\partial \mathcal{H}}{\partial t} = -\frac{\partial \mathcal{L}}{\partial t}.~
\]
在哈密顿量 \( \mathcal{H} \) 和拉格朗日量 \( \mathcal{L} \) 都不依赖于时间的情况下，即\(\frac{\partial \mathcal{H}}{\partial t} = -\frac{\partial \mathcal{L}}{\partial t} = 0\),哈密顿方程组成了 \( 2n \) 个一阶微分方程，而拉格朗日方程是 \( n \) 个二阶方程。尽管哈密顿方程通常不会减少求显式解的难度，但它们可以用于推导出重要的理论结果，因为坐标和动量是独立变量，具有近乎对称的作用。

哈密顿方程相比于拉格朗日方程有另一个优势：如果一个系统具有对称性，使得某个坐标 \( q_i \) 不出现在哈密顿量中（即这是一个循环坐标），那么对应的动量坐标 \( p_i \) 沿每条轨迹保持守恒，并且在该方程组的其他方程中可以将该坐标简化为常数。这有效地将问题从 \( n \) 个坐标减少到 \( n - 1 \) 个坐标：这是几何学中辛约简的基础。在拉格朗日框架中，动量守恒同样可以立即得出，但所有的广义速度 \( \dot{q}_i \) 仍然出现在拉格朗日量中，因此仍需在 \( n \) 个坐标中求解一个方程组。

拉格朗日和哈密顿的方法为经典力学中的更深层次结果奠定了基础，并暗示了量子力学中的类似表述：即路径积分表述和薛定谔方程。
\subsubsection{哈密顿量 \( \mathcal{H} \) 的性质如下：}
\begin{itemize}
\item 当且仅当能量函数 \( E_{\mathcal{L}} \) 具有相同性质时，哈密顿量 \( \mathcal{H} \) 的值等于系统的总能量。（参见 \( \mathcal{H} \) 的定义。）
\item \[\frac{d\mathcal{H}}{dt} = \frac{\partial \mathcal{H}}{\partial t}~\]当 \( \mathbf{p}(t) \) 和 \( \mathbf{q}(t) \) 形成哈密顿方程的解时成立。实际上，\[\frac{d\mathcal{H}}{dt} = \frac{\partial \mathcal{H}}{\partial \mathbf{p}} \cdot \dot{\mathbf{p}} + \frac{\partial \mathcal{H}}{\partial \mathbf{q}} \cdot \dot{\mathbf{q}} + \frac{\partial \mathcal{H}}{\partial t}~,\]其中除最后一项外，其余项均相互抵消。
\item \( \mathcal{H} \) 在点变换下保持不变，即平滑的坐标变化 \( \mathbf{q} \leftrightarrow \mathbf{q'} \) 不改变 \( \mathcal{H} \)。（这一点源于能量函数 \( E_{\mathcal{L}} \) 在点变换下的不变性。可以直接验证 \( E_{\mathcal{L}} \) 的不变性。）
\item \[\frac{\partial \mathcal{H}}{\partial t} = -\frac{\partial \mathcal{L}}{\partial t}.~\]（见“推导哈密顿方程”部分。）
\item \[-\frac{\partial \mathcal{H}}{\partial q^{i}} = \dot{p}_{i} = \frac{\partial \mathcal{L}}{\partial q^{i}}.~\]（比较哈密顿方程和欧拉-拉格朗日方程，或参见“推导哈密顿方程”部分。）
\item \[\frac{\partial \mathcal{H}}{\partial q^{i}} = 0~\]当且仅当\[\frac{\partial \mathcal{L}}{\partial q^{i}} = 0~\]。

满足最后一个方程的坐标称为循环坐标（或可忽略坐标）。每个循环坐标 \( q^{i} \) 都会将自由度数量减少 1，使得相应的动量 \( p_{i} \) 得到守恒，并使得哈密顿方程的求解更为简便。
\end{itemize}
\subsection{哈密顿量作为系统的总能量：}

在应用于特定系统时，哈密顿量通常取为
\[
\mathcal{H} = T + V~
\]
其中 \( T \) 是动能，\( V \) 是势能。直接使用此关系有时比先计算拉格朗日量再从中导出哈密顿量更简单。然而，这一关系并不适用于所有系统。

对于非相对论系统，当下列条件都满足时，这一关系成立【5】【6】：
\[
\frac{\partial V(\mathbf{q}, \mathbf{\dot{q}}, t)}{\partial \dot{q}_i} = 0,\quad \forall i~
\]
\[
\frac{\partial T(\mathbf{q}, \mathbf{\dot{q}}, t)}{\partial t} = 0~
\]
\[
T(\mathbf{q}, \mathbf{\dot{q}}) = \sum_{i=1}^{n}\sum_{j=1}^{n} \left( c_{ij}(\mathbf{q}) \dot{q}_i \dot{q}_j \right)~
\]
其中 \( t \) 是时间，\( n \) 是系统的自由度数量，每个 \( c_{ij}(\mathbf{q}) \) 是 \( \mathbf{q} \) 的任意标量函数。

通俗地说，这意味着关系 \( \mathcal{H} = T + V \) 成立的条件是：动能 \( T \) 不显含时间（即它是定态的），势能 \( V \) 不显含广义速度，并且动能 \( T \) 的每一项在广义速度中都是二次项。
\subsubsection{证明}
在进行本证明之前，有必要先解决相关数学符号中的一个歧义。虽然可以通过变量变换将 
\[
\mathcal{L}(\boldsymbol{p}, \boldsymbol{q}, t) = \mathcal{L}(\boldsymbol{q}, \boldsymbol{\dot{q}}, t)~
\]
相等，但需要注意的是
\[
\frac{\partial \mathcal{L}(\boldsymbol{q}, \boldsymbol{\dot{q}}, t)}{\partial \dot{q}_i} \neq \frac{\partial \mathcal{L}(\boldsymbol{p}, \boldsymbol{q}, t)}{\partial \dot{q}_i}~
\]
在这种情况下，右侧总是等于0。若要在偏导数中执行变量变换，应使用多变量链式法则。因此，为避免歧义，应在任何偏导数内的项中标明函数的参数。

另外，此证明中使用了符号 
\[
f(a, b, c) = f(a, b)~
\]
以暗示
\[
\frac{\partial f(a, b, c)}{\partial c} = 0~
\]