% 电磁场中的薛定谔方程及规范变换
% 电磁场|薛定谔方程|哈密顿算符|标势|矢势|广义动量

\pentry{点电荷的拉格朗日和哈密顿量\upref{EMLagP}， 量子化\upref{QMPos}， 原子单位制\upref{AU}}

本文使用原子单位制\upref{AU}。 电动力学中，电磁场中单个粒子的哈密顿量为
\begin{equation}\label{eq_QMEM_1}
H = \frac{1}{2m} (\bvec p - q\bvec A)^2 + q\varphi~.
\end{equation}
其中 $\varphi$ 和 $\bvec A$ 分别是电磁场的标势和矢势\upref{EMPot}，都是位置 $\bvec r$ 和时间的函数。 $\bvec p$ 是 $\bvec r$ 的广义动量\upref{HamCan}，
\begin{equation}\label{eq_QMEM_6}
\bvec p = m \bvec v + q\bvec A~.
\end{equation}
将 ${\bvec p} = -\I\hbar\grad$， 代入得量子化后的哈密顿算符为
\begin{equation}\label{eq_QMEM_2}
\ali{
H &= \frac{\bvec p^2}{2m} - \frac{q}{2m} (\bvec A \vdot \bvec p + \bvec p \vdot \bvec A)
+ \frac{q^2}{2m} \bvec A^2 + q \varphi\\
&= -\frac{1}{2m} \laplacian + \I \frac{q}{2m} (\bvec A \vdot \Nabla + \Nabla \vdot \bvec A) + \frac{q^2}{2m} \bvec A^2 + q\varphi~,
}\end{equation}
注意算符 $\Nabla \vdot \bvec A$ 是指先把波函数乘以矢势再取散度而不是直接对 $\bvec A$ 取散度（想想量子力学中算符相乘的定义）。

另外要注意 $\bvec p = -\I\Nabla$ 代表的是\autoref{eq_QMEM_6} 的\textbf{广义动量}而不是 $m\bvec v$。 所以一般规范下的平面波 $\exp(\I \bvec k \vdot \bvec r)$ 的能量是
\begin{equation}
E = \frac{(\bvec k - q\bvec A)^2}{2m}~.
\end{equation}
在长度规范\upref{LenGau}下， $\bvec A \equiv \bvec 0$， 这时才有常见的 $E = \bvec k^2/(2m)$。

如果对电磁场进行规范变换（\autoref{eq_Gauge_3}~\upref{Gauge}）
\begin{equation}\label{eq_QMEM_5}
\bvec A = \bvec A' + \grad \chi~,
\qquad
\varphi = \varphi' - \pdv{\chi}{t}~.
\end{equation}
为了仍然满足含时薛定谔方程， 波函数需要乘以一个相位因子， 但物理观测结果却不会改变
\begin{equation}\label{eq_QMEM_3}
\Psi(\bvec r, t) = \exp(\I q\chi) \Psi'(\bvec r, t)~,
\end{equation}
其中 $\chi$ 是\autoref{eq_Gauge_3}~\upref{Gauge} 中的任意标量函数 $\lambda$。 将以上三式代入含时薛定谔方程并化简后， 等于把 $\bvec A, \varphi, \Psi$ 分别直接加上一撇。 所以对于任意规范， \autoref{eq_QMEM_2} 都保持相同的形式。

常见的规范如库仑规范\upref{CouGau}， 以及偶极子近似\upref{DipApr}下的长度规范\upref{LenGau}和速度规范\upref{LVgaug}。
