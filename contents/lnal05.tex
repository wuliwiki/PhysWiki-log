% 正交矩阵（高等线性代数）
% license Xiao
% type Tutor
\pentry{词条示例\nref{nod_Sample}}{nod_2d2c}
\pentry{二次型\nref{nod_QuaFor}}{nod_1353}
注：本文参考Jie Peter的《代数学基础》

从矩阵论里我们已经学过，欧几里得空间中正交矩阵的定义：$A^T A=E$。并有充要条件为：该矩阵的列（行）向量组为标准正交基。既是充要条件，出于实用角度，我们可以把正交矩阵直接理解为把标准正交基映射到标准正交基的线性变换，并把“定义”理解为“性质”。本文解释为何欧几里得正交矩阵是如此定义的，正交矩阵在其他线性空间的推广，读者也可以用Clifford代数得到相同的定义。
\subsection{欧几里得空间}
正交矩阵是正交线性变换的表示。顾名思义，我们希望一组正交基经由线性变换后依然保持正交的性质。其次，我们希望正交矩阵最好构成一个子群，即若干个正交矩阵相乘后依然是正交矩阵。现在我们来探讨一下为何要求起始基和变换后的基都是“标准正交”的，也即要求basis$\{e_i\}$满足$\boldsymbol{e}_i\boldsymbol{e}_j=\pm\delta_{ij}$。内积对应的二次型为$\delta_{ij}=\mathrm {diag}(1,1,1)$。如果起始的基不标准正交，那么任意两个向量相乘，结果都要乘以相应二次型的系数。比如在二次型$\mathrm {diag}(2,1,3)$下，$(1\,0\,0)^T (1\,0\,0)=2$，这是相当麻烦的。


如果允许正交矩阵映射到非标准正交基上，两个正交矩阵相乘结果可能并不是正交矩阵。比如给定一组标准正交基$(\boldsymbol x,\boldsymbol y,\boldsymbol z)$，以下矩阵$A,B$都能把这组基映射到正交向量组。它们都是正交矩阵，然而$AB$并非正交矩阵。
我们一步一步看。经$A$映射后正交基为$(\boldsymbol x,\boldsymbol{x-y},\boldsymbol z)$，对应的二次型为$\mathrm {diag}(2,2,1)$。由于不是标准正交基，该基下的向量内积都需要乘以相应系数。于是在矩阵$B$的映射下，第二列与第三列的内积结果为$1$，并不正交。如果定义矩阵$C$如下所示，$AC$映射依然是正交线性变换。
\begin{equation}
A=\begin{pmatrix}
  1&  1&  0   \\
  1&  -1&  0  \\
  0& 0 & 1   \\
\end{pmatrix},
B=\begin{pmatrix}
  0&  1&  1   \\
  1&  0&  0  \\
  0& 1 & -1   \\
\end{pmatrix},
C=\begin{pmatrix}
  0&  1&  1   \\
  1&  0&  0  \\
  0& 1 & -2   \\
\end{pmatrix}~,
\end{equation}

也就是说，如果正交矩阵不能映射到标准正交基上，每一个矩阵的映射结果都可能对应不同的二次型。要判定数个矩阵映射的结果是否是正交线性变换，我们需要算出每一步映射后的二次型，一步步判断。这显然十分低效。如果我们规定正交矩阵是从“标准正交基”映射到“标准正交基”，相当于所有变换结果都对应同一个二次型。那么任意矩阵相乘，结果自然还是正交矩阵，所有正交矩阵构成一个子群。
在该定义下，欧几里得正交矩阵每一列自乘为$1$，不同列相乘为$0$。于是在该空间下，对于任意正交矩阵$M^i_j$我们有：
\begin{equation}
M^i_pM^j_k\delta_{ij}=\delta_{pk}~,
\end{equation}
把二次型写成矩阵形式，我们有$M^p_iM^j_k\delta^i_j=M^T M=\delta^p_k=E$

于是正交矩阵$M$必有$M^T=M^{-1}$。
\subsection{其他空间}
参考上述定义，对于任意空间，正交矩阵要构成一个群，必然要求用“标准”对正交矩阵作出规范定义。为了方便，可以采取如下定义。
\begin{definition}{}\label{def_lnal05_1}
任取$\mathbb R^{s,t,u}$上的一组标准正交基$\{\boldsymbol{e}_i\}$，使得前$s$个基向量的平方为$1$，后$t$个基向量平方为$-1$，最后$u$个基向量平方为$0$。如果过渡矩阵$P$将这组基变为一组标准正交基${\boldsymbol{\theta}_i}$，且$\boldsymbol{e}_i\cdot \boldsymbol{e}_i=\boldsymbol{\theta}_i\cdot\boldsymbol{\theta}_i$对所有$i$成立，那么称$P$是$\mathbb R^{s,t,u}$上的正交矩阵。

特别地，$\mathbb R^{s,0,0}$和$\mathbb R^{0,t,0}$上的正交矩阵称为欧几里得正交矩阵。$\mathbb R^{1,n,0}$和$\mathbb R^{n,1,0}$上的正交矩阵称为洛伦兹正交矩阵。
\end{definition}
因此，对于任意二次型$Q$下的正交矩阵$M$，我们有
\begin{equation}
M^TQM=Q~,
\end{equation}
其中$Q$矩阵如下：
\begin{equation}\label{eq_lnal05_1}
Q=\mathrm{diag}(\overbrace{1,1,1...}^{\text{s个}}\overbrace{-1,-1,-1...}^{\text{t个}}\overbrace{0,0,0...}^{\text{u个}})~,
\end{equation}

我们可以用该式验证定义的合理性。设$A,B$满足该式，那么$AB$也满足该式，因而正交矩阵构成群。需要注意的是，如果\autoref{eq_lnal05_1} 要作为正交矩阵的等价定义，还需要满足该矩阵是满秩的，即保证正交变换是双射，把线性无关组映射为线性无关组。
\begin{exercise}{}
如果正交矩阵只满足保二次型不变，即\autoref{eq_lnal05_1} ，试举出把标准正交基映射为线性相关组的反例。

提示：利用$\bvec 0$向量和任意向量线性相关，在配备了退化二次型的线性空间里提出反例。
\end{exercise}