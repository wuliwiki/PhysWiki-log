% 四元数
% keys 复数|矢量|虚部|矢部|矢部|共轭|四元数|交换律|分配律|结合律
% license Xiao
% type Tutor

\pentry{复数\nref{nod_CplxNo}， 矢量叉乘\nref{nod_Cross}， 域\nref{nod_field}}{nod_b52e}

%未完成： 在“域”的文章出现时需要在预备知识里补充相关链接
%基本完成
\subsection{四元数的历史}

复数可以定义为具有特定乘法有序实数对，也可以看成是在实数域上添加一个新的元素 $\I$ 所得到的扩域。

复数应用极为广泛，因为它具有非常良好的代数性质和分析性质，同时可以用来表示二维矢量空间，极大地方便了许多几何运算。John Derbyshire在他的科普作品Unknown Quantity: Real and Imaginary History of Algebra中写道，“如果从一维的实数到二维的复数的变更会给我们带来这样巨大的力量和见识，那么为什么要止步呢？难道就没有正等待着被发现的其他种类的数，比如说超复数，它们本身就是三维的吗？还有，难道那些数就不能让我们进一步认识数学吗？”

19世纪初的爱尔兰数学家William Hamilton就曾试图寻找一种具有特定乘法的三元数组，期望能和三维空间的坐标一一对应。然而他努力多年却未能找到可以满足结合律、分配律等的三元数乘法。事实上，这样的三元数乘法是不存在的，但Hamilton当时不知道。

1843年10月16日，Hamilton在和妻子一同前往爱尔兰皇家学会议会的路上，突然灵光一现，意识到了问题的本质。他“很不理智”地拿出刀来，在布鲁姆桥的一块石头上刻下了以下公式：
\begin{equation}
\I^2=\mathrm{j}^2=\mathrm{k}^2=\I\mathrm{j}\mathrm{k}=-1~.
\end{equation}
这一公式包含了一个四元数的良好的乘法定义。

\subsection{四元数的定义和基本运算}

现代四元数的定义是把每一个四元数看成一个实数和一个三维实矢量的组合：$(a_0, \bvec{a})$。在这个语境下，$\I$，$\mathrm{j}$，$\mathrm{k}$ 被看成是一个标准正交基中的矢量，为了避免将来的混淆，把这三个基矢量重新表示成 $1, \uvec i, \uvec j$ 和 $\uvec k$ 后，四元数的运算可以定义如下：

\begin{definition}{四元数的加法和乘法}\label{def_Quat_1}
记四元数集合为 $\mathbb{H}=\{(a_0, \bvec{a})|a_0\in\mathbb{R}, \bvec{a}\in\mathbb{R}^3\}$， $\forall(a_0, \bvec{a}), (b_0, \bvec{b})\in\mathbb{H}$， 加法定义为
\begin{equation}
(a_0, \bvec{a})+ (b_0, \bvec{b})=(a_0+b_0,\ \ \bvec{a}+\bvec{b})~.
\end{equation}
乘法定义为（乘号可以省略或者用其他符号）
\begin{equation}\label{eq_Quat_1}
(a_0, \bvec{a})\times (b_0, \bvec{b})=(a_0b_0-\bvec{a}\cdot\bvec{b},\ \ a_0\bvec{b}+b_0\bvec{a}+\bvec{a}\times\bvec{b})~.
\end{equation}
\end{definition}

注意， 虽然四元数的加法显然满足交换律， 但由于一般来说矢量的叉积不可交换， 因此四元数乘法一般不具有交换律。 只有 $\bvec{a}$ 平行于 $\bvec{b}$ （包括其中之一为 $\bvec 0$）的时候， 才会有 $\bvec{a}\times\bvec{b}= \bvec{0} =\bvec{b}\times\bvec{a}$。 四元数的\textbf{乘法满足分配律}（\autoref{exe_Quat_1}）。

四元数 $A=(a_0, \bvec{a})$ 的实数部分 $a_0$ 被称为\textbf{标部}，矢量部分 $\bvec{a}$ 称为\textbf{矢部}。为了方便，有时候也把这个四元数记为 $a_0+\bvec{a}$，类比复数的表示法 $(a, b)=a+b\I$。 当标部为 $0$ 时， 可以直接将四元数记为矢量 $\bvec a$， 同理， 当矢部为零时也可以记为标量 $a_0$。 这样， $a_0 + \bvec a$ 就可以看作两个四元数相加。 和复数同理， 我们认为矢部为 $0$ 的四元数就是实数。

\begin{example}{}
两个标量相乘也可以看作是四元数相乘， 易证
\begin{equation}
ab = (ab, \bvec 0) = (a,\bvec 0)(b,\bvec 0) = (b,\bvec 0)(a,\bvec 0)~.
\end{equation}
类似地， 矢量的数乘（\autoref{sub_GVecOp_1}~\upref{GVecOp}） $\lambda\bvec v$ 也可以认为是四元数相乘， 易证
\begin{equation}
\lambda\bvec v = (0, \lambda\bvec v) = (\lambda, \bvec 0)(0, \bvec v) = (0, \bvec v)(\lambda, \bvec 0)~,
\end{equation}
标量与四元数相乘也类似
\begin{equation}
\lambda (a_0, \bvec a) = (\lambda,\bvec 0) (a_0, \bvec a) = (a_0, \bvec a)(\lambda,\bvec 0) = (\lambda a_0, \lambda\bvec a)~,
\end{equation}
而两个矢量（的四元数）相乘却是以前没有见过的， 要区别于点乘和叉乘
\begin{equation}
\bvec a\bvec b = (0, \bvec a)(0, \bvec b) = (-\bvec a\vdot\bvec b,\ \bvec a\cross\bvec b)~.
\end{equation}
另外若令 $\bvec a$ 的模长为 $a$， 单位矢量 $\uvec a = \bvec a/a$， 使用四元数乘法有
\begin{equation}
\bvec a^{n} = (0, \bvec a)^{n} =
\leftgroup{
&(-1)^{n/2} a^{n} && (n = 0,2,4,\dots)\\
&\ (-1)^{(n-1)/2} a^{n}\uvec a && (n = 1,3,5,\dots)~.
}
\end{equation}
这里 $\bvec a^{n}$ 的记号可能会产生歧义（区分于例如 $\bvec a^2 = \bvec a\vdot\bvec a$）， 但一般不难通过语境判断。 也就是说在四元数乘法下， 矢量的偶数次方是标量， 奇数次方是矢量。
\end{example}

如果我们把四元数的矢部限制在一个方向上，那么得到的运算结构实际上就是复数。你可以通过比较四元数乘法规则和复数乘法规则来看出这一点——注意在限制条件下任何矢部的向量积都是 $\bvec{0}$。

除了把四元数看成一个标量加一个三维矢量以外，我们也可以把四元数看成一个四维矢量， 就像复数既可以看成一个实数配上一个一维矢量， 也可以看成一个二维矢量一样。这种情况下，四元数实际上就是实数域上的一个四维\enref{代数}{AlgFie}\footnote{从代数角度来说，Hamilton爵士当年苦苦思索多年的问题就是“是否存在实数域上的三维代数”，今天我们已经知道，实数域上只存在一维、二维、四维和八维的“具有积性的可除代数”，分别对应实数、复数、四元数和八元数，其中四元数已经不具有交换性，而八元数连结合性都丢了。这里的“积性”是指 $\abs{a}\abs{b}=\abs{ab}$，而“可除性”就是“乘法单位元存在性”。}。

两个复数相乘， 就是把它们的模长相乘， 辐角相加（\autoref{eq_CplxNo_10}~\upref{CplxNo}）， 类似地两个四元数相乘的模长也等于各自的模长相乘（证明留做习题）
\begin{equation}
\abs{AB} = \abs{A}\abs{B}~,
\end{equation}
与复数类似， 任何四元数都可以表示为模长乘以一个模长等于 $1$ 的四元数： $A = \abs{A} q$。 其中 $q$ 类似于复数的 $\E^{\I\theta}$。 $\E^{\I\theta}$ 可以代表一个角度为 $\theta$ 的平面旋转， 而在 “\enref{四元数与旋转矩阵}{QuatN}” 中会看到， 任意模长为 $1$ 的四元数 $q$ 都可以表示一个唯一的三维旋转。 

\begin{definition}{共轭、模方和模}\label{def_Quat_2}
\begin{itemize}
\item 令四元数为 $A=a_0+\bvec{a}$，记 $\widetilde{A}=a_0-\bvec{a}$，称为 $A$ 的\textbf{共轭（conjugate）}。
\item 记 $||A||=a_0^2+ \abs{\bvec{a}}^2$，称为 $A$ 的\textbf{模方}。
\item 记 $|A|=\sqrt{||A||}$，称为 $A$ 的\textbf{模}。
\end{itemize}
\end{definition}

\begin{exercise}{}\label{exe_Quat_1}
\begin{itemize}
\item 证明四元数满足乘法分配律
\item 证明四元数满足乘法结合律
\item 证明 $||A||=||\widetilde{A}||=\widetilde{A}A=A\widetilde{A}$ （类比复数）
\item 证明 $\abs{AB} = \abs{A}\abs{B}$， 即 $\norm{AB} = \norm{A}\norm{B}$ （类比复数）
\item 若将单位矢量 $\uvec e$ 看作四元数（标部为零）， 证明 $\uvec{e}^2=-1,\ \uvec{e}^3=-\uvec{e}$
\end{itemize}
\end{exercise}

\subsubsection{逆}
和复数类似， 定义非零四元数 $A$ 的逆 $A^{-1}$ 满足
\begin{equation}\label{eq_Quat_3}
AA^{-1} = A^{-1}A = 1 \qquad (A \ne 0)~.
\end{equation}
易得每个非零四元数都有唯一的逆
\begin{equation}
A^{-1} = \frac{\tilde A}{\abs{A}^2} \qquad (A \ne 0)~.
\end{equation}
代入\autoref{eq_Quat_3} 即可证明。 证明\textbf{逆元的唯一性}： 假设 $B_1, B_2$ 都是 $A$ 的逆元， 那么 $AB_1 = AB_2$， 等式两边左乘 $B_1$， 得 $B_1 = B_2$。 证毕。

另外易证
\begin{equation}
(AB)^{-1} = B^{-1}A^{-1}~.
\end{equation}

由于四元数的乘法不可交换， 我们不定义除法， 因为除法可能有两种不同的定义 $AB^{-1}$ 和 $B^{-1}A$。 我们直接使用这两种符号即可。

根据以上讨论不难发现， 所有的非零四元数及其乘法运算构成一个\textbf{体}（\autoref{def_field_1}~\upref{field}）。

\subsubsection{四元数乘法的矩阵表示}
四元数乘法 $(a_0,\bvec a)(a_0,\bvec b) = (a_0,a_1,a_2,a_3)(b_0,b_1,b_2,b_3)$ 可以看作是一个线性变换， 用矩阵乘法表示为
\begin{equation}
\begin{aligned}
(a_0,\bvec a)(a_0,\bvec b) &= \pmat{
a_0 & -a_1 & -a_2 & -a_3\\
a_1 & a_0 & -a_3 & a_2\\
a_2 & a_3 & a_0 & -a_1\\
a_3 & -a_2 & a_1 & a_0
}\pmat{
b_0\\b_1\\b_2\\b_3}\\
&= \qty[\pmat{a_0& a_1 & a_2& a_3}\pmat{
b_0 & -b_1 & -b_2 & -b_3\\
b_1 & b_0 & -b_3 & b_2\\
b_2 & b_3 & b_0 & -b_1\\
b_3 & -b_2 & b_1 & b_0
}]\Tr~,
\end{aligned}
\end{equation}

\subsection{四元数的指数表示}

记 $\E$ 是自然对数的底数，那么对于任意实数 $x$，有 $\E^x = \sum^\infty\limits_{n=0} x^n / n!$。如果把实数 $x$ 替换为其它能够进行乘方的对象，比如说矩阵、复数等，那么还可以把指数的概念拓展到更多的对象上，构造出复数的指数、矩阵的指数等。

\begin{definition}{四元数的指数表示}

令四元数为 $A=a_0+\bvec{a}$，则使用四元数的乘法（\autoref{eq_Quat_1}），定义（类比复数的\enref{指数函数定义}{CExp}）
\begin{equation}\label{eq_Quat_2}
\E^A = \sum^\infty\limits_{n=0}\frac{A^n}{n!}~,
\end{equation}
\end{definition}
可以证明（留做习题）
\begin{equation}
\E^A = \E^{a_0}\E^{\bvec{a}}=\E^{a_0}\sum^\infty\limits_{n=0}\frac{\bvec{a}^n}{n!}=\E^{a_0}(\cos{a}+ \uvec{a}\sin a)~.
\end{equation}
其中 $\uvec{a}$ 是和 $\bvec{a}$ 同方向的单位矢量，$a$ 是 $\bvec{a}$ 作为四元数的模或者作为三维实矢量的模。

\begin{exercise}{与复数的类比}
比较复数和四元数的指数表示，说明为什么可以将复数看成矢部限制在一个方向上的四元数。
\end{exercise}

由于四元数的加法满足交换律，而乘法一般不满足，因此一般情况下四元数并不满足 $\E^{A+B} = \E^A \E^B$。因此，四元数的指数表示法在计算中其实用得不多。 \autoref{eq_Quat_2} 中的第一个等号成立是因为 $a_0\bvec a = \bvec a a_0$ 满足交换律。

\subsection{四元数的拓展}

我们以上定义的四元数，可以看成四个基矢量 $1$， $\uvec i$， $\uvec j$ 和 $\uvec k$ 的线性组合的集合， 而这些线性组合的系数取自实数域 $\mathbb R$。 如果系数还可以取自复数域 $\mathbb C$， 定义出来的数被称为\textbf{双四元数}， 或\textbf{复四元数}。一个双四元数可以看成一个复数和一个复数域上的三维矢量的组合。

对于一个双四元数 $A=a_0+a_1 \uvec i+a_2\uvec j+a_3\uvec k$，共轭的概念就被细分了：

\begin{definition}{双四元数的共轭}
\begin{itemize}
\item 四元共轭：$\widetilde{A}=a_0-a_1\uvec i-a_2\uvec j-a_3\uvec k$
\item 反共轭：$A^C=a_0\Cj + a_1\Cj\uvec i+a_2\Cj\uvec j+a_3\Cj\uvec k$
\item 转置：$A^T=a_0+a_1\uvec i-a_2\uvec j+a_3\uvec k$
\item 复共轭：$A\Cj=a_0\Cj-a_1\Cj\uvec i+a_2\Cj\uvec j-a_3\Cj\uvec k$
\item 厄密（hermitian）共轭：$A^\dagger=a_0\Cj-a_1\Cj\uvec i-a_2\Cj\uvec j-a_3\Cj\uvec k$
\end{itemize}
\end{definition}

双四元数的模方是用四元共轭定义的：$||A||=A\widetilde{A}=\widetilde{A}A=\sum^{3}_{n=0}a^2_n$。但是和四元数不同的是，双四元数的模方并不总是非负实数，而是有可能取任何复数。

\begin{exercise}{双四元数共轭模方的关系}

证明：$||A||=||\widetilde{A}||=||A^T||=||A^C||^*=||A^*||^*=||A^\dagger||^*$。

\end{exercise}

\begin{exercise}{双四元数共轭的乘法规律}
设 $A$ 和 $B$ 是两个双四元数，证明：
\begin{equation}
\leftgroup{
&A^CB^C=(AB)^C\\
&A^*B^*=(AB)^*\\
&\widetilde{A}\widetilde{B}=\widetilde{BA}\\
&A^TB^T=(BA)^T\\
&A^\dagger B^\dagger=(BA)^\dagger~.
}
\end{equation}

\end{exercise}

和普通四元数不同的是，双四元数中有可能存在非零但模为0的数，比如下面\autoref{ex_Quat_1} 所举例的 $u$ 和 $v$。

类似地，让四元数的系数取值为四元数，所得到的数被称为\textbf{二级四元数}。一般地，让四元数的系数取值为 $n$\textbf{级四元数}，则能得到 $n+1$\textbf{级四元数}。但是由于四元数不再是一个域，也没有交换律，用其做系数的效果远远不如复数系数，应用范围相对有限，在此不作详细介绍。


\subsection{四元数的矩阵表示}

如果将四元数的四个基 $1, \uvec i, \uvec j$ 和 $\uvec k$ 分别对应到以下四个矩阵

\begin{equation}
1=\begin{pmatrix}1&0\\0&1\end{pmatrix} ~,
\qquad
\uvec i=\begin{pmatrix}\I&0\\0&-\I\end{pmatrix}~,
\qquad
\uvec j=\begin{pmatrix}0&1\\-1&0\end{pmatrix}~,
\qquad
\uvec k=\begin{pmatrix}0&\I\\\I&0\end{pmatrix} ~.
\end{equation}
那么一个任意的四元数或双四元数 $A=a_0+\bvec{a}$ 可以用矩阵表示为
\begin{equation}
\begin{pmatrix}a_0+\I a_1&a_2+\I a_3\\-a_2+\I a_3&a_0-\I a_1 \end{pmatrix} ~.
\end{equation}

\begin{example}{矩阵表示的例子}\label{ex_Quat_1}
\begin{equation}
1+\begin{pmatrix}1\\0\\\I\end{pmatrix} =1+1\uvec i+\I\uvec k =\begin{pmatrix}1+\I&-1\\-1&1-\I\end{pmatrix} ~,
\end{equation}
\begin{equation}
u=\frac{1}{2}(1-\I\uvec i)=\begin{pmatrix}1&0\\0&0\end{pmatrix} ~,
\end{equation}
\begin{equation}
v=-\frac{1}{2}(\uvec j+\I\uvec k)=\begin{pmatrix}0&0\\1&0\end{pmatrix} ~.
\end{equation}
\end{example}

容易验证，四元数的加法和乘法运算，与把基分别换成这四个矩阵以后的矩阵加法和乘法运算是同构的。

在矩阵表示中，$A$ 的转置共轭就是矩阵 $A$ 的转置，复共轭就是 $A$ 的各矩阵元取复共轭，厄密共轭就是 $A$ 的厄密共轭矩阵（矩阵转置后再取各矩阵元的复共轭），而四元数的模方就是其矩阵表示的行列式：$||A||=\opn{det}A$。因此，模方不为零的（双）四元数对应的矩阵是可逆的，其逆矩阵所表示的就是该四元数的逆。
