% 映射
% 单射|满射|函数|一一对应|定义域|值域|逆映射

\pentry{集合\upref{Set}}

\begin{definition}{映射}
给定集合 $A$ 和 $B$，我们可以假想从 $A$ 中\textbf{每一个}元素上拉\textbf{一根}有方向的线连接到 $B$ 中的一个元素，这些线的连接方式就被称为一个从 $A$ 到 $B$ 的\textbf{映射（mapping）}， 也叫\textbf{算符（operator）}．将这个映射记为 $f$， $A$ 叫做 $f$ 的\textbf{定义域（domain）}， $B$ 叫做\textbf{到达域（codomain）}\footnote{也叫陪域、上域、目标集（target set）}， $B$ 中被线连接到的元素的集合叫做 $f$ 的\textbf{值域（range）}\footnote{值域在一些文献中指的是到达域．}或\textbf{像（image）}， 记为 $f(A)$．
\end{definition}

我们一般将 “$f$ 是从 $A$ 到 $B$ 的映射” 记为
\begin{equation}
f:A\to B
\end{equation}
也就是说从 $A$ 的元素上拉线到 $B$ 的元素上． 有时候， 为了表示映射的定义域 $A$ 或到达域 $B$ 是另一个集合的 $S$ 的子集， 我们也会将映射记为
\begin{equation}
f: A\subseteq S \to B \quad\text{或}\quad f: A \to B \subseteq S
\end{equation}
注意映射是有方向区分的， $A$ 中每个元素都\textbf{有且只有}一根线拉出去， 但是 $B$ 中的元素可以同时被一根或多根线连接， 也可以没有连接（即不在值域中）． 换一种简单的说法， “一对一” 和 “多对一” 连线是允许的， 但 “一对多” 是不允许的．

\begin{example}{}
映射的典型例子是一元实函数 $y = f(x)$， 其中定义域和值域都是实数集 $R$ 的某个子集．
\end{example}

\subsection{映射的类型}
\begin{definition}{}\label{map_def1}
如果映射 $f:A \to B$ 中每个 $B$ 中元素只被 1 根或者 0 根线连接， 那么称 $f$ 是一个\textbf{单射（injection）}． 如果 $f:A\to B$ 中每个 $B$ 中元素都被至少1根线连接， 那么称 $f$ 是一个\textbf{满射（surjection）}． 如果 $f$ 既是单射又是满射，那么称它为一个\textbf{双射（bijection）}， 或者叫\textbf{一一对应（one-to-one correspondence）}．
\end{definition}

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/map_1.pdf}
\caption{映射的分类} \label{map_fig1}
\end{figure}

如果 $f:A\to B$ 是一个双射，那么 $A$ 中每一个元素都唯一地连接到 $B$ 中某一个元素，并且 $B$ 中每一个元素也都唯一被 $A$ 中某一个元素所连接，因此很明显可以将这个过程反过来，从 $B$ 中向 $A$ 中拉连接线．另外，如果 $A$ 和 $B$ 存在双射，意味着 $A$ 和 $B$ 的元素数量应该一致\footnote{本书中统一使用这种定义． 一些其他教材中也把我们的 “单射” 称为 “一一映射”， 把 “满射” 称为 “到上”， 把 “双射” 称为 “一一到上”， 需要特别小心．}．

函数是一种常见的映射， 例如 $f(x) = 2x$ 可以看作映射 $f: \mathbb R \to \mathbb R$． 但是映射可以从任意集合到任意集合． 例如将整数映射到正多边形， 将函数的映射到函数或实数（一般把这种映射称为\textbf{算符}）等．

注意当一个集合中有无限个元素时， 我们有可能在它的子集和它本身之间建立一一映射， 例如函数 $\tan(x)$ 可以从实轴的开区间 $(-\pi/2, \pi/2)$ 一一映射到整个实轴 $\mathbb R$， 又例如我们可以将全体整数 $\mathbb Z$ 乘以二后一一映射到全体偶数 $2\mathbb Z$ 上． 这时我们仍然认为这两个集合的元素一样多， 虽然直觉上可能不容易接受．

\textbf{Cantor-Bernstein 定理}显示，如果集合 $A$ 到集合 $B$ 上存在一个单射 $f$ 和一个满射 $g$，那么总可以利用 $f$ 和 $g$ 来构造出一个双射．

\subsection{多元运算}\label{map_sub1}
有时候我们需要将两个集合 $A, B$ 中任意各取一个元素， 然后映射另一个集合 $C$ 中的元素， 称为\textbf{二元运算（binary operation）}． 我们可以使用笛卡尔积（\autoref{Set_eq1}~\upref{Set}）将这个映射表示为
\begin{equation}\label{map_eq1}
A \times B \to C
\end{equation}
一个简单的例子就是两个实数的的加法减法或乘法可以表示为 $\mathbb R \times \mathbb R \to \mathbb R$ （或简记为 $\mathbb R^2 \to \mathbb R$）， 但除法不可以， 因为除数的集合不是 $\mathbb R$ 而是 $\mathbb R$ 去掉 $0$．

同理， \textbf{多元运算}可以用多个卡氏积表示为
\begin{equation}
A_1 \times \dots \times A_N \to C
\end{equation}
例如含有 $N$ 个自变量的函数就是一个 $N$ 元运算． 特殊地， $N$ 个相同集合 $A$ 做卡氏积可以简单表示为 $A^N$， 例如 $N$ 个有序复数的集合为 $\mathbb C^N$．

\subsection{相等和拓展}
\begin{definition}{}
当映射（算符） $f:A\to B$ 和 $g:C\to D$ 的定义域相等（$A = C$）且对任意 $x\in A$ 都有 $fx = gx$， 那么我们就说两个映射（算符）\textbf{相等}， 记为 $f = g$， 否则它们就\textbf{不相等}．
\end{definition}
注意定义中的 $B, D$ 不需要相等．
\begin{definition}{}\label{map_def3}
若 $A$ 是 $C$ 的子集（$A\subseteq C$）， 我们就说 $g$ 是 $f$ 的\textbf{拓展（extension）}， 记为 $f \subseteq g$． 特殊地， 当 $A$ 是 $C$ 的真子集（$A\subset C$）， 就记为 $f \subset g$．

同时也称 $f$ 是 $g$ 在 $A$ 上的\textbf{限制（restriction）}．
\end{definition}

\subsection{恒等映射}
\begin{definition}{}
若一个集合到它自身的映射 $f:X\to X$ 把任意 $x\in X$ 映射到 $x$ 本身， 我们就叫它\textbf{恒等映射（identity map）}或者\textbf{单位算符（unit operator）}， 通常用 $I$ 或 $E$ 表示．
\end{definition}
注意对不同集合 $X$， 它们的单位算符定义域并不相等， 所以它们的单位算符也不相等．

\subsection{复合映射}\label{map_sub2}
\begin{definition}{}\label{map_def4}
给定两个映射 $f:A\to B$ 和 $g:C\to D$， 如果 $f$ 的值域 $R$ 是 $g$ 的定义域 $C$ 的一个子集， 则可以定义\textbf{复合映射（composition of maps）} $g\circ f: A\to D$， 即先将 $A$ 中的元素通过 $f$ 映射到 $R \subseteq C$， 再通过 $g$ 映射到 $D$ 的元素．
\end{definition}
在没有歧义的情况下也可以将 “$\circ$” 省略， 尤其是将映射称为\textbf{算符}时．

复合映射常见的例子是复合函数， 令 $\mathbb R$ 上的函数 $f(x) = \sin x$， $g(x) = x^2$， 则复合函数 $g\circ f: \mathbb R \to [0, 1]$ 为 $(g\circ f)(x) = g(f(x)) = \sin^2 x$．

根据定义， 复合映射满足\textbf{结合律}， 令 $f, g, h$ 为映射， 则
\begin{equation}
h \circ (g \circ f) = (h \circ g) \circ f
\end{equation}

\subsection{映射的乘积}

\begin{definition}{}\label{map_def2}
给定两个映射 $f:A\to B$ 和 $g:C\to D$，则可以定义两个映射的\textbf{乘积（product）}为 $f\times g:A\times C\to B\times D$，其中对于任意 $a\in A, b\in B$ 有 $f\times g(a, b)=(f(a), g(b))$．
\end{definition}

\subsection{逆映射}
若已知一个映射 $f: A\to B$， 如何构造一个逆映射？ 注意我们要求\textbf{逆映射必须是一个映射}． 我们可以先试着把所有定义域和值域互换， 然后把所有 “连线” 的方向逆转． 但一般情况下， 我们不能保证这样得到的关系符合映射的定义： 例如若 $f$ 是多对一映射， 那么方向逆转后， 就会出现 “一对多” 的情况， 而这是不允许的． 又例如 $B$ 中有些元素没被 $f$ 射到， 那么 $B$ 就不能作为逆映射的定义域， 因为定义域要求每个元素都要射出一条线． 加上最少的限制以后， 可以定义逆映射如下：

\begin{definition}{逆映射}
如果 $f: A\subseteq A' \to B$ 是单射， $A'$ 是 $A$ 的任意父集， 令 $R \subseteq B$ 为映射的值域， 那么可以把它的逆映射记为 $f^{-1}: R \to A'$， 把任意 $y \in R$， 映射到 $x \in A$， 并满足 $f(x) = y$．
\end{definition}
也就是说， 只有单射存在逆映射． 对于非单射， 我们可以先通过限制它的定义域找到一个单射， 再寻找逆映射．

\begin{example}{}
如果取正弦函数 $y = \sin x$ 的值域为 $R = [-1, 1]$ 如果取定义域为 $\mathbb R$，  那么它不是一个单射， 因为每一个 $y \in R$ 都对应无穷个 $x$， 所以不存在反函数． 但如果取定义域为 $[-\pi/2, \pi/2]$， 那么它是一个单射， 存在反三角函数 $\sin^{-1}: [-1, 1] \to [-\pi/2, \pi]$．

根据以上定义， $\sin^{-1} (\sin(x))$ 是定义在 $[-\pi/2, \pi/2]$ 上的恒等函数， 而 $\sin (\sin^{-1}(x))$ 是定义在 $[-1, 1]$ 上的恒等函数， 所以有 $\sin \circ \sin^{-1} \subseteq \sin^{-1} \circ \sin$．
\end{example}

\begin{corollary}{}
若映射 $f:A \to R \subseteq B$ 存在逆映射 $f^{-1}: R \to A$， 那么复合映射 $f^{-1} \circ f: A \to A$ 是恒等映射．
\end{corollary}
根据定义可证．

\addTODO{幂集最好另开词条， 这里只介绍单射的情况， 以及简单介绍一下逆像的概念}

给定集合 $A, B$，定义 $B^A$ 为“从 $A$ 到 $B$ 的所有可能的映射所构成的集合”． 如果 $B$ 是一个二元集合，即它只有两个元素，不妨记为 $B=\{0,1\}$，那么 $B^A$ 可以用来表示 $A$ 的\textbf{幂集}，即由 $A$ 的所有子集所构成的集合．这是因为对于任意的 $f\in B^A$，我们可以把这个 $f$ 对应到 $A$ 的子集 $S$，其中 $S$ 的元素全都被 $f$ 映射到1上， $A-S$ 的元素全都被 $f$ 映射到 0 上．当然， 0 和 1 的地位反过来也可以． 由于这个特点，我们简单地把 $A$ 的幂集记为\footnote{当 $A$， $B$ 都是有限集的时候， $|B^A|=|B|^{|A|}$．特别地， $|2^A|=2^{|A|}$．}  $2^A$. 

利用映射 $f:A\to B$，可以导出一个映射 $f^{-1}:2^B \to 2^A$，称为映射 $f$ 的\textbf{逆（inverse）} ．对于 $B$ 的任意子集 $C$，有
\begin{equation}
f^{-1}(C) = \qty{x | x \in A, f(x) \in C}
\end{equation}
此时，$f^{-1}(C)$ 称为 $C$ 在 $f$ 下的\textbf{逆像（inverse image）}或\textbf{原像（preimage）}．

特别地，和 $f$ 的值域中不相交的 $C$ 被 $f^{-1}$ 映射到空集上，而空集也是 $A$ 的一个子集．如果 $f$ 是一个双射，那么对于任意 $y\in B$，单元素子集 $\{y\}$ 都被 $f^{-1}$ 映射在 $A$ 的某个单元素子集上，那么我们也可以认为此时 $f^{-1}$ 实际上是单个元素映射在单个元素上，也就是从 $B$ 到 $A$ 的映射．

如果 $f:A\to B$ 是\textbf{单射}， 那么 $f^{-1}$ 总是把单点集映射到单点集上，因此这时我们可以定义 $f^{-1}:B\to A$，使得 $\forall x\in A$ 都有 $f^{-1}(f(x))=x$．特别地，此时我们将 $f^{-1}$ 称为 $f$ 的\textbf{逆映射（inverse map）}\footnote{注意“映射的逆”和“逆映射”的区别．映射的\textbf{逆}是子集到子集的映射，而\textbf{逆映射}是点到点的映射．任何映射都有\textbf{逆}，但是只有单射才有\textbf{逆映射}．}．

对于双射 $f:A\to B$， 显然 $f\circ f^{-1}$ 和 $f^{-1}\circ f$ 都是单位算符（恒等映射）．注意两者的定义域分别为 $A$ 和 $B$， 当 $A \ne B$ 时不能写成 $f\circ f^{-1} = f^{-1}\circ f$．如果把 $A$，$B$ 到自身的恒等映射分别记为 $I_A$ 和 $I_B$，那么 $f\circ f^{-1}=I_B$，$f^{-1}\circ f=I_A$．
