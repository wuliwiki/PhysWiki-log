% 刘维尔定理（热力学与统计物理）
% keys 统计力学|刘维尔定理|相空间|流体密度
% license Xiao
% type Tutor

\begin{issues}
\issueDraft
\end{issues}

$(q, p)$ 空间（广义坐标、广义动量）称为相空间， 复杂系统的所有系综看成多维相空间中的流体， 每个具体系统的状态是相空间中的一点， 随时间变化。 跟随一点时， 周围密度不随时间变化。

$t$ 等于零时在相空间中取一块小区域， 具有边界 $\mathcal B$。 可以证明随着时间变化， 虽然边界开始变形， 但边界两边的点不会跨越边界。 也可以证明， 这个区域的体积始终保持不变。

具体的，刘维尔定理（Liouville theorem 或 Liouville's theorem）可以表述为：
\textbf{系综的几率密度 $\rho(q_i, p_i, t)$（等价于 代表点密度/相点密度 $\widetilde \rho(q_i, p_i, t)$）在运动中保持不变，即}
\begin{equation}\label{eq_LiouTh_1}
\dv{\rho}{t} = \dv{\widetilde{\rho}}{t} = 0 ~.
\end{equation}

这里的\textbf{系综}可以理解为是性质、结构与所研究系统完全相同，但互相独立、各自处于某微观状态的大量假想系统的集合。相空间中的相点遵循哈密顿正则方程移动。定理 \autoref{eq_LiouTh_1} 中使用全微分而非偏微分代表观测的密度“随相点一起移动”。

\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/eb26efb136ab5fe8.png}
\caption{代表点与研究的代表点密度随时间变化} \label{fig_LiouTh_2}
\end{figure}




刘维尔定理的一个最直接推论是， 如果开始时相空间中这种流体的密度处处相同， 那么接下来在任意时刻 $t$， 流体密度仍然处处相同。

在这样的流体里面随机抽取一个点， 那么这个点几乎肯定处于平衡态。 热力学第二定律就是在这个 “几乎肯定” 上成立的。


















下面考虑证明刘维尔定理：

设自由度为 $s$ 的 $2s$ 维相空间（$q_i$ 有 $s$ 维，$p_i$ 有 $s$ 维）的某处体元 $\dd \Omega = \mathrm{d}^{s}{p_i} \cdot  \mathrm{d}^{s}{q_i}$ 内有一些相点，有相点密度 $\widetilde \rho(q_i, p_i, t)$。考虑这些相点随时间变化 $t \rightarrow t + \dd t$，各自沿由正则运动方程（哈密顿正则方程）规定的轨道各自独立运动（每个相点代表系综中的一个“系统”，系统间互相独立）：
$$
\begin{aligned}
t                            &\rightarrow t+\dd t, \\
q_i(t)                       &\rightarrow q_i(t+\dd t) = q_i + \dot q_i \dd t, \\
p_i(t)                       &\rightarrow p_i(t+\dd t) = p_i + \dot p_i \dd t, \\
\dd \Omega                   &\rightarrow \dd \Omega', \\
\widetilde \rho(q_i, p_i, t) &\rightarrow \widetilde \rho(q_i + \dot q_i \dd t, p_i + \dot p_i \dd t, t + \dd t),
\end{aligned}~~
$$
考虑 $\dd{\widetilde{\rho}} = \widetilde{\rho}(q_i + \dot q_i \dd t, p_i + \dot p_i \dd t, t + \dd t) - \widetilde{\rho}(q_i, p_i, t)$，这就使得有：
\begin{equation}
\dd{\widetilde \rho} = \pdv{\widetilde \rho}{t} \dd t + \sum_{i=1}^{s}\left(\pdv{\widetilde \rho}{q_i}\dot q_i + \pdv{\widetilde \rho}{p_i}\dot p_i\right) \dd t  ~,
\end{equation}
分别考虑这式的两项。