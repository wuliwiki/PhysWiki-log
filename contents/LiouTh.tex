% 刘维尔定理（热力学与统计物理）
% keys 统计力学|刘维尔定理|相空间|流体密度
% license Xiao
% type Tutor

\pentry{相空间\nref{nod_PhSpace}}{nod_9520}

$(q, p)$ 空间（广义坐标、广义动量）称为相空间， 复杂系统的所有系综看成多维相空间中的流体， 每个具体系统的状态是相空间中的一点， 随时间变化。 跟随一点时， 周围密度不随时间变化。

$t$ 等于零时在相空间中取一块小区域， 具有边界 $\mathcal B$。 可以证明随着时间变化， 虽然边界开始变形， 但边界两边的点不会跨越边界。 也可以证明， 这个区域的体积始终保持不变。

具体的，刘维尔定理（Liouville theorem 或 Liouville's theorem）可以表述为：
\textbf{系综的概率密度 $\rho(q_i, p_i, t)$（等价于 代表点密度/相点密度 $\widetilde \rho(q_i, p_i, t)$）在运动中保持不变，即}
\begin{equation}\label{eq_LiouTh_1}
\dv{\rho}{t} = \dv{\widetilde{\rho}}{t} = 0 ~.
\end{equation}

这里的\textbf{系综}可以理解为是性质、结构与所研究系统完全相同，但互相独立、各自处于某微观状态的大量假想系统的集合。相空间中的相点遵循哈密顿正则方程移动。定理 \autoref{eq_LiouTh_1} 中使用全微分而非偏微分代表观测的密度“随相点一起移动”。式中的 $\rho$ 总正比于 $\widetilde \rho$。

\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/eb26efb136ab5fe8.png}
\caption{代表点与研究的代表点密度随时间变化} \label{fig_LiouTh_2}
\end{figure}




刘维尔定理的一个最直接推论是， 如果开始时相空间中这种流体的密度处处相同， 那么接下来在任意时刻 $t$， 流体密度仍然处处相同。

在这样的流体里面随机抽取一个点， 那么这个点几乎肯定处于平衡态。 热力学第二定律就是在这个 “几乎肯定” 上成立的。


















下面考虑刘维尔定理的一个经典证明：

设自由度为 $s$ 的 $2s$ 维相空间（$q_i$、$p_i$ 各有 $s$ 维）的某处体元 $\dd \Omega = \mathrm{d}^{s}{p_i}  \mathrm{d}^{s}{q_i}$ 内有一些相点，有相点密度 $\widetilde \rho(q_i, p_i, t)$。考虑这些相点随时间变化 $t \rightarrow t + \dd t$，各自沿由正则运动方程（哈密顿正则方程）规定的轨道各自独立运动（每个相点代表系综中的一个“系统”，系统间互相独立）：
$$
\begin{aligned}
t                            &\rightarrow t+\dd t, \\
q_i(t)                       &\rightarrow q_i(t+\dd t) = q_i + \dot q_i \dd t, \\
p_i(t)                       &\rightarrow p_i(t+\dd t) = p_i + \dot p_i \dd t, \\
\dd \Omega                   &\rightarrow \dd \Omega', \\
\widetilde \rho(q_i, p_i, t) &\rightarrow \widetilde \rho(q_i + \dot q_i \dd t, p_i + \dot p_i \dd t, t + \dd t),
\end{aligned}~~
$$
考虑 $\dd{\widetilde{\rho}} = \widetilde{\rho}(q_i + \dot q_i \dd t, p_i + \dot p_i \dd t, t + \dd t) - \widetilde{\rho}(q_i, p_i, t)$，这就使得有：
\begin{equation}\label{eq_LiouTh_3}
\dd{\widetilde \rho} = \pdv{\widetilde \rho}{t} \dd t + \sum_{i=1}^{s}\left(\pdv{\widetilde \rho}{q_i}\dot q_i + \pdv{\widetilde \rho}{p_i}\dot p_i\right) \dd t  ~,
\end{equation}
分别考虑这式的两项。

首先看第一项 $\pdv{\widetilde \rho}{t}$，这代表了在固定位置的相点密度的时间变化率，也就是在 $\dd \Omega$ 内的相点的数量在 $\dd t$ 时间内的变化。这是相点沿着各自在相空间内的轨道运动导致的，本身在 $\dd \Omega$ 内的某些相点在 $\dd t$ 时间后运动离开 $\dd \Omega$，而某些不在 $\dd \Omega$ 内的相点在 $\dd t$ 时间后运动到 $\dd \Omega$ 内。故，$\dd t$ 内 $\dd \Omega$ 内相点增加 $\pdv{\widetilde \rho}{t} \dd t \dd \Omega$ 个。

而 $\dd \Omega = \dd{}^s q_i \cdot \dd{}^s p_i$ 是由 $2s$ 对平面围成的：$q_i$ 与 $q_i + \dd q_i$ 共 $s$ 个，$p_i$ 与 $p_i + \dd p_i$ 共 $s$ 个。不失一般性的，考虑其中任意一对（超）平面，不妨考虑 $p_i$ 与 $p_i+\dd p_i$ 。设 $\dd \Omega = \dd p_i \times \dd S$。
\begin{figure}[ht]
\centering
\includegraphics[width=13cm]{./figures/976b76b3a2b36651.png}
\caption{$\dd t$ 时间内通过 $p_i$ 处的 $\dd S$ 平面进入 $\dd \Omega = \dd t \times \dd S$ 区域的示意图} \label{fig_LiouTh_3}
\end{figure}
相点的箭头方向是各相点速度在 $\dot p_i$ 方向上的投影，因为我们只考虑 $p_i$ 方向上的变化。

首先考虑流入 $\dd \Omega$ 区域的点，应当在 $\left(\dot p_i \dd t\right) \times \dd S$ 这个（超）柱体内。“底面积”为 $\dd S$，高 $\dot p_i \dd t$，这区域内有相点 $\widetilde \rho \left(\dot p_i \dd t \dd S \right)$ 个。类似的，流出的点从 $p_i + \dd p_i$ 位置，故流出相点
$$
\left[\widetilde \rho \left(\dot p_i \dd t \dd S\right)\right]_{p_i + \dd p_i} = \left[ \eval{\left(\widetilde\rho \dot p_i\right)}_{p_i} + \eval{\pdv{\left(\widetilde\rho \dot p_i\right)}{p_i}}_{p_i} \dd p_i \right] \dd t \dd S ~~
$$
个。将这式与 $\widetilde \rho \left(\dot p_i \dd t \dd S\right)$ 相减得到净流入 $\dd \Omega$ 区域的相点数为
\begin{equation}
- \pdv{\left(\widetilde \rho p_i\right)}{p_i} \dd t \dd \Omega ~~
\end{equation}
个。而这对于 $q_i$ 是等价的。故共净流入相点
\begin{equation}
\pdv{\widetilde \rho}{t} \dd t \dd \Omega = - \sum_{i} \left(\pdv{\left(\widetilde \rho \dot p_i\right)}{p_i} + \pdv{\left(\widetilde \rho \dot q_i\right)}{q_i}\right) \dd t \dd \Omega ~~
\end{equation}
个。故有
\begin{equation}\label{eq_LiouTh_2}
\pdv{\widetilde \rho}{t} = -\sum_{i} \left(\pdv{\left(\widetilde \rho \dot p_i\right)}{p_i} + \pdv{\left(\widetilde \rho \dot q_i\right)}{q_i}\right) ~.
\end{equation}
将这结果代回\autoref{eq_LiouTh_3}，可以得到
\begin{equation}
\dv{\widetilde \rho}{t} = -\widetilde \rho \sum_{i} \left(\pdv{\dot q_i}{q_i} + \pdv{\dot p_i}{p_i}\right) ~,
\end{equation}
再考虑哈密顿正则运动方程，引入哈密顿量 $H$，就可以得到证明：
\begin{equation}\label{eq_LiouTh_4}
\dv{\widetilde \rho}{t} = -\widetilde \rho \sum_{i} \left(\pdv{}{q_i} \pdv{H}{p_i} - \pdv{}{p_i} \pdv{H}{q_i}\right) = 0 ~.
\end{equation}

\begin{corollary}{泊松括号表达下的刘维尔定理}
若引入泊松括号还可以将\autoref{eq_LiouTh_4} 改写为：
\begin{equation}
\pdv{\widetilde \rho}{t} + \{\widetilde \rho, H\} = \pdv{\rho}{t} + \{\rho , H\} = 0 ~,
\end{equation}
这正是刘维尔定理的另一表达形式。这使得我们可以发现，刘维尔定理的成立条件是系统为保守系（哈密顿量 $H$ 不显含时），并且系统在我们研究的时间内不受外界作用。

可以发现，刘维尔定理是纯粹由经典力学得到的推论，证明只需要运用到哈密顿正则运动方程。

值得一提的，如果外界作用满足绝热近似，而且可以用势场的形式表达，那么刘维尔定理仍然适用。
\end{corollary}

\begin{corollary}{系综的概率分布函数与连续性方程}
考虑在\autoref{eq_LiouTh_2} 的基础上引入速度与 $\nabla$ 算子
\begin{equation}
\begin{aligned}
\bvec{v} &\equiv (\dot q_1, \dot q_2, \dots, \dot q_s, \dot p_1, \dot p_2, \dots, \dot p_s), \\
\nabla &\equiv (\pdv{}{q_1}, \pdv{}{q_2}, \dots, \pdv{}{q_s}, \pdv{}{p_1}, \pdv{}{p_2}, \dots, \pdv{}{p_s}) ~.
\end{aligned}
\end{equation}
这里 $\bvec v$ 为相点在相空间内的速度，$\nabla$ 是这相空间的 nabla 算子。则可以将\autoref{eq_LiouTh_2} 改写为连续性方程（\autoref{eq_fluidC_6}）的形式：
\begin{equation}
\pdv{\widetilde \rho}{t} + \nabla \cdot \left(  \widetilde \rho \bvec v\right) = 0 ~.
\end{equation}
其中 $\nabla \cdot$ 是这相空间的梯度算符。这式代表相点数守恒。
\end{corollary}
