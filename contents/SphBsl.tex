% 球贝塞尔函数
% 球贝塞尔方程|球贝塞尔函数|修正球贝塞尔函数

\pentry{贝塞尔函数\upref{Bessel}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Bessel_function}{相关页面}。以及 R. Mehrem, \href{https://arxiv.org/abs/0909.0494}{arXiv:0909.0494} (2009)。}\textbf{球贝塞尔方程（spherical Bessel's equation）}为
\begin{equation}
x^2 \dv[2]{y}{x} + 2x \dv{y}{x} + [x^2 - l(l + 1)]y = 0~.
\end{equation}
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/fbdaeb7313c4976f.pdf}
\caption{球贝塞尔函数和球汉克尔函数（来自 Wikipedia）} \label{fig_SphBsl_1}
\end{figure}
两个线性无关的解分别为第一类球贝塞尔函数 $j_l(x)$ 和第二类球贝塞尔函数 $y_l(x)$， 见\autoref{fig_SphBsl_1}。 它们可以通过贝塞尔函数\upref{Bessel} $J_l$， $Y_l$ 来定义
\begin{equation}
j_l(x) = \sqrt{\frac{\pi}{2x}} J_{l+1/2}(x)~,
\qquad
y_l(x) = \sqrt{\frac{\pi}{2x}} Y_{l+1/2}(x)~.
\end{equation}
同样也可以定义两类\textbf{球汉克尔函数（spherical Hankel's function）}
\begin{equation}
h_l^{(1)}(x) = \sqrt {\frac{\pi }{2x}} H_{l+1/2}^{(1)}(x) = j_l(x) + \I y_l(x)~,
\end{equation}
\begin{equation}
h_l^{(2)}(x) = \sqrt{\frac{\pi }{2x}} H_{l+1/2}^{(2)}(x) = j_l(x) - \I y_l(x)~.
\end{equation}
另一种等效的定义方式使用 \textbf{Rayleigh's 方程}
\begin{equation}
j_l(x) = (-x)^l \qty(\frac{1}{x} \dv{x})^l \frac{\sin x}{x}~,
\end{equation}
\begin{equation}
y_l(x) = -(-x)^l \qty(\frac{1}{x} \dv{x})^l \frac{\cos x}{x}~.
\end{equation}
$l$ 为整数的球贝塞尔函数都可以用正弦余弦函数表示， 例如
\begin{align}
&j_0(x) = \frac{\sin x}{x}~,\\
&j_1(x) = \frac{\sin x}{x^2} - \frac{\cos x}{x}~,\\
&j_2(x) = \qty(\frac{3}{x^2} - 1) \frac{\sin x}{x} - \frac{3\cos x}{x^2}~,\\
&j_3(x) = \qty(\frac{15}{x^3} - \frac{6}{x})\frac{\sin x}{x} - \qty(\frac{15}{x^2}-1)\frac{\cos x}{x}~.
\end{align}
\begin{align}
&y_0(x) = -\frac{\cos x}{x}~,\\
&y_1(x) = -\frac{\cos x}{x^2} - \frac{\sin x}{x}~,\\
&y_2(x) = \qty(-\frac{3}{x^2}+1)\frac{\cos x}{x} - \frac{3\sin x}{x^2}~,\\
&y_3(x) = \qty(-\frac{15}{x^3}+\frac{6}{x}) \frac{\cos x}{x} - \qty(\frac{15}{x^2} - 1)\frac{\sin x}{x}~.
\end{align}
更多项可以用 Mathematica 命令如\footnote{笔者也不明白为什么要这么做。}
\begin{lstlisting}[language=mma]
l = 4; Series[SphericalBesselJ[l, x], {x, \[Infinity], 1000}] // 
  Normal // Simplify
\end{lstlisting}

\subsection{性质}
原点值
\begin{equation}
j_l(0) = \delta_{l,0} ~,\qquad y_l(0) = -\infty~.
\end{equation}

奇偶性： 当 $l$ 为偶数， $j_l, y_l$ 分别是偶函数和奇函数， 而 $l$ 为奇数时则相反。
\begin{equation}\label{eq_SphBsl_3}
j_l(-x) = (-1)^l j_l(x)~,
\qquad
y_l(-y) = -(-1)^l y_l(x)~.
\end{equation}

一阶导数满足（ $f$ 是 $j, y, h^{(1)}, h^{(2)}$ 中的任意一种）
\begin{equation}
f'_l(z) = f_{l-1}(z) - \frac{l+1}{z} f_l(z)~.
\end{equation}
渐进形式
当 $x \gg 1$ 时， 球贝塞尔函数的渐进表达式为
\begin{equation}\label{eq_SphBsl_2}
j_l(x) \to \sin(x - l\pi /2)/x~,
\qquad
y_l(x) \to  - \cos(x - l\pi /2)/x~,
\end{equation}
\begin{equation}
h_l^{(1)}(x) \to ( -\I)^{l+1} \E^{\I x}/x~,
\qquad
h_l^{(2)}(x) \to \I^{l + 1} \E^{-\I x}/x~.
\end{equation}
与勒让德多项式的关系（\autoref{eq_Legen_3}~\upref{Legen}）
\begin{equation}
j_l(\rho) = \frac{(-\I)^l}{2} \int_{-1}^1 P_l(x) \E^{\I \rho x} \dd{x}~.
\end{equation}
分解（$[\dots]$ 表示 Clebsch–Gordan 系数\upref{SphCup}）
\begin{equation}
j_l(x_1 \pm x_2) = \sum_{l_1,l_2} \I^{l_1\pm l_2-l} \frac{(2l_1+1)(2l_2+1)}{2l+1}
\bmat{l_1 & l_2 & l\\ 0 & 0 & 0}^2 j_{l_1}(x_1) j_{l_2}(x_2)~.
\end{equation}

\subsection{积分性质}
由渐进形式可得径向归一化积分为（$\delta$ 是狄拉克 $\delta$ 函数\upref{Delta}， 推导见\autoref{eq_Delta_9}~\upref{Delta}）
\begin{equation}\label{eq_SphBsl_4}
\begin{aligned}
\int_0^\infty k'r j_l(k'r) \cdot kr j_l(kr) \dd{r} &= \int_0^\infty \sin(k'r - l\pi/2)\sin(kr - l\pi/2) \dd{r}\\
& = \frac{\pi}{2}\delta(k'-k) \qquad (k, k' > 0)~,
\end{aligned}
\end{equation}
\begin{equation}
% 已验证 l = 0~18
\int_{0}^{\infty} j_l(x) \dd{x} = \frac{\pi l!}{2^{l+1} [(l/2)!]^2}~.
\end{equation}
使用奇偶性\autoref{eq_SphBsl_3} 易得
\begin{equation}
\int_{-\infty}^{+\infty} j_l(x) \dd{x} = \leftgroup{
&\frac{\pi l!}{2^l [(l/2)!]^2} &\quad (l = \text{偶数})\\
&0 &\quad (l = \text{奇数})
}~.\end{equation}
正交性
\begin{equation}
\int_{-\infty}^{+\infty} j_l(x) j_{l'}(x) \dd{x} = \frac{\pi}{2l+1}\delta_{l,l'}~,
\end{equation}
\begin{equation}
\int_0^\infty j_l(k' r) j_l(kr) \dd{r} = \frac{\pi}{2(2l+1)} \frac{k_<^l}{k_>^{l+1}}~.
\end{equation}
傅里叶变换\upref{FTExp}
\begin{equation}
\int_{-\infty}^{+\infty} \E^{\I k x} j_l(x) \dd{x} = \pi \I^l P_l(k)~.
\end{equation}

\subsection{修正球贝塞尔函数}

\textbf{修正球贝塞尔方程}为
\begin{equation}
x^2 \dv[2]{y}{x} + 2x\dv{y}{x} - [x^2 + l(l + 1)]y = 0~.
\end{equation}
两个线性无关解称为\textbf{第一类修正球贝塞尔函数（modified spherical Bessel function of the first kind）}和\textbf{第二类修正球贝塞尔函数}
\begin{equation}
i_l(x) = \sqrt{\frac{\pi }{2x}} I_{l+1/2}(x) = \I^{-l} j_l(\I x)~,
\end{equation}
\begin{equation}\label{eq_SphBsl_1}
k_l(x) = \sqrt{\frac{2}{\pi x}} K_{l+1/2}(x) = \frac{\pi }{2} \I^{l + 2} h_l^{(1)}(\I x)~,
\end{equation}
渐进形式为
\begin{equation}
i_l(x) \to \frac{\E^x}{2x}~,
\qquad
k_l(x) \to \frac{\pi}{2} \frac{\E^{-x}}{x}~.
\end{equation}
