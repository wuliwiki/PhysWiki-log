% Gamma 函数
% 微积分|定积分|Γ 函数| Gamma 函数|阶乘|半整数

\pentry{定积分\upref{DefInt}}

当 $x$ 取实数且 $x>-1$ 时，可以定义阶乘函数为
\begin{equation}\label{Gamma_eq1}
x! \equiv \Gamma (x + 1) = \int_0^{+\infty} t^x \E^{-t} \dd{t}
\end{equation}
递推关系仍为
\begin{equation}\label{Gamma_eq2}
x!=x(x-1)! \qquad (x>0)
\end{equation}
且 $(-1/2)!=\sqrt{\pi}$，  $0! = 1$．

\subsection{推导}
\pentry{分部积分法\upref{IntBP}}

首先定义 $\Gamma$ \textbf{（Gamma）} 函数为
\begin{equation}
\Gamma(x) = \int_0^{+\infty} t^{x-1} \E^{-t} \dd{t}
\end{equation}
当 $x \leqslant 0$ 时该积分在 $x=0$ 处不收敛，以下仅讨论 $x$ 为正实数的情况\footnote{事实上，自变量为负实数（非整数）时，$\Gamma$ 函数有另一种定义，这里不讨论．}．

我们现在验证当 $x$ 取正整数时，新定义的阶乘 $x! = \Gamma(x+1)$ 与原来的定义 $x! = x(x-1)\dots 1$ 相同．首先
\begin{equation}\label{Gamma_eq4}
0! = \Gamma(1) = \int_0^{+\infty} \E^{-t} \dd{t} = 0 - (-1) = 1
\end{equation}

使用分部积分法\upref{IntBP}，令 $t^x$ 为“求导项”， $\E^{-t}$ 为“积分项”， 可得递推公式\footnote{该证明仅对 $x>0$ 适用， 这样才有 $0^x \E^{-0} = 0$， 使第四个等号成立．}（\autoref{Gamma_eq2}）
\begin{equation}\label{Gamma_eq5}
\begin{aligned}
x! &= \Gamma(x+1) = \int_0^{+\infty} t^x \E^{-t} \dd{t} =  - \eval{t^x \E^{-t}}_{0}^{+\infty} + \int_0^{+\infty} x t^{x-1} \E^{-t} \dd{t} \\
&= x\int_0^{+\infty} t^{x-1} \E^{-t} \dd{t} = x\Gamma (x) = x(x-1)!
\end{aligned} \end{equation} 
由递推\autoref{Gamma_eq5} 和初值\autoref{Gamma_eq4}， 对任意正整数 $n$ 有
\begin{equation}
n! = n(n-1)! = n(n-1)(n-2)!... = n(n-1)...1
\end{equation}

再来看半整数的阶乘，我们讨论范围内的最小半整数的阶乘为 
\begin{equation}
\qty(-\frac12) ! = \int_0^{+\infty} \frac{\E^{-x}}{\sqrt x}\dd{x} = 2\int_0^{+\infty} \E^{-t^2} \dd{t} = \int_{-\infty}^{+\infty} \E^{-t^2} \dd{t} = \sqrt{\pi}
\end{equation}
其中使用了换元法令 $x = t^2$ 将定积分变为高斯积分\upref{GsInt}．

对任意大于零的半整数 $n/2$，有
\begin{equation}
\frac{n}{2}! = \frac{n}{2} \qty(\frac{n}{2}-1)! = \frac{n}{2} \qty(\frac{n}{2}-1) \dots \frac12 \qty(-\frac12) ! = \frac{n}{2} \qty(\frac{n}{2}-1) \dots \frac12 \sqrt{\pi}
\end{equation}

\subsection{渐近公式}
对于大的$x$, 有\textbf{斯特林公式（Stirling formula）}：
$$
\Gamma(x+1)
  =\sqrt{2\pi x}\left({x\over \E}\right)^x
  \left(
   1
   +{1\over12x}
   +{1\over288x^2}
   -{139\over51840x^3}
   -{571\over2488320x^4}
   + \cdots
  \right).
$$
这是一个渐近展开， 右边的级数是发散的． 它的推导可见拉普拉斯方法\upref{LapAsm}
