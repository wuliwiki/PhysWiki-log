% Gamma 函数
% 微积分|定积分|Γ 函数| Gamma 函数|阶乘|半整数

\pentry{定积分\upref{DefInt}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Gamma_function}{相关页面} 以及 \cite{Arfken} 相关章节．}$\Gamma$ 函数\textbf{（gamma function）}可以看成是阶乘在实数或复数域的拓展， 该函数有多种定义方法， 这里先讨论实数域上的定积分定义． 该方法可以定义 $(-1, \infty)$ 区间的阶乘
\begin{equation}\label{Gamma_eq1}
x! \equiv \Gamma (x + 1) = \int_0^{+\infty} t^x \E^{-t} \dd{t} \qquad (x > -1)
\end{equation}
即 $\Gamma$ 函数在区间 $(0,\infty)$ 被定义为
\begin{equation}\label{Gamma_eq3}
\Gamma(x) \equiv \int_0^{+\infty} t^{x-1} \E^{-t} \dd{t} \qquad (x > 0)
\end{equation}
可以证明新定义的阶乘的递推关系仍为
\begin{equation}\label{Gamma_eq2}
(x+1)!=(x+1)x! \qquad (x>-1)
\end{equation}
且 $0! = 1$． 所以当 $x$ 取正整数 $N$ 时， \autoref{Gamma_eq1} 的结果仍然是熟悉的 $N! = N(N-1)\dots, 1$．

另外能证明 $(-1/2)!=\sqrt{\pi}$， 由此我们可以直接写出半整数的阶乘为
\begin{equation}
\frac{N}{2}! = \frac{N}{2} \qty(\frac{N}{2}-1) \dots \frac12 \sqrt{\pi} \qquad (N > 0)
\end{equation}

\subsection{推导}
\pentry{分部积分法\upref{IntBP}}

首先
当 $x \leqslant 0$ 时该积分在 $x=0$ 处不收敛，以下仅讨论 $x$ 为正实数的情况\footnote{事实上，自变量为负实数（非整数）时，$\Gamma$ 函数有另一种定义，这里不讨论．}．

我们现在验证当 $x$ 取正整数时，新定义的阶乘 $x! = \Gamma(x+1)$ 与原来的定义 $x! = x(x-1)\dots 1$ 相同．首先
\begin{equation}\label{Gamma_eq4}
0! = \Gamma(1) = \int_0^{+\infty} \E^{-t} \dd{t} = 0 - (-1) = 1
\end{equation}

使用分部积分法\upref{IntBP}，令 $t^x$ 为“求导项”， $\E^{-t}$ 为“积分项”， 可得递推公式\footnote{该证明仅对 $x>0$ 适用， 这样才有 $0^x \E^{-0} = 0$， 使第四个等号成立．}（\autoref{Gamma_eq2}）
\begin{equation}\label{Gamma_eq5}
\begin{aligned}
x! &= \Gamma(x+1) = \int_0^{+\infty} t^x \E^{-t} \dd{t} =  - \eval{t^x \E^{-t}}_{0}^{+\infty} + \int_0^{+\infty} x t^{x-1} \E^{-t} \dd{t} \\
&= x\int_0^{+\infty} t^{x-1} \E^{-t} \dd{t} = x\Gamma (x) = x(x-1)!
\end{aligned} \end{equation} 
由递推\autoref{Gamma_eq5} 和初值\autoref{Gamma_eq4}， 对任意正整数 $n$ 有
\begin{equation}
n! = n(n-1)! = n(n-1)(n-2)!... = n(n-1)...1
\end{equation}

再来看半整数的阶乘，我们讨论范围内的最小半整数的阶乘为 
\begin{equation}
\qty(-\frac12) ! = \int_0^{+\infty} \frac{\E^{-x}}{\sqrt x}\dd{x} = 2\int_0^{+\infty} \E^{-t^2} \dd{t} = \int_{-\infty}^{+\infty} \E^{-t^2} \dd{t} = \sqrt{\pi}
\end{equation}
其中使用了换元法令 $x = t^2$ 将定积分变为高斯积分\upref{GsInt}．

\subsection{渐近公式}
对于大的$x$, 有\textbf{斯特林公式（Stirling formula）}：
$$
\Gamma(x+1)
  =\sqrt{2\pi x}\left({x\over \E}\right)^x
  \left(
   1
   +{1\over12x}
   +{1\over288x^2}
   -{139\over51840x^3}
   -{571\over2488320x^4}
   + \cdots
  \right).
$$
这是一个渐近展开， 右边的级数是发散的． 它的推导可见拉普拉斯方法\upref{LapAsm}

\addTODO{以下为草稿}
\begin{definition}{}
		($\Gamma$函数的定义)由积分
		\begin{equation}
			\Gamma(z)=\int_{0}^{\infty}e^{-t}t^{z-1}\mathrm{d}t\label{Gamma_eq6}
		\end{equation}
		定义的函数称为$\Gamma$函数.
	\end{definition}

	由Morera定理, 由\autoref{Gamma_eq6} 式所定义的函数 $\Gamma(z)$ 在 $\mathrm{Re}(z)>0$ 是解析的,且
	\[
		D(\Gamma(z))=\int_{0}^{\infty}e^{-t}t^{z-1}\log t\mathrm{d}t\qquad\mathrm{Re}(z)>0
	\]
	由分部积分法
	\[
		\Gamma(z+1)=z\Gamma(z+1)
	\]
	重复利用分部积分法得到
	\begin{equation}
		\Gamma(z+n)=\Gamma(z)\prod_{k=0}^{n-1}(z+k){Gamma(z+n)}\quad(n\in{\N^{+}})
	\end{equation}
	根据\eqref{Gamma(z+n)}式,可以将$\Gamma(z)$解析延拓到半平面$\mathrm{Re}(z)>-n$
	\[
		\Gamma(z)=\frac{\Gamma(z+n)}{\displaystyle{\prod_{k=0}^{n-1}(z+k)}}
	\]

	\subsection{Guass 公式}

	设
	\begin{equation}
		f_{n}(z)=\int_{0}^{n}\left(1-\frac{t}{n}\right)^{n}t^{z-1}\ddt
    \qquad\operatorname{Re}(z)>0
	\end{equation}
	作变量替换 $u=t/n $并分部积分 $n$ 次,得到
	\begin{equation}\label{Gamma_eq7}
		f_{n}(z)=n^{z}\int_{0}^{n}(1-u)^{n}u^{z-1}\mathrm{d}u 
	\end{equation}
	当$0\leq t\leq n,n>1$时
	\begin{equation}\label{Gamma_eq8}
		0\leq 1-\E^{t}\left(1-\frac{t}{n}\right)^{n}\leq\frac{et^2}{4n}
	\end{equation}
	事实上,由于
	\[
		D\left\{1-E^{t}\left(1-\frac{t}{n}\right)^{n}\right\}=-\frac{1}{n}t\E^{t}\left(1-\frac{t}{n}\right)^{n-1}
	\]
	因此
	\[
		1-\E^{t}\left(1-\frac{t}{n}\right)^{n}
    =\frac{1}{n}\E^{t}\int_{0}^{t}ve^{v}\left(1-\frac{v}{n}\right)^{n-1}\dd v
	\]
	而函数 $ve^{v}(1-v/n)^{n-1}$ 在 $v=1$ 取得最大值
	\[
		\sup_{v\geq 0}\left\{ve^{v}\left(1-\frac{v}{n}\right)^{n-1}\right\}
    =\E\left(1-\frac{1}{n}\right)^{n-1}\leq \frac{\E}{2}
	\]
	故有
	\[
		1-e^{t}\left(1-\frac{t}{n}\right)^{n} \leq \frac{e}{2n}\int_{0}^{t}v\dd v
    =\frac{\Et^2}{4n}
	\]
	此外当 $v>0$时,$e^{-v}\geqslant1-v$ ,则$e^{-t/n}\geq 1-{t \over n}$,于是$\E^{-t}\geq\left(1-t \over n\right)^{n}$,故
	\[
		1-e^{t}\left(1-\frac{t}{n}\right)^{n}\geq 0
	\]
	利用不等式 \autoref{Gamma_eq8} ,得到
	\[
		\left|\int_{0}^{n}e^{-t}t^{z-1}\mathrm{d}t-\int_{0}^{n}\left(1-\frac{t}{n}\right)^{n}t^{z-1}\mathrm{d}t\right|
		\leqslant\frac{e}{4n}\int_{0}^{n}e^{-t}t^{|z|+1}\mathrm{d}t\leqslant\frac{e}{4n}\Gamma(|z|+2)
	\]
	从而
	\[
		\lim_{n\to\infty}\int_{0}^{n}e^{-t}t^{z-1}\left[1-e^{t}\left(1-\frac{t}{n}\right)^{n}\right]\mathrm{d}t=0
	\]
	结合 \autoref{Gamma_eq7} 式和 \autoref{Gamma_eq8} 式,可得
	\begin{equation}\label{Gamma_eq9}
		\Gamma(z)=\lim_{n\to\infty}\frac{n!n^{z}}{\displaystyle{\prod_{k=0}^{n}(z+k)}}
	\end{equation}
	由于$\Gamma(z)$已经延拓到左半平面,因此根据唯一性定理,\eqref{Gauss's formula}式对于$z\notin{\Z^{-}}$成立,这个式子称为Gauss公式.可知
	\[
		\frac{n!n^{z}}{\prod\limits_{k=0}^{n}(z+k)}
		=\frac{\mathrm{exp}\{z\log n\}}{z\prod\limits_{k=1}^{n}\left(1+\dfrac{z}{k}\right)}
		=\frac{\mathrm{exp}\{z\log n\}-z\sum\limits_{k=1}^{n}\dfrac{1}{k}}{z\prod\limits_{k=1}^{n}\left(1+\dfrac{z}{k}\right)e^{-z/k}}
	\]
	且
	\begin{equation}
		\lim_{n\to\infty}\left(\sum_{k=1}^{n}\frac{1}{k}-\log n\right)=\gamma
	\end{equation}
	从而
	\begin{equation}\label{Gamma_eq10}
		\frac{1}{\Gamma(z)}=ze^{\gamma z}\prod_{k=1}^{\infty}\left(1+\frac{z}{k}\right)e^{-z/k}
	\end{equation}
	\autoref{Gamma_eq10} 式称为Weistrass公式.因此
	\begin{equation}\label{Gamma_eq11}
		\Gamma(z)\Gamma(1-z)=\frac{\pi}{\sin(\pi z)}\qquad 0<\mathrm{Re}(z)<1
	\end{equation}
	\autoref{Gamma_eq11} 式称为余元公式.
