% 素数定理（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Prime_number_theorem}{相关文章}。

在数学中，素数定理描述了素数在正整数中的渐近分布情况。它形式化地表达了一个直观的观点：随着数值的增大，素数变得越来越稀疏，并且精确地量化了这一稀疏现象发生的速度。

该定理由雅克·阿达马和夏尔·让·德拉瓦莱-普桑于1896年各自独立证明，所用的方法基于伯恩哈德·黎曼引入的一些思想，尤其是黎曼ζ函数。最早发现的分布形式为：$\pi(N) \sim \frac{N}{\log N}$其中，$\pi(N)$ 表示素数计数函数，即不超过 $N$ 的素数个数，$\log N$ 是 $N$ 的自然对数。这意味着对于足够大的 $N$，从不超过 $N$ 的整数中随机选一个数是素数的概率大约为 $1 / \log N$。换句话说，在前 $N$ 个整数中，相邻两个素数之间的平均间隔大约为 $\log N$。

因此，一个最多有 $2n$ 位数的随机整数（当 $n$ 足够大时）成为素数的可能性，大约是一个最多有 $n$ 位数的随机整数的一半。例如，在所有最多有 1000 位的正整数中，大约每 2300 个数中有一个是素数（因为 $\log(10^{1000}) \approx 2302.6$）；而在最多有 2000 位的正整数中，大约每 4600 个数中才有一个是素数（因为 $\log(10^{2000}) \approx 4605.2$）。
\subsection{定理的表述}
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/17ef6d25124d34a0.png}
\caption{该图显示了素数计数函数 $\pi(x)$ 与其两个近似函数 $x / \log x$ 和 $\mathrm{Li}(x)$ 的比值。随着 $x$ 的增大（注意：横轴为对数刻度），这两个比值都趋近于 1。其中，$\pi(x) / (x / \log x)$ 的比值从上方非常缓慢地收敛，而 $\pi(x) / \mathrm{Li}(x)$ 的比值则从下方收敛得更快。} \label{fig_SDL_1}
\end{figure}
设 $\pi(x)$ 为素数计数函数，定义为不超过实数 $x$ 的素数个数，例如 $\pi(10) = 4$，因为有四个素数（2, 3, 5 和 7）不超过 10。

那么，素数定理指出：$\frac{x}{\log(x)}$ 是 $\pi(x)$ 的一个良好近似，其含义是，当 $x$ 趋于无穷大时，函数 $\pi(x)$ 与 $\frac{x}{\log(x)}$ 的商的极限为 1，即：
$$
\lim_{x \to \infty} \frac{\pi(x)}{\left[\frac{x}{\log(x)}\right]} = 1~
$$
这被称为素数分布的渐近法则。

使用渐近记号，该结果可重新表述为：
$$
\pi(x) \sim \frac{x}{\log x}~
$$
这里的渐近记号（以及该定理）并不表示 $\pi(x)$ 与 $\frac{x}{\log x}$ 的差在 $x$ 趋于无穷大时有极限，而是表示后者对前者的相对误差趋近于 0。
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/c7e868ce31e62b68.png}
\caption{对数-对数图显示了 $x / \log x$ 与 $\mathrm{Li}(x)$ 这两个对素数计数函数 $\pi(x)$ 的近似所产生的绝对误差。与比值不同的是，$\pi(x)$ 与 $x / \log x$ 之间的差值会随着 $x$ 的增大而无限增长。另一方面，$\mathrm{Li}(x) - \pi(x)$ 的符号会无限次地发生变化。} \label{fig_SDL_2}
\end{figure}
素数定理等价于如下陈述：第 $n$ 个素数 $p_n$ 满足：
$$
p_n \sim n \log(n)~
$$
这里的渐近记号同样表示：当 $n$ 趋于无穷大时，该近似的相对误差趋于 0。例如，第 $2 \times 10^{17}$ 个素数是 8512677386048191063，而 $(2 \times 10^{17}) \log(2 \times 10^{17})$ 的值为约 7967418752291744388，相对误差约为 6.4\%。
另一方面，以下渐近关系在逻辑上是等价的\(^\text{[5]: 80–82 }\)：
$$
\lim_{x \to \infty} \frac{\pi(x) \log x}{x} = 1, \quad \text{以及} \quad \lim_{x \to \infty} \frac{\pi(x) \log \pi(x)}{x} = 1.~
$$
如下面将要概述的，素数定理也等价于以下公式：
$$
\lim_{x \to \infty} \frac{\vartheta(x)}{x} = \lim_{x \to \infty} \frac{\psi(x)}{x} = 1,~
$$
其中 $\vartheta(x)$ 和 $\psi(x)$ 分别是第一和第二切比雪夫函数。

还等价于：
$$
\lim_{x \to \infty} \frac{M(x)}{x} = 0,~
$$
其中：
$$
M(x) = \sum_{n \leq x} \mu(n)~
$$
是梅滕斯函数，$\mu(n)$ 是莫比乌斯函数\(^\text{[5]: 92–94 }\)。
\subsection{素数渐近分布定律的证明史}
根据安东·费尔克尔和尤里·维加编制的素数表，阿德里安-马里·勒让德在1797年或1798年猜想，素数计数函数 $\pi(a)$ 可由函数 $a / (A \log a + B)$ 近似，其中 A 和 B 是未具体说明的常数。在他1808年出版的第二版《数论》一书中，他提出了更精确的猜想，设定 $A = 1$，$B = -1.08366$。卡尔·弗里德里希·高斯大约在1792或1793年、年仅15或16岁时，也考虑过同样的问题（这是他1849年回忆中提到的）。1838年，彼得·古斯塔夫·勒热讷·狄利克雷提出了他自己的近似函数，即对数积分 $\mathrm{li}(x)$（以略有不同的级数形式，并与高斯通信交流）。勒让德与狄利克雷的公式都蕴含了前文所述的猜想：$\pi(x)$ 与 $x / \log(x)$ 渐近等价，尽管后来的研究发现，如果从差值（而非比值）角度来看，狄利克雷的近似要显著更好。

1848年和1850年，俄国数学家帕夫努季·切比雪夫发表了两篇论文，试图证明素数分布的渐近规律。他的工作值得注意之处在于引入了黎曼ζ函数 $\zeta(s)$（实数 $s$ 的情形），类似于莱昂哈德·欧拉早在1737年的用法。切比雪夫的论文早于黎曼1859年著名的论文，他成功地证明了一个稍弱的形式：如果极限 $\lim_{x \to \infty} \pi(x) / (x / \log x)$ 存在，那么该极限值必定等于1\(^\text{[7]}\)。此外，切比雪夫无条件地证明了该比值对充分大的 $x$ 被夹在两个常数之间，即：$0.92129 < \frac{\pi(x)}{x / \log x} < 1.10555$\(^\text{[8][9]}\)。尽管切比雪夫的论文尚未给出素数定理的完整证明，但他对 $\pi(x)$ 的估计已足以证明“伯特兰猜想”：对于任意整数 $n \geq 2$，在区间 $(n, 2n)$ 内必定存在至少一个素数。

关于素数分布的一个重要论文是黎曼于1859年发表的回忆录《论小于给定大小的素数的数量》（“On the Number of Primes Less Than a Given Magnitude”），这是他在该领域唯一发表的一篇论文。黎曼在文中引入了一些新的思想，最重要的是：素数的分布与复变函数扩展下的黎曼ζ函数的零点密切相关。特别地，正是在这篇论文中，他首次提出将**复分析方法应用于研究实数函数 $\pi(x)$ 的思想。

在黎曼的思想基础上，雅克·阿达玛\(^\text{[1]}\)和 夏尔-让·德拉瓦莱-普桑\(^\text{[2]}\)各自独立地找到了素数分布渐近定律的证明，两者均发表于 1896年。这两个证明都使用了复分析方法，证明的关键步骤是：黎曼ζ函数 $\zeta(s)$ 在所有形如 $s = 1 + it$（其中 $t > 0$）的复数点上都不为零\(^\text{[10]}\)。

20世纪，这一定理便被称为素数定理。此后人们又发现了多种不同的证明方法，其中包括**阿特勒·塞尔伯格\(^\text{[11]}\)与保罗·艾狄胥\(^\text{[12]}\)于1949年提出的“初等”证明。这些初等证明不依赖于复分析，但仍然结构复杂。阿达玛和德拉瓦莱-普桑的原始证明过程冗长繁复，后来有学者借助托伯定理加以简化，尽管如此，仍然难以完全消化。

1980年，美国数学家唐纳德·J·纽曼\(^\text{[13][14]}\)发现了一个简短的证明。这个证明被认为是目前已知最简洁的素数定理证明，尽管它不是“初等”的，因为它使用了复分析中的柯西积分定理。
\subsection{证明概要}
以下是根据特伦斯·陶的一次讲座中提到的素数定理（PNT）证明概要\(^\text{[15]}\)。像大多数关于素数定理的证明一样，该证明首先将问题重新表述为一个更易处理但直觉性较弱的素数计数函数的形式。核心思想是通过给素数（或相关集合，如素数的幂）加权，从而构造一个在渐进行为上更平滑的函数。最常见的这种广义计数函数是**切比雪夫函数** $\psi(x)$，其定义如下：
$$
\psi(x) = \sum_{k \geq 1} \sum_{\substack{p^k \leq x\\ p \text{ 为素数}}} \log p~
$$
有时也写作：
$$
\psi(x) = \sum_{n \leq x} \Lambda(n)~
$$
其中 $\Lambda(n)$ 是 冯·芒戈尔特函数，定义如下：
$$
\Lambda(n) =
\begin{cases}
\log p & \text{若 } n = p^k \text{，其中 } p \text{ 是素数且 } k \geq 1 \\
0 & \text{否则}
\end{cases}~
$$
接下来，我们可以比较容易地证明，素数定理等价于如下断言：
$$
\lim_{x \to \infty} \frac{\psi(x)}{x} = 1~
$$
这个结论可以通过以下两个估计式导出：

首先上界：
$$
\psi(x) = \sum_{\substack{p \leq x \\ p \text{ 为素数}}} \log p \left\lfloor \frac{\log x}{\log p} \right\rfloor \leq \sum_{\substack{p \leq x \\ p \text{ 为素数}}} \log x = \pi(x) \log x~
$$
然后下界，使用大 O 符号（即渐近符号）表示，对于任意 $\varepsilon > 0$：
$$
\psi(x) \geq \sum_{\substack{x^{1-\varepsilon} \leq p \leq x \\ p \text{ 为素数}}} \log p \geq \sum_{\substack{x^{1-\varepsilon} \leq p \leq x \\ p \text{ 为素数}}} (1 - \varepsilon)\log x = (1 - \varepsilon)\left(\pi(x) + O(x^{1-\varepsilon})\right)\log x~
$$
通过上述上下界的估计，就可以看出 $\psi(x)$ 与 $x$ 渐近等价，从而导出素数定理的结论。

下一步是寻找 $\psi(x)$ 的一个有用表示式。

设 $\zeta (s)$ 为黎曼 $\zeta$  函数。可以证明，$\zeta (s)$ 与冯·芒戈尔特函数 $\Lambda(n)$ 之间存在如下关系，因此也与 $\psi(x)$ 相关：
$$
- \frac{\zeta'(s)}{\zeta(s)} = \sum_{n=1}^{\infty} \Lambda(n)\, n^{-s}~
$$
对该等式及$\zeta$函数的相关性质进行精细分析（使用梅林变换和佩龙公式），可以推出：当 $x$ 不是整数时，成立如下公式：
$$
\psi(x) = x - \log(2\pi) - \sum_{\rho:\, \zeta(\rho) = 0} \frac{x^{\rho}}{\rho}~
$$
其中求和范围为所有 $\zeta$ 函数的零点（包括平凡零点和非平凡零点）。这个令人惊艳的表达式是数论中的著名显式公式之一，它已经暗示了我们想要证明的结果：右边首项为 $x$，正是 $\psi(x)$ 的主项阶数，其后为阶数较低的修正项。

证明的下一步涉及对 $\zeta$ 函数零点的研究。平凡零点为 $-2, -4, -6, -8, \dots$，可以单独处理，它们对 $\psi(x)$ 的影响为：
$$
\sum_{n=1}^{\infty} \frac{1}{2n\, x^{2n}} = -\frac{1}{2} \log\left(1 - \frac{1}{x^2}\right)~
$$
该表达式在 $x$ 很大时趋于 0，可忽略不计。

而非平凡零点，即 $\zeta (s)$ 在临界带 $0 \leq \text{Re}(s) \leq 1$ 上的零点，如果存在实部为 1 的零点（即 Re(ρ) = 1），则对应的 $x^\rho$ 项将与主项 $x$ 同阶，从而影响 $\psi(x)$ 的渐近性。因此，为了完成证明，我们必须说明所有 $\zeta$函数的非平凡零点都满足：
$$
\text{Re}(\rho) < 1~
$$
这一步至关重要，是素数定理成立的核心条件之一。
\subsubsection{在 Re(s) = 1 上的非零性}
为此，我们首先默认以下事实：$\zeta(s)$ 在半平面 $\operatorname{Re}(s) > 0$ 是一个亚纯函数，在 $s = 1$ 处有一个简单极点，在其余点处解析；并且在$\operatorname{Re}(s) > 1$ 区域满足如下欧拉乘积公式：
$$
\zeta(s) = \prod_p \frac{1}{1 - p^{-s}}~
$$
该乘积公式是基于整数唯一素因数分解定理，说明 $\zeta(s)$ 在该区域绝不会为零，因此其对数是良定义的，并且有：
$$
\log \zeta(s) = -\sum_p \log(1 - p^{-s}) = \sum_{p,\,n} \frac{p^{-n s}}{n}~
$$
令 $s = x + i y$，则有：
$$
|\zeta(x + i y)| = \exp\left( \sum_{n,\,p} \frac{\cos(n y \log p)}{n p^{n x}} \right)~
$$
我们使用以下恒等式：
$$
3 + 4 \cos \phi + \cos 2\phi = 2(1 + \cos \phi)^2 \geq 0~
$$
因此可以得出：
$$
\left| \zeta(x)^3 \, \zeta(x + i y)^4 \, \zeta(x + 2i y) \right| = \exp\left( \sum_{n,\,p} \frac{3 + 4\cos(n y \log p) + \cos(2n y \log p)}{n p^{n x}} \right) \geq 1~
$$
对所有 $x > 1$ 都成立。

假设现在 $\zeta(1 + i y) = 0$。由于 $\zeta(s)$ 在 $s = 1$ 有一个简单极点，可以确定 $y \neq 0$。我们考虑 $x > 1$，并让 $x \to 1^+$。因为 $\zeta(x)$ 在 $x \to 1^+$ 时发散（趋向于无穷大），而 $\zeta(x + 2i y)$ 在该区域保持解析，所以上式左边趋于 0，与右边 $\geq 1$ 的不等式矛盾。
因此，$\zeta(s)$ 在 $\operatorname{Re}(s) = 1$ 上没有零点。

由此我们可以得出结论：素数定理（PNT）在直觉上是正确的。但要严格完成这个证明，还需克服一些技术难点，主要是因为在显式公式中关于$\zeta$函数零点的求和不是绝对收敛的，而只是条件收敛，并且以“主值”的形式存在。针对这一点有多种解决方法，其中多数依赖于精细的复分析估计。参考资料中的 Edwards 所著的书\(^\text{[16]}\)中详细提供了这些细节。另一种解决方式是使用 Ikehara 的 Tauber 定理，不过这个定理本身的证明也相当复杂。数学家 D.J. Newman 注意到：在素数定理的证明中其实不需要 Ikehara 定理的全力形式，只需要一个较易证明的特例即可。
\subsection{纽曼对素数定理的证明}
D. J. Newman 给出了一个快速证明素数定理（PNT）的方法。该证明由于依赖复分析，因此被视为“非初等”的，但只使用了该领域入门课程中的基础技巧：柯西积分公式、柯西积分定理和复积分估计。下面是该证明的简要概述，完整细节请参考文献 [14]。该证明采用与上一节相同的初步步骤，但不是使用函数 $\psi$（即第二类切比雪夫函数），而是使用切比雪夫函数：
$$
\vartheta(x) = \sum_{p \leq x} \log p~
$$
它是通过从 $\psi$ 的级数中去除某些项得到的。类似于前一节（如 Tao 讲义中）所用的论证，可以证明：
$$
\vartheta(x) \leq \pi(x) \log x~
$$
且对任意 $0 < \varepsilon < 1$，有：
$$
\vartheta(x) \geq (1 - \varepsilon)\left(\pi(x) + O(x^{1 - \varepsilon})\right) \log x~
$$
因此，素数定理等价于如下极限成立：
$$
\lim_{x \to \infty} \frac{\vartheta(x)}{x} = 1~
$$
同样，Newman 并不直接使用：
$$
-\frac{\zeta'(s)}{\zeta(s)}~
$$
而是改用函数：
$$
\Phi(s) = \sum_{p \leq x} \log p \cdot p^{-s}~
$$
这是通过从 $-\zeta'(s)/\zeta(s)$ 的级数中去除一些项得到的。函数 $\Phi(s)$ 与 $-\zeta'(s)/\zeta(s)$ 的区别是它们的差在 $\operatorname{Re}(s) = 1$ 上是全纯的函数。由于上一节中已经证明 $\zeta(s)$ 在直线 $\operatorname{Re}(s) = 1$ 上没有零点，因此：
$$
\Phi(s) - \frac{1}{s - 1}~
$$
在 $\operatorname{Re}(s) = 1$ 上没有奇点。

Newman 证明中还需要一条额外信息——这也是其简明方法中的估计关键：函数 $\vartheta(x)/x$ 是有界的。这可以通过 Chebyshev 提出的一种巧妙且简洁的方法来证明。

分部积分可以揭示切比雪夫函数 $\vartheta(x)$ 与函数 $\Phi(s)$ 之间的关系。对于满足 $\operatorname{Re}(s) > 1$ 的复数 $s$，有：
$$
\Phi(s) = \int_{1}^{\infty} x^{-s} \, d\vartheta(x) = s \int_{1}^{\infty} \vartheta(x)\, x^{-s-1} \, dx = s \int_{0}^{\infty} \vartheta(e^{t})\, e^{-st} \, dt~
$$
Newman 的方法通过研究如下积分是否收敛来证明素数定理（PNT）：
$$
I = \int_{0}^{\infty} \left( \frac{\vartheta(e^{t})}{e^{t}} - 1 \right) \, dt~
$$
若该积分 $I$ 收敛，则意味着被积函数在 $t \to \infty$ 时趋于 0，也就等价于素数定理的陈述。一般来说，不定积分的收敛并不保证被积函数在无穷远处趋于 0，因为其可能震荡。然而，在本例中由于 $\vartheta(x)$ 是单调递增的，因此很容易证明其极限存在。

为了证明 $I$ 收敛，对满足 $\operatorname{Re}(z) > 0$ 的复数 $z$，定义函数：
$$
f(t) = \frac{\vartheta(e^{t})}{e^{t}} - 1~
$$
并定义：
$$
g_T(z) = \int_{0}^{T} f(t)\, e^{-zt} \, dt,\quad\quad g(z) = \int_{0}^{\infty} f(t)\, e^{-zt} \, dt~
$$
则有：
$$
\lim_{T \to \infty} g_T(z) = g(z) = \frac{\Phi(s)}{s} - \frac{1}{s - 1},\quad\quad \text{其中 } z = s - 1~
$$
这个表达式表示的是在直线 $\operatorname{Re}(z) = 0$ 上的一个全纯函数。

要证明积分 $I$ 收敛，即证明素数定理，只需证明：
$$
\lim_{T \to \infty} g_T(0) = g(0)~
$$
这一步涉及到换序极限的问题，即：
$$
\lim_{T \to \infty} \lim_{z \to 0} g_T(z) = \lim_{z \to 0} \lim_{T \to \infty} g_T(z)~
$$
因此，该证明被归类为一种 Tauberian 定理 的应用。

差值 $g(0) - g_T(0)$ 可通过柯西积分公式表示，并通过对被积函数进行估计来证明当 $T$ 足够大时该差值很小。我们固定常数 $R > 0$ 和 $\delta > 0$，使得函数 $g(z)$ 在如下区域中是全纯的：
$$
|z| \leq R \quad \text{且} \quad \operatorname{Re}(z) \geq -\delta~
$$
令 $C$ 表示该区域的边界。由于 $0$ 位于该区域的内部，柯西积分公式可得：
$$
g(0) - g_T(0) = \frac{1}{2\pi i} \int_C \left( g(z) - g_T(z) \right) \frac{dz}{z}~
$$
进一步引入 Newman 提出的一个因子 $F(z)$，得到：
$$
g(0) - g_T(0) = \frac{1}{2\pi i} \int_C \left( g(z) - g_T(z) \right) F(z) \frac{dz}{z}~
$$
其中，
$$
F(z) = e^{zT} \left( 1 + \frac{z^2}{R^2} \right)~
$$
这个因子 $F(z)$ 是整函数，且满足 $F(0) = 1$，因此不会改变该积分的值。

为了估计该积分，将轮廓 $C$ 分成两部分：$C = C_+ + C_-$其中：
$$
C_+ = C \cap \{ z \mid \operatorname{Re}(z) > 0 \}, \quad C_- = C \cap \{ \operatorname{Re}(z) \leq 0 \}~
$$
于是可以将差值表示为：
$$
g(0) - g_T(0) = \int_{C_+} \int_T^\infty H(t, z)\,dt\,dz - \int_{C_-} \int_0^T H(t, z)\,dt\,dz + \int_{C_-} g(z)F(z) \frac{dz}{2\pi i z}~
$$
其中：
$$
H(t, z) = f(t) e^{-tz} F(z)/2\pi i~
$$
由于 $\vartheta(x)/x$ 有界，因而 $f(t)$ 也有界，设 $B$ 是 $|f(t)|$ 的一个上界。

再结合如下估计：
$$
|F(z)| \leq 2 \exp(T \operatorname{Re}(z)) |\operatorname{Re}(z)|/R \quad \text{（当 } |z| = R \text{ 时）}~
$$
可以得出第一个积分的绝对值满足：
$$
\leq \frac{B}{R}~
$$
第二项中沿 $C_-$ 的被积函数是整函数（entire），因此根据柯西积分定理（Cauchy’s integral theorem），我们可以将 $C_-$ 修改为左半平面内的一个半圆，而不改变积分值。和第一个积分类似的估计可得其绝对值也满足：
$$
\leq \frac{B}{R}~
$$
最后，令 $T \to \infty$，由于 $e^{zT} \to 0$（从而 $F(z) \to 0$）在该轮廓上，所以第三个积分趋于 0。

结合这三项可得：
$$
\limsup_{T \to \infty} \left| g(0) - g_T(0) \right| \leq \frac{2B}{R}~
$$
因为这个估计对任意 $R > 0$ 成立，令 $R \to \infty$ 即得：
$$
\lim_{T \to \infty} g_T(0) = g(0)~
$$
从而得到素数定理（PNT）成立。

