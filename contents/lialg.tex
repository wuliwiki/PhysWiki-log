% 合同变换
% license Xiao
% type Tutor

给定域 $\mathbb F$ 上的线性空间 $V$，$f$ 为对称双线性函数：$V\times V\to \mathbb F$，也就是二次型 $q(\bvec{v}),\bvec{v}\in V$。再给定 $V$ 上的一组基 $\{\boldsymbol e_i\}$，则二次型可以表示为：
\begin{equation}
\eta_{ij}=f(\boldsymbol {\mathrm e}_i,\boldsymbol {\mathrm e}_j)~,
\end{equation}
对于$V$的另一组基$\{\boldsymbol \theta_i\}$，二次型可以表示为$\Theta_{ij}=f(\boldsymbol {\mathrm \theta}_{i},\boldsymbol {\mathrm \theta}_{j})$。设过渡矩阵为$T^i_j,\boldsymbol {\theta}_i=T^j_i\boldsymbol e_j$。那么我们可以看到二次型在不同基下的表示是如何通过过渡矩阵联系在一起的：
\begin{equation}
\begin{aligned}
\Theta_{ij}&=f(\boldsymbol {\mathrm \theta}_{i},\boldsymbol {\mathrm \theta}_{j})\\
&=f(T^r_i\boldsymbol e_r,T^s_j\boldsymbol e_s)\\
&=T^r_i \eta_{rs}T^s_j~,
\end{aligned}
\end{equation}
把上式两端的二次型张量写作（1,1）型矩阵，则有：
$$\Theta^i_j=T^i_r\eta^r_sT^s_j~,$$
写成更清楚的矩阵形式，就是我们的合同变换：$\Theta=T^T\eta T$。可见，合同变换的本质是改变二次型的基。
\begin{definition}{矩阵合同变换}
设A,B为n阶矩阵，若存在可逆矩阵C，使得
\begin{equation}
C^TAC=B~,
\end{equation}
则称矩阵$A$与B合同，记作$A\simeq B$
\end{definition}
\begin{exercise}{}
证明合同关系是等价关系。即满足
\begin{enumerate}
\item 反身性  $A\simeq A$
\item 对称性  若$A\simeq B$，则$B\simeq A$
\item 传递性  若$A\simeq B,\quad B\simeq C$，则$A\simeq C$
\end{enumerate}
\end{exercise}
研究任何变换下的不变量是很重要的。相对于相似变换，合同变换的不变量很少，只有秩与惯性指数。
由于矩阵C是可逆的，则左乘的逆矩阵和右乘的矩阵C都可以写作一系列初等矩阵的乘积，所以合同变换只是进行了若干个初等列变换与行变换，因而秩不变。惯性指数不变在惯性定理的证明中得以体现。

在合同变换中，有一条很重要的定理：\textbf{实对称矩阵一定能通过合同变换化为对角矩阵}。也即：实数域上的二次型总有标准形。证明思路如下：
考虑矩阵$A^i_j$，现在要消掉第一行第二列的元素$b$。一共有三种情况：
\begin{enumerate}
\item $b$=0,不需要消除
\item $b$≠0，第一行第一列元素$a$≠0，C为执行$ka+b=0$的初等列变换。合同变换中配对的行变换把其对称元素，即第二行第一列的元素也化为0.
\item $b$≠0，$a$=0，那么第一步合同变换为把第二行的元素加到第一行，把第二列的元素加到第一列，使得$a$≠0，再执行上一步变换。
\end{enumerate}
以第一个对角元为“参考”，用该思路可以消除第一行和第一列的非对角元元素。其他非对角元素的消除同理。

如果只是对角化，那么对角矩阵有很多可能。然而，有一类合同变换十分特殊，是用正交矩阵对A进行合同变换。因此，这也是相似对角化的过程。
\begin{theorem}{}
实对称矩阵$A$总可以用正交矩阵进行合同变换，得到对角矩阵$\opn{diag}(\lambda_1,\lambda_2...\lambda_n)$，各对角元为A的本征值
\end{theorem}  

proof.首先，我们证明n阶实对称矩阵$A$必有n个实本征值。
我们知道，求本征值的过程是在解特征多项式$|A-\lambda E|$。根据代数学基本定理，n次方程在复数域上必有n个根。因此只需要证明实对称矩阵的本征值皆为实数即可。
设$\boldsymbol x$为任意一个本征向量，$\lambda$为其对应的本征值，那么我们有
\begin{equation}
\begin{aligned}
A\boldsymbol x&=\lambda \boldsymbol x\\
(A\boldsymbol x)^{*T}&=\boldsymbol x^{*T}A=\lambda^{*}\boldsymbol x^{*T}\\
\boldsymbol x^{*T}A\boldsymbol x&=\lambda \boldsymbol x^{*T}\boldsymbol x=\lambda^{*}\boldsymbol x^{*T}\boldsymbol x~,
\end{aligned}
\end{equation}
因而实对称矩阵的本征值都是实数。

然后证明，实对称矩阵$A$的不同本征值对应相互正交的本征向量。为了表示方便，以下回归$A$作为对称变换的意义，括号表示内积。设$\boldsymbol x_1,\boldsymbol x_2$为A的两个本征向量，那么我们有
$$(A\boldsymbol {x_1,x_2})=\lambda_1(\boldsymbol {x_1,x_2})=(\boldsymbol x_1,A\boldsymbol x_2)=\lambda_2(\boldsymbol{x_1,x_2})=0~,$$
利用对称性，我们还能得到对称变换的另一性质。
\begin{lemma}{}
如果$W$为对称变换$\sigma$的不变子空间，则其正交补亦是$\sigma$的不变子空间。
\end{lemma}
这意味着对称变换的矩阵形式，即对称矩阵可以分解为不变子空间的直和。从前文我们已知，对称矩阵的不同本征值对应的本征向量是相互正交的。现在我们对本征值进行分类。前i个本征值都只有一个本征向量，由于它们是矩阵$A$的不变子空间，因此直和亦是不变子空间，设为W。拓展前i个正交向量为全空间的标准正交基。由于本征向量本来就相互正交，因而只作归一化即可，归一化后亦是矩阵的不变子空间。在这组基下，线性空间$V=W\oplus W^{\perp}$，矩阵为$\opn{diag}(\lambda_1,\lambda_2...\lambda_i,W^{\perp})$。

重根$(\lambda_{i+1},\lambda_{i+2}...\lambda_k)$分别对应特征子空间$W_{i+1},W_{i+2}...W_k$，它们依然是相互正交的。所以$W_{i+1}\oplus W_{i+2}...\oplus W_k\subset W$为讨论方便，下设实对称矩阵$A$只有一个重根，证明依然能被分解为(n-i)个不变子空间，即$W_{i+1}=W^{\perp}$。
此时我们已经利用标准正交基把矩阵$A$化为$\opn{diag}(\lambda_1,\lambda_2...\lambda_i,W^{\perp})$。设$\lambda_{i+1}$对应若干个本征向量，利用其中一个本征向量，可以进一步分解$W^{\perp}$。由于对称矩阵在合同变换后依然是对称的，所以必能在剩余子空间中找到起码一个本征向量，再分解。重复这个步骤，把对称矩阵对角化。相当于在特征子空间上把本征向量进行施密特正交化。
这个证明也说明，实对称矩阵特征根的代数重数等于几何重数。
证毕。

因此，利用施密特正交化后的本征向量组，我们可以把实对称矩阵化为对角矩阵。可以验证，对角元即对应的本征值。即：如果该标准正交基为$\{\boldsymbol{x_1,x_2,x_3...x_n}\}$，对角化结果$\opn{diag}(\lambda_1,\lambda_2,...\lambda_n)$
