% 常微分方程解的存在、唯一及连续可微定理
% keys 存在|唯一|连续依赖|可微|定理|常微分方程|变分方程
% license Xiao
% type Tutor

\pentry{皮卡映射\upref{PicMap}，基本知识（常微分方程）\upref{ODEPr}}{nod_92f0}
本节证明常微分方程的解的存在、唯一、及对参数连续可微定理。所谓 “解对参数连续可微” 是指微分方程
\begin{equation}\label{eq_ODEUC_2}
\dot x=v(x,t)~,
\end{equation}
 的解 $\varphi$ 也是某些参数 $\mu=(\mu_1,\cdots,\mu_m)$ 的函数，即 $\varphi(\mu,t)$。于是 \autoref{eq_ODEUC_2} 右边也应写成 $v(x,\mu,t)$。 即需要证明形如
\begin{equation}\label{eq_ODEUC_1}
\dot x=v(x,\mu,t)~
\end{equation}
的微分方程解的存在唯一且对参数 $\mu$ 的连续可微定理。然而，可以验证，对\autoref{eq_ODEUC_2} 证明存在唯一性和对初始点解为 $C^r$ 类，等价于证明\autoref{eq_ODEUC_1} 的存在唯一性和对参数 $\mu$ 为 $C^r$ 类。事实上：
若微分方程\autoref{eq_ODEUC_2} 解 $\varphi$ 存在唯一且对初始点 $(t_0,x_0)$ $r$ 次连续可微。记 
\begin{equation}
y=(x,\mu),\quad f=(v_x,v_{\mu})=(v,v_{\mu})~,
\end{equation}
则 \autoref{eq_ODEUC_1} 等价于(初始 $\mu$ 分量为 $\mu$ 的)微分方程
\begin{equation}\label{eq_ODEUC_3}
\begin{aligned}
\dot y=f(y,t)=(v(y,t),0)~.
\end{aligned}
\end{equation}
由假设，\autoref{eq_ODEUC_3} 的解 $\varphi(t)$存在唯一，且 $r$ 次连续可微的依赖于起始点 $(t_0,x_0,\mu)$（即解可写为 $\varphi(x_0,\mu,t_0,t)\equiv\varphi(t)$ 且 $\varphi(x_0,\mu,t_0,t_0)=x_0$），于是解也就 $r$ 阶连续可微的依赖于 $\mu$；
反之，如果对\autoref{eq_ODEUC_1} 的微分方程存在唯一及对参数 $\mu$ $r$ 次连续可微定理成立，则由 $\mu$ 是参数，可令 $v_\mu(x,t)\equiv v(x,\mu,t)$ 则\autoref{eq_ODEUC_1} 等价于
\begin{equation}\label{eq_ODEUC_4} 
\dot x=v_{\mu}(x,t)~.
\end{equation}
由假定，其解存在唯一且对参数 $\mu$ 属于 $C^r$ 类。取参数 $\mu$ 对应起始点 $(t_0,x_0)$ 的情形，于是微分方程\autoref{eq_ODEUC_4} 的解存在唯一且对起始点 $r$ 阶连续可微。

一般的常微分方程都可以写为\autoref{eq_ODEUC_2} 的形式，并通过上面考虑，我们只需要证明对形为\autoref{eq_ODEUC_2} 的微分方程的解存在唯一且连续依赖于起始点即可。

解的可微定理引出一个重要的方法：\textbf{小参数法}（或\textbf{微扰法}）。设想包含小参数 $\epsilon$ 的微分方程 $\dot x=v(x,\epsilon)$，$v$ 对 $\epsilon$ 连续可微，于是解的可微定理使得具有固定初始条件的解可以写成形式
\begin{equation}
x(t)=x_0(t)+\epsilon y(t)+O(\epsilon^2)~.
\end{equation}
其中 $x_0$ 是“未受扰” 方程 $\dot x=v(x,0)$ 的解。

\subsection{存在、唯一及对参数的连续可微定理}
\begin{theorem}{存在、唯一及对参数的连续依赖定理}\label{the_ODEUC_1}
设微分方程
\begin{equation}\label{eq_ODEUC_9}
\dot x=v(x,t)~
\end{equation}
中向量场 $v$ 在扩张相空间（\autoref{def_PSaPF_2}~\upref{PSaPF}）中的一区域 $U$ 上有直到 $r$ 阶连续的导数 $v\in C^r$，则对任一点 $(t_0,x_0)\in U$，存在扩张相空间中点 $(t_0,x_0)$ 的一邻域 $M$，使得任一给定的 $(t_1,x_1)\in M$，都唯一存在满足初始条件 $\varphi(t_1)=x_1$ 的微分方程
\begin{equation}\label{eq_ODEUC_5}
\dot x=v(x,t)~
\end{equation}
的解 $\varphi(t)$ ，而且这个解是依赖于 $x_1,t_1,t$ 的 $C^{r-1}$ 类函数。即若将解 $\varphi$ 写成包含初始点 $(t_1,x_1)$ 的形式 $g(x_1,t_1,t)$，则 $g$ 对变量 $x_1,t_1,t$ 有直到 $r-1$ 阶连续的导数，即 $g\in C^{r-1}$。
\end{theorem}
\textbf{证明（存在唯一和对参数的连续性）：}由\autoref{the_PicMap_2}~\upref{PicMap}，对任一点 $(t_1,x_1)$，都有要求的点 $(t_1,x_1)$ 的领域 $M$（对应 $\abs{x-x_1}\leq b',\abs{t-t_1}\leq a'$）存在，使得 $\forall z\in M$ ，皮卡映射（\autoref{def_PicMap_1}~\upref{PicMap}）
\begin{equation}\label{eq_ODEUC_6}
(A\varphi)(x_1,t_1,t)\equiv x_1+\int_{t_1}^{t}v(\varphi(x_1,t_1,\tau),\tau) \,\mathrm{d}{\tau} ~
\end{equation}
是 $M$ 中的压缩映射（$M$ 的定义见\autoref{the_PicMap_2}~\upref{PicMap}）。由于压缩映射都有不动点（\autoref{the_ConMap_1}~\upref{ConMap}），而皮卡映射\autoref{eq_ODEUC_6} 的不动点 $g(x_1,t_1,t)$ 就是微分方程\autoref{eq_ODEUC_5} 的解（\autoref{the_PicMap_1}~\upref{PicMap}），由 $M$ 的完备性（\autoref{exe_PicMap_1}~\upref{PicMap}），该不动点对应的曲线也在 $M$ 中。而 $M$ 中的曲线都是连续的，故解的存在性和对变量 $(x_1,t_1,t)$ 的连续性得证！

下面证明唯一性：设 $g_1(x_1,t_1,t),g_2(x_1,t_1,t)$ 都是初值条件 $g(x_1,t_1,t_1)=x_1$ 的微分方程\autoref{eq_ODEUC_5} 的解。由于 $g_1,g_2\in M$，所以可对其实行皮卡映射。由于在解存在的区域里皮卡映射是压缩映射，故成立（为何度量变成范数可类比线性算子度量空间\upref{ONorm}，这里 $\norm{g}=\max\limits_{x_1,t_1,t}\abs{g(x_1,t_1,t)}$）
\begin{equation}\label{eq_ODEUC_7}
\norm{A g_1-A g_2}\leq\lambda\norm{g_1-g_2},\quad\lambda<1~.
\end{equation}
由于\autoref{the_PicMap_1}~\upref{PicMap}，$g_1,g_2$ 都是 $A$ 的不动点，故\autoref{eq_ODEUC_7} 变成
\begin{equation}
\norm{g_1-g_2}\leq\lambda\norm{g_1-g_2},\quad\lambda<1~.
\end{equation}
上式只能在 $\norm{g_1-g_2}=0$ 时成立，这意味着唯一性。对 $g\in C^{r-1}$ 单独放在下面进行证明。

\textbf{证毕！}

\subsection{可微性的证明}
对于可微性，我们用数学归纳法进行证明。我们分为三个分定理进行证明。下面将用 $C_{x_1}^r$ 表示关于 ${x_1}$ 是 $C^r$ 类的函数。
\begin{theorem}{}
同\autoref{the_ODEUC_1} 叙述，仅假定 $v\in C^2$，那么 $g\in C_{x_1}^1$.
\end{theorem}
\textbf{证明：}对初始点 $(t_1,x_1)\in M$ 的映射 $g_0(x_1,t_1,t)$ 和初始矩阵为单位矩阵 $\mat E$ 的矩阵映射 $f_0(x_1,t_1,t)$，我们分别用 $g_n,f_n$ 表示其皮卡近似\footnote{对矩阵映射来说，只不过曲线所在空间维度变大了}：
\begin{equation}\label{eq_ODEUC_8}
\begin{aligned}
g_{n+1}(x_1,t_1,t)&=x_1+\int_{t_1}^{t}v(g_n(x_1,t_1,\tau),\tau)\dd\tau,\\
f_{n+1}(x_1,t_1,t)&=\mat E+\int_{t_1}^{t}v_{*}(g_n(x_1,t_1,\tau),\tau)f_n(x_1,t_1,\tau)\dd\tau~.
\end{aligned}
\end{equation}
这里的 $v_{*}$ 表示 $v$ 对其第一个变量 $x$ 的导数。
注意 $(g_{0})_{*}=f_0$，于是由数学归纳法可从\autoref{eq_ODEUC_8} 推得 $(g_{n+1})_{*}=f_{n+1}$。因此，序列 $\{f_n\}$ 是 $\{g_n\}$ 的导数序列。对充分小的 $\abs{t-t_1}$，\autoref{eq_ODEUC_8} 一致收敛（因为皮卡映射的压缩性要求其不动点存在，$f_n$ 的皮卡映射可看出其对应向量场 $v_f(x,y,t)=v(x,t)y$，显然对 $x,y,t$ 连续可微）。因此序列 $\{g_n\}$ 及其关于 $x_1$ 的导数都一致收敛，因此极限函数
\begin{equation}
g(x_1,t_1,t)=\lim_{n\rightarrow\infty}g_n(x_1,t_1,t)~
\end{equation}
关于 $x_1$ 一致可微。实际上，
\begin{equation}\label{eq_ODEUC_10}
\begin{aligned}
f(x_1,t_1,t)&=\lim_{n\rightarrow\infty}g_{n*}(x_1,t_1,t)\\
&=\lim\limits_{n\rightarrow\infty}\lim\limits_{\Delta x_1\rightarrow0}\frac{g_{n}(x_1+\Delta x_1,t_1,t)-g_{n}(x_1,t_1,t)}{\Delta x_1}\\
&=\lim\limits_{\Delta x_1\rightarrow0}\lim\limits_{n\rightarrow\infty}\frac{g_{n}(x_1+\Delta x_1,t_1,t)-g_{n}(x_1,t_1,t)}{\Delta x_1}\\
&=\lim\limits_{\Delta x_1\rightarrow0}\frac{g(x_1+\Delta x_1,t_1,t)-g(x_1,t_1,t)}{\Delta x_1}\\
&=g_*(x_1,t_1,t)~.
\end{aligned}
\end{equation}
\textbf{证毕！}

注意\autoref{eq_ODEUC_8} 第二式表明其对应微分方程为
\begin{equation}\label{eq_ODEUC_11}
\dot y=v_*(x,t)y,\quad y\in TU_x~.
\end{equation}
其和\autoref{eq_ODEUC_9} 一起称为关于微分方程\autoref{eq_ODEUC_9} 的\textbf{变分方程}。于是\autoref{eq_ODEUC_10} 表明方程\autoref{eq_ODEUC_9} 的解关于初始条件 $x_1$ 的导数 $g_*$ 是满足初始条件 $y(t_1)=E$ 的\autoref{eq_ODEUC_11} 的解。
这就证得下面的定理
\begin{theorem}{}
微分方程
\begin{equation}
\dot x=v(x,t)~
\end{equation}
 具有初始点 $(t_1,x_1)$ 的解关于初始条件 $x_1$ 的导数 $g_*$ 是其满足初始点 $(t_1,E)$ 的变分方程的解：
 \begin{equation}
 \begin{aligned}
 &\pdv{}{t}g(x_1,t_1,t)=v(g(x_1,t_1,t),t),\\
 &\pdv{}{t}g_*(x_1,t_1,t)=v_*(g(x_1,t_1,t),t)g_*(x_1,t_1,t),\\
 &g(x_1,t_1,t_1)=x_1,\quad g_*(x_1,t_1,t_1)=E~.
 \end{aligned}
 \end{equation}
\end{theorem}
\begin{theorem}{}
同\autoref{the_ODEUC_1} 叙述，当 $v\in C^r$($r\geq2$)，则 $g\in C_{x_1}^{r-1}$。
\end{theorem}
\textbf{证明：} 假设对定理对 $<r$ 成立。则
\begin{equation}
 v\in C^r\Rightarrow v_*\in C^{r-1}\Rightarrow v_y(x,t,y)=v_*(x,t)y\in C^{r-1}\Rightarrow g_*\in C_{x_1}^{r-2}\Rightarrow g\in C_{x_1}^{r-1}~.
\end{equation}

\textbf{证毕！}
\begin{lemma}{}\label{lem_ODEUC_1}
设 $f:G\times I^2\rightarrow \mathbb R^n$ 是欧氏空间区域 $G$ 和 $t$ 轴区间直积 $I^2$ 的直积到 $\mathbb R^n$ 的映射。若 $f\in C_{x_1}^r \cap C^{r-1}$，则积分函数
\begin{equation}
F(x_1,t_1,t)=\int_{t_1}^t f(x_1,t_1,\tau)\dd\tau~,
\end{equation}
是 $C^r$ 类的。
\end{lemma}
\textbf{证明：}因为 $f\in C_{x_1}^r\cap C^{r-1}\Rightarrow F\in C_{x_1}^r\cap C_t^{r}\cap C_{t_1}^{r}$ ，所以 $F$ 对 $x_1$ （或 $t$ 或 $t_1$） 的 $r$ 阶偏导存在。剩下只需证明任意的 $r$ 阶混合导都存在，若先对 $t$ （或 $t_1$）求偏导，则 $\pdv{F(x_1,t_1,t)}{t}=f(x_1,t_1,t)$（或 $\pdv{F(x_1,t_1,t)}{t_1}=-f(x_1,t_1,t)$），由于 $f\in C^{r-1}$，所以剩下 $r-1$ 次混合导都存在；若先对 $x_1$ 求偏导，且第 1 次对$t$ (或 $t_1$)求偏导在第 $i$ 次，那么由
\begin{equation}
\begin{aligned}
f\in C^{r-1}\Rightarrow\pdv[i-1]{}{x_1}\pdv{F(x_1,t_1,t)}{t}=\pdv[i-1]{f(x_1,t_1,t)}{x_1}\in C^{r-i} \\
\qty(f\in C^{r-1}\Rightarrow\pdv[i-1]{}{x_1}\pdv{F(x_1,t_1,t)}{t_1}=-\pdv[i-1]{f(x_1,t_1,t)}{x_1}\in C^{r-i} )~.
\end{aligned}
\end{equation}
于是剩余的 $r-i$ 次混合偏导存在且连续。

\textbf{证毕！}
\begin{theorem}{}\label{the_ODEUC_2}
同\autoref{the_ODEUC_1} 叙述，若 $v\in C^r $，则 $g\in C^{r-1}$。
\end{theorem}
\textbf{证明：}由于解是对应的皮卡映射的不动点，于是
\begin{equation}
g(x_1,t_1,t)=x+\int_{t_1}^tv(g(x_1,t_1,\tau),\tau)\dd\tau~.
\end{equation}
由 $\pdv{v}{x_1}=\pdv{v}{x_1}\pdv{g}{x_1}$ 知 $\pdv{v}{x_1}$ 关于 $x_1$ 的阶数为 $\pdv{v}{x_1}$ 和 $\pdv{g}{x_1}$ 关于 $x_1$ 的阶数最小的那个。所以若 $g$ 关于 $x_1$ 阶数小于 $r$，则 $v$ 关于 $x_1$ 的阶数 和 $g$ 一致。于是由  \autoref{lem_ODEUC_1} 
\begin{equation} 
g\in C^{i-1}\cap C_x^{i}\Rightarrow g\in C^i,\quad i<r~.
\end{equation}
由\autoref{the_ODEUC_2} ， $g\in C_{x_1}^s,\quad s<r$。于是
\begin{equation}
g\in C^0\Rightarrow g\in C^1\Rightarrow\cdots\Rightarrow g\in C^{r-1}~.
\end{equation}
由已经证明的解 $g$ 连续依赖于其变量，即 $g\in C^0$ 成立，上式立刻得到 $g\in C^{r-1}$。

\textbf{证毕！}