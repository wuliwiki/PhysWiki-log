% 张量积空间的算符

\begin{issues}
\issueDraft
\end{issues}

\pentry{张量积空间\upref{DirPro}}

\subsection{算符}
两个低维空间的线性算符 $\Q A$ 和 $ \Q B$ 做张量积可以得到张量积空间中的算符 $\Q A \otimes \Q B$。 我们定义 $\Q A \otimes \Q B$ 为线性算符， 该算符对任意基底的作用结果为
\begin{equation}
\Q A \otimes \Q B \ket{u_i, v_j} = (\Q A \ket{u_i}) \otimes (\Q B \ket{v_j})~,
\end{equation}
要对任意矢量作用， 只需将矢量记为张量积空间基底的线性组合， 然后再分别对张量积基底作用即可。

特殊地， 可以用 $\Q A \otimes \Q I$ 运算将 $\{\ket{u_i}\}$  空间中的 $\Q A$ 拓展到张量积空间中来
\begin{equation}
\Q A \otimes \Q I \ket{u_i, v_j} = (\Q A \ket{u_i}) \otimes \ket{v_j}~.
\end{equation}
这说明算符 $\Q A \otimes \Q I$ 在每个 $v$ 子空间中都是闭合的。 所以， 算符 $\Q A \otimes \Q I$ 作用在张量积空间的任意矢量上， 相当于 $\Q A \otimes \Q I$ 对该矢量在各个子空间中的分量分别作用。 $\Q B$ 也同理，不再赘述。 根据定义， 不难证明
\begin{equation}
(\Q A \otimes \Q I)(\Q I \otimes \Q B) = (\Q I \otimes \Q B)(\Q A \otimes \Q I) = \Q A \otimes \Q B~.
\end{equation}

和矢量空间一样， 线性算符空间中也不是任何算符都能表示为两个算符的张量积。

\subsubsection{二维矩阵}
若张量积空间中的基底正交归一， 则张量积算符矩阵元为
\begin{equation}\ali{
(\Q A \otimes \Q B)_{\alpha,\alpha'} &= (\Q A \otimes \Q B)_{i,j,i',j'} = \bra{u_{i} v_{j}} \Q A \otimes \Q B \ket{u_{i'} v_{j'}}\\
&= \bra{u_{i} v_{j}} (\Q A \ket{u_{i'}} \otimes \Q B \ket{v_{j'}})
= \bra{u_i} \Q A \ket{u_{i'}} \bra{v_j} \Q B \ket{v_{j'}}~.
}\end{equation}

注意矩阵元的位置与基底的排序有关， 如果按照\autoref{eq_DirPro_4}~\upref{DirPro} 排序， 则每个 $u$ 子空间的基底都在一起。 现在用分块矩阵的概念， 若把矢量根据 $u$ 子空间分成一段段， 每一段是 $u$ 子空间中分量的系数， 矩阵也会分成一些正方形的小块， 第 $(m, n)$ 小块中为
\begin{equation}
A_{mn} \mat B~,
\end{equation}
所以， $\Q A \otimes \Q B$ 的矩阵是把 $\mat A$ 的每个矩阵元 $A_{mn}$ 拓展成矩阵分块 $A_{mn} \mat B$。

同理， 若基底以\autoref{eq_DirPro_5}~\upref{DirPro} 排序， 即每个 $v$ 子空间的基底都在一起， 则  $\Q A \otimes \Q B$ 的矩阵就是把 $\mat B$ 的每个矩阵元 $B_{mn}$ 拓展成矩阵分块 $B_{mn} \mat A$。 

任何线性算符都可以表示为算符张量的线性组合， 所以一般的算符仍然可以表示为分块矩阵， 但每个分块未必成比例。

\subsubsection{四维张量}
将直积空间基底排序的做法丧失了两个空间基底的对称性。 我们可以将张量积空间中矢量 $\ket{c}$ 的坐标 $C_{i,j}$ 写成矩阵的形式（注意概念上这仍然是一个矢量而不表示线性映射）。矩阵的第 $i$ 行就是 $\ket{u_i}$ 子空间分量的坐标， 第 $j$ 列就是 $\ket{v_j}$ 子空间分量的坐标。

$\Q A \otimes \Q B$ 作用在该矩阵上， 就相当于用矩阵 $\mat A$ 处理每一列（矩阵 $\mat C$ 的行变换）， 再用矩阵 $\mat B$ 处理每一行（矩阵 $\mat C$ 的列变换）， 也可以是先列变换再行变换。
\begin{equation}
\sum_{j'} B_{jj'} \qty(\sum_{i'} A_{ii'} C_{i'j'})
= \sum_{i'} A_{ii'} \qty(\sum_{j'}B_{jj'} C_{i'j'})~.
\end{equation}
如果 $\mat A$ 或 $\mat B$ 是对角的， 那么分别只需要把矩阵的每一行或每一列的系数乘以对角元， 再分别使用矩阵 $\mat B$ 或 $\mat A$ 作用即可。 这就相当于对每个子空间中的分量独立作用。

我们可以用四维张量来表示这个算符， 令算符 $T = A\otimes B$， 则 $T_{i,j,i'j'} = A_{i,i'} B_{j, j'}$， 那么算符与矢量的乘法为
\begin{equation}
(T \ket{c})_{i,j} = \sum_{i',j'} T_{i,j,i'j'} C_{i',j'}~,
\end{equation}
一般的线性算符也都可以用四维张量表示。

\subsection{多重张量积}
例如三个空间中的矢量 $\ket{a}$， $\ket{b}$， $\ket{c}$ 的张量积为 $\ket{a}\ket{b}\ket{c}$， 可以表示为三维矩阵。 算符可以表示为 $2\times3 = 6$ 维张量。 算符作用在矢量就是
\begin{equation}
y_{i,j,k} = \sum_{i',j',k'} Q_{i,j,k,i',j',k'} x_{i',j',k'}~.
\end{equation}
其他运算也都可以类比。

\subsection{部分内积}
\footnote{这个运算并不是标准运算而是本部分的一个定义}如果我们定义两矢量的张量积与 $u$ 空间中的矢量的\textbf{部分内积}运算为
\begin{equation}
\bra{u_1}(\ket{u}\ket{v}) = \braket{u_1}{u}\ket{v}~,
\end{equation}
且该运算是线性的， 那么 $u$ 空间中的任意矢量乘以张量积空间中任意矢量的运算为
\begin{equation}
\ali{
\qty(\sum_k x_k \bra{u_k})\qty(\sum_{i,j} C_{ij}\ket{u_i}\ket{v_j})
&= \sum_{i,j} C_{ij} \qty(\sum_k  x_k \braket{u_k}{u_i})\ket{v_j}\\
&=\sum_j \qty(\sum_i x_i C_{ij}) \ket{v_j}~,
}\end{equation}
即对每个 $\ket{v_j}$ 子空间中的分量分别做内积， 得到 $v$ 空间的矢量。

同理， 也可以定义 $v$ 空间的部分内积
\begin{equation}
\bra{v_1}(\ket{u}\ket{v}) = (\braket{v_1}{v}) \ket{u}~,
\end{equation}
那么 $v$ 空间中的任意左矢 $\bra{v_1}$ 乘以任意张量积空间的矢量等于将每个 $\ket{u_j}$ 子空间中的分量分别与 $\bra{v_1}$ 内积， 得到 $u$ 空间的矢量。

\subsection{部分矩阵元}
先定义算符的\textbf{部分运算为} $(\Q A \otimes \Q B) \ket{b_j} = (\Q A\ket{\cdot}) \otimes (\Q B \ket{b_j})$， 这是一个 $a$ 空间的算符作用在某个 $a$ 空间矢量后再与 $\ket{b}$ 做张量积的运算。

定义\textbf{部分矩阵元}如 $\mel{b_i}{\Q A \otimes \Q B}{b_j} = \mel{b_i}{\Q B}{b_j} \Q A$ 是 $a$ 空间的算符。 所以 $\Q A \otimes \Q B$ 作用在任意矢量上， 就相当于先把 $\Q A$ 作用在每个 $\ket{b_j}$ 子空间的分量上， 再将这些子空间根据矩阵 $\mel{b_i}{\Q B}{b_j}$ 进行线性变换。 特殊地， 如果 $\mel{b_i}{\Q B}{b_j}$ 是对角矩阵， 那么只需要把 $\Q A$ 作用在每个 $\ket{b_j}$ 子空间的分量上再乘以对角矩阵元 $\mel{b_j}{\Q B}{b_j}$ 即可。

$\mel{a_i}{\Q A \otimes \Q B}{a_j} = \mel{a_i}{\Q A}{a_j} \Q B$ 的讨论同理。

\subsection{其他笔记}

\subsubsection{关于本征问题的定理}%（证明未完成）

\begin{itemize}
\item 如果考虑张量积空间中的本征问题， $\Q A$  的本征矢 $\ket{eig_i}$ 具有 $n$ 重简并， 简并空间的基底分别为 $\ket{eig_i}\ket{v_1}, \ket{eig_i}\ket{v_2}\dots$。 

\item $\Q A \otimes \Q B$ 的本征值共有 $m \times n$ 个， $m$ 和 $n$ 分别是 $A$ 和 $B$ 的维度， 若 $a_1, a_2,\dots, a_m$ 和 $b_1, b_2, \dots, b_n$ 分别是 $A$ 和 $B$ 的本征值， 那么 $A \otimes B$ 的本征值和本征矢分别为 $a_i b_j$ 和 $\ket{u_i, v_j}$ （$0 \leqslant i \leqslant m,  0 \leqslant j \leqslant n$）。

\item $A \otimes I + I \otimes B$ 的本征值和本征矢分别为 $a_i + b_j$ 和 $\ket{u_i, v_j}$。

\item 两个厄米矩阵张量积仍然是厄米矩阵。

\item 两个厄米矩阵相加仍然是厄米矩阵。
\end{itemize}

\subsubsection{算符的展开}
另外， 量子力学中的算符（我见过的）都可以表示为两个小空间中的算符的张量积的线性组合
\begin{equation}
\Omega = \sum_k A_k \otimes B_k~.
\end{equation}
例如中心力场中的单电子哈密顿算符
\begin{equation}
H = K_r + \frac{L^2}{2mr^2} + V(r) - q\bvec{\mathcal{E}} \vdot \bvec r~.
\end{equation}
其中 $K_r, V(r)$ 就是 $R$ 空间的算符与 $Y$ 空间的单位算符的张量积， $L^2$ 算符（\autoref{eq_RadSE_3}~\upref{RadSE}） 是 $R$ 空间中的单位算符与 $Y$ 空间中算符的张量积。 而最后一项没有微分算符， 只是一个函数， 这个行数同样也可以展开为张量积空间中的基底的线性组合， 即两空间中的算符的张量积的线性组合。

一种简单的证明方法是，例如 2 乘 2 的矩阵 $\mat A$ 与 2 乘 2 的矩阵 $\mat B$ 直积， 就是把 $\mat A$ 的每个矩阵元乘以 $\mat B$ 变为一个 4 乘 4 的矩阵。 要得分解任意 4 乘 4 的矩阵， 我们只需要取 $\mat A_i$ 分别为一组矩阵基底 $[1, 0; 0, 0]$， $[0, 1; 0, 0]$， $[0, 0; 1, 0]$， $[0, 0; 0, 1]$， 然后再令 $\mat B_i$ 为每个子矩阵即可。

\subsubsection{单空间的基底展开}
张量积空间中的任意矢量可以只在一个小空间的基底上展开， 例如波函数可以看做径向波函数空间和角向波函数空间的张量积。 波函数可以只在角向波函数空间中的基底——球谐函数上展开
\begin{equation}
\ket{\Psi} = \sum_j \ket{R_j}\ket{Y_j}~,
\end{equation}
其中 $j$ 代表 $l, m$ 组合的某种排序。

如果我们在一个小空间中使用基底， 而另一个空间中不用。 例如 $Y$ 空间中我们用球谐函数作为基底， 可以得到一个“算符矩阵”， 即每个矩阵元为 $R$ 空间的算符。 例如薛定谔方程
\begin{equation}
H \ket{\Psi} = \I \pdv{t}  \ket{\Psi}~,
\end{equation}
使用了 $Y$ 空间的基底后可以表示为
\begin{equation}
H \sum_j \ket{R_j}\ket{Y_j} =  \I  \sum_j\pdv{t}  \ket{R_j}\ket{Y_j}~,
\end{equation}
左乘 $\bra{Y_i}$ 变为
\begin{equation}
\sum_j \mel{Y_i}{H}{Y_j} \ket{R_j} =  \I  \pdv{t}  \ket{R_i}
\quad\Rightarrow\quad
\sum_j H_{ij} \ket{R_j} =  \I  \pdv{t}  \ket{R_i}~,
\end{equation}
其中每个 $H_{ij}$ 都是 $R$ 空间的算符。

从这里我们总结出， 张量积空间中的矢量可以展开为一个小空间中的 $N$ 个矢量分别与另一个小空间中的 $N$ 个基底的张量积。 所谓的“坐标” 就是第一个小空间中的 $N$ 个矢量排成的“列矢量”。 张量积空间中的矢量左乘一个小空间中的矢量可以得到另一个小空间中的矢量。 张量积空间的算符分别左乘右乘一个小空间中的正交归一基底可以得到另一个小空间中的算符。

另一个例子是多通道散射问题（见小时物理笔记）。 就是将总波函数看做是某个变量 $R$ （例如某个电子和质心的距离） 的空间与剩下所有自由度的空间的张量积。 每个 channel 就对应剩下所有自由与的空间中的一个基底， 系数就是 $R$ 空间中的一个径向波函数 $\psi_i$。 如果有 $N$ 个通道， 就可以得到 $N$ 个 $\psi_i$ 的 coupled equation， 其实就是矩阵形式的薛定谔方程。

另外， 参考一下 wikipedia 的 tensor product 页面吧。
