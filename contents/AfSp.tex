% 仿射空间
% 仿射空间|坐标架


\pentry{矢量空间\upref{LSpace}}
在任一矢量空间 $V$ 中，与零矢量 $0$ 结合在一起的坐标原点总是起着特殊的作用，因为在空间 $V$ 的所有到其自身的线性双射 $f:V\rightarrow V$ 下（这样的映射也称作矢量空间的\textbf{自同构映射}），零矢量 $0$ 是不变的（\autoref{LinMap_cor1}~\upref{LinMap}），这意味着坐标原点具有突出于其它空间点的性质。然而，对身处3维空间中的我们来说，放置在不同位置的点线面显然不依赖于一个挑选出来的坐标原点。因此，为了满足我们的需求，我们希望把矢量空间的自同构群加以扩展，使得所有的空间点都等价。完成这一任务的属于\textbf{仿射空间}。
\subsection{仿射空间}\label{AfSp_sub1}
仿射空间的定义是基于矢量空间\upref{LSpace}的。
\begin{definition}{仿射空间}\label{AfSp_def1}
设 $V$ 是域 $\mathbb F$ 上的矢量空间。且 $\mathbb A$ 是一个集合，其元素称作\textbf{点}，并用 $\dot{p},\dot{q},\dot{r},\cdots$ 表示。称 $\mathbb A$ （或$(\mathbb A,V)$）是和 $V$ \textbf{相伴（连带的）的仿射空间}，若给定笛卡尔积 $\mathbb A\times V$ 到 $\mathbb A$ 的映射（记该映射的像 $f(\dot p,v)$ 为 $\dot p+v$）：
\begin{equation}
f:(\dot p,v)\mapsto\dot p+v
\end{equation}
其具有性质：
\begin{enumerate}
\item \begin{equation}
\forall \dot p\in\mathbb A,\qquad
\forall u,v\in V\Rightarrow\dot p+0=\dot p, \qquad
(\dot p+u)+v=\dot p+(u+v)
\end{equation}
其中，0是空间 $V$ 的零矢量；
\item $\forall \dot p,\dot q\in\mathbb A$，有且仅有一个矢量 $v\in V$ 使得 $\dot p+v=\dot q$。 通常用 $\overrightarrow{pq}$ 或 $\dot q-\dot p$ 代表矢量 $v$。
\end{enumerate}
并把 $V$ 的维数 $n$ 称为 $\mathbb A$ 的\textbf{维数}，有时记成 $\mathbb A^n$。
\end{definition}
在定义中，用了 $\dot p+v$，这和矢量空间中的 $u+v$ 的＋号一样，但这并不会引起混淆。因为，一个是 $\mathbb A$ 中的点和 $V$ 中矢量的相作用，一个是 $V$ 中的两矢量相作用，当写出表达式时，“+” 两边的对象是已知的，就能立刻知道是哪种情况。

由仿射空间的定义，可推出下面两个性质（留做习题）：
\begin{enumerate}
\item 每个点 $\dot p\in \mathbb A$ 都对应一个从 $V$ 到 $\mathbb A$ 的双射：
\begin{equation}\label{AfSp_eq4}
v\mapsto \dot p+v
\end{equation}

\item 有 $\mathbb A\rightarrow\mathbb A$ 上的双射：
\begin{equation}\label{AfSp_eq3}
t_v:\dot p\mapsto\dot p+v
\end{equation}
 称其为用矢量 \textbf{$v$ 平移 $\mathbb A$}（或平行移动 $\mathbb A$）。由定义中的1，2，有
 \begin{equation}
 t_u\cdot t_v=t_{u+v},\quad t_v\cdot t_{-v}=e
 \end{equation}
  其中 $e=t_0$ 是恒等映射。显然所有的平移构成一个群\upref{Group}。
\end{enumerate}
\begin{definition}{平移空间}
令
\begin{equation}
\alpha t_u+\beta t_v:= t_{\alpha u+\beta v}
\end{equation}
则所有平移的集合构成一个矢量空间，称为\textbf{平移空间}，记作 $\mathbb A^{\#}$.
\end{definition}
\begin{example}{}
由仿射空间的定义，试证明：
\begin{equation}
\overrightarrow{pq}+\overrightarrow{qr}=\overrightarrow{pr},\quad \overrightarrow{pq}=-\overrightarrow{qp},\quad\overrightarrow{pp}=0
\end{equation}
亦即
\begin{equation}
(\dot q-\dot p )+(\dot r-\dot q)=\dot r-\dot p,\quad(\dot q-\dot p)=-(\dot p-\dot q),\quad\dot p-\dot p=0
\end{equation}
\end{example}

\begin{exercise}{}\label{AfSp_exe1}
试证明：平移空间 $\mathbb A^{\#}$ 同构于矢量空间 $V$ 的加法群。
\end{exercise}
\subsection{仿射空间的同构}
仿射空间的同构和一般的同构定义实质上相同，都是起说明两个集合结构相同的作用，即集合上元素之间运算，对应于另一集合对应元素之间的运算，这个“对应”是靠双射来完成的。
\begin{definition}{仿射映射，同构}\label{AfSp_def2}
设 $\mathbb A,\mathbb A'$ 是同一域 $\mathbb F$ 上分别与矢量空间 $V,V'$ 相伴随的仿射空间。称映射 
\begin{equation}
f:\mathbb A\rightarrow\mathbb A' 
\end{equation}
是个\textbf{仿射映射}(或\textbf{线性仿射映射})，如果，所有的 $\dot p\in \mathbb A,v\in V$ 都满足
\begin{equation}
f(\dot p+v)=f(\dot p)+Df\cdot v
\end{equation}
 其中，$Df:V\rightarrow V'$ 是矢量空间上的线性映射，称 $Df$ 是映射 $f$ 的\textbf{线性部分}（或\textbf{微分}）。若仿射映射 $f$ 为双射，则称 $\mathbb A$ 和 $\mathbb A'$ 是\textbf{同构的}，若此外 $\mathbb A=\mathbb A'$ ，则称 $\mathbb A$ 借助 $f$ 实现\textbf{自同构}。
\end{definition}

\begin{theorem}{}\label{AfSp_the1}
仿射映射
\begin{equation}
f:\mathbb A\rightarrow\mathbb A' 
\end{equation}
是双射，当且仅当线性部分
\begin{equation}
Df:V\rightarrow V'
\end{equation}
是双射
\end{theorem}
\textbf{证明：}
\begin{enumerate}
\item $f\Rightarrow Df$\\

因为 $f$ 是双射，所以对 $v_1\neq v_2\Rightarrow \dot p+v_1\neq\dot p+v_2$，有
\begin{equation}
\begin{aligned}
f(\dot p)+Df\cdot v_1=f(\dot p+v_1)&\neq f(\dot p+v_2)=f(\dot p)+Df\cdot v_2\\
&\Downarrow\\
Df\cdot v_1&\neq Df\cdot v_2
\end{aligned}
\end{equation}
这就证明了 $Df$ 的单射性。  $\forall  v'\in V'$，对 $\forall f(\dot p)+v'$, $f$ 双射意味着 $\exists v$，使得 
\begin{equation}
f(\dot p)+v'=f(\dot p+v)=f(\dot p)+Df\cdot v
\end{equation}
即 $v'=Df\cdot v$，这就证明了满射性。于是 $Df$ 双射得证。
\item $Df\Rightarrow f$\\
设 $\dot p\neq \dot q$，固定一点 $\dot o\in \mathbb A$，由仿射空间性质，$\exists \overrightarrow{op}\neq\overrightarrow{oq}\in V$，使得 
\begin{equation}
\dot p=\dot o+\overrightarrow{op},\quad\dot q=\dot o+\overrightarrow{oq} 
\end{equation}
由 $Df$ 的单射性
\begin{equation}
\begin{aligned}
Df\cdot \overrightarrow{op}&\neq Df\cdot \overrightarrow{oq}\\
&\Downarrow\\
f(\dot p)=f(\dot o)+Df\cdot \overrightarrow{op}&\neq f(\dot o)+Df\cdot \overrightarrow{oq}=f(\dot q)
\end{aligned}
\end{equation}
即有 $f(\dot p)\neq f(\dot q)$，这就证明了 $f$ 的单射性。\\

$\forall \dot p'\in\mathbb A'$，同样 $\exists\overrightarrow{o'p'}\in V'$ 使得 $\dot p'=o'+\overrightarrow{o'p'}$，其中 $\dot o'=f(\dot o)$，由 $Df$ 的满射性，
\begin{equation}
\exists v\in V,\quad st.\; Df\cdot v=\overrightarrow{o'p'}
\end{equation}
于是
\begin{equation}
f(\dot o+v)=f(\dot o)+Df\cdot v=\dot o'+\overrightarrow{o'p'}=\dot p'
\end{equation}
这就证明了满射性。
\end{enumerate}
\textbf{证毕！}

\begin{corollary}{}
具有相同维数的仿射空间 $(\mathbb A,V),(\mathbb A',V')$ 必同构。
\end{corollary}
\textbf{证明：} 由于维数相同的矢量空间必同构，所以存在双射 $F:V\rightarrow V'$ ，令其作为 $Df$ ，由\autoref{AfSp_the1} ，即\textbf{得证!}
\begin{theorem}{}
任意仿射变换 $f:\mathbb E\rightarrow\mathbb E$ ，设其线性部分为 $\mathcal F$，则必有
\begin{equation}
f=t_a g
\end{equation}
其中 $t_a$ 是矢量 $a=\overrightarrow{of(o)}$ 对应的平移，$g$ 是一个在给定点 $\dot o$ 处保持不动的仿射变换。

现在，若将固定点改为 $\dot o'$ ，那么需取 $a'=a+(\mathcal F-\mathcal E)\overrightarrow{oo'}$ 来代替 $a$。
\end{theorem}

\textbf{证明：} 设 $V$ 是与空间 $\mathbb E$ 伴随的矢量空间，则 $\forall v\in V$ ，有
\begin{equation}\label{AfSp_eq1}
f(\dot o+v)=f(\dot o)+\mathcal F v=\dot o+\overrightarrow{of(o)}+\mathcal F v
\end{equation}
若令
\begin{equation}
g(\dot o+v)=\dot o+\mathcal F v,\quad a=\overrightarrow{of(o)}
\end{equation}
则\autoref{AfSp_eq1} 可写为
\begin{equation}
f(\dot o+v)=g(\dot o+v)+a=t_a g(\dot o+v)
\end{equation}
由于 $v$ 的任意性，故 $f=t_ag$。由，$g$ 显然对 $\dot o$ 不变。

当用固定点取 $\dot o'$，显然 $\overrightarrow{of(o)}$ 需用 $\overrightarrow{o'f(o')}$ 替换，而
\begin{equation}
\begin{aligned}
f(\dot o')=f(\dot o)+\mathcal F \overrightarrow{oo'}\quad\Rightarrow \quad \dot o'+\overrightarrow{o'f(o')}&=\dot o+\overrightarrow{of(o)}+\mathcal F \overrightarrow{oo'}\\
&\Downarrow\\
\overrightarrow{o'f(o')}&=\overrightarrow{of(o)}+(\mathcal F-\mathcal E)\overrightarrow{oo'}
\end{aligned}
\end{equation}
注意 $a=\overrightarrow{of(o)}$，并令 $a'=o'f(o')$ ，即得 $a'=a+(\mathcal F-\mathcal E)\overrightarrow{oo'}$。

\textbf{证毕！}
\subsection{坐标}
\begin{definition}{坐标系（坐标架）}
称点 $\dot o\in\mathbb A$ 和 $V$ 的一个基底 $\{e_1,\cdots,e_n\}$ 的集合 $\{\dot o;e_1,\cdots,e_n\}$ 是 $n$ 维仿射空间 $(\mathbb A,V)$ 的一个\textbf{坐标系}（或\textbf{坐标架}）。矢量 $\overrightarrow{op}$ 在基底 ${e_i}$ 下
\begin{equation}
\overrightarrow{op}=\sum_{i=1}^n x_ie_i
\end{equation}
的坐标就被认为是点 $\dot p$ 在坐标系 $\{\dot o;e_1,\cdots,e_n\}$ 之下的\textbf{坐标}。
\end{definition}
坐标系同样也可以用这样的 $n+1$ 个点 $\{\dot p_0;\dot p_1,\cdots,\dot p_n\}$ 给出，只要矢量 $\overrightarrow{p_0p_1},\cdots,\overrightarrow{p_0p_n}$ 构成空间 $V$ 的一个基底即可。
\begin{theorem}{}\label{AfSp_the2}
设 $\{\dot p_0;\dot p_1,\cdots,\dot p_n\}$ 是空间 $V$ 的一个坐标系：
\begin{equation}
e_i:=\overrightarrow{p_0 p_i},\quad i=1,\cdots,n
\end{equation}
若 $\dot p,\dot q$ 在此坐标系中的坐标分别为 $x_1,\cdots,x_n$ 和 $y_1,\cdots,y_n$ ，那么：
\begin{enumerate}
\item 矢量 $\overrightarrow{pq}$ 在此基底之下的坐标为 $y_1-x_1,\cdots,y_n-x_n$;
\item 对任意矢量 $a=\sum\limits_{i=1}^n a_ie_i$ ，点 $\dot p+a$ 的坐标是 $x_1+a_1,\cdots,x_n+a_n$。
\end{enumerate}
\end{theorem} 
\textbf{证明：} 由 ：
\begin{equation}\label{AfSp_eq2}
\overrightarrow{pq}=\overrightarrow{pp_0}+\overrightarrow{p_0q}=\overrightarrow{p_0q}-\overrightarrow{p_0p}
\end{equation}
由矢量加法定义，即证得定理中的1.

设 $\dot q=\dot p+a$，于是 $a=\overrightarrow{pq}$，结合\autoref{AfSp_eq2} ，有
\begin{equation}
a=\overrightarrow{p_0q}-\overrightarrow{p_0p}\Rightarrow \overrightarrow{p_0q}=a+\overrightarrow{p_0p}
\end{equation}
由矢量加法和点的坐标定义，即证得定理中的2.

\textbf{证毕！}
\subsubsection{不同坐标系下坐标的转换关系}
\begin{theorem}{}\label{AfSp_the3}
设 $\{\dot o;e_1,\cdots,e_n\},\{\dot o';e'_1,\cdots,e'_n\}$ 是仿射空间 $\mathbb A$ 中的两个坐标系。 $\dot p,\dot o'$ 在前一坐标系下的坐标分别为 $x_1,\cdots,x_n$ 和$b_1,\cdots,b_n$。则 $\dot p$ 在后一坐标系下的坐标 $x_i'$ 满足
\begin{equation}
\bvec x'=\mat A^{-1}\bvec x-\mat A^{-1}\bvec b
\end{equation}
 其中，$\mat A$ 是前一坐标系到后一坐标系的转换矩阵。
 \begin{equation}
 \bvec x=(x_1,\cdots,x_n)^T,\;\bvec x'=(x_1',\cdots,x_n')^T,\;\bvec b=(b_1,\cdots,b_n)^T
 \end{equation}
 
\end{theorem}
\textbf{证明：}由
\begin{equation}
\begin{aligned}
\sum_{i}x_ie_i&=\overrightarrow{op}=\overrightarrow{oo'}-\overrightarrow{po'}=\sum_{i}b_ie_i+\sum_{j}x'_je'_j\\
&=\sum_i b_ie_i+\sum_{j}x'_j\sum_{i}a_{ij}e_i\\
&=\sum_{i}\qty(\sum_{j}a_{ij}x_j'+b_i)e_i
\end{aligned}
\end{equation}
其中 $a_{ij}$ 是 $\mat A$ 的矩阵元。上式翻译成矩阵语言就是：
\begin{equation}
\bvec x=\mat A\bvec x'+\bvec b
\end{equation}
由于 $\mat A$ 必定可逆，则
\begin{equation}
\bvec x'=\mat A^{-1}\bvec x-\mat A^{-1}\bvec b
\end{equation}
\textbf{证毕！}

