% 方势垒
% keys 势垒|散射|波函数|薛定谔方程
% license Xiao
% type Tutor

% 全部系公式已数值验证！

\pentry{无限深势阱\nref{nod_ISW}， 一维散射态的正交归一化\nref{nod_ScaNrm}}{nod_df6b}

本文采用\enref{原子单位制}{AU}。 我们要解一维定态薛定谔方程（参考\autoref{eq_AU_4}）为
\begin{equation}
-\frac{1}{2m} \dv[2]{\psi}{x} + V\psi= E \psi~.
\end{equation}
令方势垒长度为 $2l$， 关于原点对称。 势能函数为
\begin{equation}
V(x) =
\begin{cases}
0 & (x < -l)\\
V_0 & (-l \leqslant x < l)\\
0 & (l \leqslant x)~.
\end{cases}
\end{equation}
一些教材把势垒放在区间 $[0, a]$， 这时只需令 $a = 2l$， 把解出的波函数向右平移 $l$ 即可。 以下讨论两种常见的解， 一种类似于 $\sin(kx), \cos(kx)$ 另一种类似于 $\exp(\I kx), \exp(-\I kx)$。

\subsection{奇偶函数解}
对称势能的好处是存在奇和偶的实函数解， 且它们自动正交。
\subsubsection{$E \ge V_0$ 的情况}
令
\begin{equation}
k = \sqrt{2mE}~,
\qquad
b = \sqrt{2m(E-V_0)}~.
\end{equation}
令对称解和反对称的波函数分别为
\begin{equation}
\psi_{\bvec k}^e(x) =
\begin{cases}
A_1 \cos(bx) & (0 \leqslant x \leqslant l)\\
C_1 \cos(kx) + D_1 \sin(kx) & (l < x)\\
\psi_{\bvec k}^e(-x) & (x < 0)~,
\end{cases}
\end{equation}

\begin{equation}
\psi_{\bvec k}^o(x) =
\begin{cases}
B_2 \sin(bx) & (0 \leqslant x \leqslant l)\\
C_2 \cos(kx) + D_2 \sin(kx) & (l < x)\\
-\psi_{\bvec k}^o(-x) & (x < 0)~,
\end{cases}
\end{equation}
其中 $l < x$ 的部分也可以分别记为
\begin{equation}
G_i \sin(kx + \phi_i) \qquad (i = 1,2)~,
\end{equation}
\begin{equation}
G_i = \sqrt{C_i^2 + D_i^2}
\qquad
\phi_i = \Arctan(C_i, D_i)
\qquad
(i = 1,2)~.
\end{equation}


在 $x = l$ 处匹配波函数和一阶导数， 解得
\begin{equation}\label{eq_SqrPot_1}
\leftgroup{
\frac{C_1}{A_1} &= \cos(kl)\cos(bl) + \frac{b}{k} \sin(kl)\sin(bl) \\
\frac{D_1}{A_1} &= -\frac{b}{k} \cos(kl) \sin(bl) + \sin(kl)\cos(bl)~,
}
\end{equation}

\begin{equation}\label{eq_SqrPot_2}
\leftgroup{
\frac{C_2}{B_2} &= \cos(kl)\sin(bl) - \frac{b}{k} \sin(kl)\cos(bl)\\
\frac{D_2}{B_2} &= \frac{b}{k} \cos(kl) \cos(bl) + \sin(kl)\sin(bl)~.
}
\end{equation}
对波函数归一化使 $\int \psi_k'(x)\psi_k(x) = \delta(k'-k)$， 令无穷远处振幅为 $1/\sqrt{\pi}$ （\autoref{the_ScaNrm_1}）， 得
\begin{equation}\label{eq_SqrPot_4}
\begin{aligned}
A_1 = \frac{1}{\sqrt{\pi} \sqrt{\cos[2](bl) + (b^2/k^2)\sin[2](bl)}}~,\\
B_2 = \frac{1}{\sqrt{\pi} \sqrt{\sin[2](bl) + (b^2/k^2)\cos[2](bl)}}~.
\end{aligned}
\end{equation}

\subsubsection{$0 < E < V_0$ 的情况}
令 $\kappa = \sqrt{2m(V_0-E)}$
\begin{equation}
\psi_{\bvec k}^e(x) =
\begin{cases}
A_1 \cosh(\kappa x) & (0 \leqslant x \leqslant l)\\
C_1 \cos(kx) + D_1 \sin(kx) & (l < x)~,
\end{cases}
\end{equation}
\begin{equation}
\psi_{\bvec k}^o(x) =
\begin{cases}
A_2 \sinh(\kappa x) & (0 \leqslant x \leqslant l)\\
C_2 \cos(kx) + D_2 \sin(kx) & (l < x)~.
\end{cases}
\end{equation}
在 $x = l$ 处匹配波函数和一阶导数， 分别得
\begin{equation}
\leftgroup{
&A_1 \cosh(\kappa l) = C_1 \cos(kl) + D_1 \sin(kl)\\
&\kappa A_1 \sinh(\kappa l) = - kC_1  \sin(kl) +  kD_1 \cos(kl)~,
}\end{equation}
\begin{equation}
\leftgroup{
&A_2 \sinh(\kappa l) = C_2 \cos(kl) + D_2 \sin(kl)\\
&\kappa A_2 \cosh(\kappa l) = -kC_2 \sin(kl) + k D_2 \cos(kl)~.
}\end{equation}
解得
\begin{equation}
\leftgroup{
&\frac{C_1}{A_1} = \cosh(\kappa l)\cos(kl) - \frac{\kappa}{k}\sinh(\kappa l) \sin(kl)\\
&\frac{D_1}{A_1} = \cosh(\kappa l)\sin(kl) + \frac{\kappa}{k}\sinh(\kappa l) \cos(kl)~,
}\end{equation}
\begin{equation}
\leftgroup{
&\frac{C_2}{A_2} = \sinh(\kappa l)\cos(kl) - \frac{\kappa}{k}\cosh(\kappa l)\sin(kl)\\
&\frac{D_2}{A_2} = \sinh(\kappa l)\sin(kl) + \frac{\kappa}{k} \cosh(\kappa l)\cos(kl)~.
}\end{equation}
对波函数归一化， 同样令无穷远处振幅为 $1/\sqrt{\pi}$ 得
\begin{equation}
A_1 = \frac{1}{\sqrt{\pi}\sqrt{\cosh^2(\kappa l) + (\kappa/k)^2 \sinh^2(kl)}}~,
\end{equation}
\begin{equation}
A_2 = \frac{1}{\sqrt{\pi}\sqrt{\sinh^2(\kappa l) + (\kappa/k)^2 \cosh^2(kl)}}~.
\end{equation}

\subsection{行波解}
令左、中、右三个区间 $\exp$ 项的系数分别为 $A,B$、$C,D$、$E,F$。 左边右入射和出射， 右边只有出射没有反射
\begin{equation}
\psi_{k,1}(x) = \leftgroup{
&A \exp(\I kx) + B \exp(-\I kx) &\quad& (x < -L)\\
&C \exp(\I bx) + D \exp(-\I bx) && (-L \le x \le L)\\
&F \exp(-\I kx) &\quad& (x < -L)~,\\
}\end{equation}
\begin{equation}
\psi_{k,2}(x) = \psi_{k,1}(-x)~,
\end{equation}
要归一化只需满足 $A = 1/\sqrt{2\pi}$ （\autoref{eq_ScaNrm_10}）。

\subsubsection{$E > V_0$ 的情况}
当 $E > V_0$ 时， 系数解为
\begin{equation}
\leftgroup{
&A = 1/\sqrt{2\pi}\\
&B = \mathcal{N}\cdot (k^2 - b^2)\sin(2bl)\exp(-\I kl)\\
&C = \mathcal{N}\cdot \I k (k + b) \exp(-\I bl)\\
&D = \mathcal{N}\cdot \I k(b-k) \exp(\I bl)\\
&E = \mathcal{N}\cdot 2\I kb \exp(-\I kl)~,
}\end{equation}
其中
\begin{equation}
\mathcal{N} = \frac{1}{\sqrt{2\pi}}\frac{(k^2 + b^2)\sin(2bl) - 2\I kb \cos(2bl)}{(k^2-b^2)^2\sin^2(2bl) + 4k^2b^2} \exp(-\I kl)~.
\end{equation}
可以验证 $\psi_{k,1}, \psi_{k,2}$ 正交的条件（\autoref{eq_ScaNrm_11}） $\Re[B^*E] = 0$。

透射率， 反射率分别为
\begin{equation}
T = \abs{\frac{E}{A}}^2 = \frac{4k^2b^2}{(k^2-b^2)^2\sin^2(2bl) + 4k^2b^2}~,
\end{equation}

\begin{equation}
R = \abs{\frac{B}{A}}^2 = \frac{(k^2 - b^2) \sin[2](2bl)}{(k^2-b^2)^2\sin^2(2bl) + 4k^2b^2}~.
\end{equation}

\subsubsection{$0 < E < V_0$ 的情况}
当 $0 < E < V_0$ 时， 系数解为
\begin{equation}
\leftgroup{
&A = 1/\sqrt{2\pi}\\
&B = \mathcal{N}\cdot (\kappa ^2 + k^2)\sinh(2\kappa l)\exp(-\I kl)\\
&C = \mathcal{N}\cdot k(\I \kappa  - k) \exp(-\kappa l)\\
&D = \mathcal{N}\cdot k(\I \kappa  + k) \exp(\kappa l)\\
&E = \mathcal{N}\cdot 2\I k\kappa \exp(-\I kl)~,
}\end{equation}
\begin{equation}
\mathcal{N} = \frac{1}{\sqrt{2\pi}}\frac{(k^2 - \kappa ^2) \sinh(2\kappa l) - 2\I k\kappa  \cosh(2\kappa l)}{(k^2+\kappa^2)^2\sinh^2(2\kappa l) + 4k^2\kappa^2} \exp(-\I kl)~,
\end{equation}

\begin{equation}
T = \abs{\frac{E}{A}}^2 = \frac{4k^2\kappa ^2}{(k^2+\kappa^2)^2\sinh^2(2\kappa l) + 4k^2\kappa^2}~,
\end{equation}

\begin{equation}
R = \abs{\frac{B}{A}}^2 = \frac{(\kappa ^2 + k^2) \sinh[2](2\kappa l)}{(k^2+\kappa^2)^2\sinh^2(2\kappa l) + 4k^2\kappa^2}~.
\end{equation}

\addTODO{未完成：透射率反射率画图}

\subsubsection{投影系数}
任意平方可积的波函数可以用正交归一化的行波展开为
\begin{equation}
\psi(x) = \int_0^{+\infty} C_1(k)\psi_{k,1}(x) + C_2(k)\psi_{k,2}(x) \dd{k}~,
\end{equation}
若 $\psi(x)$ 只在 $x < -l$ 不为零， 则有
\begin{equation}\label{eq_SqrPot_3}
\begin{aligned}
&C_1(k) = \braket{\psi_{k,1}}{\psi} = \tilde\psi(k) + \sqrt{2\pi} B^* \tilde\psi(-k)~,\\
&C_2(k) = \braket{\psi_{k,2}}{\psi} = \sqrt{2\pi} E^* \tilde\psi(-k)~,
\end{aligned}
\end{equation}
其中 $\tilde\psi(k)$ 是 $\psi(x)$ 的\enref{傅里叶变换}{FTExp}
\begin{equation}
\tilde\psi(k) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{+\infty} \psi(x)\E^{-\I kx} \dd{x}~.
\end{equation}
具体例子见 “\enref{方势垒散射数值计算}{FSBsct}”， 我们将把一个高斯波包展开为散射态的积分。
