% 惯性张量
% keys 刚体|惯性张量|坐标系基底变换
% license Xiao
% type Tutor

\begin{issues}
\issueTODO
\end{issues}

\pentry{常见几何体的转动惯量\nref{nod_ExMI}，张量\nref{nod_Tensor}， 瞬时转轴\nref{nod_InsAx}}{nod_ce1a}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Moment_of_inertia}{相关页面}。}我们已经初步学习了刚体绕固定轴的转动\upref{RigRot}， 现在我们做一个更一般的讨论， 也就是惯性系中刚体绕某个固定点的转动， 注意这个固定点未必是质心。 刚体绕固定轴转动只有一个自由度 $\theta$， 而绕固定点转动却可以有 3 个自由度\upref{RigBd}。 为了讨论方便， 本文以旋转的固定点作为坐标原点。

\subsection{惯性张量}
刚体绕固定点旋转的角动量等于\textbf{惯性张量} $\mat I$ 乘以瞬时角速度矢量 $\bvec \omega$
\begin{equation}\label{eq_ITensr_3}
\bvec L = \mat I \bvec \omega~.
\end{equation}
该式推导见下文。 其中惯性张量 $\mat I$ 是一个 3 维方矩阵\upref{Mat}， 把三维角速度矢量线性映射到三维动量矢量。 惯性张量与物体的质量分布、朝向、以及固定点的位置有关。 也就是说， 在刚体旋转时， $\mat I$ 一般也会随时间变化。

惯性张量的矩阵元一般记为
\begin{equation}
\ten I = \begin{pmatrix}
I_{xx}& I_{xy}& I_{xz} \\
I_{yx}& I_{yy}& I_{yz} \\
I_{zx}& I_{zy}& I_{zz}
\end{pmatrix}~.
\end{equation}
如果将 $x, y, z$ 分别记为 $x_1, x_2, x_3$， 则 $\mat I$ 的矩阵元可以通过体积分计算
\begin{equation}\label{eq_ITensr_1}
I_{ij} = \delta_{ij} \int r^2 \rho(\bvec r)\dd{V} - \int x_i x_j \rho(\bvec r)\dd{V} \qquad (i, j = 1, 2, 3)~.
\end{equation}
其中 $\bvec r$ 是刚体上某点的位置矢量\upref{Disp}， $r = \abs{\bvec r}$， $\rho(\bvec r)$ 是位置 $\bvec r$ 处的密度， 与刚体的位置和朝向有关。 也可以表示成矩阵积分的形式， 即对每个矩阵元分别积分
\begin{equation}\label{eq_ITensr_2}
\mat I = \int \rho(\bvec r)
\begin{pmatrix}
y^2 + z^2 & -xy & -xz\\
-yx & x^2 + z^2 & -yz\\
-zx & -zy & x^2 + y^2
\end{pmatrix}
\dd{V}~.
\end{equation}
若把刚体看作质点系， 令第 $i$ 个质点的质量为 $m_k$， 位置为 $\bvec r_{k} = (x_{1,k},x_{2,k},x_{3,k})$， \autoref{eq_ITensr_1} 也可记为
\begin{equation}\label{eq_ITensr_8}
I_{ij} = \delta_{ij}\sum_k m_k r_k^2 - \sum_k m_k x_{ik}x_{jk} \qquad (i, j = 1, 2, 3)~.
\end{equation}

从定义容易看出， $\mat I$ 是一个对称矩阵， 即 $I_{ij} = I_{ji}$。 而对称矩阵必定有三个正交归一的本征矢， 详见 “刚体的主轴\upref{PrncAx}”。

\begin{example}{长方体的惯性张量}\label{ex_ITensr_1}
令质心在原点， 密度为常数， 质量为 $M$ 的长方体延 $x, y, z$ 方向的长度分别为 $a, b, c$， 那么有
\begin{equation}
\begin{aligned}
&\iiint xy \dd{x}\dd{y}\dd{z} = \iiint yz \dd{x}\dd{y}\dd{z} = \iiint zx \dd{x}\dd{y}\dd{z} = 0~,\\
&\iiint x^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} a^3 bc~,\\
&\iiint y^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} ab^3 c~,\\
&\iiint z^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} ab c^3~.
\end{aligned}
\end{equation}
使用 $M = \rho abc$ 可得
\begin{equation}\label{eq_ITensr_4}
\mat I = \frac{1}{12} M
\pmat{
   b^2 + c^2 & 0 & 0\\
   0 & a^2 + c^2 & 0\\
   0 & 0 & a^2 + b^2
}~,
\end{equation}
可以发现这个是一个对角矩阵。 这就意味着， 如果长方体分别绕 $x, y, z$ 轴转动， 它的角动量也分别延 $x, y, z$ 轴。 由\autoref{eq_ExMI_1}~\upref{ExMI} 可以验证三个方向的转动惯量是对的。 当转轴与坐标轴不重合时， 可见转动惯量的方向与转动方向一般不同。

特殊地， 当 $a = b = c$ （正方体）时， 惯性张量变为单位矩阵乘以常数
\begin{equation}
\mat I = \frac{1}{6} Ma^2
\pmat{
   1 & 0 & 0\\
   0 & 1 & 0\\
   0 & 0 & 1
}~.
\end{equation}
由于单位矩阵乘以任何矢量都得到相同的矢量， 正方体延任意转轴转动时， 角动量都和角速度矢量成正比
\begin{equation}
\bvec L = \mat I \bvec \omega = \frac{1}{6} Ma^2 \bvec \omega~,
\end{equation}
这可以验证\autoref{eq_ExMI_9}~\upref{ExMI}的结果。
\end{example}

\begin{example}{细杆的角动量}
假设细杆沿 $x$ 轴放置， 长度为 $L$。 要计算它的惯性张量， 我们可以从头积分（\autoref{exe_ITensr_1}）， 也可以假设细杆是一个细长的长方体， 直接用\autoref{ex_ITensr_1} 的结论（令 $a = L, b \to 0, c \to 0$） 得
\begin{equation}\label{eq_ITensr_5}
\mat I = \frac{1}{12} M \pmat{0 & 0 & 0\\ 0 & L^2 & 0\\ 0 & 0 & L^2}~.
\end{equation}
可以看到， 如果转轴延 $x$ 方向， 即 $\bvec\omega = (\omega, 0, 0)\Tr$， 角动量为零， 如果延 $y, z$ 方向， 则角动量大小都等于
\begin{equation}
L = \frac{1}{12} M L^2 \omega~.
\end{equation}
对应的转动惯量为 $I = ML^2/12$， 这与\autoref{eq_ExMI_2}~\upref{ExMI} 一致。
\end{example}

\begin{exercise}{}\label{exe_ITensr_1}
直接使用积分计算细杆的角动量（\autoref{eq_ITensr_5}）。
\end{exercise}

\subsubsection{推导}
我们把刚体看作质点系刚体\upref{RigBd}， 刚体绕固定点转动时， 刚体上的每个点都在做瞬时圆周运动。 根据角动量的定义\autoref{eq_AngMom_1}~\upref{AngMom} 以及圆周运动的速度\autoref{eq_CMVD_5}~\upref{CMVD}
\begin{equation}
\bvec L = \sum_i m_i \bvec r_i \bvec v_i = \sum_i m_i \bvec r_i \cross (\bvec \omega \cross \bvec r_i) = \sum_i m_i r_i^2 \bvec \omega - \sum_i m_i (\bvec \omega \vdot \bvec r_i) \bvec r_i~,
\end{equation}
其中最后一步使用了 “连续叉乘的化简\upref{TriCro}” 中的\autoref{eq_TriCro_1}。 将上式右边写成分量的形式， 并将求和表示为刚体密度 $\rho(\bvec r)$ 的积分得
\begin{equation}
\begin{aligned}
\pmat{L_x\\ L_y\\ L_z} &= \int \rho r^2 \pmat{\omega_x\\ \omega_y\\ \omega_z} \dd{V} - \int \rho
\begin{pmatrix}
xx & xy & xz\\
yx & yy & yz\\
zx & zy & zz
\end{pmatrix}
\pmat{\omega_x\\ \omega_y\\ \omega_z} \dd{V}\\
&= \qty[\int \rho
\begin{pmatrix}
r^2 -xx & -xy & -xz\\
-yx & r^2 -yy & -yz\\
-zx & -zy & r^2 -zz
\end{pmatrix}
\dd{V}]
\pmat{\omega_x\\ \omega_y\\ \omega_z}
\end{aligned}~.
\end{equation}
对比\autoref{eq_ITensr_3} 可知， 方括号中的积分就是惯性张量 $\mat I$（\autoref{eq_ITensr_2}）。


\subsection{坐标旋转变换}\label{sub_ITensr_1}
\pentry{空间旋转矩阵\nref{nod_Rot3D}， 相似变换\nref{nod_MatSim}}{nod_a623}

一般情况下当刚体相对于选取的参考系发生平移或任意方向的转动， （相对于原点的）惯性张量都会发生改变。  我们先来讨论惯性张量在两个原点相同朝向不同的坐标系之间如何变换， 这叫做惯性张量的\textbf{旋转变换}。 在计算刚体运动时， 通常先建立一个与刚体始终相对静止的参考系叫做\textbf{体坐标系（body frame）}， 另外选一个原点相同的惯性系， 称为\textbf{实验室坐标系（lab frame）}。 实际问题中， 刚体以及体坐标系绕坐标原点随时间相对实验室系转动。 令同一个矢量在实验室系的坐标为 $\bvec r_{L}$， 在体坐标系的坐标为 $\bvec r_{B}$， 令旋转变换矩阵\upref{Rot3D}为 $\mat R$， 满足
\begin{equation}
\bvec r_L = \mat R\bvec r_B~,
\end{equation}
令体坐标系和实验室系中的惯性张量分别为 $\mat I_0$ 和 $\mat I$， 则二者的关系为
\begin{equation}\label{eq_ITensr_6}
\mat I = \mat R \mat I_0 \mat R^{-1} = \mat R \mat I_0 \mat R\Tr~,
\end{equation}
其中使用了酉矩阵的性质 $\mat R^{-1} = \mat R\Tr$ （\autoref{eq_UniMat_2}~\upref{UniMat}）。 注意该式是一个相似变换\upref{MatSim}， 所以 $\mat I$ 和 $\mat I_0$ 互为相似矩阵。

证明： 要计算 $\bvec L = \bvec I \bvec \omega$， 把\autoref{eq_ITensr_6} 右边三个矩阵从右到左依次作用在 $\bvec \omega$ 上。 先计算 $\mat R\Tr \bvec \omega$ 把实验室系中的角速度矢量 $\bvec \omega$ 变换到体坐标系中的 $\bvec \omega_0$。 再计算 $\bvec I_0 \bvec \omega_0$ 得到体坐标系中的角动量 $\mat L_0$， 最后计算 $\mat R \mat L_0$ 得到实验室系中的角动量 $\bvec L$。 证毕。

\begin{example}{}
如果转轴和轻杆法线的夹角为 $\theta$， （未完成）
\end{example}

\subsection{坐标平移变换}
若刚体原来的惯性张量（关于原点）为 $I$， 总质量为 $M$， 质心为 $\bvec r_c = (x_{1,c}, x_{2,c}, x_{3,c})$， 把它平移 $\bvec r_0 = (x_{1,0}, x_{2,0}, x_{3,0})$ 后令新的惯性张量（关于原点）为 $\mat I'$， 则
\begin{equation}\label{eq_ITensr_7}
I'_{ij} = I_{ij} + 2 \delta_{ij} M\bvec r_c\vdot \bvec r_0 + M(\delta_{ij}r_0^2 - x_{ic}x_{j0} - x_{jc}x_{i0} - x_{i0}x_{j0})\qquad (i, j = 1, 2, 3)~.
\end{equation}
特殊地， 若 $\bvec r_c = \bvec 0$， 则
\begin{equation}
I'_{ij} = I_{ij} + M(\delta_{ij}r_0^2 - x_{i0}x_{j0})\qquad (i, j = 1, 2, 3)~.
\end{equation}


\textbf{推导}： 
把\autoref{eq_ITensr_8} 中 $r_k^2$ 替换为 $(\bvec r_k + \bvec r_0)^2$， $x_{ik}$ 替换为 $x_{ik} + x_{i0}$， $x_{jk}$ 替换为 $x_{jk} + x_{j0}$， 再利用质心的定义（\autoref{eq_CM_1}~\upref{CM}） $\bvec r_c = \sum_k m_k\bvec r_k/M$， 就可以得到\autoref{eq_ITensr_7}。

\begin{exercise}{长方体的惯性张量 2}
若把\autoref{ex_ITensr_1} 中的长方体平移 $\bvec r_0 = (a/2, b/2, c/2)$， 使其一个角处于原点， 求新的惯性张量。

答案：
\begin{equation}
\begin{aligned}
\mat I' &= \frac{1}{12} M
\pmat{
   4b^2 + 4c^2 & -3ab & -3ac\\
   -3ab & 4a^2 + 4c^2 & -3bc\\
   -3ac & -3bc & 4a^2 + 4b^2
}~.
\end{aligned}
\end{equation}
\end{exercise}
\begin{exercise}{陀螺模型}\label{exe_ITensr_2}
显然， 球体的惯性张量就是其转动惯量（\autoref{eq_ExMI_5}~\upref{ExMI}） $2MR^2/5$ 乘以单位矩阵。 若把它沿 $z$ 轴平移 $a$， 就得到一个陀螺模型， 求陀螺的惯性张量。

答案：
\begin{equation}
I = \frac{2}{5}MR^2\pmat{
   1 & 0 & 0\\
   0 & 1 & 0\\
   0 & 0 & 1
} + Ma^2 \pmat{
   1 & 0 & 0\\
   0 & 1 & 0\\
   0 & 0 & 0
}~.\end{equation}
\addTODO{引用陀螺的数值模拟}
\end{exercise}

% 例子未完成， 球体的惯性张量是对角的
