% 惯性张量
% 刚体|惯性张量|坐标系基底变换

\begin{issues}
\issueTODO
\end{issues}

\pentry{常见几何体的转动惯量\upref{ExMI}，张量\upref{Tensor}， 瞬时转轴\upref{InsAx}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Moment_of_inertia}{相关页面}．}我们已经初步学习了刚体绕固定轴的转动， 现在我们做一个更一般的讨论， 也就是刚体绕某个固定点的转动． 刚体绕固定轴转动只有一个自由度 $\theta$， 而绕固定点转动却可以有 3 个自由度（见 “刚体\upref{RigBd}”）．

\subsection{惯性张量}
刚体绕固定点旋转的角动量等于\textbf{惯性张量} $\mat I$ 乘以瞬时角速度矢量 $\bvec \omega$
\begin{equation}\label{ITensr_eq3}
\bvec L = \mat I \bvec \omega
\end{equation}
惯性张量是一个 3 维方阵， 其阵元一般记为
\begin{equation}
\ten I = \begin{pmatrix}
I_{xx}& I_{xy}& I_{xz} \\
I_{yx}& I_{yy}& I_{yz} \\
I_{zx}& I_{zy}& I_{zz}
\end{pmatrix}
\end{equation}
我们现在假设刚体绕坐标原点旋转， 如果将 $x, y, z$ 分别记为 $x_1, x_2, x_3$， 则 $\mat I$ 的矩阵元可以通过体积分计算
\begin{equation}\label{ITensr_eq1}
I_{ij} = \delta_{i, j} \int r^2 \rho(\bvec r)\dd{V} - \int x_i x_j \rho(\bvec r)\dd{V} \qquad (i, j = 1, 2, 3)
\end{equation}
其中 $\bvec r$ 是刚体上某点的位置矢量\upref{Disp}， $r = \abs{\bvec r}$， $\rho(\bvec r)$ 是位置 $\bvec r$ 处的密度． 也可以表示成矩阵积分的形式， 即对每个矩阵元分别积分
\begin{equation}\label{ITensr_eq2}
\mat I = \int \rho(\bvec r)
\begin{pmatrix}
y^2 + z^2 & -xy & -xz\\
-yx & x^2 + z^2 & -yz\\
-zx & -zy & x^2 + y^2
\end{pmatrix}
\dd{V}
\end{equation}
可以看出， 惯性张量与坐标系的选取有关， 而这又可以划分为原点的位置和坐标轴的取向．

\begin{example}{长方体的惯性张量}\label{ITensr_ex1}
令重心在原点， 密度为常数， 质量为 $M$ 的长方体延 $x, y, z$ 方向的长度分别为 $a, b, c$， 那么有
\begin{equation}
\begin{aligned}
&\iiint xy \dd{x}\dd{y}\dd{z} = \iiint yz \dd{x}\dd{y}\dd{z} = \iiint zx \dd{x}\dd{y}\dd{z} = 0\\
&\iiint x^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} a^3 bc\\
&\iiint y^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} ab^3 c\\
&\iiint z^2 \dd{x}\dd{y}\dd{z} = \frac{1}{12} ab c^3
\end{aligned}
\end{equation}
使用 $M = \rho abc$ 可得
\begin{equation}\label{ITensr_eq4}
\mat I = \frac{1}{12} M
\pmat{
   b^2 + c^2 & 0 & 0\\
   0 & a^2 + c^2 & 0\\
   0 & 0 & a^2 + b^2
}
\end{equation}
可以发现这个是一个对角矩阵． 这就意味着， 如果长方体分别绕 $x, y, z$ 轴转动， 它的角动量也分别延 $x, y, z$ 轴． 由\autoref{ExMI_eq1}~\upref{ExMI} 可以验证三个方向的转动惯量是对的． 当转轴与坐标轴不重合时， 可见转动惯量的方向与转动方向一般不同．

特殊地， 当 $a = b = c$ （正方体）时， 惯性张量变为单位矩阵乘以常数
\begin{equation}
\mat I = \frac{1}{6} Ma^2
\pmat{
   1 & 0 & 0\\
   0 & 1 & 0\\
   0 & 0 & 1
}
\end{equation}
由于单位矩阵乘以任何矢量都得到相同的矢量， 正方体延任意转轴转动时， 角动量都和角速度矢量成正比
\begin{equation}
\bvec L = \mat I \bvec \omega = \frac{1}{6} Ma^2 \bvec \omega
\end{equation}
这可以验证\autoref{ExMI_eq9}~\upref{ExMI}的结果．
\end{example}

\begin{example}{细杆的角动量}
假设细杆沿 $x$ 轴放置， 长度为 $L$． 要计算它的惯性张量， 我们可以从头积分（\autoref{ITensr_exe1}）， 也可以假设细杆是一个细长的长方体， 直接用\autoref{ITensr_ex1} 的结论（令 $a = L, b \to 0, c \to 0$） 得
\begin{equation}\label{ITensr_eq5}
\mat I = \frac{1}{12} M \pmat{0 & 0 & 0\\ 0 & L^2 & 0\\ 0 & 0 & L^2}
\end{equation}
可以看到， 如果转轴延 $x$ 方向， 即 $\bvec\omega = (\omega, 0, 0)\Tr$， 角动量为零， 如果延 $y, z$ 方向， 则角动量大小都等于
\begin{equation}
L = \frac{1}{12} M L^2 \omega
\end{equation}
对应的转动惯量为 $I = ML^2/12$， 这与\autoref{ExMI_eq2}~\upref{ExMI} 一致．
\end{example}

\begin{exercise}{}\label{ITensr_exe1}
直接使用积分计算细杆的角动量（\autoref{ITensr_eq5}）．
\end{exercise}

\subsection{推导}
我们把刚体看作质点系刚体\upref{RigBd}， 刚体绕固定点转动时， 刚体上的每个点都在做瞬时圆周运动． 根据角动量的定义\autoref{AngMom_eq1}~\upref{AngMom} 以及圆周运动的速度\autoref{CMVD_eq5}~\upref{CMVD}
\begin{equation}
\bvec L = \sum_i m_i \bvec r_i \bvec v_i = \sum_i m_i \bvec r_i \cross (\bvec \omega \cross \bvec r_i) = \sum_i m_i r_i^2 \bvec \omega - \sum_i m_i (\bvec \omega \vdot \bvec r_i) \bvec r_i
\end{equation}
其中使用了 “连续叉乘的化简\upref{TriCro}” 中的\autoref{TriCro_eq1}． 将上式右边写成分量的形式， 并将求和表示为刚体密度 $\rho(\bvec r)$ 的积分得
\begin{equation}
\begin{aligned}
\pmat{L_x\\ L_y\\ L_z} &= \int \rho r^2 \pmat{\omega_x\\ \omega_y\\ \omega_z} \dd{V} - \int \rho
\begin{pmatrix}
xx & xy & xz\\
yx & yy & yz\\
zx & zy & zz
\end{pmatrix}
\pmat{\omega_x\\ \omega_y\\ \omega_z} \dd{V}\\
&= \qty[\int \rho
\begin{pmatrix}
r^2 -xx & -xy & -xz\\
-yx & r^2 -yy & -yz\\
-zx & -zy & r^2 -zz
\end{pmatrix}
\dd{V}]
\pmat{\omega_x\\ \omega_y\\ \omega_z}
\end{aligned}
\end{equation}
对比\autoref{ITensr_eq3} 可知， 方括号中的积分就是惯性张量 $\mat I$（\autoref{ITensr_eq2}）．

\addTODO{以下内容开新词条}
\subsection{坐标旋转变换}
\pentry{空间旋转矩阵\upref{Rot3D}}

上文中提到惯性张量矩阵与坐标系的选取有关，一般情况下当刚体相对于选取的参考系发生平移或任意方向的转动， 惯性张量都会发生改变．  我们先来讨论如果惯性张量在两个原点相同朝向不同的坐标系之间如何变换， 这叫做惯性张量的\textbf{旋转变换}． 先建立一个与刚体始终相对静止的参考系叫做\textbf{体坐标系（body frame）}， 一般我们选择体坐标系的原点在刚体质心处， 但刚体受力运动时， 体坐标系并不是一个惯性系， 所以我们还要选一个惯性系， 即\textbf{实验室坐标系（lab frame）}． 令实验室系矢量到体坐标系矢量的变换矩阵\upref{Rot3D}为 $\mat R$， 记体坐标系和实验室系中的惯性张量分别为 $\mat I_0$ 和 $\mat I$， 则二者的关系为
\begin{equation}\label{ITensr_eq6}
\mat I = \mat R \mat I_0 \mat R^{-1} = \mat R \mat I_0 \mat R\Tr
\end{equation}
其中使用了酉矩阵的性质 $\mat R^{-1} = \mat R\Tr$ （\autoref{UniMat_eq2}~\upref{UniMat}）． 注意该式是一个相似变换\upref{MatSim}， 所以 $\mat I$ 和 $\mat I_0$ 互为相似矩阵．

证明： 要计算 $\bvec L = \bvec I \bvec \omega$， 把\autoref{ITensr_eq6} 右边三个矩阵从右到左依次作用在 $\bvec \omega$ 上． 先计算 $\mat R\Tr \bvec \omega$ 把实验室系中的角速度矢量 $\bvec \omega$ 变换到体坐标系中的 $\bvec \omega_0$． 再计算 $\bvec I_0 \bvec \omega_0$ 得到体坐标系中的角动量 $\mat L_0$， 最后计算 $\mat R \mat L_0$ 得到实验室系中的角动量 $\bvec L$． 证毕．

\begin{example}{}
如果转轴和轻杆法线的夹角为 $\theta$， （未完成）
\end{example}

\subsection{坐标平移变换}
（未完成）

% 例子未完成， 球体的惯性张量是对角的
