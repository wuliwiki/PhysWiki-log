% 最小作用量、哈密顿原理
% 位形空间|作用量|泛函|哈密顿原理|最小作用量|拉格朗日方程证明

\pentry{拉格朗日方程\upref{Lagrng}}

若一个经典力学系统某时刻的状态完全由 $N$ 个独立的广义坐标 $q_1\dots q_N$ 描述（以下把 $q_1\dots q_N$ 记为 $\{q_i\}$），那么可以把 $\{q_i\}$ 看做是 $N$ 维空间中的一点，这个空间叫做\textbf{位形空间（configuration space）}．系统变化的过程可以看做位形空间中的一点随时间变化而走出的\textbf{轨迹（trajectory）}．若该轨迹 $\{ {{q_i}(t)} \}$ 已知，可定义 $t_1$ 与 $t_2$ 之间系统的\textbf{作用量（action）}为
\begin{equation}\label{HamPrn_eq1}
S[\{q_i(t)\}] = \int_{t_1}^{t_2} L[\{q_i(t)\}, \{\dot q_i(t)\}, t] \dd{t}
\end{equation}
注意 $\dot q_i(t)$ 代表 $q_i(t)$ 对时间求导， 所以以下讨论中我们要求所有函数 $q_i(t)$ 必须在 $[t_1, t_2]$ 区间处处可导． 其中 $L$ 是拉氏量（\autoref{Lagrng_eq2}~\upref{Lagrng}）．

我们想要探究这么一个问题： 当我们固定轨迹的起点和终点， 即预先规定 $t_1, t_2$ 时刻每个 $q_i(t)$ 的值， 这时候取什么样的轨迹才能使作用量 $S$ 取得最小值或者最大值呢？

这个问题和求一元函数的最大最小值\upref{DerMax}有些相似， 事实上我们并不能一步到位找到 “最值”， 而是需要先求出若干个 “极值” 或 “驻点”， 然后在这些解中进一步选取最大值或最小值． 类比过来， 泛函的极值是指上述轨迹发生微小改变（但两个端点保持不变）时泛函的值几乎不变（即小于一阶无穷小）．

我们可以把 $S[\{q_i(t)\}]$ 看成某种广义的函数， 显然这个函数的函数值是一个实数， 但自变量却不直接是 $N$ 个实数， 而是 $N$ 个实函数 $q_i(t)$． 我们把这种函数的函数叫做\textbf{泛函（functional）}．% 连接未完成
数学专业中， 讨论泛函的课程叫做\textbf{泛函分析（functional analysis）}．

爱尔兰数学家\textbf{威廉·哈密顿（William Hamilton）}意识到， 要求经典力学系统的演化（即位形空间中的轨迹）， 除了通过牛顿三定律， 也可以通过求作用量 $S$ 的极值得出\footnote{这有些类似于几何光学中的费马定理， 可以代替反射和折射定律}． 我们把这叫做\textbf{哈密顿原理（Hamilton's principle）}． 哈密顿原理也被称为\textbf{最小作用量（least action）}原理\footnote{“最小” 只是习惯的叫法，极值可以是极小值，极大值或鞍点．}．% 未完成：脚注是否正确？

\begin{theorem}{哈密顿原理}
若一个经典力学系统在 $t_1$ 和 $t_2$ 时刻的坐标分别为 $\{q_i(t_1)\}$ 和 $\{q_i(t_2)\}$，那么在这段时间内所有连接这两点的轨迹中，只有一个能使作用量 $S$ 取最值， 而这个轨迹就是该系统真实演变的轨迹．
\end{theorem}

在下面的推导中我们将看到， 要求这个轨迹， 只需要求解拉格朗日方程\autoref{Lagrng_eq1}~\upref{Lagrng}即可
\begin{equation}
\dv{t} \qty(\pdv{L}{\dot q_i}) = \pdv{L}{q_i} \qquad
(i = 1\dots N)
\end{equation}

\subsection{由哈密顿原理导拉格朗日方程}

假设满足哈密顿原理的轨迹为 $\{q'_i(t)\}$，为了让轨迹发生微小改变，现取一个变量 $\alpha$ 及任意 $N$ 个一阶可导实函数 $\{\eta_i(t)\}$，令 $q_i(t,\alpha ) = q'_i(t) + \alpha \eta_i(t)$．由于 $\alpha$ 变化的过程中仍然要保持初末时刻的 $q_i$ 不变，$\eta_i(t)$ 必须满足 $\eta_i(t_1) = \eta_i(t_2) = 0$．

现在拉格朗日量最终是 $t$ 和 $\alpha$ 的函数，而作用量则完全是 $\alpha$ 的函数．
 
根据哈密顿原理，在 $\alpha = 0$ 处有 $\dv*{S}{\alpha} = 0$．为书写方便，以下所有对 $\alpha$ 的（偏）导数都默认在 $\alpha=0$ 时求得．
\begin{equation}
\dv{S}{\alpha} = \int_{t_1}^{t_2} \pdv{\alpha} L[\{q_i(t,\alpha )\}, \{\dot q_i(t,\alpha)\}, t] \dd{t}
\end{equation}
注意 $\alpha$ 在时间积分中只是参数， 所以可以置换偏导和积分的顺序． % 连接未完成
这里使用偏导是为了强调求导时保持 $t$ 不变．使用偏导的链式法则\upref{PChain}有
\begin{equation}\label{HamPrn_eq3}
\ali{
\dv{S}{\alpha} =
\sum_i \int_{t_1}^{t_2} \qty[\pdv{L}{q_i} \pdv{q_i}{\alpha} + \pdv{L}{\dot q_i}\pdv{q_i}{\alpha}{t}] \dd{t}
}\end{equation}
对第二项使用分部积分\upref{IntBP} 得
\begin{equation}
\int_{t_1}^{t_2} \pdv{L}{\dot q_i} \pdv{q_i}{\alpha}{t} \dd{t}  = \eval{\pdv{L}{\dot q_i}\pdv{q_i}{\alpha}}_{t = t_1}^{t = t_2} - \int_{t_1}^{t_2} \dv{t} \qty(\pdv{L}{\dot q_i})\pdv{q_i}{\alpha} \dd{t}
\end{equation}
其中 $\pdv*{q_i}{\alpha}  = \eta_i$，在 $t_1, t_2$ 时刻都为 0，第一项消失．代入\autoref{HamPrn_eq3} 得
\begin{equation}
\sum_i \int_{t_1}^{t_2} \qty[\pdv{L}{q_i} - \dv{t} \qty(\pdv{L}{\dot q_i})] \eta_i(t) \dd{t} = 0
\end{equation}
由于 $\eta_i(t)$ 可以任取，方括号内为零．要证明这点只需取 $\eta_i(t) = \delta_{ij}\delta(t - t')$ 代入即可．于是我们得到拉格朗日方程组
\begin{equation}\label{HamPrn_eq2}
\dv{t} \qty(\pdv{L}{\dot q_i}) = \pdv{L}{q_i} \qquad
(i = 1\dots N)
\end{equation}
