% 悬链线
% 微分方程|受力分析|绳子|悬链线|力学|微积分

\pentry{双曲函数\upref{TrigH}， 常微分方程\upref{ODE}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Catenary}{相关页面}。}\textbf{悬链线（catenary）}在物理上是指一条粗细不计的、 质量均匀分布的柔软绳子两端悬挂在相同高度的两个点后（\autoref{fig_Catena_1} ）当绳子在重力作用下达到平衡后形成的曲线。

\begin{figure}[ht]
\centering
\includegraphics[width=7cm]{./figures/4014b09a79783abd.pdf}
\caption{悬链线} \label{fig_Catena_1}
\end{figure}

令绳子的最低点横坐标为 $x = 0$， 水平向右为 $x$ 轴， 竖直向上为 $y$ 轴。 那么悬链线可以用函数 $y(x)$ 来表示为\footnote{可加减任意常数，此处略去。}
\begin{equation}\label{eq_Catena_3}
y(x) = \frac{1}{k}\cosh(kx)~.
\end{equation}
其中 $\cosh$ 是双曲余弦函数\upref{TrigH}， 常数 $k$ 满足
\begin{equation}\label{eq_Catena_10}
\sinh(\frac{ka}{2}) = \frac{kL}{2}~.
\end{equation}
其中 $a$ 是两个悬挂点之间的距离， $L$ 是绳子的总长度。

\subsubsection{高度不相等的情况}
\begin{figure}[ht]
\centering
\includegraphics[width=7cm]{./figures/f812d38e5b5ef450.pdf}
\caption{悬挂点左低右高的悬链线} \label{fig_Catena_3}
\end{figure}
如\autoref{fig_Catena_3}， 假设悬挂点左低右高， 水平距离为 $a'$， 高度差为 $h' > 0$， 绳长为 $L'$。 悬链线仍然具有\autoref{eq_Catena_3} 的形式， 我们希望根据 $a', h', L'$ 求出 $k$。 若把左边的悬链线补全到和右边一样的高度后， 悬链线仍然关于最低点对称， 令补全后两端相距为 $a$ （在下文推导中会使用）， 那么 $k$ 满足
\begin{equation}\label{eq_Catena_6}
\cosh(ka') - 1 = \frac{k^2}{2}(L'^2 - h'^2)~,
\end{equation}
注意左边的悬挂点未必需要在最低点的左边。 另外根据\autoref{eq_Catena_6} 可以验证当 $L' = h'$ 时， $a' = 0$。

\subsection{推导（受力分析法）}
\pentry{曲线的长度\upref{CurLen}， 最小作用量 哈密顿原理\upref{HamPrn}}

\begin{figure}[ht]
\centering
\includegraphics[width=9cm]{./figures/b11488efeeacde23.pdf}
\caption{受力分析} \label{fig_Catena_2}
\end{figure}
假设原点处的张力为 $T$， 绳的线密度为 $\lambda$， 那么区间 $[0, x]$ 的曲线长度为（\autoref{eq_CurLen_1}~\upref{CurLen}）
\begin{equation}\label{eq_Catena_1}
L(x) = \int_0^x \sqrt{1 + \dot y(x')^2} \dd{x'}~.
\end{equation}
其中 $\dot y$ 表示函数 $y(x)$ 的导函数， 下文中 $\ddot y$ 则表示二阶导函数）。 区间 $[0, x]$ 所受重力为 $G = \lambda L g$。 根据受力分析， $x$ 点的斜率为 $G/T$， 这样就得到了悬链线 $y(x)$ 的微分—积分方程
\begin{equation}
\dot y = \frac{g\lambda}{T} \int_0^x \sqrt{1 + \dot y^2} \dd{x'}~.
\end{equation}
两边对 $x$ 再次求导得二阶微分方程
\addTODO{如何对积分上限求导？放链接}
\begin{equation}
\ddot y = k \sqrt{1 + \dot y^2}~,
\end{equation}
其中令 $k = g\lambda/T$。 注意这是一个非线性二阶常微分方程， 我们还没学过如何求解。 但可以证明它的通解为
\begin{equation}\label{eq_Catena_2}
y(x) = \frac{1}{k}\cosh(kx+C_0)+C_1~,
\end{equation}
其中，$C_0,C_1$ 为常数。
考虑到整个系统的对称性， $y(x)$ 是偶函数，这意味着 $C_0=0$，又 $y(0)=0$，所以 $C_1=-\frac{1}{k}$，我们有
\begin{equation}\label{eq_Catena_7}
y(x)=\frac{1}{k}[\cosh(kx)-1]~.
\end{equation}

那么， 如果已知两个悬挂点之间距离为 $a$， 绳子总长度为 $L$， 以及 $\lambda, g$。 如何求出 $k$ 或拉力 $T$ 呢？ 根据\autoref{eq_Catena_1} 有限制条件
\begin{equation}
\frac{L}{2} = \int_{0}^{\frac{a}{2}} \sqrt{1 + \dot y^2} \dd{x'}~.
\end{equation}
把\autoref{eq_Catena_7} 代入有
\begin{equation}
\frac{2}{k}\sinh(\frac{ka}{2}) = L~,
\end{equation}
这样就可以解出 $k$， 进而求出 $T$。

\subsubsection{高度不相等的情况}
根据高度差 $h'$ 的定义可得
\begin{equation}\label{eq_Catena_4}
\frac{1}{k}\cosh(k\frac{a}{2}) - \frac{1}{k}\cosh\qty[k\qty(\frac{a}{2}-a')] = h'~.
\end{equation}
由绳长的约束得
\begin{equation}
L' = \int_{a/2-a'}^{a/2} \sqrt{1 + \dot y(x')^2} \dd{x'}~.
\end{equation}
把\autoref{eq_Catena_3} 代入该式后化简得
\begin{equation}\label{eq_Catena_5}
\frac{1}{k}\sinh(k\frac{a}{2}) - \frac{1}{k}\sinh\qty[k\qty(\frac{a}{2}-a')] = L'~.
\end{equation}
分别把 \autoref{eq_Catena_4} 和\autoref{eq_Catena_5} 相加和相减得
\begin{equation}
a = \frac{2}{k} \ln\frac{k(h'+L')}{1 - \E^{-ka'}}~,
\qquad
a = -\frac{2}{k} \ln\frac{k(h'-L')}{1 - \E^{ka'}}~,
\end{equation}
令两式右边相等得\autoref{eq_Catena_6}。

\subsection{推导（欧拉—拉格朗日方程法）}
在该问题中，悬挂点是固定的两个点，绳子可看成经过这两个点的总长为 $L$ 的曲线，由能量最低原理，我们知道绳子对应曲线的形状将使得绳子的质心最低，曲线可用一个函数表示，那么问题就变成求这样一个函数，使得绳子质心最低，这显然是一个极值问题，更明确的说，是一个求泛函极值的问题。求解这样的问题的普遍方法为变分法。

我们以地面水平方向为 $x$ 轴， 两悬挂点水平方向中垂线为 $y$ 轴，则两悬挂点 $x$ 坐标分别为 $-\frac{a}{2}$ 和 $\frac{a}{2}$，绳子对应的曲线函数为 $y(x)$，绳长 $L$，质量为 $m$，则其质心的 $y$ 坐标为
\begin{equation}
y_C=\frac{\int_{0}^{L}y(\frac{m}{L}\dd s)}{m}=\int_{-\frac{a}{2}}^{\frac{a}{2}} \frac{y\sqrt{1+y'^2}}{L}\dd x~.
\end{equation}
现在，问题就转化为求 $y(x)$，使得 $y_C$ 最小。这个问题可用欧拉-拉格朗日方程\autoref{eq_Lagrng_1}~\upref{Lagrng}求解。

注意，上式的被积函数是 $y,y'$ 的函数，而与 $x$ 无关，直接用拉格朗日方程不好求解。这时候我们要先对被积函数变一下形。以 $F(y,y')$ 表示被积函数： 
\begin{equation}\label{eq_Catena_05}
F(y,y')=\frac{y\sqrt{1+y'^2}}{L}~.
\end{equation}
我们将自变数 $x$ 更换为 $y$，则 $x$ 是 $y$ 的函数。于是我们的问题就变成求积分
\begin{equation}
y_C=\int_{-\frac{a}{2}}^{\frac{a}{2}} F(y,\frac{1}{\dv {x}{y} })\dv{x}{y}\dd y~
\end{equation}
的极值曲线，令 
\begin{equation}\label{eq_Catena_9}
x'=\dv{x}{y},\quad \phi(y,x')=x'F(y,\frac{1}{x'})~,
\end{equation}
则
\begin{equation}
y_C=\int_{-\frac{a}{2}}^{\frac{a}{2}} \phi(y,x')\dd y~.
\end{equation}

现在，函数 $\phi(y,x')$ 包含自变量 $y$，我们就可以使用拉格朗日方程求解。回想拉格朗日方程的推导，不难看出，$\phi(y,x')$ 代表拉格朗日函数 $L(t,q,q')$, $y$ 代表拉格朗日方程中的 $t$，而 $x,x'$ 分别代表 $q,q'$。代入拉格朗日方程\autoref{eq_Lagrng_1}~\upref{Lagrng}，由于 $\phi(y,x')$ 不显含 $x$，有
\begin{equation}
\pdv{\phi}{x'}=C~,
\end{equation}
其中 $C$ 为常数。代入\autoref{eq_Catena_9} 
\begin{equation}
F(y,y')-y'F_{y'}(y,y')=C~.
\end{equation}
代入\autoref{eq_Catena_05}，得
\begin{equation}
\frac{y\sqrt{1+y'^2}}{L}-\frac{yy'^2}{L\sqrt{1+y'^2}}=C~.
\end{equation}
整理得
\begin{equation}
y'=\frac{\sqrt{y^2-(CL)^2}}{CL}~,
\end{equation}
即
\begin{equation}
\frac{\dd y}{\sqrt{y^2-(CL)^2}}=\frac{\dd x}{CL}~.
\end{equation}
两边积分，右边为
\begin{equation}
\frac{x}{CL}+C'~,
\end{equation}
其中 $C'$ 为常数。
左边，令 $y=CL\cosh t $，易得左边为
\begin{equation}
t+C''~.
\end{equation}
其中，$C''$ 为常数。于是
\begin{equation}
t+C''=\frac{x}{CL}+C'\Rightarrow t=\frac{x}{CL}+C_0~.
\end{equation}
其中，$C_0=C'-C''$ 为常数。

由于 $t=f^{-1}(y)$ 是 $y=f(t)=CL\cosh t$ 的反函数，代入上式
\begin{equation}\label{eq_Catena_13}
y=f\qty(\frac{x}{CL}+C_0)=CL\cosh (\frac{x}{CL}+C_0)~.
\end{equation}
以最低点为零点，代入边界条件 $y(0)=0$，得
\begin{equation}
y(0)=CL\cosh (C_0)=0\Rightarrow C_0=0~.
\end{equation}
即
\begin{equation}
y(x)=CL \cosh \frac{x}{CL}~,
\end{equation}
令 $k=\frac{1}{CL}$，则
\begin{equation}\label{eq_Catena_8}
y=\frac{1}{k}\cosh (kx)~.
\end{equation}
此为\autoref{eq_Catena_3} 

约束条件为绳长为 $L$，即满足
\begin{equation}
L = \int_{-\frac{a}{2}}^{\frac{a}{2}} \sqrt{1 + \dot y^2} \dd{x}~,
\end{equation}
上式代入\autoref{eq_Catena_8} ，解得
\begin{equation}
\frac{2}{k}\sinh(\frac{ka}{2}) = L~.
\end{equation}
此为\autoref{eq_Catena_10} 
