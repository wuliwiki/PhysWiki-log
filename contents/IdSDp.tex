% 理想气体的状态密度（相空间）
% keys 理想气体|状态密度|球体体积|相空间
% license Xiao
% type Tutor

\pentry{$N$ 维球体的体积\nref{nod_NSphV}， 相空间\nref{nod_PhSpace}}{nod_ee62}

统计力学中一个非常重要的基本假设是\textbf{等概率原理}，它讲的是：\textbf{处于平衡状态的孤立系统，系统各个可能的微观状态出现的概率是相等的}。也许你第一眼看到这个原理会百思不得其解，因为它一定程度上违背我们的直觉：这个“可能的微观状态”的“可能”是指什么？系统中每个粒子的速度可以任意大吗？我们平常遇到的这些孤立系统的平衡态，它们都有稳定不变的宏观性质（体积，压强，温度等），任何微观状态的概率怎么会“平权”呢？…… 这一系列问题将在我们的计算和思考过程中得到解决，而我们将会惊叹于等概率原理的绝妙之处。

让我们先来解决几个数学问题，为以后的道路作铺垫：
\subsection{能量和动量的状态密度}
对于一个 $6N$ 维的状态空间（$N$ 个粒子，这里只考虑它们的 $x,y,z,p_x,p_y,p_z$ $6$ 个自由度），单个粒子质量为 $m$，系统的总能量为：
\begin{equation}
E=\sum_{i} \frac{p_{i,x}^2+p_{i,y}^2+p_{i,z}^2}{2m}~.
\end{equation}


能量 $E$ 只和动量 $p_x,p_y,p_z$ 有关\footnote{统计力学主要研究的气体系统中，粒子的相互作用势可忽略不计，所以在计算能量时可以不考虑势能 $V$}，所以相空间中能量 $E$ 对应着动量空间的一个球面，这个动量空间的维数是 $3N$。

我们想要知道 $E$~$E+\Delta E$ 中有多少个微观状态（包括了多少个相空间中的状态点）。根据统计力学中的量子力学假设，每个状态点占据相空间中 $h^{3N}$ 的体积（称它为\enref{相格}{PhSpace}），那么状态点的个数就是相空间中 $E$~$E+\Delta E$ 所包括的体积除以 $N!h^{3N}$（注意我们有全同粒子假设，交换两个粒子所对应的微观状态是同一个，所以还要除以 $N!$）。这个状态点的个数除以 $\Delta E$，就是所谓的\textbf{状态密度}——单位能量所包括的状态点的个数。

先考虑能量 $<E$ 的状态点的个数。对于位置坐标没有限制，位置空间的体积为 $V^N$。再计算动量空间中半径为 $\sqrt{2Em}$ 的球体的体积\footnote{可以根据体积公式\autoref{eq_NSphV_8} }。相空间中能量小于 $E$ 的状态数为

\begin{equation}\label{eq_IdSDp_1}
\Omega_0 = \frac{1}{N! h^{3N}} \int\limits_{\sum p^2 \leqslant 2mE} \dd[3N]{q} \dd[3N]{p} = \frac{V^N}{N! h^{3N}} \int\limits_{\sum p^2 \leqslant 2mE} \dd[3N]{p}~.
\end{equation}


其中积分 $\int_{\dots} \dd[3N]{p} $ 正是 $n=3N$ 维球体的体积，球体半径为 $R = \sqrt{2mE}$。将 $n=3N$ 和 $R = \sqrt{2mE} $ 代入球体体积公式\footnote{$n$ 维空间中\enref{球体的体积}{NSphV}为
$V_n = \frac{\pi^{n/2}}{\Gamma(n/2+1)}R^n$。}， 得
\begin{equation}
\int\limits_{\sum p^2 \leqslant 2mE} \dd[3N]{p} = \frac{(2\pi mE)^{3N/2}}{\Gamma(3N/2+1)}~.
\end{equation}
代入\autoref{eq_IdSDp_1} 可得
\begin{equation}\label{eq_IdSDp_2}
\Omega_0 = \frac{V^N}{N! h^{3N}} \frac{(2\pi mE)^{3N/2}}{\Gamma(3N/2+1)}~.
\end{equation}
对 $E$ 求导就能得到能量的状态密度函数：
\begin{equation}\label{eq_IdSDp_3}
g(E) = \frac{V^N}{N! h^{3N}} \frac{(2\pi m)^{3N/2}}{\Gamma(3N/2)} E^{3N/2 - 1}~.
\end{equation}
特别地，当粒子数 $N=1$ 时，就得到了理想气体单粒子能级密度
\begin{equation}
g(E)=\frac{V}{h^3} \frac{(2\pi m)^{3/2} }{\Gamma(3/2)} =\frac{V}{h^3} \frac{(2\pi m)^{3/2} }{\sqrt{\pi}/2} \sqrt{\varepsilon}=\frac{2\pi V(2m)^{3/2}}{h^3}\sqrt{\varepsilon}~.
\end{equation}
单粒子的动量 $p=\sqrt{2\varepsilon m}$，$g(\varepsilon)\dd \varepsilon=g(p)\dd p=g(p)\sqrt{m/(2\varepsilon)}\dd \varepsilon$，于是可以解得关于动量绝对值的状态密度函数为
\begin{equation}\label{eq_IdSDp_4}
g(p) = \frac{V}{h^{3}} \frac{2\pi^{3/2}}{\Gamma(3/2)} p^2=\frac{4\pi p^2V}{h^3}~.
\end{equation}
