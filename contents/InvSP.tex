% 不变子空间
% keys 不变子空间
% license Xiao
% type Tutor

% Giacomo: 
\addTODO{这个前置要求有点过多了，应该只需要线性算子的定义就够了}

\pentry{线性算子代数\upref{LiOper}}

注：如无特殊声明，以下向量空间都是域$\mathbb{F}$上的向量空间。

\begin{definition}{不变子空间}
相对于向量空间 $V$ 上的线性算子\upref{LiOper} $\mathcal{A}: V \rightarrow V$，子空间\upref{SubSpc} $U \subseteq V$ 被称为\textbf{不变的}，如果 $\mathcal{A} U \subset U$。此时$\mathcal{A}|_U: U \to U$ 是一个 $U$ 上的线性算子。
\end{definition}

\begin{example}{}
算子 $\mathcal{A}$ 的\textbf{核} $\mathrm{Ker}\;\mathcal A$ 和\textbf{像} $\mathrm{Im}\;\mathcal{A}$
\begin{equation}\label{eq_InvSP_3}
\begin{aligned}
\mathrm{Ker}\;\mathcal{A}&=\{ v\in V|\mathcal{A} v= 0\}\\
\mathrm{Im}\;\mathcal{A}&=\{ w\in V| w=\mathcal{A} v,\forall v\in V\}~,
\end{aligned}
\end{equation}
都是 $\mathcal A$ 的不变子空间。
\end{example}

\begin{theorem}{}
有限维度矢量空间 $V$ 的子空间 $U$ 是算子 $\mathcal{A}$ 的不变子空间，当且仅当存在基底 $\mathcal{B}$， $\mathcal{B}_U: = \mathcal{B} \cap U$ 是 $U$ 的基底，使得算子 $\mathcal{A}$ 的矩阵 $A$ 在基底 $\mathcal{B}$ 下可以写成上三角分块矩阵
\begin{equation}
A = \begin{pmatrix}
A_U & B\\
0 & C
\end{pmatrix}~.
\end{equation}
其中，$A_U$ 是 $\mathcal{A}|_{U}: U \to U$ 的在 $\mathcal{B}_U$ 下的矩阵形式。
\end{theorem}

\begin{theorem}{}
有限维度矢量空间 $V$ 的子空间 $U$ 是可逆算子 $\mathcal{A}$ 的不变子空间，那么 $\mathcal{A} U = U$。
\end{theorem}
\begin{exercise}{}
证明它。提示：可以先找一组基。
\end{exercise}

\begin{example}{}
上述定理在无限维度时不成立：对于空间
$$
V: = \{ (\dots, a_{-1}, a_0, a_1, \dots) \mid a_i \in \mathbb{F}\}~,
$$
即向双向无限延伸的序列的；$\mathbb{A}$是右移算符（它的逆运算是左移动算符，因此是可逆的），那么我们可以取
$$
U: = \{ (\dots, 0, a_0, a_1, \dots) \in V \}~,
$$
即 $a_i = 0, \forall i < 0$，可以发现
$$
\mathcal{A} U = \{ (\dots, 0, a_0, a_1, \dots) \in U \mid a_0 = 0 \}~
$$
是 $U$ 的真子集。
\end{example}

\addTODO{应用到群表示论}

\begin{theorem}{}\label{the_InvSP_1}
$n$ 维矢量空间 $V$ 是算子 $\mathcal{A}$ 的 $m$ 维不变子空间 $U$ 和 $(n-m)$ 维不变子空间 $W$ 的直和，当且仅当算子 $\mathcal{A}$ 的矩阵 $A$ 在某基底下具有分块对角形式
\begin{equation}\label{eq_InvSP_1}
A=\begin{pmatrix}
A_U&0\\
0&A_W
\end{pmatrix}~.
\end{equation}
其中， $A_U,A_W$ 分别是算子 $\mathcal{A}$ 分别限制在 $U$ 和 $W$ 上的算子 $\mathcal{A}|_U$ 和 $\mathcal{A}|_W$ 在该基底下对应的矩阵，而且 $A_U,A_W$ 分别是 $m$ 阶方阵和 $(n-m)$ 阶方阵。即
\begin{equation}
V=U\oplus W,\mathcal{A}U\subset U,\mathcal{A}W\subset W\Leftrightarrow A=\begin{pmatrix}
A_U&0\\
0&A_W
\end{pmatrix}~.
\end{equation}

\end{theorem}
\addTODO{这个定理不是很清晰}

\textbf{证明：}1.$
V=U\oplus W,\mathcal{A}U\subset U,\mathcal{A}W\subset W\Rightarrow A=\begin{pmatrix}
A_U&0\\
0&A_W
\end{pmatrix}
$

设 $U$ 的基底为 $(\hat e_1,\cdots,\hat e_m)$ ，$W$ 的基底为 $(\hat e_{m+1},\cdots,\hat e_n)$，则由\autoref{the_DirSum_1}~\upref{DirSum}，$(\hat e_{1},\cdots,\hat e_n)$ 是 $V$ 的基底。

由于 $\mathcal{A}u\in U, \mathcal{A} w\in W,\forall  u\in U, w\in W$，则
\begin{equation}\label{eq_InvSP_2}
\begin{aligned}
\mathcal{A}\hat e_j&=\sum_{i=1}^m a_{ij}\hat e_i\quad (j=1,\cdots ,m)~,\\
\mathcal{A}\hat e_j&=\sum_{i=m+1}^n a_{ij}\hat e_i\quad (j=m+1,\cdots ,n)~.
\end{aligned}
\end{equation}
由线性算子与矩阵的对应关系\autoref{eq_LiOper_2}~\upref{LiOper}，知算子 $\mathcal{A}$ 的对应矩阵 $A$ 即为 
\begin{equation}
A=(a_{ij})=\begin{pmatrix}
A_U&0\\
0&A_W
\end{pmatrix}~.
\end{equation}


2.$
A=\begin{pmatrix}
A_U&0\\
0&A_W
\end{pmatrix}\Rightarrow V=U\oplus W,\mathcal{A}U\subset U,\mathcal{A}W\subset W~.
$

任选 $V$ 的基底 $(\hat e_1,\cdots,\hat e_n)$, 由算子和矩阵对应关系\autoref{eq_LiOper_2}~\upref{LiOper}，即得 $A$ 对应的算子 $\mathcal{A}$ 具有关系式\autoref{eq_InvSP_2} 。而这意味着由基底 $(\hat e_1,\cdots,\hat e_m)$ 和 $(\hat e_{m+1},\cdots,\hat e_n)$ 张成的空间 $U=\langle\hat e_1,\cdots,\hat e_m\rangle$ 和 $W=\langle\hat e_{m+1},\cdots,\hat e_n\rangle$ 是算子 $\mathcal{A}$ 的不变子空间，而由基底 $(\hat e_1,\cdots,\hat e_n)$ 的线性无关性可知，$V=U\oplus W$。

\textbf{证毕！}


\begin{definition}{算子的直和}
若矢量空间 $V$ 是算子 $\mathcal{A}$ 的不变子空间 $U,W$ 的直和 $V=U\oplus W$ ，则称算子 $\mathcal{A}$ 是其限制在 $U,W$ 上的算子 $\mathcal{A}_U,\mathcal{A}_W$ 的直和，并记作
\begin{equation}
\mathcal{A}=\mathcal{A}_U\dot{+}\mathcal{A}_W~.
\end{equation}
此时称算子 $\mathcal{A}$ 对应的矩阵 $A$ 是 $\mathcal{A}_U,\mathcal{A}_W$ 对应矩阵 $A_U$ 和 $A_W$ 的直和，并记作
\begin{equation}
A=\begin{pmatrix}
A_U&0\\
0&A_W
\end{pmatrix}=A_U\dot{+}A_W~.
\end{equation}

\end{definition}
