% 调和数（基础）
% keys 调和数|数论
% license Usr
% type Tutor

\pentry{数论函数\upref{NumFun}，Euler-Mascheroni 常数\upref{Masche}}

调和级数是有名的发散级数，也是最简单的发散级数之一。既然我们不能求出发散级数的值，那我们总能计算出它的部分和，或是它趋向无穷大的阶吧。但是实际上它的部分和没有特别简单的表达式，于是，一个简单粗暴的方法是，直接把调和级数的部分和定义为一个数论函数。

\begin{definition}{调和数}
第$n$调和数$H_n$定义为调和级数的第$n$部分和，即
\begin{equation}
H_n = \sum_{i=1}^n\frac{1}{n}~.
\end{equation}
\end{definition}

可以通过积分的方法给出$H_n$的阶。

\begin{theorem}{调和数的阶}
当$n\to\infty$时，
\begin{equation}
H_n = \log n + \gamma + O(1/n) ~.
\end{equation}
其中 $\gamma$ 称为 Euler-Mascheroni 常数。
\end{theorem}

\textbf{证明}:

\begin{equation}
\begin{aligned}
H_n & = \sum_{i=1}^n\frac{1}{n}\\
& = \sum_{i=1}^n\int_n^{n+1}\frac{1}{n}\dd{t}\\
& = \sum_{i=1}^n\int_n^{n+1}\qty(\frac{1}{n}-\frac{1}{t})\dd{t}+\int_1^{t+1}\frac{1}{t}\dd{t}\\
& = \log n+\sum_{i=1}^n\int_n^{n+1}\qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t}+\log\qty(1+\frac{1}{n})\\
& = \log n+\int_1^{n+1}\qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t}+\log\qty(1+\frac{1}{n})~.
\end{aligned}
\end{equation}

我们来考察次项这个积分趋近无限时的表现，
\begin{equation}
\int_n^{n+1}\qty(\frac{1}{n}-\frac{1}{t})\dd{t}<\frac{1}{n(n+1)}<\frac{1}{n^2}~,
\end{equation}
可以知道，级数
\begin{equation}
\sum_{i=1}^{+\infty} \int_n^{n+1}\qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t}~
\end{equation}
收敛，也就是积分收敛。令
\begin{equation}
\gamma = \int_1^{+\infty} \qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t} = \sum_{i=1}^{+\infty} \int_n^{n+1}\qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t}~,
\end{equation}
我们得到
\begin{aligned}
\int_1^{n+1}\qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t}&=\gamma - \int_{n+1}^{+\infty}\qty(\frac{1}{\lfloor t\rfloor}-\frac{1}{t})\dd{t}\\
\end{aligned}
进而有