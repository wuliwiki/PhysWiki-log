% 椭圆坐标系

\begin{issues}
\issueOther{3D 图}
\end{issues}

\pentry{椭圆\upref{Elips3}， 双曲线\upref{Hypb3}， 正交曲线坐标系\upref{CurCor}}

\subsection{椭圆坐标系}
\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Elliptic_coordinate_system}{相关页面}．}
二维平面上的\textbf{椭圆坐标系（elliptic coordinate system）}是一个正交曲线坐标系， 它是三种三维正交曲线坐标系定义的基础，这三种正交曲线坐标系为：\textbf{椭圆柱坐标系（elliptic cylindrical coordinate system）}、\textbf{长椭球坐标系（ellipsoidal coordinate system）}和\textbf{扁椭球坐标系（oblate spheroidal coordinate system）}．椭圆坐标系的坐标线为共焦的椭圆和双曲线，椭圆柱坐标系由椭圆坐标系沿垂直于椭圆坐标面的方向投影得到；长（短）椭球坐标系是将椭圆坐标系绕椭圆长（短）轴方向旋转得到．

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/EliCor_1.pdf}
\caption{平面椭圆坐标系（来自 Wikipedia）} \label{EliCor_fig1}
\end{figure}

椭圆坐标系上点的位置由 $(\xi,\eta)$ 这2个有序实数表示．$\xi$ 的等值曲线为一组共焦椭圆族， 焦距为 $2c$； $\eta$ 的等值曲线为一组共焦的双曲线族，其焦点与椭圆族焦点相重． $\xi$、 $\eta$ 由直角坐标定义
\begin{equation}\label{EliCor_eq3}
\left\{\begin{aligned}
&x=c\cosh\xi\cdot\cos\eta\\
&y=c\sinh\xi\cdot\sin\eta
\end{aligned}\right.
\end{equation}
其中 $\xi\geq0,0\leq\eta<2\pi$．

若令\autoref{EliCor_fig1} 的横轴和纵轴为直角坐标的 $x, y$ 轴， 容易看出椭圆和双曲线的方程分别为
\begin{equation}\label{EliCor_eq4}
\frac{x^2}{c^2\cosh^2\xi}+\frac{y^2}{c^2\sinh^2\xi}=1
\end{equation}
\begin{equation}\label{EliCor_eq5}
\frac{x^2}{c^2\cos^2\eta}-\frac{y^2}{c^2\sin^2\eta}=1
\end{equation}
可得椭圆的离心率为 $e = 1/\cosh \xi$， 双曲线的离心率为 $e = 1/\abs{\cos \eta}$．

容易证明椭圆坐标系是一个正交曲线坐标系．在某点 $\bvec{r}$ 处，坐标轴 $\xi$ 和 $\eta$ 的方向分别为 $\pdv*{\bvec{r}}{\xi}$ 和 $\pdv*{\bvec{r}}{\eta}$．
由\autoref{EliCor_eq3} 
\begin{equation}
\left\{
    \begin{aligned}
    &\dd x=c\sinh\xi\cdot\cos\eta\dd\xi-c\cosh\xi\cdot\sin\eta\dd\eta\\
    &\dd y=c\cosh\xi\cdot\sin\eta\dd\xi+c\sinh\xi\cdot\cos\eta\dd\eta\\
    \end{aligned}\right.
\end{equation}
则
\begin{equation}
\left\{
    \begin{aligned}
&\pdv*{\bvec{r}}{\xi}=c\sinh\xi\cdot\cos\eta\ \uvec{x}+c\cosh\xi\cdot\sin\eta\ \uvec{y}\\
&\pdv*{\bvec{r}}{\eta}=-c\cosh\xi\cdot\sin\eta\ \uvec{x}+c\sinh\xi\cdot\cos\eta\ \uvec{y}\\
    \end{aligned}\right.
\end{equation}

令椭圆坐标轴 $\xi$、 $\eta$ 对应的单位矢量分别为 $\uvec{\xi}$、 $\uvec{\eta}$，由\autoref{CurCor_eq8}~\upref{CurCor}
\begin{equation}
\left\{
    \begin{aligned}
    &\uvec{\xi}=\frac{\pdv*{\bvec{r}}{\xi}}{|\pdv*{\bvec{r}}{\xi}|}=\frac{1}{\alpha}\qty(\sinh\xi\cdot\cos\eta\ \uvec{x}+\cosh\xi\cdot\sin\eta\ \uvec{y})\\
    &\uvec{\eta }=\frac{\pdv*{\bvec{r}}{\eta}}{|\pdv*{\bvec{r}}{\eta}|}=\frac{1}{\alpha}\qty(-\cosh\xi\sin\eta\ \uvec{x}+\sinh\xi\cdot\cos\eta\ \uvec{y})\\
    \end{aligned}\right.
\end{equation}
易求得 $\uvec{\xi}\vdot\uvec{\eta} = 0$,  即椭圆坐标系 $(\xi,\eta,z)$ 为正交曲线坐标系．

\subsection{椭圆柱坐标系}
椭圆柱坐标系是在椭圆坐标系的基础上增加一垂直于椭圆坐标面的 $z$ 坐标得到， 空间一点坐标用 3 个有序数 $(\xi,\eta,z)$ 表示． 同样， 若用直角坐标系定义椭圆柱坐标系， 则
\begin{equation}\label{EliCor_eq1}
\left\{\begin{aligned}
&x=c\cosh\xi\cdot\cos\eta\\
&y=c\sinh\xi\cdot\sin\eta\\
&z=z
\end{aligned}\right.
\end{equation}
其中 $\xi\geq0,0\leq\eta<2\pi,-\infty<z<+\infty$．

显然，\autoref{EliCor_eq4} 、\autoref{EliCor_eq5} 成立．现在情况变成： $\xi$ 的等值曲面为一组共焦椭圆柱面族，而 $\eta$ 的等值曲面为一组共焦的双曲柱面族， $z$ 的等值面为椭圆坐标面．

只增加垂直于椭圆坐标面的坐标轴 $z$ 意味着，椭圆柱坐标系是一个正交曲线坐标系． 其单位矢量为
\begin{equation}
\left\{
    \begin{aligned}
    &\uvec{\xi}=\frac{\pdv*{\bvec{r}}{\xi}}{|\pdv*{\bvec{r}}{\xi}|}=\frac{1}{\sqrt{\sinh^2\xi+\sin^2\eta}}\qty(\sinh\xi\cdot\cos\eta\uvec{x}+\cosh\xi\cdot\sin\eta\uvec{y})\\
    &\uvec{\eta }=\frac{\pdv*{\bvec{r}}{\eta}}{|\pdv*{\bvec{r}}{\eta}|}=\frac{1}{\sqrt{\sinh^2\xi+\sin^2\eta}}\qty(-\cosh\xi\sin\eta\uvec{x}+\sinh\xi\cdot\cos\eta\uvec{y})\\
    &\uvec{z}=\frac{\pdv*{\bvec{r}}{z}}{|\pdv*{\bvec{r}}{z}|}=\uvec{z}
    \end{aligned}\right.
\end{equation}
坐标按 $(\xi,\eta,z)$ 排序是由于 $\uvec{\xi}\cross\uvec{\eta}=\uvec{z}$（类比直角坐标系 $(x,y,z)$ 中 $\uvec x\cross\uvec y=\uvec z$）．

以下为了方便书写， 令
\begin{equation}
\alpha \equiv \sqrt{\sinh^2\xi+\sin^2\eta}
\end{equation}

\subsection{长椭球坐标系}
设二维椭圆坐标系定义在 $xOz$ 平面上，椭圆长轴与 $z$ 轴重合．将椭圆坐标系绕着 $z$ 轴旋转，便可得到长椭球坐标系（而绕 $x$ 轴旋转则得到扁椭球坐标系．不过，在扁椭球坐标系的情况我们仍选择 $z$ 轴为旋转轴，而将焦点置于 $x$ 轴上）．我们将另一坐标记为 $\phi$.

现在，情况是这样的： $\xi$ 的等值曲面为旋转椭球面， $\eta$ 的等值曲面为双叶旋转双曲面．由旋转对称性知，任一过旋转轴 $z$ 轴的平面都是椭圆坐标面（因为该平面与原来的椭圆坐标面等价），那么正交性要求 $\phi$ 坐标线必是垂直于旋转轴 $z$ 轴的平面与旋转椭球面的交线．即 $\phi$ 等值面为一组过旋转轴 $z$ 轴的半平面．这意味着， $\phi$ 等值面用直角坐标表示为
\begin{equation}
y=f(\phi)x
\end{equation}
$f(\phi)$ 是 $\phi$ 等值面与 $xOy$ 面的交线与 $x$ 轴夹角的正切值， 注意坐标零点选取的任意性，那么可取该夹角即为 $\phi$，则
\begin{equation}
y\cos\phi = x\sin\phi\quad(0\geq\phi<2\pi)
\end{equation}
要该式永远成立，必有
\begin{equation}\label{EliCor_eq2}
y = g(\xi,\eta)\sin\phi,\quad
x = g(\xi,\eta)\cos\phi
\end{equation}

$\xi$ 和 $\eta$ 的等值面用直角坐标可表示为
\begin{equation}\label{EliCor_eq6}
\begin{aligned}
\frac{z^2}{c^2\cosh^2\xi}+\frac{x^2+y^2}{c^2\sinh^2\xi}=1\\
\frac{z^2}{c^2\cos^2\eta}-\frac{x^2+y^2}{c^2\sin^2\eta}=1
\end{aligned}
\end{equation}
其中，$\xi\geq 0,0\leq\eta<\pi$．$\eta$ 取值为 $[0,\pi)$ 而非 $[0,2\pi)$ 是因为长椭球坐标系应理解为半个椭圆坐标系（$\eta\in[0,\pi)$）绕 $z$ 轴旋转 $2\pi$ 得到．

\autoref{EliCor_eq6} 第一式两边乘 $1/\sin^2\eta$， 第二式两边乘 $1/\sinh^2\xi$， 再相加可消去 $x^2+y^2$ 的项，从而解得
\begin{equation}
z=c\cosh\xi\cos\eta
\end{equation}
解得的 $z$ 再代入\autoref{EliCor_eq6} ，得到
\begin{equation}\label{EliCor_eq7}
x^2+y^2=c^2\sinh^2\xi\sin^2\eta
\end{equation}
\autoref{EliCor_eq2} 又要求
\begin{equation}\label{EliCor_eq8}
x^2+y^2=g^2(\xi,\eta)
\end{equation}
比较\autoref{EliCor_eq7} 和\autoref{EliCor_eq8} ，得
\begin{equation}\label{EliCor_eq9}
g(\xi,\eta)=c\sinh\xi\sin\eta
\end{equation}
\autoref{EliCor_eq9} 代入\autoref{EliCor_eq2} ，求得
\begin{equation}
\begin{aligned}
x=c\sinh\xi\sin\eta\cos\phi\\
y=c\sinh\xi\sin\eta\sin\phi
\end{aligned}
\end{equation}

综上，长椭球坐标系与直角坐标系有如下关系
\begin{equation}\label{EliCor_eq10}
\begin{aligned}
&x=c\sinh\xi\sin\eta\cos\phi\\
&y=c\sinh\xi\sin\eta\sin\phi\\
&z=c\cosh\xi\cos\eta
\end{aligned}
\end{equation}
其中，$\xi\geq 0,0\leq\eta<\pi,0\leq\phi<2\pi$.

当然，这是一个正交曲线坐标系，因为我们正是由正交性条件得到的\autoref{EliCor_eq10} ．

与椭圆坐标系和椭圆柱坐标系求单位矢量的方法一样，我们得到下面的结果
\begin{equation}
\begin{aligned}
&\uvec{\xi}=\frac{1}{\alpha}\qty(\cosh\xi\sin\eta\cos\phi\uvec{x}+\cosh\xi\sin\eta\sin\phi\uvec{y}+\sinh\xi\cos\eta\uvec{z})\\
&\uvec{\eta}=\frac{1}{\alpha}\qty(\sinh\xi\cos\eta\cos\phi\uvec{x}+\sinh\xi\cos\eta\sin\phi\uvec{y}-\cosh\xi\sin\eta\uvec{z})\\
&\uvec{\phi}=\frac{1}{\sqrt{2}\sinh\xi\sin\eta}\qty(-\sinh\xi\sin\eta\sin\phi\uvec{x}+\sinh\xi\sin\eta\cos\phi\uvec{y})
\end{aligned}
\end{equation}
\subsection{扁椭球坐标系}
扁椭球坐标系是由长轴在 $x$ 轴，椭圆坐标面在 $xOz$ 面中的椭圆坐标系绕 $z$ 轴旋转得到的．由此可知，椭圆坐标系的两个焦点，变为一个半径为 $c$ 的圆，包含于三维空间的 $xOy$ 平面．称这圆为\textbf{焦圆}，又称为\textbf{参考圆}．

与长椭球坐标系一样的做法，我们可得到扁椭球坐标系与直角坐标系的关系
\begin{equation}\label{EliCor_eq11}
\begin{aligned}
&x=c\cosh\xi\cos\eta\cos\phi\\
&y=c\cosh\xi\cos\eta\sin\phi\\
&z=c\sinh\xi\sin\eta
\end{aligned}
\end{equation}
其中，$\xi\geq 0,-\frac{\pi}{2}\leq\eta<\frac{\pi}{2},-\pi\leq\phi<\pi$．这里， $\phi$ 取 $[-\pi,<\pi)$ 只不过是将 $\phi$ 坐标的起点选为 $-\pi$.

扁椭球坐标系中坐标的单位矢量为
\begin{equation}
\begin{aligned}
&\uvec{\xi}=\frac{1}{\alpha}\qty(\sinh\xi\cos\eta\cos\phi\uvec{x}+\sinh\xi\cos\eta\sin\phi\uvec{y}+\cosh\xi\sin\eta\uvec{z})\\
&\uvec{\eta}=\frac{1}{\alpha}\qty(-\cosh\xi\sin\eta\cos\phi\uvec{x}-\cosh\xi\cos\eta\sin\phi\uvec{y}+\sinh\xi\cos\eta\uvec{z})\\
&\uvec{\phi}=\frac{1}{\sqrt{2}\cosh\xi\cos\eta}\qty(-\cosh\xi\cos\eta\sin\phi\uvec{x}+\cosh\xi\cos\eta\cos\phi\uvec{y})
\end{aligned}
\end{equation}

\subsection{椭圆柱、长（扁）椭球坐标系中的矢量算符}
\pentry{正交曲线坐标系中的矢量算符\upref{CVecOp}}
我们先来求三个正交曲线坐标系的\textbf{拉梅系数} $\Big|\pdv*{\bvec{r}}{q_i}\Big|\;(i=1,2,3)$，其中 $q_i$ 为坐标系的3个坐标．由\autoref{EliCor_eq1} ，得椭圆柱坐标系的拉梅系数
\begin{equation}
H_\xi=H_\eta=c\alpha \quad \quad H_z=1
\end{equation}
由\autoref{EliCor_eq10} ，得长椭球坐标系的拉梅系数
\begin{equation}
H_\xi=H_\eta=c\alpha \quad \quad H_\phi=\sqrt{2}c\sinh\xi\sin\eta
\end{equation}
由\autoref{EliCor_eq11} ，得扁椭球坐标系的拉梅系数
\begin{equation}
H_\xi=H_\eta=c\alpha \quad \quad H_\phi=\sqrt{2}c\cosh\xi\cos\eta
\end{equation}
\subsubsection{椭圆柱坐标系中的矢量算符}
结合\autoref{CVecOp_eq7}~\upref{CVecOp} 到\autoref{CVecOp_eq6}~\upref{CVecOp}，注意这里，$u=\xi,v=\eta,w=z,H_\xi=f,H_\eta=g,H_z=h$，得

\begin{equation}
\grad s = \frac{1}{c\alpha} \pdv{s}{\xi}\uvec \xi + \frac{1}{c\alpha}\pdv{s}{\eta} \uvec \eta +  \pdv{s}{z}\uvec z
\end{equation}
\begin{equation}
\begin{aligned}
\div \bvec A = &\frac{1}{c^2\qty(\sinh^2\xi+\sin^2\eta)}\Bigg[\pdv{\xi}(c\alpha A_\xi) \\&+ \pdv{\eta}\qty(c\alpha A_\eta) + \pdv{z}\qty(c^2\qty(\sinh^2\xi+\sin^2\eta)A_z)\Bigg]
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
&\curl \bvec A = \frac{1}{c\alpha}\qty[\pdv{\eta}A_z - \pdv{z}\qty(c\alpha A_\eta)]\uvec \xi\\
&\quad + \frac{1}{c\alpha}\qty[\pdv{z}\qty(c\alpha A_\xi) - \pdv{\xi}A_z]\uvec \eta
+ \\
&\frac{1}{c^2\qty(\sinh^2\xi+\sin^2\eta)}\qty[\pdv{\xi}\qty(c\alpha A_\eta) - \pdv{\eta}\qty(c\alpha A_\xi)]\uvec z
\end{aligned}
\end{equation}
\begin{equation}
\laplacian s = \frac{1}{c^2\qty(\sinh^2\xi+\sin^2\eta)}\qty(\pdv[2]{s}{\xi} + \pdv[2]{s}{\eta} )+ \pdv[2]{s}{z}
\end{equation}

\subsubsection{长椭球坐标系中的矢量算符}
这里，$u=\xi,v=\eta,w=\phi,H_\xi=f,H_\eta=g,H_\phi=h$，同样有

\begin{equation}
\grad s = \frac{1}{c\alpha} \pdv{s}{\xi}\uvec \xi + \frac{1}{c\alpha}\pdv{s}{\eta} \uvec \eta +  \frac{1}{\sqrt{2}c\sinh\xi\sin\eta}\pdv{s}{\phi}\uvec \phi
\end{equation}
\begin{equation}
\begin{aligned}
\div \bvec A = &\frac{1}{c\sinh\xi\sin\eta\qty(\sinh^2\xi+\sin^2\eta)}\Bigg[\sin\eta\pdv{\xi}(\sinh\xi\alpha A_\xi) \\&+ \sinh\xi\pdv{\eta}\qty(\sin\eta\alpha A_\eta) + \frac{\sinh^2\xi+\sin^2\eta}{\sqrt{2}}\pdv{\phi}A_\phi\Bigg]
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
\curl \bvec A =& \frac{1}{\sqrt{2}c\sinh\xi\sin\eta\alpha}\qty[\sqrt{2}\sinh\xi\pdv{\eta}\qty(\sin\eta
A_\phi) - \alpha\pdv{\phi}A_\eta]\uvec \xi\\
&+ \frac{1}{\sqrt{2}c\sinh\xi\sin\eta\alpha}\qty[\alpha\pdv{\phi}A_\xi - \sqrt{2}\sin\eta\pdv{\xi}\qty(\sinh\xi
A_\phi)]\uvec \eta
\\
&+\frac{1}{c\qty(\sinh^2\xi+\sin^2\eta)}\qty[\pdv{\xi}\qty(\alpha A_\eta) - \pdv{\eta}\qty(\alpha A_\xi)]\uvec \phi
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
\laplacian s &= \frac{1}{c^2\sinh\xi\sin\eta\qty(\sinh^2\xi+\sin^2\eta)}\qty[\sin\eta\pdv{\xi}\qty(\sinh\xi\pdv{s}{\xi}) + \sinh\xi\pdv{\eta}\qty(\sin\eta\pdv{s}{\eta})]\\
& + \frac{1}{2c^2\sinh^2\xi\sin^2\eta }\pdv[2]{s}{\phi}
\end{aligned}
\end{equation}

\subsubsection{扁椭球坐标系中的矢量算符}
同样的，这里有
\begin{equation}
\grad s = \frac{1}{c\alpha} \pdv{s}{\xi}\uvec \xi + \frac{1}{c\alpha}\pdv{s}{\eta} \uvec \eta +  \frac{1}{\sqrt{2}c\cosh\xi\cos\eta}\pdv{s}{\phi}\uvec \phi
\end{equation}
\begin{equation}
\begin{aligned}
\div \bvec A = &\frac{1}{c\cosh\xi\cos\eta\qty(\sinh^2\xi+\sin^2\eta)}\Bigg[\cos\eta\pdv{\xi}(\cosh\xi\alpha A_\xi) \\&+ \cosh\xi\pdv{\eta}\qty(\cos\eta\alpha A_\eta) + \frac{\sinh^2\xi+\sin^2\eta}{\sqrt{2}}\pdv{\phi}A_\phi\Bigg]
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
\curl \bvec A =& \frac{1}{\sqrt{2}c\cosh\xi\cos\eta\alpha}\qty[\sqrt{2}\cosh\xi\pdv{\eta}\qty(\cos\eta
A_\phi) - \alpha\pdv{\phi}A_\eta]\uvec \xi\\
&+ \frac{1}{\sqrt{2}c\cosh\xi\cos\eta\alpha}\qty[\alpha\pdv{\phi}A_\xi - \sqrt{2}\cos\eta\pdv{\xi}\qty(\cosh\xi
A_\phi)]\uvec \eta
 \\
&+\frac{1}{c\qty(\sinh^2\xi+\sin^2\eta)}\qty[\pdv{\xi}\qty(\alpha A_\eta) - \pdv{\eta}\qty(\alpha A_\xi)]\uvec \phi
\end{aligned}
\end{equation}
\begin{equation}
\begin{aligned}
\laplacian s &= \frac{1}{c^2\cosh\xi\cos\eta\qty(\sinh^2\xi+\sin^2\eta)}\qty[\cos\eta\pdv{\xi}\qty(\cosh\xi\pdv{s}{\xi}) + \cosh\xi\pdv{\eta}\qty(\cos\eta\pdv{s}{\eta})]\\
&+ \frac{1}{2c^2\cosh^2\xi\cos^2\eta }\pdv[2]{s}{\phi}
\end{aligned}
\end{equation}

%\addTODO{写出梯度散度旋度， 引用 “正交曲线坐标系中的矢量算符\upref{CVecOp}”}
