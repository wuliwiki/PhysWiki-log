% 粒子交换算符
% keys 交换算符|本征值|本征矢|自旋态|哈密顿算符|厄米算符
% license Xiao
% type Tutor

\begin{issues}
\issueOther{讨论和证明多个全同粒子的对称和反对称子空间维数（若每个粒子处于 $N$ 维空间）}
\end{issues}

\pentry{全同粒子\nref{nod_IdPar}，正交子空间\nref{nod_OrthSp}}{nod_9452}

对双粒子波函数， 定义\textbf{粒子交换算符（particle exchange operator）}为
\begin{equation}\label{eq_ExchOp_3}
P_{1,2}\psi(\bvec r_1, \bvec r_2) = \psi(\bvec r_2, \bvec r_1)~.
\end{equation}
可以证明这是一个厄米算符， 即
\begin{equation}
\braket{\phi}{P_{1,2}\psi} = \braket{P_{1,2}\phi}{\psi}~.
\end{equation}
不难证明该算符有且只有 $1$ 和 $-1$ 两个本征值， 根据\enref{厄米算符本征方程的性质}{HerEig}，对应的本征矢空间是两个\enref{互补的正交子空间}{OrthSp}，量空间分别由对称波函数和反对称波函数（以下分别记为 $\psi_+$ 和 $\psi_-$）的集合构成， 即满足
\begin{equation}
\psi_\pm(\bvec r_2, \bvec r_1) = \pm\psi_\pm(\bvec r_1, \bvec r_2)~,
\end{equation}
这两个子空间外的波函数既非对称也非反对称。

若交换算符作用在双粒子自旋态上， 使用\autoref{eq_IdPar_3}  的记号表示就是
\begin{equation}\label{eq_ExchOp_6}
P_{1,2}\ \chi_{1,2} = \chi_{2,1}~.
\end{equation}

\subsection{一般希尔伯特空间中的交换算符}
那么一般来说我们如何定义双粒子态空间中的交换算符呢？ 首先我们要确定单粒子空间， 并找到一组单粒子的基底 $\qty{\ket{i}}$。 然后把两个单粒子空间做张量积得到双粒子的态空间， 基底取 $\qty{\ket{i}\ket{j}}$。 交换算符作用在某个双粒子态矢上， 就先将其在基底 $\qty{\ket{i}\ket{j}}$ 上展开， 再将每个基底 $\ket{i}\ket{j}$ 替换为 $\ket{j}\ket{i}$ 即可：
\begin{equation}\label{eq_ExchOp_4}
P_{1,2} \sum_{i,j} C_{i,j} \ket{i}\ket{j} = \sum_{i,j} C_{i,j} \ket{j}\ket{i} = \sum_{i,j} C_{j,i} \ket{i}\ket{j}~.
\end{equation}

\subsubsection{连续本征矢}
交换算符的定义也可以拓展到连续本征矢的情况。 例如在\autoref{eq_ExchOp_3} 中， 单粒子的位置本征态基底记为 $\ket{\bvec r}$， 张量积空间的基底记为 $\ket{\bvec r_1}\ket{\bvec r_2}$， 那么\autoref{eq_ExchOp_4} 中求和变为积分
\begin{equation}
P_{1,2} \int \psi(\bvec r_1, \bvec r_2) \ket{\bvec r_1}\ket{\bvec r_2} \dd[3]{r_1} \dd[3]{r_2} = \int \psi(\bvec r_2, \bvec r_1) \ket{\bvec r_1}\ket{\bvec r_2} \dd[3]{r_1} \dd[3]{r_2}~.
\end{equation}

\subsubsection{多个粒子的情况}
$N > 2$ 个全同粒子波函数的交换算符也可以通过上述方法借助基底来定义。 我们可以把交换粒子 $i,j$ （$i\ne j$） 的算符记为 $P_{i,j}$， 共有 $C_N^2 = n(n-1)/2$ 个。 例如三粒子空间中，
\begin{equation}
P_{2,3} \ket{i}\ket{j}\ket{k} = \ket{i}\ket{k}\ket{j}~.
\end{equation}
这些算符中有一些是对易的（如 $P_{1,2}$ 和 $P_{3,4}$）， 一些是不对易的（如 $P_{1,2}$ 和 $P_{2,3}$）。

在多个全同粒子的态空间中， 玻色子的态矢只能处于所有交换算符的对称子空间的交集中， 这个交集仍然是矢量空间（\autoref{the_SubSpc_1}）； 费米子的态矢只能处于所有交换算符的反对称子空间的交空间中。

显然， 同一个交换算符的乘积是单位算符：
\begin{equation}\label{eq_ExchOp_7}
P_{i,j}^2 = 1~.
\end{equation}
即同一个交换算符作用两次后， 任意态矢都保持不变。

\subsection{与哈密顿算符对易}

\pentry{守恒量（量子力学）\nref{nod_QMcons}}{nod_e03e}
对于全同粒子， 交换算符与哈密顿算符对易\footnote{对非全同粒子则不成立， 例如两个质量不同的粒子的动能算符与交换算符不对易}。 这保证了 $P$ 是一个\enref{守恒量}{QMcons}。也就是全同粒子的波函数在按照薛定谔方程演化过程中将一直保持对称性或反对称性。

% \subsection{对称和反对称子空间的维度}

% 单粒子的自旋态的一组基底是 $\qty{\ket{s, m_s}}$， 其中 $-s \le m_s \le s$， 即空间的维数为 $2s+1$。 那么可区分的双粒子所在的自旋态就是该空间和自己的张量积空间， 如果它们自旋相同， 令 $s = s_1 = s_2$， 则维数为 $(2s+1)^2$， 基底可以记为（省略 $s$ 方便书写） $\ket{m_{s1}}\ket{m_{s2}}$。

% 如果只考虑自旋态的交换对称

%代表  $\uparrow\uparrow$ 代表两个电子都处于上旋本征态 $\ket{s=1/2,m_s=1/2}$， 显然是对称的， 而 $\uparrow\downarrow$ 代表一个上旋一个下旋， 粒子交换后变为 $\downarrow\uparrow$ 既不对称也不是反对称。

% 如果考虑自旋， 单个粒子的状态所在的空间是波函数和自旋态所在的希尔伯特空间的\enref{张量积空间}{Tensor}， 也是希尔伯特空间。 而多个粒子状态所在的空间又是单粒子态空间的张量积。 例如双粒子的状态就是四个空间的张量积， 为了方便， 我们往往会先对两个波函数空间做张量积， 得到双粒子波函数

\subsection{本征态与测量}
两个全同粒子的本征态（或者其他任何态）也必须是必须是对称或反对称的， 例如双粒子的位置本征态
$$\frac{1}{\sqrt 2}[\delta_{\bvec r_a}(\bvec r_1) \delta_{\bvec r_b}(\bvec r_2)\pm \delta_{\bvec r_b}(\bvec r_1) \delta_{\bvec r_a}(\bvec r_2)]~.$$
只能告诉我们一个粒子在 $\bvec r_a$ 处另一个粒子在 $\bvec r_b$ 处， 仍然不能区分它们。

于是根据测量理论， 我们仍然要将总波函数（已满足对称或反对称）投影到本征态上去。 例如位置的概率分布为
\begin{equation}\label{eq_ExchOp_1}
\begin{aligned}
f(\bvec r_1, \bvec r_2) &= \abs{\frac{1}{\sqrt{2}}\int [\delta_{\bvec r_1}(\bvec r'_1) \delta_{\bvec r_2}(\bvec r'_2) \pm \delta_{\bvec r_2}(\bvec r'_1) \delta_{\bvec r_1}(\bvec r'_2)] \psi_\pm(\bvec r'_1,\bvec r'_2) \dd[3]{r'_1}\dd[3]{r'_2}}^2\\
&= \abs{\frac{1}{\sqrt{2}} \psi_\pm(\bvec r_1, \bvec r_2) \pm  \frac{1}{\sqrt{2}} \psi_\pm(\bvec r_2, \bvec r_1)}^2\\
&= \abs{\frac{1}{\sqrt{2}} \psi_\pm(\bvec r_1, \bvec r_2) +  \frac{1}{\sqrt{2}} \psi_\pm(\bvec r_1, \bvec r_2)}^2\\
&= 2\abs{\psi_\pm(\bvec r_1, \bvec r_2)}^2~.
\end{aligned}
\end{equation}
注意该式中 $f(\bvec r_1, \bvec r_2)$ 不区分 $\bvec r_1, \bvec r_2$ 的顺序。 也就是说 $f(\bvec r_1, \bvec r_2)$ 告诉我们一个粒子在 $\bvec r_1$， 另一个在 $\bvec r_2$ 的概率密度。

对应地， 在做归一化时如果对全空间积分， 在每一个 $f(\bvec r_1, \bvec r_2)$ 都重复计算了 $f(\bvec r_2, \bvec r_1)$。 所以最直接的解决的方法是对全空间积分后除以 $2$， 使归一化条件为
\begin{equation}\label{eq_ExchOp_2}
\frac{1}{2}\int f(\bvec r_1, \bvec r_2) \dd[3]{r_1}\dd[3]{r_2} = \int \abs{\psi_\pm(\bvec r_1, \bvec r_2)}^2 \dd[3]{r_1}\dd[3]{r_2} = 1~.
\end{equation}

另一种方法是不除 2， 而是选取上式积分范围的一半使得对任何 $f(\bvec r_1, \bvec r_2)$， $f(\bvec r_2, \bvec r_1)$ 不会被重复计算， 在一维运动情况下， 我们可以只对 $r_1, r_2$ 平面满足 $r_1 < r_2$ 的一半积分。 在多维运动时， 我们只需要选取任意一个坐标， 例如令 $y_1 < y_2$ 即可将整个积分范围划分为满足要求的两半\footnote{也可以使用任何可以区分粒子交换的条件， 例如 $x_1^2 + y_1^2 + z_1^2 < x_2^2 + y_2^2 + z_2^2$， 将角标 $1$ 和 $2$ 互换后， 两条不等式只能满足一条。}。

\begin{example}{单粒子位置分布}\label{ex_ExchOp_1}
若两个全同粒子的波函数为 $\psi(\bvec r_1,\bvec r_2)$， 求单个粒子的位置分布 $P(\bvec r)$。 注意我们并不能求 $P(\bvec r_1)$ 或者 $P(\bvec r_2)$。

我们只需要将\autoref{eq_ExchOp_1} 对其中一个 $\bvec r$ 全空间积分即可
\begin{equation}
f(\bvec r) = \int f(\bvec r, \bvec r') \dd[3]{r'} = 2\int \abs{\psi_\pm(\bvec r, \bvec r')}^2 \dd[3]{r'} ~.
\end{equation}
根据\autoref{eq_ExchOp_2}， 发现一个粒子的总概率是 $\int f(\bvec r) \dd[3]{r} = 2$ 而不是 $1$。 这并没有问题， 因为空间中共有两个粒子。
\end{example}

\subsubsection{一般投影}
类比\autoref{eq_ExchOp_1} 可以发现， 将任何对称或反对称的双粒子波函数 $\psi(\bvec r_1, \bvec r_2)$ 投影到形式为
\begin{equation}
[\phi_1(\bvec r_1)\phi_2(\bvec r_2) \pm \phi_2(\bvec r_1)\phi_1(\bvec r_2)]/\sqrt{2}~.
\end{equation}
且具有相同交换对称性的波函数上， 都会得到相同的两项相加\footnote{如果投影到对称性相反的波函数上， 结果为零}。 所以为了方便计算， 我们可以只投影到第一项 $\phi_1(\bvec r_1)\phi_2(\bvec r_2)$ 上再乘以 $\sqrt{2}$ 即可。
\addTODO{以下内容来自个人笔记， 有待整理和审评}

\subsection{算符}
现在来看上述的对称或反对称空间允许什么样的算符， 即什么算符在这两个子空间是闭合的。 闭合是指算符作用完后仍然落在同一空间， 即
\begin{equation}
P_{1,2}\Omega\ket{\Psi} = \pm \Omega \ket{\Psi}~,
\end{equation}
即所有满足 $P_{1,2}\Omega = \pm \Omega$ 的算符。

首先， 同一个单粒子算符对所有粒子作用之和满足该条件， 例如总动能 $T = T_1 + T_2$。 满足 $P_{1,2}T = T$。 又例如外势能（非相互作用势能） $V = V(\bvec r_1) + V(\bvec r_2)$。 不允许单独出现单粒子算符， 例如 $V(\bvec r_1)$。

同理， 不允许出现不同的算符分别作用于两粒子 $U_1 + V_2$。

从物理意义上来说， 就是不允许出现任何可以区分两个全同粒子的算符。 因为全同粒子绝对不可区分，所以任何作用（算符）不可能对两个全同粒子具有不同的形式。

另一类允许的算符是多粒子算符， 例如两粒子间的相互作用 $V(\bvec r_1, \bvec r_2) = V(\abs{\bvec r_2 - \bvec r_1})$。

\subsection{可分离哈密顿}
在对称或反对称子空间中， 如果总哈密顿量可以写成各个粒子的哈密顿量之和 $H = \sum H_i$， (注意 $H_i$ 对每个粒子的形式必须一样)， 则可先计算单个粒子的本征方程 $H_i \ket{\psi_{in}} = E_{in}\ket{\psi_{in}}$ (对任何 $i$ 形式都一样)， 总能量为 $E_{n_1,n_2,\dots} = \sum_i E_{n_i}$ ， 总波函数为Slater行列式（费米子）以及对称化算符（玻色子）， 双粒子系统中即 $(\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i})/\sqrt{2}$。

双粒子系统的证明： $\ket{\psi_i}$ 是单粒子薛定谔方程的波函数， 可区分双粒子的完备基底为 $\ket{\psi_j}\ket{\psi_i}$ ， 但这些基底中只有 $\ket{\psi_k}\ket{\psi_k}$ 落在玻色子子空间， 剩下的基底都不是 $P_{1,2}$ 的本征值。 为了构建对称和反对称子空间， 先把所有 $i \ne j$ 的基底分为成对的 $\ket{\psi_i}\ket{\psi_j}$ $\ket{\psi_j}\ket{\psi_i}$， 把每一对分别相加和相减再归一化得到许多对新的基底 $(\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i})/\sqrt{2}$ (显然这么做不失完备性)， 不难看出， 所有含加号的基底张成完备的双波色子空间， 所有含减号的基底张成完备的双费米子空间。 这说明在双粒子系统中， 全空间等于对称子空间和反对称子空间的直和 （即两个子空间的基底一起张成全空间）。 然而对多粒子系统， 这并不成立， 但用Slater行列式和 “正Slater行列式” 得到的两组基底仍然是完备的。 继续双粒子的情况， 现在证明上面得到的两个子空间的基底已经是总哈密顿量的本征矢了
\begin{equation}
\begin{aligned}
(H_1 + H_2) (\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i}) &= E_i \ket{\psi_i}\ket{\psi_j} \pm E_j \ket{\psi_j}\ket{\psi_i} + E_j \ket{\psi_i}\ket{\psi_j} \pm E_i \ket{\psi_j}\ket{\psi_i}\\
&= (E_i + E_j) (\ket{\psi_i}\ket{\psi_j} \pm \ket{\psi_j}\ket{\psi_i})~.
\end{aligned}
\end{equation}

证毕。
多维的情况可以用对称和反对称算符的运算证明，（详见 Bransden）。

\subsection{可分离态的时间演变}
从物理意义上来看， 可分离变量意味着粒子间没有相互作用， 例如 $V(\abs{\bvec r_i, \bvec r_j})$ 项。 那么没有相互作用的两个粒子是否需要对称化或反对称化呢？ 如果需要， 那么原则上我们将要把全宇宙所有的全同粒子（反）对称化！ 这是一定要的， 因为量子力学对全同粒子的基本假设就是态矢只能落在对称空间或反对称空间， 这两个空间之外的所有态矢不可能存在， 它们违反了全同粒子假设！ 另外， $\bvec r_1, \bvec r_2$ ， 这些角标只是符号工具， 二次量子化中将彻底抛弃角标。

根据所有全同粒子对称化的原理， 看两个粒子的波函数 $(\ket{\psi_1}\ket{\psi_2} \pm \ket{\psi_2}\ket{\psi_1})/\sqrt{2}$， 如果 $(\ket{\psi_i}$ 与 $\ket{\psi_j}$ 相距很远， 波函数完全没有重合， 时刻 $t_1$ 在 $\ket{\psi_1}$ 的附近测到一个粒子， 然后时刻 $t_2$ 在 $\ket{\psi_2}$ 范围测到一个粒子， 能不能说这是刚才的粒子呢？ 不能！ 只能说全宇宙有 $N$ 个这种粒子， $t_1$ 的时候其中一个在 $\ket{\psi_1}$ 附近， $t_2$ 的时候其中一个在 $\psi_2$ 附近。
