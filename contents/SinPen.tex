% 单摆（大摆角）
% 单摆|周期|椭圆积分|微分方程|机械能

\pentry{单摆\upref{Pend}， 椭圆积分\upref{EliInt}}

令最大摆角为 $\theta_0$， 能量守恒， 机械能为
\begin{equation}
E = \frac{1}{2} m l^2 \dot \theta^2 - mg l \cos\theta = - mg l \cos\theta_0
\end{equation}
所以 $\theta$ 处的角速度为
\begin{equation}
\dot{\theta} = \sqrt{\frac{2g}{l} (\cos\theta - \cos\theta_0) }
\end{equation}
令 $t = 0$ 时 $\theta = 0$ 且 $\dot{\theta} > 0$， 该微分方程的解% 链接未完成
可以用椭圆积分\autoref{EliInt_eq2}~\upref{EliInt} 表示
\begin{equation}\label{SinPen_eq1}
t(\alpha) = \sqrt{\frac{l}{2g}} \int_0^{\alpha} \frac{\dd{\theta}}{\sqrt{\cos\theta - \cos\theta_0}}
= \sqrt{\frac{l}{g}} \csc\frac{\theta_0}{2} F\qty(\frac{\alpha}{2}, \csc\frac{\theta_0}{2})
\qquad (0 \leqslant \alpha \leqslant \theta_0)
\end{equation}
周期可以表示为从最低点第一次摆到最高点所需时间的 4 倍
\begin{equation}
T = 4t(\theta_0) = 4 \sqrt{\frac{l}{g}} \csc\frac{\theta_0}{2} F\qty(\frac{\theta_0}{2}, \csc\frac{\theta_0}{2})
\end{equation}
Wikipedia 给出的公式为
\begin{equation}\label{SinPen_eq3}
T = 4 \sqrt{\frac{l}{g}} F\qty(\frac{\pi}{2}, \sin\frac{\theta_0}{2})
\end{equation}
此式可由\autoref{SinPen_eq1} 作如下变换得到：
\begin{equation}\label{SinPen_eq2}
t(\alpha)=\frac12\sqrt{\frac{l}{g}}\int_{0}^{\alpha}\frac{\mathrm{d}\theta}{\sqrt{\sin^2\frac{\theta_0}2-\sin^2\frac{\theta}2}}
\end{equation}
令
\begin{equation}
\sin \phi(\theta)=\frac{\sin^2\frac{\theta}2}{\sin^2\frac{\theta_0}2}
\end{equation}
则
\begin{equation}
\mathrm d\theta=2\frac{\sin\frac{\theta_0}2}{\cos\frac{\theta}2}\cos\phi(\theta)\mathrm d\phi
=2\frac{\sin\frac{\theta_0}2}{\sqrt{1-\sin^2\frac{\theta}2}}\sqrt{1-\sin^2\phi(\theta)}\mathrm d\phi
=2\frac{\sqrt{\sin^2\frac{\theta_0}2-\sin^2\frac{\theta}2}}{\sqrt{1-\sin^2\frac{\theta_0}2\sin^2{\phi(\theta)}}}\mathrm d\phi
\end{equation}
代入\autoref{SinPen_eq2} 有
\begin{equation}
t(\alpha)=\sqrt{\frac{l}{g}}\int_{0}^{\phi(\alpha)}\frac{\mathrm{d}\phi}{\sqrt{1-\sin^2\frac{\theta_0}2\sin^2{\phi(\theta)}}}
\end{equation}
又$\phi(\theta_0)=\frac\pi2$，则
\begin{equation}
T=4t(\theta_0)=\sqrt{\frac{l}{g}}\int_{0}^{\frac\pi2}\frac{\mathrm{d}\phi}{\sqrt{1-\sin^2\frac{\theta_0}2\sin^2{\phi(\theta)}}}=4 \sqrt{\frac{l}{g}} F\qty(\frac{\pi}{2}, \sin\frac{\theta_0}{2})
\end{equation}
与\autoref{SinPen_eq3} 相同。


（图未完成）（未完成：周期的级数展开， $\theta(t)$ 级数解）
