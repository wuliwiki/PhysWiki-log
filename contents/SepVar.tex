% 分离变量法解偏微分方程
% 偏微分方程|分离变量

\begin{issues}
\issueDraft
\end{issues}

在求解各种物理问题中的偏微分方程时， 我们经常使用\textbf{分离变量法}。 不夸张地说， 分离变量法在解各种物理学的偏微分方程是最重要最常用的方法。 在分离变量法中， 我们假设微分方程的解可以表示为
\begin{equation}\label{SepVar_eq2}
f(x_1, \dots , x_N) = \sum_{i_1, \dots, i_N} c_{i_1, \dots, i_N} f_{i_1}(x_1) f_{i_2}(x_2) \dots f_{i_N}(x_N)
\end{equation}
即每个变量都具有一组一元函数， 这些一元函数的乘积的线性组合可以表示方程的解。 若将该式代入偏微分方程， 可以分别得到关于每个变量 $x_i$ 的常微分方程， 我们就说这个偏微分方程式\textbf{可分离变量}的。 我们通过一个例子来说明。

% ======= 回收 ======

% 以二元偏微分方程为例，要解该方程，先假设…乘积，
% 由于等号左边只含有 ，右边只含有y，所以两边只能等于一个常数。原因如下：

% 若 是方程的一个解，则在定义域中任意改变 $x, y$ 上式都成立。现在令 不变(等号左边为常数)，当y在定义域内任意变化时，由于等式必须成立，等式右边必须是同一常数。现在，当x变化是，等号左边也是同一常数。


% 这样，一个偏微分方程就变成了两个常微分方程。解这两个方程，得到偏微分方程的一个特解。

% 在大部分情况下，所有特解的线性组合就是通解…。

% ==================


\subsection{弦上的驻波}

\pentry{一维波动方程\upref{WEq1D}， 多元函数的傅里叶级数\upref{NdFuri}}

一维的波动方程（\autoref{WEq1D_eq3}~\upref{WEq1D}）为
\begin{equation}
\pdv[2]{x} f(x, t) - \frac{1}{v^2} \pdv[2]{t}f(x, t) = 0
\end{equation}
假设弦长为 $a$， 两端固定， 则边界条件为
\begin{equation}\label{SepVar_eq3}
f(0, t) = f(a, t) = 0
\end{equation}
显然， $f(x, t) \equiv 0$ 是方程的一个解， 代表一根静止的弦， 但这对我们并没有什么用。 那么有哪些些非零的解呢？ 我们现在只会解一些常微分方程， 而 $f(x, t)$ 是一个二元函数， 让人有点无从下手， 所以我们可以先猜测某个解具有
\begin{equation}\label{SepVar_eq1}
f_n(x, t) = X_n(x) T_n(t)
\end{equation}
的形式， 即分别含有两个变量的两个一元函数相乘。 把\autoref{SepVar_eq1} 代入原方程\autoref{SepVar_eq2} ， 得
\begin{equation}
\pdv[2]{x}[X_n(x)T_n(t)] - \frac{1}{v^2}\pdv[2]{t} [X_n(x) T_n(t)] = 0
\end{equation}
% 但考虑到偏微分的计算法则， 有
% \begin{equation}
% \pdv[2]{XT}{x} = T \dv[2]{X_n}{x}
% \end{equation}
% \begin{equation}
% \pdv[2]{X_nT_n}{t} = X \dv[2]{T_n}{t}
% \end{equation}
根据求导法则，方程变为
\begin{equation}
T_n\dv[2]{X_n}{x} = \frac{X_n}{v^2} \dv[2]{T_n}{t}
\end{equation}
现在把方程两边同时除以 $X_nT_n$， 使等式左边只是 $x$ 的函数， 右边只是 $t$ 的函数
\begin{equation}
\frac{1}{X_n}\dv[2]{X_n}{x} = \frac{1}{v^2 T_n} \dv[2]{T_n}{t}
\end{equation}
让我们观察一下这个方程的特点。在某个时刻 $t$， $X(x)$ 必定会随 $x$ 变化（因为我们要找的是非零解， 弦不可能是一条直线）。 反之， 如果保持 $x$ 不变（观察弦上某个点的运动情况）， $T(t)$ 也必须随 $t$ 改变（因为弦上的任意一点一般会做某种运动， 例如振动， 不可能都静止）。 把这样的推理用到上式， 就会得出， 唯一可能让等式成立的方法是方程两边分别等于一个常数， 因为 $x$ 不变时方程左边是常数，  $t$ 不变时方程右边是常数。 若设这个常数为 $-k^2$（一个任意实数， 这么表示是为了下文书写方便）， 得
\begin{equation}
\frac{1}{X_n}\dv[2]{X_n}{x} = -k^2
\qquad
\frac{1}{v^2 T_n}\dv[2]{T_n}{t} = -k^2
\end{equation}
或
\begin{equation}
\dv[2]{X_n}{x} + k^2 X_n = 0
\qquad
\dv[2]{T_n}{t} + v^2k^2 T_n = 0
\end{equation}
这两条都是一维齐次亥姆霍兹方程\upref{HmhzEq}。

若常数 $k_n^2 < 0$ ， 方程的解为指数函数
\begin{align}
X_n &= C_1 \E^{k_nx} + C_2 \E^{-k_nx}\\
T_n &= D_1 \E^{k_nvt} + D_2 \E^{-k_nvt}
\end{align}
此时，$f_n = X_nT_n$ 不可能满足边界条件\autoref{SepVar_eq3}  （但有可能满足其他边界条件），因此舍去。

若$k_n=0$，则
\begin{align}
X_n &= C_1x+C_2\\
T_n &= D_1t+D_2\\
\end{align}
同样也不能满足边界条件，舍去。

若常数 $k_n^2 > 0$ ， 方程的解为
\begin{align}\label{SepVar_eq4}
X &= C_1 \cos(kx) + C_2 \sin(kx)\\
T &= D_1 \cos(kvt) + D_2 \sin(kvt)
\end{align}

代入边界条件 $X(0) = 0$ 且 $X(a) = 0$。 先将前者代入\autoref{SepVar_eq4} 得 $C_1 = 0$， 所以 $X_n = C_2\sin(k_nx)$。 再代入后者得 $C_2\sin(k_na) = 0$。 为了获得非零解， 我们不可能让 $C_1, C_2$ 都为零， 所以只能令 $\sin(ka) = 0$， 解出常数 $k_n = n\pi/a$. 其中 $n=1,2,3,...$ 为任意正整数。因此$k$只能是\textbf{离散的值}，这个特性是由于方程的边界条件。

因此，
\begin{align}
\label{SepVar_eq5}X_n &= C_2 \sin(k_nx)\\
T_n &= D_1 \cos(k_nvt) + D_2 \sin(k_nvt)\\
k_n & = n\pi/a, n=1,2,3,...
\end{align}

\begin{equation}
f_n(x, t) = X_n(x) T_n(t) = C_{1n} \sin(\frac{n\pi}{a}x)\cos(\frac{n\pi}{a} vt) + C_{2n}\sin(\frac{n\pi}{a}x)\sin(\frac{n\pi}{a}vt)
\end{equation}
每一个$f_n$都可以看作一个以一定频率震动的“驻波”。此处的$C, D$都是待定系数，因此可以“合并”。

\autoref{SepVar_eq5} 也可以记为 $T_n=D\cos(k_nvt+\phi_n)$。现在， 我们叠加这无穷多个解，得到最后的解。这个解可以认为是一系列特定频率的驻波的线性组合。
\begin{equation}
f(x, t) = \sum_{n=1}^\infty X_nT_n = \sum_{n=1}^\infty C_n\sin(\frac{n\pi}{a}x)\cos(\frac{n\pi}{a}vt + \phi_n)
\end{equation}

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/SepVar_1.pdf}
\caption{驻波示意图，包含两个不同频率的驻波。\href{https://www.geogebra.org/m/qc7nps6n}{笔者制作的一个可动演示见这里}（站外链接）} \label{SepVar_fig1}
\end{figure}