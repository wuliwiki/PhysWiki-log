% 超定线性方程组的最小二乘法解
% keys 线性代数|矩阵|复数矩阵|线性方程组|超定方程组|线性相关|线性无关
% license Xiao
% type Tutor

\pentry{最小二乘法\nref{nod_LstSqr}}{nod_5de0}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Overdetermined_system}{相关页面}。}令 $\mat A$ 为 $M\times N$ 的复数矩阵， $\bvec x$ 和 $\bvec y$ 为复数列矢量， 当 $M > N$ 时， 以下线性方程组称为\textbf{超定方程组（overdetermined system）}
\begin{equation}\label{eq_OvrDet_1}
\mat A \bvec x = \bvec y~.
\end{equation}

我们把 $\mat y$ 和 $\mat A$ 拼接成一个 $M\times(N+1)$ 的矩阵， 当这个矩阵的 $M$ 个行矢量中只有小于或等于 $N$ 个线性无关时， 我们只需取所有线性无关的行即可得到非超定的线性方程组。举一个简单的例子，如果第 2 条方程（第 2 行）是第 1 条方程（第 1 行）乘以常数，那么这两条方程中我们只需保留一条即可。

如果有大于 $N$ 个线性无关的行（由于每行只有 $N+1$ 个元，那么最多只可能有 $N+1$ 个线性无关的行）， 那么超定方程无解。
\addTODO{为什么？}

\addTODO{以下似乎应该移动到最小二乘法\upref{LstSqr} 中}
但我们仍然可以寻找一个最优的 $\bvec x$， 使以下误差函数取最小值
\begin{equation}
\norm{\mat A\bvec x - \bvec y}^2 =  \sum_k  \abs{\sum_j A_{kj} x_j - y_k}^2~,
\end{equation}

所以这是一个最小二乘法问题。 令误差函数分别对每个 $x_i$ 的实部和虚部分别求导等于 0， 得
\begin{equation}
\sum_j \qty(\sum_i A\Her_{ik} A_{kj}) x_j = \sum_k A\Her_{ik} y_k~.
\end{equation}
即
\begin{equation}\label{eq_OvrDet_4}
(\mat A\Her \mat A) \bvec x = \mat A\Her \bvec y~.
\end{equation}

\begin{theorem}{}\label{the_OvrDet_1}
当 $\mat A$ 的各列线性无关时， \autoref{eq_OvrDet_4} 必有唯一解。
\end{theorem}

\textbf{证明}： 对 $\mat A$ 做列变换不会改变行列式 $\abs{\mat A\Her \mat A}$ 的值（对 $\mat A$ 做行变换或对 $\mat B$ 做列变换分别相当于对 $\mat A\mat B$ 做相同的行变换或列变换）。 所以可以通过列变换使 $\mat A$ 的各列正交且非零， 于是 $\mat A\Her \mat A$ 变为对角矩阵， 且对角元都大于零， 所以行列式也大于零。 证毕。

对比\autoref{eq_OvrDet_1} 可以发现\autoref{eq_OvrDet_4} 只是在左右两侧同时乘以 $\mat A$ 的厄米共轭。 所以任何能满足\autoref{eq_OvrDet_1} 的解也可以通过\autoref{eq_OvrDet_4} 解得。
