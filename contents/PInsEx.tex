% 纯不可分扩张
% 可分扩张|域|扩域|代数扩张|可分次数|separable degree

\pentry{可分扩张\upref{SprbEx}}
%GTM 242 V.6


\subsection{纯不可分的概念}

我们容易想到并且熟悉的扩域，通常是可分扩张．相对地，凡不是可分扩张的情况，都叫做不可分扩张——也就是说，不可分扩张是可分元、不可分元混杂的扩域．这样一来，代数扩张就分为两类了．似乎不可分扩张只是可分扩张的例外，不像可分扩张有那么好的性质；可相对的，下面定义的纯不可分扩张就很有意思了．

\begin{definition}{纯不可分扩张}

设$\mathbb{K}/\mathbb{F}$是代数扩域．如果$\mathbb{K}-\mathbb{F}$中的元素在$\mathbb{F}$上\textbf{都是不可分的}，那么称$\mathbb{K}/\mathbb{F}$是\textbf{纯不可分扩张（purely inseparable extension）}，且称$\mathbb{K}$在$\mathbb{F}$上（over $\mathbb{F}$）是\textbf{纯不可分}的．

\end{definition}

任何域$\mathbb{F}$都是自己的纯不可分扩张，因为不存在$\mathbb{F}-\mathbb{F}$的元素，命题前提为假则命题恒真．

留意\autoref{SprbEx_the4}~\upref{SprbEx}，可以猜测可分性质与$p$次根是否在给定域中息息相关，其中$p$是这个域的特征．由此提示，我们可以定义“纯不可分元素”：


\begin{definition}{纯不可分元素}\label{PInsEx_def1}
设域$\mathbb{F}$的特征为素数$p$．称$\alpha\in\overline{\mathbb{F}}$是$\mathbb{F}$上的\textbf{纯不可分元素（purely inseparable element）}，如果存在非负整数$k$使得$\alpha^{p^k}\in\mathbb{F}$．

或者说，$\alpha$是$\mathbb{F}$的代数元，且其最小多项式为$x^{p^n}-a$，其中$n$是上述$k$中最小的，$a\in\mathbb{F}$．
\end{definition}

同样，域$\mathbb{F}$的元素都是纯不可分元素．



一切代数扩张，必是进行一次可分扩张后再进行一次纯不可分扩张的结果．要注意，反过来的“代数扩张必是先进行纯不可分扩张再进行可分扩张的结果”并不总是成立．
\addTODO{是否需要举一个反例，说明为什么并不总是成立？}




\begin{theorem}{}\label{PInsEx_the3}
给定代数扩域$\mathbb{K}/\mathbb{F}$，则集合$\mathbb{S}=\{\alpha\in\mathbb{K}|\alpha\text{在}\mathbb{F}\text{上可分}\}$是一个域．

且$\mathbb{K}/\mathbb{S}$是一个纯不可分扩张．
\end{theorem}

\textbf{证明}：

由\textbf{可分元素的封闭性}（\autoref{SprbE2_cor4}~\upref{SprbE2}），可知$\mathbb{S}$是$\mathbb{F}$的可分闭包与$\mathbb{K}$的交集，显然是个域．

反设$\mathbb{K}-\mathbb{S}$中存在$\mathbb{S}$的可分元素$a$，那么$\mathbb{S}(a)/\mathbb{S}$是可分扩张．由可分扩张的传递性（\autoref{SprbE2_cor1}~\upref{SprbE2}），可知$\mathbb{S}(a)/\mathbb{F}$是可分扩张，这与可分闭包的定义矛盾．因此反设不成立，即$\mathbb{K}-\mathbb{S}$中全是$\mathbb{S}$的不可分元素．

\textbf{证毕}．

该定理还引出了一个重要的概念：

\begin{definition}{可分次数}
给定代数扩域$\mathbb{K}/\mathbb{F}$，构造中间域$\mathbb{K}_S=\{\alpha\in\mathbb{K}|\alpha\text{在}\mathbb{F}\text{上可分}\}$．

则称$[\mathbb{K}_S:\mathbb{F}]$是$\mathbb{K}/\mathbb{F}$的\textbf{可分次数（separable degree）}，记为$[\mathbb{K}:\mathbb{F}]_S$．

称$[\mathbb{K}:\mathbb{F}] / [\mathbb{K}:\mathbb{F}]_S$为$\mathbb{K}/\mathbb{F}$的\textbf{不可分次数（inseparable degree）}．
\end{definition}






由于特征为$0$的域都是\textbf{完美域}（定义见\autoref{SprbEx_the5}~\upref{SprbEx}），不存在不可分元素，因此纯不可分扩张的讨论集中在特征为素数$p$的域上．

考虑域$\mathbb{F}$，$\opn{ch}\mathbb{F}=p$．对于任意$\alpha, \beta\in\overline{\mathbb{F}}$和$k\in\mathbb{Z}^+$，都有$\alpha^{p^k}-\beta^{p^k}=(\alpha-\beta)^{p^k}$，其中$\overline{\mathbb{F}}$是$\mathbb{F}$的代数闭包．于是，任意$a\in\mathbb{F}$在其代数闭包里有唯一的$p^k$次根$\alpha$，因为
\begin{equation}
x^{p^k}-a=x^{p^k}-\alpha^{p^k}=(x-\alpha)^{p^k}
\end{equation}
显然这是$\alpha$在$\mathbb{F}$上的最小多项式，以及该最小多项式在$\overline{\mathbb{F}}$上的分解．

% 由于\autoref{SprbEx_the4}~\upref{SprbEx}，$\mathbb{F}$是完美域当且仅当任意元素$a\in\mathbb{F}$在$\mathbb{F}$中都有$p$次方根．

受此启发，我们可以得到一个纯不可分扩张的例子：

\begin{example}{}\label{PInsEx_ex1}
设域$\mathbb{F}$的特征为素数$p$．定义集合
\begin{equation}
\mathbb{F}^{1/p^\infty} = \{\alpha\in\overline{\mathbb{F}}\mid \alpha^{p^k}\in\mathbb{F}, k\in\mathbb{Z}^+\}
\end{equation}
即全体$\mathbb{F}$元素的$p^k$次根构成的集合，显然$\mathbb{F}$是它的子集．

这个集合满足加法和乘法的封闭性：设$\alpha^m\in\mathbb{F}$和$\beta^n\in\mathbb{F}$，另$k$为$m$和$n$的任意公倍数，则$\alpha^k$和$\beta^k$都是$\mathbb{F}$的元素，那么有
\begin{equation}
\begin{aligned}
(\alpha+\beta)^k&=\alpha^k+\beta^k\\
(\alpha\beta)^k&=\alpha^k\beta^k
\end{aligned}
\end{equation}
故$\mathbb{F}^{1/p^\infty}$构成一个域．

任取$\alpha\in\mathbb{F}^{1/p^\infty}-\mathbb{F}$，令$k$是使得$\alpha^k\in\mathbb{F}$的最小非负整数，那么$\alpha$在$\mathbb{F}$上的最小多项式为
\begin{equation}
\opn{Irr}(\alpha, \mathbb{F})(x) = x^{p^k}-a
\end{equation}

而在$\mathbb{F}^{1/p^\infty}$上有
\begin{equation}
x^{p^k}-a = (x-\alpha)^{p^k}
\end{equation}

因此$\alpha$在$\mathbb{F}$上不可分．

\end{example}

\begin{exercise}{}
定义集合$\mathbb{F}^{1/p^k}=\{\alpha\in\overline{\mathbb{F}}\mid \alpha^{p^k}\in\mathbb{F}\}$，其中$k$是给定的任意正整数．证明这个集合是$\mathbb{F}$的扩域．

$\mathbb{F}^{1/p^\infty}/\mathbb{F}^{1/p^k}$是不是纯不可分扩张？
\end{exercise}

\autoref{PInsEx_ex1} 启发我们得到纯不可分扩张的另一等价定义．为了描述这一等价定义，我们先看一个简单的引理：

\begin{lemma}{}
设域$\mathbb{F}$的特征是素数$p$，且$\alpha$是其代数元．

则“存在非负整数$k$使得$\alpha^{p^k}\in\mathbb{F}$”$\iff$“存在$a\in\mathbb{F}$和非负整数$n$使得$\opn{Irr}(\alpha, \mathbb{F})(x) = x^{p^n}-a$”．

\end{lemma}

\textbf{证明}：

$\implies$：

取$n$是所有符合条件的$k$中最小的．则$\opn{Irr}(\alpha, \mathbb{F})(x) = x^{p^n}-a$．

$\Leftarrow$：

取$k=n$即可．

\textbf{证毕}．

\begin{corollary}{}\label{PInsEx_cor1}
设域$\mathbb{F}$的特征是素数$p$，$\overline{\mathbb{F}}$是其代数闭包，则对于任意$a\in\mathbb{F}$和$k\in\mathbb{Z}^+$，存在唯一的$\alpha\in\overline{\mathbb{F}}$，使得$\alpha^{p^k}=a$．
\end{corollary}

也就是说，特征为$p$的域上，任意元素都有唯一的$p^k$次根．这同时意味着，纯不可分元素在$\mathbb{F}$上的最小多项式只有一个根——可以说，这种元素的最小多项式“不可分”的程度、或者说“根的重数”已经达到极致了，“纯”不可分确实名不虚传．


现在，我们可以给出纯不可分扩张的等价定义了：




\begin{theorem}{纯不可分扩张的等价定义}\label{PInsEx_the1}


给定代数域扩张$\mathbb{K}/\mathbb{F}$，其特征为素数$p$．则下列命题等价：

1. $\mathbb{K}$在$\mathbb{F}$上纯不可分；

2. $\forall \alpha\in\mathbb{K}$，$\alpha$在$\mathbb{F}$上纯不可分；

3. 存在一个$\mathbb{K}\to\mathbb{F}^{1/p^\infty}$\footnote{$\mathbb{F}^{1/p^\infty}$的定义见\autoref{PInsEx_ex1} .}的保$\mathbb{F}$\textbf{单}同态；

4. $[\mathbb{K}:\mathbb{F}]_S=1$．


\end{theorem}

\textbf{证明}：

1. $\implies$2. 

只需要考虑$\alpha\in\mathbb{K}-\mathbb{F}$的情况．记$\opn{Irr}(\alpha, \mathbb{F})=f$，则$f$不可分、不可约，故由\autoref{SprbEx_def2}~\upref{SprbEx}和\autoref{SprbEx_cor2}~\upref{SprbEx} 知，可以把$f$中次数不是$p$整数倍的单项式挖掉．

换言之，存在可分的不可约多项式$g(x)\in\mathbb{F}[x]$和非负整数$k$，使得$f(x)=g(x^{p^k})$．于是$g(\alpha^{p^k})=0$，因此$g=\opn{Irr}(\alpha^{p^k}, \mathbb{F})$，从而$\alpha^{p^k}$是$\mathbb{F}$上的可分元素．又因为$\mathbb{K}/\mathbb{F}$纯不可分，故$\alpha^{p^k}\in\mathbb{F}$．


2. $\implies$3. 

由纯不可分元素的\autoref{PInsEx_def1} ，显然$\mathbb{K}\subseteq\mathbb{F}^{1/p^\infty}$．故恒等映射即为所求．

3. $\implies$4. 

令$\varphi:\mathbb{K}\to\mathbb{F}^{1/p^\infty}$和$\sigma:\mathbb{K}\to\overline{\mathbb{F}}$都是保$\mathbb{F}$单同态．下证它们是同一个映射．

由于$\opn{ch}\mathbb{F}=p$，于是由\autoref{PInsEx_cor1} ，任取正整数$k$，每个$a\in\mathbb{F}$在其代数闭包上都有唯一的$p^k$次根．

\textbf{任取}$\alpha\in\mathbb{K}$，那么$\varphi(\alpha^{p^k})=(\varphi(\alpha))^{p^k}\in\mathbb{F}$．由于$\varphi$是单射且保$\mathbb{F}$的元素不变，故$\alpha^{p^k}\in\mathbb{F}$．于是同理，$\sigma(\alpha^{p^k})=\alpha^{p^k}$．

由于都是同态，故$\varphi(\alpha^{p^k})=\sigma(\alpha^{p^k})\iff \varphi(\alpha)=\sigma(\alpha)$．

4. $\implies$1. 

由可分次数的定义，题设意味着$\mathbb{K}-\mathbb{F}$的元素都不是$\mathbb{F}$上的可分元素．


\textbf{证毕}．

由\autoref{PInsEx_the1} 中第1和第3条的等价性，可知域$\mathbb{F}$最大的纯不可分扩张就是$\mathbb{F}^{1/p^\infty}$．





\subsection{纯不可分扩张的一些性质}


\begin{theorem}{}
给定特征为素数$p$的域$\mathbb{F}$和$\overline{\mathbb{F}}$的子集$S$，如果$S$的元素都是$\mathbb{F}$的纯不可分元素，那么$\mathbb{F}(S)/\mathbb{F}$是纯不可分扩张．
\end{theorem}

\textbf{证明}：

任取$\alpha_i\in S\cup\mathbb{F}$，则$\alpha_i$纯不可分，于是存在正整数$k_i$使得$\alpha_i^{p^{k_i}}\in\mathbb{F}$．于是，$\alpha_1^{p^{k_1}p^{k_2}}$和$\alpha_2^{p^{k_2}p^{k_1}}$都在$\mathbb{F}$中．

则有
\begin{equation}\label{PInsEx_eq1}
(\alpha_1\alpha_2)^{p^{k_1+k_2}}=\alpha_1^{p^{k_1}p^{k_2}}\alpha_2^{p^{k_2}p^{k_1}}\in\mathbb{F}
\end{equation}
\begin{equation}\label{PInsEx_eq2}
(\alpha_1+\alpha_2)^{p^{k_1+k_2}}=\alpha_1^{p^{k_1}p^{k_2}}+\alpha_2^{p^{k_2}p^{k_1}}\in\mathbb{F}
\end{equation}
和
\begin{equation}\label{PInsEx_eq3}
(\alpha_1^{-1})^{p^{k_1}} = (\alpha_1^{p^{k_1}})^{-1} \in\mathbb{F}
\end{equation}

换言之，纯不可分元素之积、和、逆都是纯不可分元素，因此$\mathbb{F}(S)$中的元素都是$\mathbb{F}$的纯不可分元素．由\autoref{PInsEx_the1} 第2条的定义得证．

\textbf{证毕}．




\begin{theorem}{}
设$\mathbb{L}/\mathbb{K}/\mathbb{F}$是代数扩域链．如果$\mathbb{L}/\mathbb{F}$纯不可分，那么$\mathbb{K}/\mathbb{F}$和$\mathbb{L}/\mathbb{K}$也纯不可分．
\end{theorem}

\textbf{证明}：

$\mathbb{K}\subseteq\mathbb{L}$，因此据\autoref{PInsEx_the1} 第2条的定义，$\mathbb{K}/\mathbb{F}$纯不可分．

$\mathbb{F}\subseteq\mathbb{K}$，因此据可分元素的定义和\autoref{PInsEx_the1} 第2条的定义，$\mathbb{F}/\mathbb{K}$纯不可分．


\textbf{证毕}．


\begin{theorem}{塔性质}
设$\mathbb{L}/\mathbb{K}/\mathbb{F}$是代数扩域链．如果$\mathbb{K}/\mathbb{F}$和$\mathbb{L}/\mathbb{K}$纯不可分，那么$\mathbb{L}/\mathbb{F}$纯不可分．
\end{theorem}

\textbf{证明}：

任取$\alpha\in\mathbb{L}$，则由于$\mathbb{L}/\mathbb{K}$纯不可分，存在正整数$m$使得$\alpha^{p^m}\in\mathbb{K}$．由于$\mathbb{K}/\mathbb{F}$纯不可分，存在正整数$n$使得$(\alpha^{p^m})^{p^n}\in\mathbb{F}$．于是，$\alpha$是$\mathbb{F}$上的纯不可分元素．

\textbf{证毕}．


\begin{theorem}{}
如果$\mathbb{K}/\mathbb{F}$是一个纯不可分的代数扩张，且域合成$\mathbb{EK}$存在，那么$\mathbb{EK}/\mathbb{EF}$是纯不可分扩张．
\end{theorem}

\textbf{证明}：

任取$\epsilon\in\mathbb{E}$和$\kappa\in\mathbb{K}$，则存在正整数$k$使得$(\epsilon\kappa)^k\in\mathbb{EF}$．注意到$\mathbb{EK}$是由集合$\{\epsilon\kappa\mid\epsilon\in\mathbb{E}, \kappa\in\mathbb{K}\}$生成的，再类比\autoref{PInsEx_eq1} 、\autoref{PInsEx_eq2} 和\autoref{PInsEx_eq3} 可知，$\mathbb{EK}$中的元素都是$\mathbb{EF}$上的纯不可分元素．

\textbf{证毕}．


\begin{exercise}{}
给定域$\mathbb{F}$，设$\mathbb{K}_i$都是$\mathbb{F}$的代数纯不可分扩域．证明$\mathbb{K}_1\mathbb{K}_2/\mathbb{F}$是纯不可分扩张．
\end{exercise}

\begin{theorem}{}\label{PInsEx_the2}
给定域$\mathbb{F}$及其代数闭包$\overline{\mathbb{F}}$．则$\alpha\in\overline{\mathbb{F}}$是$\mathbb{F}$上的纯不可分元素，当且仅当对于$\overline{\mathbb{F}}$的保$\mathbb{K}$自同构$\sigma$，都有$\sigma\alpha=\alpha$．
\end{theorem}

\textbf{证明}：

$\opn{ch}\mathbb{F}=0$以及其它$\mathbb{F}$是完美域的情况是平凡情况．下面讨论$\mathbb{F}$存在不可分元素的情况，设其特征为$p$．

必要性：

设$\alpha\in\overline{\mathbb{F}}$是$\mathbb{F}$上的纯不可分元素，则存在正整数$k$和$a\in\mathbb{F}$使得$\alpha$是$\mathbb{F}$上不可约多项式$x^{p^k}-a$唯一的根．$\sigma$必须把$\mathbb{F}$上多项式的一个根映射为另一个根，因此只能有$\sigma\alpha=\alpha$．







充分性：

设对于$\overline{\mathbb{F}}$的保$\mathbb{K}$自同构$\sigma$，都有$\sigma\alpha=\alpha$．设$\alpha$在$\mathbb{F}$上的最小多项式为$f(x)$，那么由于任意的$\sigma$可以将$\alpha$变为$f(x)$的任意其它根，可知$f(x)$在代数闭包$\overline{\mathbb{F}}$上只有一个根，因此$f$在$\overline{\mathbb{F}}$上应分解为$(x-\alpha)^n$，其中$n$是一个正整数．

展开$(x-\alpha)^n$，其常数项$\alpha^n=a\in\mathbb{F}$．因此$x^n-a$也是$\alpha$的零化多项式．由于次数相等以及最小多项式的定义，可知$(x-\alpha)^n=x^n-a$．

类比\autoref{SprbEx_the3}~\upref{SprbEx}一开始的证明过程，可知存在可分的不可约多项式$h(x)\in\mathbb{F}$和非负整数$k$，使得$h(x^{p^k})=f(x)=x^n-a$，因此$p^k\mid n$．设$n=p^km$，那么$h(x)=x^m-a$．由于$f$只有唯一的根$\alpha$，故$h$也只能有唯一的根\footnote{$h$的根都是$a$的$m$次根，而$\alpha$是$a$唯一的$p^km$次根，因此也是$h$的根唯一的$p^k$次根，故$h$的根也唯一}．加上$h$是可分的，不存在重根，故$m=1$．因此，$\alpha$是$a$唯一的$p^k$次根，符合\autoref{PInsEx_def1} ．

\textbf{证毕}．

\autoref{PInsEx_the2} 充分性的证明很能说明纯不可分扩张的特点：就一个根，因此对应定理中$\sigma \alpha$的可能性就一个．








