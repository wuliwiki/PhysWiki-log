% 导数
% 微积分|导数|导函数|切线|极限

% 未完成： 举几个例子，说明常数导数为零， 直线导数为定值等！
\pentry{切线与割线\upref{TanL}， 函数\upref{functi}，极限\upref{Lim}}

\subsection{导数的直观几何理解}

一个一元函数 $y = f(x)$， 在直角坐标系中表示为一条曲线．在这个曲线的光滑部分取一点 $A$， 并作其切线\upref{TanL}．

\begin{figure}[ht]
\centering
\includegraphics[width=5cm]{./figures/Der_1.pdf}
\caption{点 $A$ 的切线}
\end{figure}


若切线存在，该切线与 $x$ 轴的夹角 的正切值 $\theta$ 就叫点 $A$ 的导数．当函数在 $A$ 点递增时，可能的取值为 $\theta \in (0,\pi/2)$， 即 $\tan \theta  \in (0, + \infty)$． 递减时，取 $\theta  \in (-\pi/2,0)$， 即 $\tan \theta \in (-\infty ,0)$． 当切线水平时，$\theta  = \tan \theta  = 0$． 

若函数曲线在 $x$ 的某一开区间内的每一点都可导， 则这个区间上每一个 $x$ 对应一个导数．将其写成关于 $x$ 的函数 $g(x)$，  $g(x)$  就是该区间上的 \textbf{导函数}． 通常将导函数记为以下的一种（后3种记号的来源见下文）

\begin{equation}\label{Der_eq1}
f'(x),\quad [f(x)]',\quad \dv{y}{x},\quad \dv{f}{x},\quad \dv{x}f(x)
\end{equation}
在物理中， 常常在物理量上方加一点表示对时间求导（注意仅限于对时间求导）， 例如 $\dot f(t) = \dv*{f(t)}{t}$．

若切线不存在（例如折线的棱角处，但也有其他更复杂的情况）， 我们说点 $A$ 不可导． 如果某区间内是 “光滑” 的， 那么的该区间内处处可导．

\begin{figure}[ht]
\centering
\includegraphics[width=5cm]{./figures/Der_3.pdf}
\caption{棱角处不可导}
\end{figure}

若函数曲线在某一点附近是光滑的，那么在这点附近取一小段，当这一段取得足够小，可以近似认为它是线段且与切线重合（如下图）． 以这条线段为斜边，作一直角三角形，令其底边长为 $\dd{x}$ （在微积分中，通常把非常小的一段 $\Delta x$ 记为 $\dd{x}$，  $\dd{x}$ 是一不能分割的整体符号，而不是两个量相乘），竖直边的边长为 $\dd{y}$ （当函数递增时， $\dd{y}$ 取正值，反之取负值）．根据上面导数的定义，$\dv*{y}{x} = \tan \theta $ 就是函数的导数．所以导数通常表示为 $\dv*{y}{x}$， 导数的倒数则为 $\dv*{x}{y}$． 

\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/Der_2.pdf}
\caption{将切点放大，会发现切线和曲线在切点附近“重合”}
\end{figure}

由上面的讨论可得，当 $x$ 增加一小段 $\Delta x$ 时，$y$ 轴的增量约为 $\Delta y \approx f'(x)\Delta x$，且当 $\Delta x$ 越小，这条式子就越精确成立， 记为 $\dd{y} = f'(x) \dd{x}$．这个关系就叫函数的微分．

\subsection{导数的严谨理解}
% 导数的代数理解就是： 一个量关于另一个量的变化率． 例如质点直线运动时，速度的大小就是其路程对时间的导数．把这种描述用极限\upref{Lim}表达出来就是
% \begin{equation}\label{Der_eq2}
% f'(x) = \lim_{\Delta x \to 0} \frac{f(x + \Delta x) - f(x)}{\Delta x}
% \end{equation}
% 在图3的右图中，$\Delta x$ 的始末位置并不非常重要，既可以从 $x$ 取到 $x + \Delta x$， 也可以从 $x - \Delta x$  取到 $x$ 等等（ 因为当 $\Delta x$ 非常小的时候，$x$ 附近的曲线基本处处跟切线重合，它们的斜率都是一样的）． 所以导数的定义也有其他类似的形式

% \begin{equation}
% f'(x) = \lim_{\Delta x \to 0} \frac{f(x) - f(x - \Delta x)}{\Delta x} = \lim_{\Delta x \to 0} \frac{f(x + \Delta x) - f(x - \Delta x)}{2\Delta x}
% \end{equation}
% 虽然上面用到了诸如“近似”等词，但根据定义，极限都是精确的．

% 例子： 速度 加速度（一维）\upref{VnA1}．

切线的几何描述并不严谨和完整，初学者可能会有很多疑问，比如割线的两个点靠近切点的时候，如果其中一个点到切点的距离始终是另一个点到切点距离的两倍，那它们还算同时达到切点吗？

实际上，在\textbf{极限}\upref{Lim}中我们强调过，极限的概念并不是简单地等同，而是趋近的性质．用割线去接近切线也是一种极限，不存在“达到切点”的情况，只能是越来越接近切点．

和其它类型的极限一样，割线趋近的过程强调“任意性”．为了方便描述，我们需要把一根切线表示为数字．最直接的办法就是用切线的斜率来表示．

\begin{definition}{斜率}
对于用$f(x)=ax+b$描述的直线，定义其斜率为$a$．
\end{definition}

由于我们给定了切点，因此割线接近切线的过程中，肯定也会接近切点，我们只需要考察割线的斜率是不是收敛就行．由于斜率是一个数字，这就使得我们又获得了一个数列，而我们对于数列的极限是很熟悉的了．

\begin{definition}{导数}\label{Der_def1}
考虑实函数$f(x)$，给定实数$x_0$．对于\textbf{一对}数列$\{a_n\}$、$\{b_n\}$，令$\lim\limits_{n\to\infty}a_n=x_0$、$\lim\limits_{n\to\infty}b_n=x_0$，且各$a_n\not=b_n$\footnote{这一条是保证总能画出割线，因为两点确定一条直线嘛，$a_n=b_n$的话这条割线就画不出来了．}．这样，每一对点$(a_n, f(a_n))$、$ (b_n, f(b_n))$都能唯一确定一条割线，也就确定了割线的斜率$d_n$．

如果对于\textbf{任意}的上述数列对$\{a_n\}$、$\{b_n\}$，其生成的$d_n$都收敛到同一个实数$A$上，那么该实数$A$就是$f(x)$在$x_0$处的\textbf{切线斜率}，也称\textbf{导数（derivative）}．
\end{definition}

我们来看几个例子，加深理解．

\begin{example}{}
考虑函数$f(x)=2x+1$．容易验证，无论怎么选一对数列，它们生成的割线斜率都是$2$．因此由定义，$f(x)$在任何一个点处的导数值都是$2$．
\end{example}

\begin{example}{}\label{Der_ex1}
考虑函数$f(x)=x^2$，尝试计算其在$x=2$处的导数值\footnote{$x=2$处即点$(2, 4)$．也可以说$y=4$且$x>0$处，但肯定是$x=2$处的说法更方便．}．

取数列$a_n=2+g_n$和$b_n=2+h_n$，其中$g_n$和$h_n$都趋近于$0$，且各$g_n\not=h_n$．那么$a_n$和$b_n$所确定的割线就通过点$(2+g_n, 4+4g_n+g_n^2)$和点$(2+h_n, 4+4h_n+h_n^2)$，因此割线斜率是
\begin{equation}
\begin{aligned}
d_n&=\frac{4+4g_n+g_n^2-4-4h_n-h_n^2}{g_n-h_n}\\
&=\frac{4(g_n-h_n)+(g_n+h_n)(g_n-h_n)}{g_n-h_n}\\
&=4+g_n+h_n
\end{aligned}
\end{equation}
由于随着$n$的增大，$g_n$和$h_n$都趋于零，因此$d_n$趋于$4$．

又由于我们没有具体约束$g_n$和$h_n$，使得上述讨论适用于一切可用于构造趋近于给定点割线的数列$a_n$和$b_n$，因此满足\textbf{任意}性，因此$f(x)=x^2$在$x=2$处的导数值就是$4$．
\end{example}

\begin{exercise}{}
考虑函数$f(x)=\abs{x}$，画出这个函数的图像，并证明其在$x=0$处没有导数．
\end{exercise}

\begin{exercise}{}
考虑函数$f(x)=[x]$，定义为$[x]$是小于等于$x$的、最接近$x$的整数．比如，$[\pi]=3$，$[e]=2$，$[4.99]=4$， $[-4.99]=-5$．

画出这个函数的图像，并证明其在横坐标为整数的点处没有导数．
\end{exercise}








\subsection{导函数及其计算}

我们上面讨论的是对于函数$f(x)$，在给定点求其导数．但是如果我们把所有点的导数都求出来（“不存在导数”也是一种结果），那么我们就得到了一个新的函数，就叫做$f(x)$的\textbf{导函数}，记为$f'(x)$．

如果我们能把导函数的表达式计算出来，那么就可以直接代值去计算各处的导数，没必要挨个像\autoref{Der_ex1} 那样进行一番冗长的运算了．

% 为了实现这个目的，我们要先研究一番几个基本的函数．

% \begin{example}{多项式函数的导数}
% 多项式是形如$f(x)=a_0+a_1x+a_2x^2+\cdots+a_nx^n$的函数．为了计算其导函数，我们首先要考虑最简单的多项式，$x^n$．

% 对于任意实数$x_0$，取数列$a_n=x_0+g_n$和$b_n=x_0+h_n$，其中$g_n$和$h_n$都趋近于$0$，且各$g_n\not=h_n$．那么$a_n$和$b_n$分别确定点$(x_0+g_n, (x_0+g_n)^n)$和$(x_0+h_n, ((x_0+h_n)^n)$，割线斜率也就是$d_n=\frac{(x_0+g_n)^n-(x_0+h_n)^n}{g_n-h_n}$．

% 应用二项式定理$(a+b)^n=a^n+b^n+$
% \end{example}

为了方便计算，我们要先把导数的定义简化成如下形式：

\begin{definition}{导数}\label{Der_def2}
考虑实函数$f(x)$，给定实数$x_0$．如果对于任意趋近于$x_0$的数列$x_n$，都有数列$\frac{f(x_n)-f(x_0)}{x_n-x_0}$收敛，且所有这样的数列都收敛于实数$A$．那么$A$就是$f(x)$在$x_0$处的\textbf{导数}．
\end{definition}

\begin{exercise}{两个定义的等价性}
证明\autoref{Der_def1} 和\autoref{Der_def2} 是等价的．

提示：\autoref{Der_def1} 显然是蕴含了\autoref{Der_def2} 的，因为前者描述的是“所有数列对”的情况，后者则是限定了其中一个数列恒为$x_0$的特殊情况．所以你只需要证明\autoref{Der_def2} 蕴含了\autoref{Der_def1} ．提示：单独用$a_n$和$b_n$套进\autoref{Der_def2} 中$x_n$的位置能得到两条割线，而$a_n$和$b_n$在\autoref{Der_def1} 中又构成第三条割线．这三条割线是可以构成一个三角形的．根据\autoref{Der_def2} ，前两条割线的斜率都趋于$A$，那么作为三角形第三边的第三条割线，其斜率也不得不跟着趋于$A$，这样就从\autoref{Der_def2} 推出\autoref{Der_def1} 了．
\end{exercise}

接下来，





