% Baker-Hausdorff 公式
% keys Baker|Hausdorff|定理
% license Xiao
% type Tutor
\pentry{组合\nref{nod_combin}}{nod_a485}
\begin{issues}
\issueOther{添加量子力学的例子}
本文尚未给出BCH公式中的z；另需添加BCH公式的常用情形；或许需要一篇文章说明李代数的BCH公式，及
\end{issues}


\footnote{参考樱井量子力学\cite{Sakurai}。}Baker-Hausdorff 公式是一个相当有用的公式。在数学上，它可用于给出李群-李代数对应的深层结果的相对简单的证明；在量子力学中，它可实现系统哈密顿量在薛定谔绘景和\enref{海森堡绘景}{HsbPic}的转换，并在微扰论中也有诸多应用。本节将给出该公式的一个证明和由它导出的一些重要的结果。

\textbf{Baker-Hausdorff公式}是指
\begin{equation}\label{eq_BAHA_1}
\E ^{A}B\E^{-A}=\sum_{n=0}^{\infty}\frac{1}{n!}A^{(n)}~.
\end{equation}
其中，
\begin{equation}\label{eq_BAHA_5}
A^{(n)}\equiv\underbrace{[A,[A,\cdots,[A}_{n\text{个}},B]\cdots]
=\sum_{m=0}^{n}(-1)^{n-m}C_{n}^{m}A^mBA^{n-m}~.
\end{equation}


\subsection{证明}
在证明Baker-Hausdorff公式\autoref{eq_BAHA_1} 之前，我们先证明\autoref{eq_BAHA_5}。\\

\textbf{\autoref{eq_BAHA_5} 的证明：}我们用数学归纳法来证明。
$A^{(0)},A^{(1)}$ 显然成立：
\begin{equation}
\begin{aligned}
A^{(0)}&=B=\sum_{m=0}^{0}(-1)^{0-m}C_{0}^{m}A^mBA^{0-m}~,\\
A^{(1)}=&[A,B]=AB-BA=\sum_{m=0}^{1}(-1)^{1-m}C_{1}^{m}A^mBA^{1-m}~.
\end{aligned}
\end{equation}
假设对 $n=k-1$ 时\autoref{eq_BAHA_5} 成立，则
\begin{equation}
\begin{aligned}
A^{(k)}&=[A,A^{(k-1)}]=AA_{k-1}-A_{k-1}A\\
&=A\sum_{m=0}^{k-1}(-1)^{k-1-m}C_{k-1}^{m}A^mBA^{k-1-m}-\qty(\sum_{m=0}^{k-1}(-1)^{k-1-m}C_{k-1}^{m}A^mBA^{k-1-m})A\\
&=\sum_{m=0}^{k-1}(-1)^{k-1-m}C_{k-1}^{m}A^{m+1}BA^{k-1-m}-\sum_{m=0}^{k-1}(-1)^{k-1-m}C_{k-1}^{m}A^mBA^{k-m}\\
&=A^{k}B+\sum_{m=0}^{k-2}(-1)^{k-1-m}\qty(C_{k-1}^{m}+C_{k-1}^{m+1})A^{m+1}BA^{k-1-m}-(-1)^{k-1}BA^k\\
&=A^{k}B+\sum_{m=0}^{k-2}(-1)^{k-1-m}C_{k}^{m+1}A^{m+1}BA^{k-1-m}-(-1)^{k-1}BA^k\\
&=A^{k}B+\sum_{m=1}^{k-1}(-1)^{k-m}C_{k}^{m}A^{m}BA^{k-m}+(-1)^{k}BA^k\\
&=\sum_{m=0}^{k}(-1)^{k-m}C_{k}^{m}A^{m}BA^{k-m}~.
\end{aligned}
\end{equation}


由数学归纳法原理，\autoref{eq_BAHA_5} 得证。上面证明中 $C_n^m$ 为\enref{组合数}{combin}。

现在，我们将用两种方法证明Baker-Hausdorff公式。
\subsubsection{纯数学证明}
\footnote{郝柏林。统计微扰论的生成泛函.1978年统计物理讨论会综述报告}先来证明下面得引理。
\begin{lemma}{}\label{lem_BAHA_2}
\begin{equation}\label{eq_BAHA_2}
A^nB=\sum_{m=0}^{n}C_{n}^mA^{(m)}A^{n-m}~.
\end{equation}
\end{lemma}
\textbf{证明：}这里同样用数学归纳法来证明。当 $n=1$ 时，\autoref{eq_BAHA_2} 显然成立：
\begin{equation}
AB=BA+[A,B]~.
\end{equation}
假设 $n=k-1$ 时\autoref{eq_BAHA_2} 成立，则
\begin{equation}\label{eq_BAHA_3}
\begin{aligned}
A^{k}B=A\sum_{m=0}^{k-1}C_{k-1}^mA^{(m)}A^{k-1-m}=\sum_{m=0}^{k-1}C_{k-1}^mAA^{(m)}A^{k-1-m}~.
\end{aligned}
\end{equation}

因为
\begin{equation}
A^{(m+1)}=[A,A^{(m)}]\Rightarrow AA^{(m)}=A^{(m)}A+A^{(m+1)}~,
\end{equation}
所以\autoref{eq_BAHA_3} 可改写为
\begin{equation}
\begin{aligned}
A^k B&=\sum_{m=0}^{k-1}C_{k-1}^mA^{(m)}A^{k-m}+\sum_{m=0}^{k-1}C_{k-1}^mA^{(m+1)}A^{k-1-m}\\
&=A^{(0)}A^{k}+\sum_{m=1}^{k-1}\qty[C_{k-1}^m+C_{k-1}^{m-1}]A^{(m)}A^{k-m}+A^{(k)}\\
&=A^{(0)}A^{k}+\sum_{m=1}^{k-1}C_{k}^mA^{(m)}A^{k-m}+A^{(k)}\\
&=\sum_{m=0}^{k}C_{k}^mA^{(m)}A^{k-m}~.
\end{aligned}
\end{equation}
由数学归纳法原理，证得\autoref{lem_BAHA_2} 

现在，Baker-Hausdorff公式就呼之欲出了！

\textbf{Baker-Hausdorff公式的证明：}
由\autoref{lem_BAHA_2} 
\begin{equation}\label{eq_BAHA_4}
\E^A B=\sum_{n=0}^{\infty}\frac{A^nB}{n!}=\sum_{n=0}^{\infty}\frac{1}{n!}\sum_{i=0}^{n}C_{n}^iA^{(i)}A^{n-i}~.
\end{equation}

将上式求和符号交换顺序，注意指标要求满足 $i\leq n$，可将\autoref{eq_BAHA_4} 改写为
\begin{equation}\label{eq_BAHA_6}
\begin{aligned}
\E^A B&=\sum_{i=0}^{\infty}\sum_{n=i}^{\infty}\frac{1}{n!}C_{n}^iA^{(i)}A^{n-i}\\
&=\sum_{i=0}^{\infty}\frac{1}{i!}A^{(i)}\sum_{n=i}^{\infty}\frac{1}{(n-i)!}A^{n-i}\\
&=\sum_{i=0}^{\infty}\frac{1}{i!}A^{(i)}\E^A~.
\end{aligned}
\end{equation}
\autoref{eq_BAHA_6} 两边作用于 $\E^{-A}$ ，证得\autoref{eq_BAHA_1} 

\subsubsection{较物理的证明}
\footnote{何勇。用算符矩阵表示方法简洁推导 Baker-Hausdorff 公式[J].大学物理，2015,34(1):30-31}现在，我们给出一种量子力学语言的证明方式。选择 $A$ 表象为工作空间，其基右矢集合为 $\qty{\ket{a_n}}$，且 $A\ket{a_n}=a_n\ket{a_n}$。为方便起见，仅考虑离散态的情况。完备性条件为
\begin{equation}
\sum_{n}\ket{a_n}\bra{a_n}=1~.
\end{equation}
由\autoref{eq_BAHA_5}，关于 $A$ 算符的矩阵表达式为：
\begin{equation}\label{eq_BAHA_7}
\begin{aligned}
A^{(n)}&=\sum_{i,j,k,l}\sum_{m=0}^{n}(-1)^{n-m}C_{n}^{m}\ketbra{a_i}{a_i}A^m\ketbra{a_k}{a_k}B\ketbra{a_l}{a_l}A^{n-m}\ketbra{a_j}{a_j}\\
&=\sum_{i,j}\sum_{m=0}^{n}(-1)^{n-m}C_n^m{a_i}^m{a_j}^{n-m}\bra{a_i}B\ket{a_j}\ketbra{a_i}{a_j}\\
&=\sum_{i,j}\sum_{m=0}^{n}(-1)^{n-m}C_n^m{a_i}^m{a_j}^{n-m}B^i_{\; j}\ketbra{a_i}{a_j}\\
&=\sum_{i,j}(a_i-a_j)^nB^i_{\; j}\ketbra{a_i}{a_j}~.
\end{aligned}
\end{equation}
$\E^{A}B\E^{-A}$ 的矩阵表达式为
\begin{equation}\label{eq_BAHA_8}
\begin{aligned}
\E^{A}B\E^{-A}&=\sum_{i,j,k,l}\ketbra{a_i}{a_i}\E^{A}\ketbra{a_k}{a_k}B\ketbra{a_l}{a_l}\E^{-A}\ketbra{a_j}{a_j}\\
&=\sum_{i,j}\E^{a_i-a_j}B^{i}_{\;j}\ketbra{a_i}{a_j}\\
&=\sum_{i,j}\sum_{n=0}^{\infty}\frac{1}{n!}(a_i-a_j)^nB^{i}_{\;j}\ketbra{a_i}{a_j}\\
&=\sum_{n=0}^{\infty}\frac{1}{n!}\sum_{i,j}(a_i-a_j)^nB^{i}_{\;j}\ketbra{a_i}{a_j}~.
\end{aligned}
\end{equation}
对比\autoref{eq_BAHA_7} 和\autoref{eq_BAHA_8}，得
\begin{equation}
\E^{A}B\E^{-A}=\sum_{n=0}^{\infty}\frac{1}{n!}A^{(n)}~,
\end{equation}
Baker-Hausdorff 公式\autoref{eq_BAHA_1} 得证。

\subsection{Baker-Campbell-Hausdorff公式}
\pentry{矩阵指数\nref{nod_MatExp}}{nod_8f1d}
\textbf{Baker-Campbell-Hausdorff公式}是下列方程关于 $Z$ 的解
\begin{equation}
\E^{A}\E^{B}=\E^{Z}~,
\end{equation}
我们将用Baker-Hausdorff公式导出Baker-Campbell-Hausdorff公式的一些性质。

如果算子 $A$ 与 $B$ 不对易，算子函数 $\E^{A+B}$ 不能简单地分解为  $\E^{A}$ 和 $\E^{B}$ 乘积。只能引入另一个算子 $K(\tau)$ 和 $K'(\tau)$（ $A,B$ 与 $\tau$ 无关） ，写成
\begin{equation}\label{eq_BAHA_9}
\E^{\tau(A+B)}=\E^{\tau B}K(\tau)\E^{\tau A}=\E^{\tau A}K'(\tau)\E^{\tau B}~,
\end{equation}
\autoref{eq_BAHA_9} 中交换 $A,B$。可由 $K$ 导出 $K'$，故只需讨论 $K(\tau)$。下面我们来求 $K(\tau)$ 的具体形式。

\autoref{eq_BAHA_9} 对 $\tau$ 微分，并利用\autoref{eq_MatExp_3}，可得关于算子 $K$ 的微分方程：
\begin{equation}\label{eq_BAHA_10}
\begin{aligned}
\E^{\tau(A+B)}A+\E^{\tau B}K(\tau)\E^{\tau A}B&=B\E^{\tau B}K(\tau)\E^{\tau A}+\E^{\tau B}\pdv{K}{\tau}\E^{\tau A}+\E^{\tau(A+B)}A~,\\
&\Downarrow\\
\pdv{}{\tau}K&=K\E^{\tau A}B\E^{-\tau A}-BK~.
\end{aligned}
\end{equation}

将\autoref{eq_BAHA_1} 代入\autoref{eq_BAHA_10} ：
\begin{equation}\label{eq_BAHA_11}
\pdv{}{\tau}K=\sum_{n=0}^{\infty}\frac{\tau^n}{n!}KA^{(n)}-BK~.
\end{equation}
由\autoref{eq_BAHA_9}，其初值条件为：
\begin{equation}
K(0)=1~,
\end{equation}
\autoref{eq_BAHA_11} 的具体求解依赖于 $A,B$ 的性质。

\begin{example}{}
已知 $A^{(1)}=[A,B]$ 是个数，$A^{(n)}=0(n\geq 2)$。求 $\E^{\tau(A+B)}$

由\autoref{eq_BAHA_11} ：
\begin{equation}
\pdv{}{\tau}K=KB+K\tau[A,B]-BK~.
\end{equation}
要求 $K(\tau)$ 是个数，则上式变为：
\begin{equation}
\pdv{}{\tau}K=K\tau[A,B]~.
\end{equation}
解得：
\begin{equation}
K=\E^{\frac{1}{2}[A,B]\tau^2}~,
\end{equation}
将 $K$ 中 $A,B$ 交换，得到 
\begin{equation}
K'=\E^{\frac{1}{2}[B,A]\tau^2}~.
\end{equation}

故
\begin{equation}\label{eq_BAHA_12}
\E^{\tau(A+B)}=\E^{\tau B}\E^{\tau A}\E^{\frac{1}{2}[A,B]\tau^2}=\E^{\frac{1}{2}[B,A]\tau^2}\E^{\tau A}\E^{\tau B}~,
\end{equation}
\autoref{eq_BAHA_12} 还可写为
\begin{equation}
\begin{aligned}
\E^{2\tau A+2\tau B}&=\E^{\tau(A+B+A+B)}=\E^{\tau (A+B)}\E^{\tau (A+B)}\E^{\frac{1}{2}\qty[\tau(A+B),\tau(A+B)]\tau^2}\\
&=\E^{\tau(A+B)}\E^{\tau(A+B)}\\
\E^{2\tau A+2\tau B}&=\E^{\tau(A+B)}\E^{\tau(A+B)}\\
&=\E^{\tau B}\E^{\tau A}\E^{\frac{1}{2}[A,B]\tau^2}\E^{\frac{1}{2}[B,A]\tau^2}\E^{\tau A}\E^{\tau B}\\
&=\E^{\tau B}\E^{2\tau A}\E^{\tau B}~.
\end{aligned}
\end{equation}
\end{example}
