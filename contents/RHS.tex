% 装备希尔伯特空间

本节中都用 $\mathcal{H}$ 来代表所要考虑的 Hilbert 空间， 用 $\langle\cdot,\cdot\rangle$ 来代表其上的内积。 

按照通常的说法， 量子力学的基本舞台是 \textbf{Hilbert 空间}， 即完备的内积空间。 然而在这里， 我们要考虑的数学对象比 Hilbert 空间更精细一些： 我们的基本舞台不再是一般的 Hilbert 空间， 而是所谓的\textbf{装备 Hilbert 空间（rigged Hilbert space, RHS）}。 为了定义装备 Hilbert 空间， 首先要定义\textbf{核空间（nuclear space）}。 它是 Alexander Grothendieck 的博士论文研究的内容。 我们这里采用如下较狭窄但已经足够用的定义：

\begin{definition}{核空间（Nuclear Space）}
一个核空间 $\Phi$ 是一族递降的 Hilbert 空间 $\Phi_1\supset\Phi_2\supset...$ 的交， 赋予自然的拓扑， 这族Hilbert 空间满足如下条件：
\begin{enumerate}
\item $\Phi_{n+1}$ 的范数比 $\Phi_n$ 的范数更强， 而且 $\Phi_n$ 是 $\Phi_{n+1}$ 在 $\Phi_n$ 的范数之下的完备化；
\item 对于任何 $n$， 总有 $m>n$ 使得嵌入映射 $T_{m,n}:\Phi_{m}\hookrightarrow\Phi_n$ 是核算子（nuclear operator）， 即它的 Hilbert-Schmidt 迹范数是良好定义的。
\end{enumerate}
\end{definition}

    从此以后， 沿用 Dirac 的左右矢记号： 以 $\ket{\phi}$ 代表 $\Phi$ 的元素， $\bra{u}$ 代表其对偶空间 $\Phi^*$ 的元素， 二者之间的配对就以 $\braket{u}{\phi}$ 代表。 今后还要考虑包含映射 $\Phi\hookrightarrow\mathcal{H}$， 它自然诱导出包含映射 $\mathcal{H}\hookrightarrow\Phi^*$。 为方便计， 对于 $f\in\Phi\subset\mathcal{H}$， 以 $\ket{f}$ 表示之; 对于 $g\in\mathcal{H}$， 以 $\bra{g}$ 表示 $g$ 在包含映射 $\mathcal{H}\hookrightarrow\Phi^*$ 下的像。

\begin{definition}{装备 Hilbert 空间（Rigged Hilbert Space, RHS）}
装备 Hilbert 空间包含一可分 Hilbert 空间 $\mathcal{H}$ 与一稠密子空间 $\Phi\subset\mathcal{H}$， 满足如下条件： $\Phi$ 上有一更强的拓扑 $\tau_\Phi$， 使得 $(\Phi,\tau_\Phi)$ 成为一核空间， 而且有 $\Phi_0=\mathcal{H}$， 且自然的包含映射 $\Phi\hookrightarrow\mathcal{H}$ 在此拓扑下连续。
\end{definition}

    注意到自然的三重偶 $\Phi\hookrightarrow\mathcal{H}\hookrightarrow\Phi^*$ 与 $\mathcal{H}$ 的内积相容， 即如果 $f\in\Phi\subset\mathcal{H}$， $g\in\mathcal{H}$， 则 $\langle g,f\rangle_{\mathcal{H}}=\braket{g}{f}$。 此三重偶称为 \textbf{Gelfand 三重偶（Gelfand triple）}。

    为什么要如此大费周章地考虑 Gelfand 三重偶？ 原来， 它的原型乃是 Hilbert 空间语言中的位置表象空间 $L^2(\mathbb{R}^n)$ 以及其上定义的算子 $X,i\nabla$， 即位置算符和动量算符; 这两个算子的定义域都不是整个 $L^2(\mathbb{R}^n)$， 它们最自然的定义域乃是 Schwartz 函数空间 $\mathcal{S}(\mathbb{R}^n)$， 即所有光滑且各阶导数都迅速衰减的函数的空间， 赋予 Fréchet 空间拓扑。 位置算子和动量算子在 Schwartz 空间上都是连续算子。 而 Schwartz 空间 $\mathcal{S}(\mathbb{R}^n)$ 本身是加权的 Sobolev 空间系
$$
\Phi_k := \qty{f \in L^2 (\mathbb{R}^n): (-\Delta + |x|^ 2)^{k} f \in L^2 (\mathbb{R}^n) }~
$$
的交， 而包含映射 $T_{m+n,m}:\Phi_{m+n}\to\Phi_m$ 是核算子。 这时就有 Gelfand 三重偶$$
\mathcal{S}(\mathbb{R}^n)\hookrightarrow L^2(\mathbb{R}^n)\hookrightarrow \mathcal{S}'(\mathbb{R}^n)~.
$$也可以注意到， 上述定义的 Sobolev 范数中的算子 $-\Delta+|x|^2$ 正是谐振子的薛定谔算符。

    这个三重偶应该包含了所有物理上感兴趣的对象。 实际上， 它显然囊括了平方可积的束缚态， 即可归一化的波函数; 也囊括了不平方可积的散射态， 例如自由单色波 $e^{ik\cdot x}$。 前者属于 $L^2(\mathbb{R}^n)$， 而后者应该用 Schwartz 分布即 $\mathcal{S}'(\mathbb{R}^n)$ 的元素来代表。 另外， 物理上的"位置本征态"即 $\delta(x-x_0)$ 显然并不是数学意义下的函数， 但它属于对偶空间 $\mathcal{S}'(\mathbb{R}^n)$， 而且当然满足
$$
X^j\delta(x-x_0)=x_0^j~,
$$
因为对于任何 $\phi\in\mathcal{S}(\mathbb{R}^n)$， 按照定义皆有
$$
\begin{aligned}
\left[\bra{\delta(x-x_0)}X^j\right]\ket{\phi}
&:=\bra{\delta(x-x_0)}\left[X^j\ket{\phi}\right]\\
&=x_0^j\phi(x_0)
=\left[\bra{\delta(x-x_0)}x_0^j\right]\ket{\phi}~.
\end{aligned}
$$
由此可见， $\delta(x-x_0)$ 是坐标分量算符 $X^j$ 的本征态， 特征值为 $x_0^j$。 同理可得 $e^{ik\cdot x}$ 是动量分量算符 $i\partial_{x^j}$ 的本征态， 特征值为 $-k_j$; 也是自由粒子 Hamilton 算符 $-\Delta$ 的本征态， 特征值为 $|k|^2$。 动量本征态和位置本征态正是"不可归一化的态矢量"的例子。 

    这个例子正说明了为什么要引入装备 Hilbert 空间作为量子力学的舞台： 物理上感兴趣的许多算符在数学意义下的 Hilbert 空间（即所有可归一化的态的空间）中可能没有本征态， 或者本征态集合不完备; 但引入 RHS 之后， 算符在对偶空间 $\Phi^*$ 就可以有足够多的本征态。 在上面的例子中， 任何可归一化的态 $f\in{L^2}(\mathbb{R}^n)$ 都可以写成位置本征态的叠加（这里的积分在数学上的严格定义应该是 Schwartz 分布之间的卷积）：
$$
f(x)=\int_{\mathbb{R}^n}f(y)\delta(x-y)dy~,
$$    
或者动量本征态/自由 Hamilton 算符本征态的叠加（这里的积分取主值）：
$$
f(x)=\int_{\mathbb{R}^n}\hat f(k)e^{ik\cdot x}dk~.
$$
这些都是物理意义十分直观的结论。 这个结果并不是偶然的。 它是 RHS 中自伴算子谱定理的特例。
