% 圆锥曲线的极坐标方程
% 极坐标系|圆锥曲线|离心率

\pentry{极坐标的定义\upref{Polar}}

\begin{figure}[ht]
\centering
\includegraphics[width=11cm]{./figures/Cone_2.pdf}
\caption{不同离心率 $e$ 的圆锥曲线（$h = 1$）} \label{Cone_fig2}
\end{figure}

圆锥曲线的极坐标方程是 $r$ 关于 $\theta$ 的函数
\begin{equation}\label{Cone_eq5}
r(\theta)  = \frac{p}{1 - e\cos \theta }
\end{equation}
其中 $e$ 是离心率， $p$ 是半通径． 也可以记为
\begin{equation}\label{Cone_eq3}
r(\theta) = \frac{eh}{1 - e\cos \theta }
\end{equation}
其中 $h$ 是焦点到准线的距离． 极角 $\theta$ 的取值范围是所有时 $r>0$ 的值． 具体来说， 当 $0 < e < 1$ 时， 圆锥曲线称为\textbf{椭圆（ellipse）}， $\theta$ 可以取任意实数； 当 $e = 1$ 曲线称为\textbf{抛物线（parabola）}， $\theta$ 可以取任意不等于 $2\pi n$ 的实数（$n$ 取任意整数）； 当 $e > 1$ 曲线称为\textbf{双曲线（hyperbola）}， 要求 $\theta_0< \theta + 2\pi n < 2\pi-\theta_0$， 其中 $n$ 取任意整数，
\begin{equation}
\theta_0 = \arccos\frac{1}{e}
\end{equation}
下文为了方便表述， 把 $\theta$ 的取值范围限制在一个圆周内， 即 $(-\pi,\pi]$ 或 $[0, 2\pi)$．

在一些文献中， 也把\autoref{Cone_eq5} 中的负号写为正号， 此需要把\autoref{Cone_fig2} 中的曲线旋转 $180^\circ$， 因为 $-\cos\theta = \cos(\theta - \pi)$． 上述 $\theta$ 的取值范围也需要加上 $\pi$．

\subsection{双曲线的两支}
根据双曲线的其他定义\upref{Hypb3}， 对同一个 $e>1$， 双曲线事实上是两条曲线， 每条曲线称为一支． \autoref{Cone_fig2} 中仅画出了离焦点较近的一支． 上文已经提到 $\theta_0< \theta < 2\pi-\theta_0$．
\addTODO{用极坐标同时画出双曲线的两支}

事实上\autoref{Cone_eq5} 也可以表示双曲线的另一支， 只需要取 $-\theta_0< \theta < \theta_0$， 此时 $r$ 恒为负值． 若我们在极坐标中定义 $(-r, \theta)$ 和 $(r, \theta + \pi)$ 表示同一点， 就可以画出另一支． 或者说， 把\autoref{Cone_eq5} 中的  $r,\theta$ 分别替换为 $-r$ 和 $\theta+\pi$ 就得到了这支双曲线的正常极坐标方程（$r > 0$） 和极角范围
\begin{equation}\label{Cone_eq6}
r(\theta) = -\frac{p}{1 + e\cos\theta} \qquad (\pi - \theta_0<\theta < \pi + \theta_0)
\end{equation}

\subsection{推导}

\addTODO{把图中和文中的 $a$ 改成 $d$， 否则可能误以为是半通径}

\begin{figure}[ht]
\centering
\includegraphics[width=4.5cm]{./figures/Cone_1.pdf}
\caption{由离心率定义圆锥曲线}\label{Cone_fig1}
\end{figure}

圆锥曲线的一种定义（与其他定义等效）为（\autoref{Cone_fig1}）：
平面上有一点 $O$ 和一条直线 $L$， 相距为 $h$． 
平面上某一点到 $O$ 的距离为 $r$， 到 $L$ 的
（垂直）距离为 $a$， 令常数 $e > 0$， 则所有满足
\begin{equation}\label{Cone_eq1}
r/a = e
\end{equation}
的点组成的曲线就是圆锥曲线． $e$ 是常数，叫做\textbf{离心率}， $O$ 是\textbf{焦点}， $L$ 是\textbf{准线}． 当 $e = 0$ 时曲线是圆\footnote{注意根据定义， 圆的准线为无穷远， 所以只能使用\autoref{Cone_eq5} 而不能用\autoref{Cone_eq3}． 所以在\autoref{Cone_fig2} 中， 圆的半径为无穷小．}， $0 < e < 1$ 时是椭圆， $e = 1$ 时是抛物线， $e > 1$ 时是双曲线．

以 $O$ 点为原点，使极轴垂直于准线（如上图）．则 $a = h + r \cos \theta $， 根据\autoref{Cone_eq1} 得
\begin{equation}\label{Cone_eq2}
\frac{r}{h + r \cos \theta } = e
\end{equation}
变形，得\autoref{Cone_eq3}．


若定义圆锥曲线的\textbf{通径}为过焦点且平行于准线的直线被圆锥曲线截出的线段长度． 记\textbf{半通径}为 $p$，则通径为 $2p$， 那么有 $r(\pi /2) = p$． 代入\autoref{Cone_eq3} 得 $p = eh$． 所以\autoref{Cone_eq3} 又可以写为
\begin{equation}\label{Cone_eq4}
r(\theta)  = \frac{p}{1 - e\cos \theta }
\end{equation}
注意 $p$ 和 $e$ 分别控制圆锥曲线的大小和形状．由于抛物线的 $e = 1$ 不变， 所以所有抛物线的形状都相同．
