% 向量函数的微分
% 多元函数|向量函数|微分
\begin{definition}{(全微分)}
设有向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$. 若存在线性变换 $A:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$
使成立
\[
F(x)=F(p)+A(x-p)+o(\left\Vert x-p\right\Vert ),\quad\quad(x\rightarrow p\in\mathbb{R}^{n}),
\]
即
\[
{\displaystyle \lim_{x\rightarrow p}{\displaystyle \frac{F(x)-F(p)-A(x-p)}{\left\Vert x-p\right\Vert }=0,}}
\]
则称 $F(x)$ 在 $x=p$ 处\textbf{可微}, 并称线性变换 $A$ 为 $F(x)$ 在 $x=p$ 处的\textbf{微分}或\textbf{全微分},
记作 $\mathrm{d}F(p)$, 即 $\mathrm{d}F(p)=A.$ 
\end{definition}

\begin{definition}{(导矩阵)}
设有向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$, $F$ 可表为分量函数形式
$$
F(x)=\left(\begin{array}{c}
F_{1}(x)\\
F_{2}(x)\\
\vdots\\
F_{m}(x)
\end{array}\right),\quad x:=(x_{1},x_{2},\ldots,x_{n})\in\mathbb{R}^{n},
$$
其中 $F_{j}:\mathbb{R}^{n}\rightarrow\mathbb{R}$ 是数量函数 $(j=1,2,\ldots,m)$.
若每个 $F_{j}$ 在 $x=p$ 处可微, 则 ${\displaystyle \frac{\partial F_{j}}{\partial x_{i}}(p)}$
都有意义 $(i=1,2,\ldots,n),$ 因而可定义
$$
{\displaystyle \frac{\partial F}{\partial x_{i}}(p):=\left(\begin{array}{c}
\frac{\partial F_{1}}{\partial x_{i}}(p)\\
\frac{\partial F_{2}}{\partial x_{i}}(p)\\
\vdots\\
\frac{\partial F_{m}}{\partial x_{i}}(p)
\end{array}\right),\quad i=1,2,\ldots,n,}
$$
称为 $F(x)$ 在 $x=p$ 处关于 $x_{i}$ 变元的\textbf{偏导数}, 以及也可定义
\[
\mathrm{D}F(p)=(\frac{\partial F}{\partial x_{1}}(p),\frac{\partial F}{\partial x_{2}}(p),\ldots,\frac{\partial F}{\partial x_{n}}(p))
\]
称为 $F(x)$ 在 $x=p$ 处的\textbf{导映射}或\textbf{导矩阵}, 也叫\textbf{雅可比 (Jocobi)
矩阵}, 即
$$
\mathrm{D}F(p)=\left(\begin{array}{cccc}
\frac{\partial F_{1}}{\partial x_{1}}(p) & \frac{\partial F_{1}}{\partial x_{2}}(p) & \cdots & \frac{\partial F_{1}}{\partial x_{n}}(p)\\
\frac{\partial F_{2}}{\partial x_{1}}(p) & \frac{\partial F_{2}}{\partial x_{2}}(p) & \cdots & \frac{\partial F_{2}}{\partial x_{n}}(p)\\
\vdots & \vdots &  & \vdots\\
\frac{\partial F_{m}}{\partial x_{1}}(p) & \frac{\partial F_{m}}{\partial x_{2}}(p) & \ldots & \frac{\partial F_{m}}{\partial x_{n}}(p)
\end{array}\right)_{m\times n}
$$
关于 Jocobi 矩阵的记号, 有些书也将其记为 $\mathrm{D}F(p):={\displaystyle \left.\frac{\mathrm{D}(F_{1},F_{2},\ldots,F_{m})}{\mathrm{D}(x_{1},x_{2},\ldots,x_{n})}\right|_{x=p}.}$
\end{definition}



下面的定理表明, 上面两个定义是完全等价的. 

\begin{theorem}{}
向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$ 在 $p\in\mathbb{R}^{n}$
处可微的充要条件是它的每个分量函数 $F_{j}:\mathbb{R}^{n}\rightarrow\mathbb{R}$ ($j=1,2,\ldots,$ $m$)
都在 $p$ 处可微. 因此, $\mathrm{d}F(p)=\mathrm{D}F(p).$
\end{theorem}
\verb| |

下面给出一些向量函数全微分的例子.
\begin{example}{}
若矩阵 $A\in\mathbb{R}^{m\times n}$ ($m$ 行 $n$ 列), 向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m},$
$F(x)=Ax,$ 则 $F(x)$ 在任意点 $x=p$ 处的微分都等于 $A,$ 即
\[
\mathrm{d}F(p)\equiv A.
\]
\end{example}

\begin{example}{}
设 $F(x,y)=(x^{2}+xy,y^{2}+xy)$, 求 $\mathrm{D}F(x,y).$
$$
\mathrm{D}F(x,y)=\left(\begin{array}{cc}
2x+y\quad & x\\
y & 2y+x
\end{array}\right).
$$
\end{example}
\verb| |



\begin{definition}{(方向导数)}
设有向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$, 以及向量 $v\in\mathbb{R}^{n},$
定义 $F$ 在点 $p$ 处沿方向 $v$ 的\textbf{方向导数}为 
\[
{\displaystyle \frac{\partial F}{\partial v}(p)={\displaystyle \lim_{\varepsilon\rightarrow0}{\displaystyle \frac{F(p+\varepsilon v)-F(p)}{\varepsilon}}.}}
\]
\end{definition}

\begin{theorem}{(方向导数与微分的关系)}
若向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$ 在 $p\in\mathbb{R}^{n}$
处可微, 则对任意单位向量 $v\in\mathbb{R}^{n}$, 有
\[
\frac{\partial F}{\partial v}(p)=[\mathrm{D}F(p)](v)=[\mathrm{D}F(p)]\cdot v,
\]
其中第一个等号后的 $\mathrm{D}F(p)$ 表示导映射 (看成线性变换对 $v$ 作用), 第二个等号后的 $\mathrm{D}F(p)$
表示导矩阵 (看成矩阵与列向量 $v$ 作矩阵乘法运算).
\end{theorem}
\verb| |

\begin{theorem}{(链式法则)}
设有向量函数 $F:\mathbb{R}^{n}\rightarrow\mathbb{R}^{m}$, $x\mapsto F(x)$,
又有 $G:\mathbb{R}^{m}\rightarrow\mathbb{R}^{k}$, $y\mapsto G(y)$.
假设 $F$ 在点 $p$ 处可微, $G$ 在点 $F(p)$ 处可微, 则复合函数 $G\circ F$ 也在点 $p$
处可微, 且
\[
\mathrm{D}(G\circ F)(p)=\mathrm{D}G(F(p))\mathrm{D}F(p).
\]
\end{theorem}

\begin{example}{}
设 $F(x,y)=(2x+y,2y+x),$ $G(u,v)=u^{2}+v^{2}$, 则
\[
(G\circ F)(x,y)=(2x+y)^{2}+(2y+x)^{2}=5x^{2}+5y^{2}+8xy,
\]
一方面有 
$$
\mathrm{D}F(x,y)=\left(\begin{array}{cc}
2& 1\\
1 & 2
\end{array}\right),\quad\mathrm{D}G(u,v)=(2u,2v),
$$
\[
\mathrm{D}(G\circ F)(x,y)=(10x+8y,10y+8x)
\]
另一方面 
$$
\mathrm{D}G(F(x,y))\mathrm{D}F(x,y)  =  \left.(2u,2v)\right|_{u=2x+y,\,v=2y+x}\cdot\left(\begin{array}{cc}
2 & 1\\
1 & 2
\end{array}\right)
$$
$$
  =  (4x+2y,4y+2x)\left(\begin{array}{cc}
2 & 1\\
1 & 2
\end{array}\right)
  =  (10x+8y,10y+8x)
$$
 说明 $\mathrm{D}(G\circ F)(x,y)=\mathrm{D}G(F(x,y))\mathrm{D}F(x,y)$. 
\end{example}

\verb| |

与数量函数拥有\textsl{微分中值定理}\upref{MeanTh}不同, 向量函数没有微分中值定理, 只有微分中值不等式. 

\begin{theorem}{(微分中值不等式)}
设 $\Omega$ 是 $\mathbb{R}^{n}$ 中的凸区域, 向量函数$F:D\rightarrow\mathbb{R}^{m}$
处处可微, 则对任意 $x,y\in D,$ 存在 $x$ 与 $y$ 的连续上的点 $\xi,$ 使成立
\[
|F(x)-F(y)|\leqslant\left\Vert \mathrm{D}F(\xi)\right\Vert |x-y|,
\]
其中 $\left\Vert \cdot\right\Vert $ 可看成是矩阵范数或有界线性算子范数. 
\end{theorem}

\verb|写在后面| \footnote{本页关于向量函数的微分、导映射、方向导数的内容，可以推广到泛函分析Banach空间上的算子的Frechet微分或Frechet导数，这一点是重要的.}