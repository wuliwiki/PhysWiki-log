% WKB 近似
% WKB|薛定谔方程|艾里函数

\pentry{线性势能的定态薛定谔方程\upref{LinPot}}

\footnote{本文参考\cite{高量}。}在某些定态问题中， WKB 近似方法可以比较容易地求解一维定态薛定谔方程。 该方法基于将波函数按 $\hbar$ 作幂级数展开，就其本身而言，有两个基本问题：1。在远离转折点处的近似解；2。在转折点处的连接条件。并通过这两个问题求解定态薛定谔方程。

WKB 近似适用于势能 $V$ 相比于波长变化十分缓慢的情形，其一级近似公式为
\begin{equation}
\begin{aligned}
u(x)&=\frac{A}{\sqrt{k(x)}} \E^{\pm\I\int^x k(y)\dd y}~,\\
k(x)&\equiv\left\{\begin{aligned}
&\qty[\frac{2m}{\hbar^2}\qty(E-V(x))]^{1/2},\quad \text{when}\; E>V(x)\\
&-\I\kappa(x)\equiv-\I\qty[\frac{2m}{\hbar^2}(V(x)-E)]^{1/2},\quad \text{when}\; E<V(x)
\end{aligned}~.\right.
\end{aligned}
\end{equation}
其中，$u(x)$ 为定态薛定谔方程的解。
%经典区域
%\begin{equation}
%\psi(x) \approx \frac{C}{\sqrt{p(x)}} \exp(\pm \I \int p(x) \dd{x})
%\end{equation}

%隧道区域
%\begin{equation}
%\psi(x) \approx \frac{C}{\sqrt{\abs{p(x)}}} \exp(\pm \int p(x) \dd{x})
%\end{equation}

在二者的转折点 $a$ 处， 连接函数为艾里函数\upref{AiryF} $\opn{Ai}$， 详见 “线性势能的定态薛定谔方程\upref{LinPot}”。在转折点处的连接公式为
\begin{equation}\label{eq_WKB_23}
u(x)=\left\{\begin{aligned}
&\frac{D}{\sqrt{\kappa(x)}}\E^{\pm\int_a^x\kappa(y)\dd y} ,\quad(E<V,\text{视积分结果取衰减项})\\
&\frac{2D}{\sqrt{k(x)}}\sin(\int_a^x k(y)\dd y+\frac{\pi}{4}),\quad(E>V)
\end{aligned}~.\right.
\end{equation}

%从经典到非经典区域
%\begin{equation}
%\psi(x) = \leftgroup{
%&\frac{B}{\sqrt{p(x)}} \exp(\I \int_{-x}^{x_0} p(x')\dd{x'}) + \frac{C}{\sqrt{p(x)}} \exp(-\I \int_{-x}^{x_0} p(x')\dd{x'}) \qquad &(x < x_0)\\
%&\frac{D}{\sqrt{\abs{p(x)}}} \exp(-\int_{x_0}^x \abs{p(x')} \dd{x'})  \qquad &(x > x_0)
%}\end{equation}
%衔接以后
%\begin{equation}
%\psi(x) = \leftgroup{
%&\frac{2D}{\sqrt{p(x)}} \sin(\int_{x}^{x_0} p(x')\dd{x'} + \frac{\pi}{4}) \quad &(x < x_0)\\
%&\frac{D}{\sqrt{\abs{p(x)}}} \exp(-\int_{x_0}^x \abs{p(x')} \dd{x'}) \quad &(x > x_0)
%}\end{equation}

\subsection{证明}
\subsubsection{WKB近似解}
薛定谔方程
\begin{equation}\label{eq_WKB_2}
\I\hbar\pdv{\psi}{t}=-\frac{\hbar^2}{2m}\Delta\psi+V(\bvec{r})\psi
\end{equation}
的解一般总能写成如下形式
\begin{equation}\label{eq_WKB_1}
\psi(\bvec r,t)=A\E^{\I W(\bvec r,t)/\hbar}~.
\end{equation}
\autoref{eq_WKB_1} 代入\autoref{eq_WKB_2} 得到 $W$ 满足的方程
\begin{equation}\label{eq_WKB_3}
\pdv{W}{t}+\frac{1}{2m}(\nabla W)^2+V-\frac{\I\hbar}{2m}\Delta W=0~.
\end{equation}
在经典极限（$\hbar\rightarrow 0$）下，\autoref{eq_WKB_3} 等同 $W$ (称为主函数)的哈密顿方程
\begin{equation}
\pdv{W}{t}+\frac{1}{2m}(\nabla W)^2+V=0~.
\end{equation}
如果 $\psi$ 是能量本征函数 $u(\bvec r)\E^{-\I Et/\hbar}$，则 $W$ 可写成
\begin{equation}
W(\bvec r,t)=S(\bvec r)-Et~.
\end{equation}
在这种情况下，我们有
\begin{equation}
u(\bvec r)=A\E^{\I S(\bvec r)}~,
\end{equation}
且
\begin{equation}
\frac{1}{2m}(\nabla S)^2-\qty[E-V(\bvec r)]-\frac{\I\hbar}{2m}\Delta S=0~.
\end{equation}

在一维情况下，WKB 方法得到 $S$ 的按 $\hbar$ 幂展开式的头两项可以清楚的给出。下面以一维定态为例。

一维薛定谔方程可写为\cite{Sakurai}
\begin{equation}\label{eq_WKB_4}
\begin{aligned}
&\dv[2]{u}{x}+\qty[k(x)]^2u=0~,\\
&k(x)\equiv\left\{\begin{aligned}
&\qty[\frac{2m}{\hbar^2}\qty(E-V(x))]^{1/2},\quad \text{when}\; E>V(x)\\
&-\I\kappa(x)\equiv-\I\qty[\frac{2m}{\hbar^2}(V(x)-E)]^{1/2},\quad \text{when}\; E<V(x)
\end{aligned}~.\right.
\end{aligned}
\end{equation}

我们寻求\autoref{eq_WKB_4} 如下形式的解
\begin{equation}\label{eq_WKB_10}
u(x)=A\E^{\I S(x)/\hbar}~.
\end{equation}
将上式代入\autoref{eq_WKB_4} ，得
\begin{equation}\label{eq_WKB_6}
\I\hbar S''-S'^2+\hbar^2\qty[k(x)]^2=0~.
\end{equation}
其中，撇号表示对 $x$ 求导。将 $S(x)$ 按 $\hbar$ 之幂作级数展开
\begin{equation}\label{eq_WKB_5}
S(x)=\sum_{n=0}\hbar^nS_n(x)~.
\end{equation}
\autoref{eq_WKB_5} 代入\autoref{eq_WKB_6} 得
\begin{equation}
\sum_{n=0}\qty(\I S_n''-\sum_{i=0}^{n+1}S_{n+1-i}'S_i')\hbar^{n+1}+\hbar^2\qty[k(x)]^2-S_0'^2=0~.
\end{equation}
按幂次将上式分解为多个全微分方程
\begin{equation}
\begin{aligned}
-S_0'^2+\hbar^2\qty[k(x)]^2&=0\\
\hbar\qty(\I S_0''-2S_0'S_1')&=0\\
\cdots
\end{aligned}
\end{equation}
为求出一级近似解，通过比较系数，给出头两个方程
\begin{equation}\label{eq_WKB_7}
\begin{aligned}
-S_0'^2+\hbar^2k^2=0;\\
\I S_0''-2S_0'S_1'=0~.
\end{aligned}
\end{equation}
容易求得\autoref{eq_WKB_7} 第一式的解为
\begin{equation}\label{eq_WKB_8}
S_0(x)=\pm\hbar\int^x k(y)\dd y~.
\end{equation}
利用上式和\autoref{eq_WKB_7} 第一式代入\autoref{eq_WKB_7} 第二式可得
\begin{equation}\label{eq_WKB_9}
S_1(x)=\frac{\I}{2}\ln k(x)~,
\end{equation}
\autoref{eq_WKB_8} 和\autoref{eq_WKB_9} 已经将任意常数略去了。将 $S_0$ 和 $S_1$ 的结果代入\autoref{eq_WKB_10} ，可得 $u(x)$ 的一级近似解
\begin{equation}\label{eq_WKB_11}
u(x)=A\E^{\I(S_0+\hbar S_1)/\hbar}=\frac{A}{\sqrt{k(x)}} \E^{\pm\I\int^x k(y)\dd y}~.
\end{equation}
\subsubsection{解的渐进性质}
欲使\autoref{eq_WKB_11} 的解成立，显然必须要求展开式\autoref{eq_WKB_5} 是合理的。为了保证一级近似解适用，应该要求
\begin{equation}\label{eq_WKB_13}
\abs{\frac{\hbar(\I S_0''-2S_0'S_1')}{-S_0'^2+\hbar^2k^2}}\ll1~.
\end{equation}
由\autoref{eq_WKB_8} 和\autoref{eq_WKB_9} 
\begin{equation}\label{eq_WKB_12}
S_0'=\pm\hbar k,\quad S_0''=\pm\hbar k',\quad S_1'=\frac{\I k'}{2k}~.
\end{equation}
\autoref{eq_WKB_12} 代入\autoref{eq_WKB_13} ，得
\begin{equation}
\abs{\frac{k'}{k^2}}\ll1~.
\end{equation}
引入波长 $\lambda=\frac{2\pi}{\abs{k}}$ ，则
\begin{equation}\label{eq_WKB_14}
\frac{\lambda}{2\pi}\abs{\frac{k'}{k}}\ll1~.
\end{equation}
将\autoref{eq_WKB_4} 代入\autoref{eq_WKB_14} 
\begin{equation}\label{eq_WKB_15}
\frac{\lambda}{2\pi}\abs{\frac{\dv{V}{x}}{2(E-V)}}\ll1~.
\end{equation}
\autoref{eq_WKB_14} 表明，在可以和 $\lambda$ 相比的小距离中，“动量”的相对变化 $k'/k$ 要十分小。为保证这一点，只要 $V(x)$ 随 $x$ 变化得十分缓慢，而粒子的“动能” $(E-V)$ 又很大，使得 $\dv{V}{x}$ 与 “动能”相比要小得多，则\autoref{eq_WKB_14} 和\autoref{eq_WKB_15} 才成立。这表明，WKB近似方法的适用有着它的适用范围。

显然，当 $E=V(x)$ 时（满足此式的式子称为转折点），\autoref{eq_WKB_13} 不成立。由此 WKB近似不适用，只有在离开最近的转折点几个波长的地方，WKB近似解才可能是有效的。

以上的讨论完全适用于中心力场的径向方程，因为在中心力场径向方程中，只需要将 $r$ 代替 $x$ ，以 $V(\bvec r)+\frac{\hbar^2l(l+1)}{2m+2}$ 代替 $V(x)$ ，以 $u(\bvec r)$ 代替 $u(x)$ ，相应方程便与一维薛定谔方程完全类同。
\subsubsection{连接公式}
既然在转折点附近\autoref{eq_WKB_5} 和\autoref{eq_WKB_11} 的解不适用。因此需要寻找 WKB波函数在转折点处的连接公式，这需要另辟蹊径。
\begin{figure}[ht]
\centering
\includegraphics[width=5cm]{./figures/1935ae7ede528d68.pdf}
\caption{转折点 $x=a$ 附近的势能曲线} \label{fig_WKB_1}
\end{figure}

为方便讨论，不失一般性，通常假定在 $x=a$ 处有一转折点，即设
\begin{equation}
\left\{\begin{aligned}
&E>V(x),\quad x>a(\text{经典允许区})\\
&E=V(x),\quad x=a\\
&E<V(x),\quad x<a(\text{经典禁区})
\end{aligned}~,\right.
\end{equation}
如\autoref{fig_WKB_1} 所示。

建立连接公式基本思想是：首先在转折点附近求解薛定谔方程；其次给出该解在离开转折点“较远处”所具有的渐进形式；最后，将这渐进解形式与 WKB 解相比较，从而找出WKB波函数的连接公式。

\textbf{1.在转折点附近求解薛定谔方程}

由于 $V(x)$ 随 $x$ 发生缓慢变化，因此可在点a处将 $V(x)$ 泰勒展开，并取线性部分，即
\begin{equation}
V(x)=V(a)+V'(a)(x-a)=E+V'(a)(x-a)~.
\end{equation}
 其中，$V'(a)<0$。于是在 $a$ 点附近的薛定谔方程为
 \begin{equation}\label{eq_WKB_16}
 \dv[2]{u}{x}-\frac{2mV'(a)}{\hbar^2}(x-a)u=0~.
 \end{equation}
令
\begin{equation}
\begin{aligned}
&\alpha=\qty(\frac{2mV'(a)}{\hbar^2})^{\frac{1}{3}}~,\\
&\xi=\alpha(x-a)~.
\end{aligned}
\end{equation}
则\autoref{eq_WKB_16} 式变为
\begin{equation}\label{eq_WKB_17}
\dv[2]{u}{\xi}-\xi u=0~,
\end{equation}
这是艾里函数\upref{AiryF}满足的微分方程\autoref{eq_AiryF_2}~\upref{AiryF}。显然，$u$ 应是 $\mathrm{Ai}(\xi)$ 和 $\mathrm{Bi}(\xi)$ 的线性组合
\begin{equation}
u=c_1 \mathrm{Ai}(\xi)+c_2 \mathrm{Bi}(\xi)~.
\end{equation}

在经典允许区（$\xi<0$）中，$\mathrm{Ai}(\xi),\mathrm{Bi}(\xi)$ 都是 \autoref{eq_WKB_17} 满足有限条件的解。在经典禁区（$\xi>0$），\autoref{eq_WKB_17} 满足有限条件的解为 $\mathrm{Ai}(\xi)$。为使得 $u$ 在 $\xi=0$ 处连续，必有 $c_2=0$，所以
\begin{equation}\label{eq_WKB_18}
u=c_1\mathrm{Ai}(\xi)~.
\end{equation}

\textbf{2.渐进形式}

由 $\mathrm{Ai(x)}$ 函数的渐进形式\upref{AiryF} ，得\autoref{eq_WKB_18} 的渐进形式
\begin{equation}\label{eq_WKB_22}
\begin{aligned}
&c_1\opn{Ai}(\xi) \overset{\xi \to +\infty}{\longrightarrow} \frac{c_1}{2\sqrt{\pi} \xi^{1/4}} \exp(-\frac{2}{3}\xi^{3/2})~,\\
&c_1\opn{Ai}(\xi) \overset{\xi \to -\infty}{\longrightarrow} \frac{c_1}{\sqrt{\pi} \abs{\xi}^{1/4}} \sin(\frac{2}{3}\abs{\xi}^{3/2}+\frac{\pi}{4})~.\\
\end{aligned}
\end{equation}

\textbf{3。连接公式}

我们的问题是要给出在“远离”转折点的WKB近似解的连接公式。为此，我们以例题得形式来证明连接公式
\begin{example}{连接公式}
如\autoref{fig_WKB_2} 的势能曲线 $V(x)$。
\begin{figure}[ht]
\centering
\includegraphics[width=4cm]{./figures/65d219c14a786e5f.pdf}
\caption{具有两个转折点的势能曲线} \label{fig_WKB_2}
\end{figure}
试证明在 $a$ 点的连接公式为
\begin{equation}
u(x)=\left\{\begin{aligned}
&\frac{c}{2\sqrt{\kappa(x)}}\E^{\int_a^x\kappa(y)\dd y} ,\quad(E<V)\\
&\frac{c}{\sqrt{k(x)}}\sin(\int_a^x k(y)\dd y+\frac{\pi}{4}),\quad(E>V)
\end{aligned}\right.~.
\end{equation}
\textbf{证明：}
在阱内 $(a<x<b)$ 有 $E<V(x)$，仍为经典允许区（注意，这里 $\xi<0$），按\autoref{eq_WKB_11} ，WKB一级近似解可表示为
\begin{equation}\label{eq_WKB_20}
u(x)=\frac{c}{\sqrt{k(x)}}\sin(\int^x k(y)\dd y+\delta)~.
\end{equation}
其中， $\delta$ 为待定相因子。$c$ 为常数。

在点 $a$ 附近
\begin{equation}
V(x)\approx E+V'(a)(x-a)~.
\end{equation}
从而
\begin{equation}\label{eq_WKB_19}
\begin{aligned}
\int_a^xk(y)\dd y&=
\frac{\sqrt{2m}}{\hbar}\int_a^x\sqrt{E-V(y)}\dd y=\frac{2}{3}\abs{\xi}^{3/2}
\\
\sqrt{k(x)}
&=
\abs{\xi}^{1/4}\alpha^{1/2}
\end{aligned}~.
\end{equation}
将\autoref{eq_WKB_19} 两式代入\autoref{eq_WKB_20} ，可得 WKB近似解为
\begin{equation}\label{eq_WKB_21}
u=
\frac{C}{\abs{\xi}^{1/4}}\sin({\frac{2}{3}\abs{\xi}^{3/2}+\delta})~.
\end{equation}
其中， $C=c/\alpha^{1/2}~.$

\autoref{eq_WKB_21} 与\autoref{eq_WKB_22} 第二式对比得
\begin{equation}\label{eq_WKB_25}
\delta=\frac{\pi}{4},\qquad C=\frac{c_1}{\sqrt{\pi}}~.
\end{equation}
从而 WKB一级近似波函数在 $s=a$ 附近的阱内处的连接公式为
\begin{equation}
u(x)=\frac{c}{\sqrt{k(x)}}\sin(\int_a^x k(y)\dd y+\frac{\pi}{4})~.
\end{equation}

在阱外a点附近，有 $E>V(x)$，为经典禁区（注意，这里 $\xi>0$）,按\autoref{eq_WKB_11} ，WKB一级近似解可表示为
\begin{equation}
u(x)=\frac{c'}{\sqrt{\kappa(x)}}\E^{\int_a^x\kappa(y)\dd y}~,
\end{equation}


而
\begin{equation}
\begin{aligned}
\int_a^x\kappa(y)\dd y&=
\frac{\sqrt{2m}}{\hbar}\int_a^x\sqrt{V(y)-E}\dd y=\frac{2}{3}\xi^{3/2}~,
\\
\sqrt{\kappa(x)}
&=
\alpha^{1/2}\abs{\xi}^{1/4}~.
\end{aligned}
\end{equation}
故WKB一级近似解可表示为
\begin{equation}\label{eq_WKB_26}
u(x)=\frac{C'}{\xi^{1/4}}\E^{-\frac{2}{3}\xi^{3/2}}~.
\end{equation}
其中，$C'=c'/\alpha^{1/2}~.$

\autoref{eq_WKB_26}  与\autoref{eq_WKB_22} 第一式比较得
\begin{equation}\label{eq_WKB_24}
C'=\frac{c_1}{2\sqrt{\pi}}~.
\end{equation}
\autoref{eq_WKB_24} 与\autoref{eq_WKB_25} 比较得
\begin{equation}
c=2c'~.
\end{equation}
从而在转折点 $x=a$ 附近阱外连接公式为
\begin{equation}
u(x)=\frac{c}{2\sqrt{\kappa(x)}}\E^{\int_a^x\kappa(y)\dd y}~.
\end{equation}
综上，在 $a$ 点连接公式为
\begin{equation}
u(x)=\left\{\begin{aligned}
&\frac{c}{2\sqrt{\kappa(x)}}\E^{\int_a^x\kappa(y)\dd y} ,\quad(E<V)\\
&\frac{c}{\sqrt{k(x)}}\sin(\int_a^x k(y)\dd y+\frac{\pi}{4}),\quad(E>V)
\end{aligned}\right.~.
\end{equation}

利用同样的方法，可讨论在 $b$ 点的连接公式。
\end{example}

这样，连接公式\autoref{eq_WKB_23} 的成立将十分显然。

\addTODO{Griffiths 例题 Potential well with one vertical wall.}
