% 高维球谐函数
% keys 球谐函数|高维
% license Usr
% type Tutor

\pentry{球谐函数\nref{nod_SphHar}，高维弯曲空间中的拉普拉斯算符\nref{nod_GLapOp}，高维空间球坐标及其度规\nref{nod_nDSM}}{nod_94ea}

在三维的情形，球谐函数是在球坐标下，求解拉普拉斯方程时，通过分离变量得到的。其是拉普拉斯方程角度部分的解。即下面的微分方程
\begin{equation}
\Nabla_\Omega^2 Y+\lambda Y=0.~
\end{equation}
其中 $\Omega$ 代表只含角 $(\theta,\phi)$ 的部分，$\lambda$ 是常数，且
\begin{equation}
\Nabla^2_\Omega=\pdv[2]{}{\theta}+\cot\theta\pdv{}{\theta}+\frac{1}{\sin^2\theta}\pdv[2]{}{\varphi}.~
\end{equation}
本词条将仿照三维情形推导球谐函数的方法，推导高维弯曲空间中的球谐函数。

\subsection{球坐标系下的高维拉普拉斯方程}
对一般高维空间的拉普拉斯方程，可由对应空间的\enref{拉普拉斯算符}{GLapOp}获得，即从 $\Delta u=0$ 一般高维空间的拉普拉斯方程如下：
\begin{equation}\label{eq_HDsphF_2}
\begin{aligned}
&\frac{1}{\sqrt{ \left\lvert g \right\rvert }} \frac{\partial }{\partial x^i} \left(\sqrt{ \left\lvert g \right\rvert }g^{ij} \frac{\partial u}{\partial x^j} \right)\\
=&\frac{1}{\sqrt{ \left\lvert g \right\rvert }} \qty(\frac{\partial }{\partial x^i} \sqrt{ \left\lvert g \right\rvert })g^{ij} \frac{\partial u}{\partial x^j}+\qty(\frac{\partial }{\partial x^i} g^{ij}) \frac{\partial u}{\partial x^j}+g^{ij}\frac{\partial^2 u}{\partial x^i\partial x^j}\\
=&0 .
\end{aligned}~
\end{equation}

而
\begin{equation}
\begin{aligned}
&\frac{1}{\sqrt{\abs{ g}}}\frac{\partial }{\partial x^i} \sqrt{ \left\lvert g \right\rvert }=\frac{1}{2g}\pdv{g}{g_{jk}}\pdv{g_{jk}}{x^i}\\
&=\frac{1}{2g}(gg^{jk})\pdv{g_{jk}}{x^i}\\
&=\frac{1}{2}g^{jk}\pdv{g_{jk}}{x^i}.
\end{aligned}~
\end{equation}
$N+1$ 维空间球坐标系 $x^i=\theta^i,i=1,\cdots,N,x^{N+1}=r$ 下的\enref{度规}{nDSM}为
\begin{equation}
\begin{aligned}
g_{ij}&=\mathrm{diag}(\eta_i),\\
\eta_{i}&=\left\{\begin{aligned}
& r^2\prod\limits_{k=i+1}^{N}\sin^2\theta^{k},i\leq N,\\
&1,i=N+1.
\end{aligned}\right.
\end{aligned}~
\end{equation}
由此，
\begin{equation}\label{eq_HDsphF_1}
\begin{aligned}
g^{ij}&=\mathrm{diag}(h^i),\\
h^{i}&=\left\{\begin{aligned}
& r^{-2}\prod\limits_{k=i+1}^{N}\sin^{-2}\theta^{k},i\leq N,\\
&1,i=N+1.
\end{aligned}\right.
\end{aligned}~
\end{equation}
所以
\begin{equation}
\begin{aligned}
&\frac{1}{2}g^{jk}\pdv{g_{jk}}{x^{N+1}}=\frac{1}{2}\sum_{j=1}^{N+1}h^{j}\pdv{\eta_{j}}{x^i}\\
=&\frac{1}{2}\qty(\sum_{j=1}^{N}r^{-2}\prod\limits_{k=j+1}^{N}\sin^{-2}\theta^{k}2r\prod\limits_{k=j+1}^{N}\sin^2\theta^{k})\\
=&Nr^{-1}\\
&\frac{1}{2}g^{jk}\pdv{g_{jk}}{x^i}=\frac{1}{2}\sum_{j=1}^{N+1}h^{j}\pdv{\eta_{j}}{x^i}\\
=&\frac{1}{2}\qty(\sum_{j=1}^{i-1}r^{-2}\prod\limits_{k=j+1}^{N}\sin^{-2}\theta^{k}2r^2\sin\theta^{i}\cos\theta^{i}\prod\limits_{k=j+1,k\neq i}^{N}\sin^2\theta^{k})\\
=&(i-1)\cot\theta^i,\quad i\leq N.
\end{aligned}~
\end{equation}
因此
\begin{equation}
\begin{aligned}
&\frac{1}{\sqrt{ \left\lvert g \right\rvert }} \qty(\frac{\partial }{\partial x^i} \sqrt{ \left\lvert g \right\rvert })g^{ij} \frac{\partial u}{\partial x^j}\\
=&Nr^{-1}\pdv{u}{r}+\sum_{i=1}^{N}h^{i}(i-1)\cot\theta^i\pdv{u}{\theta^i}\\
\end{aligned}~
\end{equation}
而由\autoref{eq_HDsphF_1} ， $\pdv{g^{ij}}{\theta^i}=0$。且
\begin{equation}
g^{ij}\frac{\partial^2 u}{\partial x^i\partial x^j}=\sum_{i=1}^{N}h^{i}\frac{\partial^2 u}{\partial {\theta^i}^2}+\frac{\partial^2 u}{\partial r^2}~
\end{equation}
所以最后\autoref{eq_HDsphF_2} 变成
\begin{equation}
\begin{aligned}
\sum_{i=1}^{N}h^{i}\qty[(i-1)\cot\theta^i\pdv{u}{\theta^i}+\frac{\partial^2 u}{\partial {\theta^i}^2}]+r^{-N}\frac{\partial }{\partial r}\qty(r^{N}\frac{\partial u}{\partial r})=0.
\end{aligned}~
\end{equation}
若定义 
\begin{equation}
h^i_{(N)}:=r^2h^i,~
\end{equation}
则 $h^i_{(N)}$ 将仅仅依赖于角部变量。类似球坐标下\enref{三维拉普拉斯方程}{SphLap}的写法，我们有
\begin{equation}
r^{-2}\Nabla^{2}_{S^N}u+r^{-N}\frac{\partial }{\partial r}\qty(r^{N}\frac{\partial u}{\partial r})=0.~
\end{equation}
其中
\begin{equation}
\Nabla^{2}_{S^N}u:=h^{i}_{(N)}\qty[(i-1)\cot\theta^i\pdv{u}{\theta^i}].~
\end{equation}

\subsection{将球谐函数分离变量}









