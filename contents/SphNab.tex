% 球坐标系中的偏微分算符
% keys 球坐标系|梯度|散度|旋度|拉普拉斯算符
% license Xiao
% type Tutor

\pentry{正交曲线坐标系中的矢量算符\upref{CVecOp}}{nod_df95}

\subsection{矢量算符}
球坐标系中标量函数 $u(r, \theta, \phi)$ 和矢量函数 $\bvec v(r, \theta, \phi)$ 的梯度， 散度， 旋度和拉普拉斯算符的公式如下。 其中 $r$ 是极径，$\theta $ 是极角，$\phi $ 是方位角。 推导见下文。

\begin{itemize}
\item \textbf{梯度算符}
\begin{equation}\label{eq_SphNab_1}
\grad u = \pdv{u}{r}\uvec r + \frac{1}{r} \pdv{u}{\theta}\uvec \theta  + \frac{1}{r\sin \theta }\pdv{u}{\phi}\uvec \phi~.
\end{equation}
\item \textbf{散度算符}
\begin{equation}\label{eq_SphNab_2}
\div \bvec v = \frac{1}{r^2} \pdv{r} (r^2 v_r) + \frac{1}{r\sin \theta} \pdv{\theta} (\sin\theta v_\theta) + \frac{1}{r\sin \theta}\pdv{v_\phi}{\phi}~.
\end{equation}
\item \textbf{旋度算符}
\begin{equation}\ali{
\curl \bvec v = & \frac{1}{r\sin \theta} \qty[\pdv{\theta} (\sin \theta v_\phi) - \pdv{v_\theta}{\phi}]\uvec r  + \frac1r \qty[\frac{1}{\sin \theta}\pdv{v_r}{\phi} - \pdv{r} (r v_\phi)]\uvec \theta\\
&+ \frac1r \qty[\pdv{r} (r v_\theta) - \pdv{v_r}{\theta}]\uvec \phi~.
}\end{equation}
\item \textbf{拉普拉斯算符}
\begin{equation}\label{eq_SphNab_4}
\laplacian u = \div (\grad u) = \frac{1}{r^2} \pdv{r} \qty(r^2 \pdv{u}{r}) + \frac{1}{r^2 \sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{u}{\theta}) + \frac{1}{r^2 \sin^2 \theta} \pdv[2]{u}{\phi}~.
\end{equation}
\end{itemize}

\subsubsection{推导}
位置矢量的微分可以表示为
\begin{equation}\label{eq_SphNab_12}
\dd{\bvec r} = \uvec r \dd{r} + r\uvec \theta\dd{\theta} + r\sin\theta\uvec \phi\dd{\phi}~.
\end{equation}
\addTODO{该式的推导应该在正交曲线坐标系\upref{CurCor} 中完成}。
代入\autoref{eq_CVecOp_4}~\upref{CVecOp}到\autoref{eq_CVecOp_6}~\upref{CVecOp}即可完成推导。


\subsection{拉普拉斯算符的径向和角向分解}
为了书写方便小时百科中定义两个算符 $\laplacian_r$ 和 $\laplacian_\Omega$ 满足
\begin{equation}\label{eq_SphNab_3}
\laplacian = \laplacian_r + \frac{\laplacian_\Omega}{r^2}~.
\end{equation}
其中 $\laplacian_r$ 只对 $r$ 求偏导（\autoref{eq_SphNab_4} 右边第一项）， $\laplacian_\Omega$ 只对 $\theta,\phi$ 求偏导（\autoref{eq_SphNab_4} 右边后两项）。 该分解有助于使用分离变量法求解球坐标系中的拉普拉斯方程\upref{SphLap}。

$\laplacian_\Omega$ 还可以进一步分解为两个矢量算符的点乘
\begin{equation}
\laplacian_\Omega = \grad_\Omega\vdot \grad_\Omega~.
\end{equation}
其中
\begin{equation}
\begin{aligned}
\grad_\Omega &= \bvec r \cross \grad\\
&= \uvec \phi \pdv{\theta} - \uvec \theta\frac{1}{\sin\theta} \pdv{\phi}\\
&= -\qty(\sin\phi\pdv{\theta} + \cot\theta\cos\phi\pdv{\phi})\uvec x
+ \qty(\cos\phi\pdv{\theta} - \cot\theta \sin\phi \pdv{\phi}) \uvec y
+ \pdv{\phi} \uvec z~.
\end{aligned}
\end{equation}
该分解在量子力学中有应用， 见 “球坐标系中的角动量算符\upref{SphAM}”。

推导： 只需要把 $\bvec r = r \uvec r$ 和\autoref{eq_SphNab_1} 代入 $\bvec r \cross \grad$， 再把结果换到直角坐标系中即可。

\subsection{其他偏微分算符}
\pentry{复合函数的偏导、链式法则（多元微积分）\upref{PChain}}{nod_6c56}
把 $r,\theta,\phi$ 看成直角坐标 $x,y,z$ 的函数（\autoref{eq_SphCar_2}~\upref{SphCar}）， 则有
\begin{equation}
\pdv{r}{x} = \sin\theta\cos\phi, \qquad
\pdv{r}{y} = \sin\theta\sin\phi, \qquad
\pdv{r}{z} = \cos\theta~.
\end{equation}
\begin{equation}
\pdv{\theta}{x} = \frac{\cos\theta\cos\phi}{r}, \qquad
\pdv{\theta}{y} = \frac{\cos\theta\sin\phi}{r}, \qquad
\pdv{\theta}{z} = -\frac{\sin\theta}{r}~.
\end{equation}
\begin{equation}
\pdv{\phi}{x} = -\frac{\sin\phi}{r}, \qquad
\pdv{\phi}{y} = \frac{\cos\phi}{r}, \qquad
\pdv{\phi}{z} = 0~.
\end{equation}
根据多元函数的链式法则\upref{PChain}，
\begin{equation}\label{eq_SphNab_6}
\pdv{x} = \sin\theta\cos\phi\pdv{r} + \frac{\cos\theta\cos\phi}{r}\pdv{\theta} -\frac{\sin\phi}{r}\pdv{\phi}~,
\end{equation}
\begin{equation}\label{eq_SphNab_7}
\pdv{y} = \sin\theta\sin\phi\pdv{r} + \frac{\cos\theta\sin\phi}{r}\pdv{\theta} +\frac{\cos\phi}{r}\pdv{\phi}~,
\end{equation}
\begin{equation}\label{eq_SphNab_5}
\pdv{z} = \cos\theta\pdv{r} - \frac{\sin\theta}{r}\pdv{\theta}~.
\end{equation}
