% 费马大定理（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Fermat\%27s_Last_Theorem}{相关文章}。

在数论中，费马大定理（在较早的文献中有时称为“费马猜想”）陈述如下：对于任意整数\( n > 2 \)，不存在三个正整数\( a, b, c \)满足方程\( a^n + b^n = c^n \)。而对于\( n = 1 \)和\( n = 2 \)的情形，自古以来就已知存在无穷多个解。\(^\text{[1]}\)

这个命题最早是皮埃尔·德·费马大约于1637年在一本《算术》书的页边空白处提出的。他还写道他已有一个证明，但“这个证明太大，写不下”。尽管费马曾提出的其他未经证明的命题后来被他人证明并被称为“费马定理”（例如费马两平方和定理），但唯独这条“费马大定理”长期无法证明，使人们怀疑费马是否真的拥有一个正确的证明。因此，这个命题长期以来被称为\textbf{猜想}而不是定理。经过数学家长达358年的努力，安德鲁·怀尔斯于1994年首次成功给出了完整证明，并于1995年正式发表。2016年，怀尔斯因其工作获得阿贝尔奖，其成果被称为“一项惊人的突破”。\(^\text{[2]}\)此外，该证明还涵盖了大量谷山–志村猜想的内容，该猜想后来被称为模性定理，它不仅解开了费马大定理之谜，还开辟了许多新领域，并发展出了强大的模性提升技术，对解决众多其他数学难题产生了深远影响。

这个未解难题曾在 19世纪和20世纪极大地推动了代数数论的发展。在整个数学史上，费马大定理是最著名的定理之一。在被证明之前，它还曾被列入《吉尼斯世界纪录》，称为“最难的数学问题”，部分原因是该定理拥有最多数量的失败证明尝试。\(^\text{[3]}\)
\subsection{概述}  
\subsubsection{毕达哥拉斯的起源}
毕达哥拉斯方程\(x^2 + y^2 = z^2\)在正整数\(x\)、\(y\)、\(z\)上有无穷多组解，这些解被称为毕达哥拉斯三元组（最简单的例子是 3、4、5）。大约在 1637年，费马在一本书的页边空白处写道，更一般形式的方程\(a^n + b^n = c^n\)在当\(n > 2\)时，没有正整数解。尽管他声称自己有一个完整的证明，但他未留下任何细节，至今也未有人找到该证明。这个断言是在他去世大约 30 年后才被人发现的。

这个断言后来被称为费马大定理，并在接下来的三个半世纪里始终未被证明。\(^\text{[4]}\)

这一定理最终成为数学史上最著名的未解问题之一。对它的证明尝试促使了数论领域的重大进展，随着时间推移，费马大定理作为数学未解难题的地位也日益突出。
\subsubsection{后续发展与最终解答}
当\(n = 4\)时的特例由费马本人亲自证明，该特例足以说明：如果费马大定理在某个非素数指数\(n\)下不成立，那么它在某个更小的\(n\)下也将不成立，因此只需对素数指数\(n\)进行进一步研究。\(^\text{[注1]}\)在接下来的两个世纪（1637–1839年）中，该猜想仅在素数\(n = 3, 5, 7\)的情况下被证明成立，尽管索菲·热尔曼提出并证明了一种适用于整个素数类的方法，这在当时具有开创性意义。到了19世纪中期，欧内斯特·库默尔进一步拓展了该思路，并证明了该定理对于所有正规素数成立，但对于非正规素数仍需逐个分析。在库默尔工作的基础上，借助复杂的计算机研究，其他数学家将证明的范围扩展到了所有指数为素数且小于四百万的情况。\(^\text{[5]}\)但对于所有整数指数的全面证明依然遥不可及（这意味着大多数数学家认为：该定理要么无法证明、要么极其困难，或者以当时的知识几乎不可能完成）。\(^\text{[6]}\)

大约在1955年，日本数学家志村五郎和谷山丰怀疑椭圆曲线与模形式之间可能存在某种联系——这是数学中的两个完全不同的领域。这个猜想当时被称为“谷山–志村猜想”（后来称为模性定理），它最初是一个独立的数学命题，表面上与费马大定理并无关联。尽管如此，这个猜想被广泛认为本身就具有重要意义和深远影响，但也像费马大定理一样，被认为极其难以证明，几乎无法触及。\(^\text{[7]}\)

1984年，盖尔哈德·弗雷注意到这两个原本毫不相关、尚未解决的问题之间似乎存在某种联系。弗雷给出了一个初步的推理框架，表明这种联系是可能被证明的。随后，让-皮埃尔·塞尔证明了除一个关键部分（即“ε-猜想”）以外的所有部分。1986年，肯·里贝特在塞尔的基础上，完整证明了这两个问题之间的密切联系（参见：里贝特定理与弗雷曲线）。\(^\text{[2]}\)这些由弗雷、塞尔和里贝特发表的论文表明：如果能证明谷山–志村猜想对至少半稳定椭圆曲线成立，那么费马大定理也将随之被证明。这个逻辑关系如下：任何能够反驳费马大定理的解，也可以被用来反驳谷山–志村猜想。因此，如果模性定理（谷山–志村猜想的证明）被确认无误，就意味着不会存在与费马大定理相矛盾的解，也就是说，费马大定理必定成立。

尽管这两个问题在当时都被视为极其艰难、几乎“完全无法触及”的数学难题，\(^\text{[2]}\) 但这是第一次明确提出了一条有可能将费马大定理推广至所有整数指数并完成证明的路径。与费马大定理不同的是，谷山–志村猜想当时正是一个活跃的研究领域，也被认为更有可能在当代数学框架中被攻克。\(^\text{[8]}\)然而，数学界普遍的看法却是：这项联系虽然美妙，但更凸显了谷山–志村猜想的难以证明性。[9] 数学家约翰·科茨的评论代表了当时的主流观点：\(^\text{[9]}\)

“我本人当时非常怀疑费马大定理与谷山–志村猜想之间的这种美妙联系能真正带来什么成果，因为说实话，我并不认为谷山–志村猜想是可以被证明的。尽管这个问题非常优美，但看起来根本不可能被真正证明。我必须承认，我当时认为自己这一生都不太可能看到它被证明。”

当听说里贝特已经证明了弗雷所提出的联系是正确的后，英国数学家安德鲁·怀尔斯决定尝试证明谷山–志村猜想，以此作为证明费马大定理的途径。怀尔斯从小就对费马大定理着迷，并在椭圆曲线及相关领域拥有扎实背景。从1987年起，怀尔斯秘密地独自研究该问题，历时六年。1993年，他成功地证明了谷山–志村猜想中足以推导出费马大定理的部分。怀尔斯的论文在篇幅和理论深度上都非常庞大。在论文同行评审过程中，人们在其中一部分发现了一个错误。为了修复这个缺陷，怀尔斯又花了一年时间，并与他的前学生理查德·泰勒合作，最终解决了这个问题。因此，最终于1995年发表的完整证明中，还附有一篇由两人共同完成的小型论文，用以证明修正部分的有效性。怀尔斯的成就得到了广泛报道，并通过多本书籍和电视节目向大众传播。谷山–志村–韦伊猜想其余尚未证明的部分，在1996至2001年间由其他数学家在怀尔斯工作的基础上陆续完成，最终全部得以证明，该猜想也因此被称为模性定理。\(^\text{[10][11][12]}\)怀尔斯因其对数学的杰出贡献获得了多项荣誉和奖项，其中包括2016年的阿贝尔奖。\(^\text{[13][14][15]}\)
\subsubsection{费马大定理的等价表述}
有几种不同的方式可以表述费马大定理，这些表述在数学上与原问题的陈述是等价的。

为了表述这些方式，我们使用以下符号：设\( \mathbf{N} \)为自然数集合\( 1, 2, 3, \dots \)，设\( \mathbf{Z} \)为整数集合\( 0, \pm 1, \pm 2, \dots \)，设\( \mathbf{Q} \)为有理数集合\(a/b\)，其中\( a \)和\( b \)是整数且\( b \neq 0 \)。接下来我们将称\( x^n + y^n = z^n \)的解，其中一个或多个\( x, y, z \)为零的解为平凡解。所有三个数都非零的解将称为非平凡解。

为了比较，我们从原始表述开始。

\begin{itemize}
\item \textbf{原始表述}：设 \( n, x, y, z \in N \)（意味着 \( n, x, y, z \) 都是正整数）且 \( n > 2 \)，方程 \( x^n + y^n = z^n \) 没有解。\\\\  
大多数关于该主题的处理方法都是这样表述的。它也通常在\( \mathbf{Z} \)上表述：\(^\text{[16]}\)
\item \textbf{等价表述 1}：方程 \( x^n + y^n = z^n \)，其中整数 \( n \geq 3 \)，没有非平凡解 \( x, y, z \in \mathbf{Z} \)。\\\\  
如果 \( n \) 是偶数，等价性是显而易见的。如果 \( n \) 是奇数且 \( x, y, z \) 都是负数，那么我们可以用 \( -x, -y, -z \) 替换 \( x, y, z \) 来得到\( \mathbf{N} \)中的解。如果其中两个是负数，那必须是 \( x \) 和 \( z \) 或 \( y \) 和 \( z \)。如果 \( x, z \) 是负数而 \( y \) 是正数，那么我们可以重新排列得到 \( (-z)^n + y^n = (-x)^n \)，从而得到\( \mathbf{N} \)中的解；另一个情况也可以类似处理。现在，如果只有一个是负数，它必须是 \( x \) 或 \( y \)。如果 \( x \) 是负数，且 \( y \) 和 \( z \) 是正数，那么可以重新排列得到 \( (-x)^n + z^n = y^n \)，再次得到\( \mathbf{N} \)中的解；如果 \( y \) 是负数，结果是对称的。因此，在所有情况下，\( \mathbf{Z} \)中的非平凡解也意味着 \( \mathbf{N} \)中存在解，这就是原问题的表述。
\item \textbf{等价表述 2}：方程 \( x^n + y^n = z^n \)，其中整数 \( n \geq 3 \)，没有非平凡解 \( x, y, z \in \mathbf{Q}) \)。\\\\ 
这是因为 \( x, y, z \) 的指数相等（为 \( n \)），因此如果在\( \mathbf{Q} \) 中有解，那么可以通过适当的最小公倍数进行乘法运算，将解转化为\( \mathbf{Z} \)中的解，从而得到\( \mathbf{N} \)中的解。
\item \textbf{等价表述 3}：方程 \( x^n + y^n = 1 \)，其中整数 \( n \geq 3 \)，没有非平凡解 \( x, y \in \mathbf{Q} \)。\\  
方程 \( x^n + y^n = z^n \) 的一个非平凡解 \( a, b, c \in \mathbf{Z} \) 会给出方程 \( v^n + w^n = 1 \) 的非平凡解 \( a/c, b/c \in \mathbf{Q}\)。反过来，方程 \( v^n + w^n = 1 \) 中的一个解 \( a/b, c/d \in \mathbf{Q}\) 会给出方程 \( x^n + y^n = z^n \) 的非平凡解 \( ad, cb, bd \)。\\\\
这个最后的表述尤其有益，因为它将问题从关于三维空间中的曲面的研究，转化为关于二维空间中曲线的研究。此外，它允许在域\( \mathbf{Q} \)上进行操作，而不是在环 \( \mathbf{Z} \)上进行操作；域比环具有更多的结构，这使得对其元素的分析更加深入。
\item \textbf{等价表述 4} – 与椭圆曲线的联系：如果 \( a, b, c \) 是方程 \( a^p + b^p = c^p \) 的非平凡解，其中 \( p \) 为奇素数，则方程 \( y^2 = x(x - ap)(x + bp) \)（Frey 曲线）将是一个没有模形式的椭圆曲线。\(^\text{[17]}\)\\\\  
通过利用 Ribet 定理检查这条椭圆曲线，可以发现它没有模形式。然而，Andrew Wiles 的证明表明，任何形如 \( y^2 = x(x - an)(x + bn) \) 的方程确实具有模形式。因此，任何 \( x^p + y^p = z^p \)（其中 \( p \) 为奇素数）的非平凡解将会产生矛盾，从而证明没有非平凡解存在。\(^\text{[18]}\)
\end{itemize}
换句话说，任何可能与费马大定理相矛盾的解，也可以用来与模形式定理相矛盾。因此，如果模形式定理被证明为真，那么也可以推导出费马大定理不存在矛盾。正如上文所述，这一等价表述的发现对费马大定理最终的解决至关重要，因为它提供了一种可以“一次性”对所有数字进行“攻克”的方法。
\subsection{数学史}  
\subsubsection{毕达哥拉斯和丢番图}  
\textbf{毕达哥拉斯三元组 } 

在古代，人们已经知道，边长比为 3:4:5 的三角形其一个角是直角。这在建筑和早期几何学中得到了应用。人们还知道，这是一个普遍规律的例子：任何三角形，如果两边的长度各自平方后相加（\( 3^2 + 4^2 = 9 + 16 = 25 \)），等于第三边的平方（\( 5^2 = 25 \)），那么这个三角形也是直角三角形。这就是现在所称的毕达哥拉斯定理，满足这一条件的三个数称为毕达哥拉斯三元组；这两者都以古希腊的毕达哥拉斯命名。例子包括 (3, 4, 5) 和 (5, 12, 13)。这样的三元组有无数个，\(^\text{[19]}\)生成这些三元组的方法在许多文化中都被研究过，从巴比伦人开始，\(^\text{[20]}\)然后是古希腊、中国和印度的数学家们。\(^\text{[1]}\)数学上，毕达哥拉斯三元组的定义是满足方程\( a^2 + b^2 = c^2 \)的三个整数\(^\text{[21]}\)\((a,b,c)\)。

\textbf{丢番图方程}  

费马方程\( x^n + y^n = z^n \)的正整数解是丢番图方程的一个例子，\(^\text{[22]}\) 该方程以公元3世纪的亚历山大数学家丢番图命名，他研究了这些方程并发展了求解某些类型丢番图方程的方法。典型的丢番图问题是找到两个整数\( x \)和\( y \)，使得它们的和以及它们的平方和分别等于给定的两个数\( A \)和\( B \)：
\[
A = x + y~
\]
\[
B = x^2 + y^2.~
\]
丢番图的主要著作是《算术》，其中只有一部分得以保存。\(^\text{[23]}\)费马关于最后定理的猜想灵感来源于阅读《算术》的新版本，\(^\text{[24]}\)该版本由Claude Bachet于1621年翻译成拉丁文并出版。\(^\text{[25][26]
}\)

丢番图方程已经研究了数千年。例如，二次丢番图方程 \( x^2 + y^2 = z^2 \) 的解由毕达哥拉斯三元组给出，最早由巴比伦人（约公元前1800年）解决。\(^\text{[27]}\)线性丢番图方程的解，例如 \( 26x + 65y = 13 \)，可以使用欧几里得算法（约公元前5世纪）求得。\(^\text{[28]}\)从代数的角度来看，许多丢番图方程的形式与费马最后定理的方程相似，因为它们没有交叉项混合两个字母，但没有共享它的特定性质。例如，已知存在无数个正整数 \( x, y, z \)，使得 \( x^n + y^n = z^m \)，其中 \( n \) 和 \( m \) 是互质的自然数。\(^\text{[注2]}\)
\subsubsection{费马的猜想}
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/ea2ec1c6d24ec545.png}
\caption{《算术》1621年版中的问题II.8。右侧是费马所谓的“最后定理”证明的边注，因边缘过小而无法容纳该证明。} \label{fig_FMDL_1}
\end{figure}
《算术》中的问题 II.8 问的是如何将一个给定的平方数分解为两个其他的平方数；换句话说，给定一个有理数\( k \)，找到有理数\( u \)和\( v \)，使得 \( k^2 = u^2 + v^2 \)。丢番图展示了如何解决这个平方和问题，当\( k = 4 \)时，解为\( u = \frac{16}{5} \)和 \( v = \frac{12}{5} \)。\(^\text{[29]}\)

大约在1637年，费马在他那本《算术》副本的边缘写下了他的最后定理，紧接着丢番图的平方和问题旁边：\(^\text{[30][31][32]}\)

"Cubum autem in duos cubos, aut quadratoquadratum in duos quadratoquadratos & generaliter nullam in infinitum ultra quadratum potestatem in duos eiusdem nominis fas est dividere cuius rei demonstrationem mirabilem sane detexi. Hanc marginis exiguitas non caperet."

“将一个立方数分解为两个立方数，或者一个四次方分解为两个四次方，或者一般来说，将任何大于二次方的幂分解为两个相同幂次的数，这是不可能的。我已经发现了一个真正奇妙的证明，但这个边缘太窄，无法容纳它。”\(^\text{[33][34]}\)

费马去世后（1665年），他的儿子克莱芒-塞缪尔·费马出版了这本书的新版本（1670年），并增加了他父亲的评论。\(^\text{v}\)虽然当时这并不是真正的定理（即没有证明的数学陈述），但这个边注随着时间的推移被称为费马的最后定理，\(^\text{[30]}\)因为它是费马提出的最后一个未被证明的定理。\(^\text{[36][37]}\)

目前尚不清楚费马是否确实为所有指数\( n \)找到了有效的证明，但似乎不太可能。仅有一份与此相关的证明流传下来，即\( n = 4 \)的情况，正如在 § 特定指数的证明 部分所描述的。

虽然费马将\( n = 4 \)和\( n = 3 \)的情况作为挑战题目给他的数学通信者们，如马林·梅尔森、布莱兹·帕斯卡和约翰·沃利斯，\(^\text{[38]}\)他从未提出过一般情况。\(^\text{[39]}\)此外，在他生命的最后三十年里，费马再也没有写过关于他“真正奇妙的证明”的任何内容，也从未将其发表。范·德·波尔滕\(^\text{[39]}\)建议，尽管缺乏证明并不重要，但缺乏挑战意味着费马意识到自己没有证明；他引用了魏尔\(^\text{[40]}\)的话，认为费马可能曾一时自欺，产生了一个无法挽回的错误想法。费马可能在这种“奇妙证明”中使用的技巧至今未知。

怀尔斯和泰勒的证明依赖于20世纪的技术。\(^\text{[41]}\)与此相比，费马的证明必须是初等的，因为那时的数学知识有限。

虽然哈维·弗里德曼的宏大猜想暗示，任何可证明的定理（包括费马最后定理）都可以仅使用“初等函数算术”来证明，但这样的证明在技术上可能被称为“初等的”，并且可能涉及数百万个步骤，因此远远超出费马所能提供的证明长度。
\subsubsection{特定指数的证明}
