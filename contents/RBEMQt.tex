% 刚体运动方程（四元数）
% keys 刚体|转动|运动方程|四元数
% license Xiao
% type Tutor

\begin{issues}
\issueAbstract
\end{issues}

\pentry{刚体的运动方程\nref{nod_RBEqM}， 四元数与旋转矩阵\nref{nod_QuatN}}{nod_c6df}

\subsubsection{实验室坐标系的运动方程}
我们用四元数 $q$ 和角速度 $\bvec \omega$ （共 7 个标量）来表示刚体绕固定点旋转的运动状态。 下面来列运动方程（7 元一阶微分方程组）。

\autoref{eq_QuatN_1}  中已经给出了 4 条（$q$ 关于时间的导数）
\begin{equation}
\dot{q} = \frac12 \omega q~,
\end{equation}

而之前的\autoref{eq_RBEqM_6}  给出了另外 3 条（$\bvec\omega$ 关于时间的导数）。 注意现在我们可以用四元数 $q$ 表示 $\mat R$ （\autoref{eq_QuatN_2}）。
\begin{equation}
\begin{aligned}
\dot{\bvec \omega} &= \mat R \mat I_0^{-1} \mat R\Tr \qty[\bvec \tau  - \bvec\omega\cross(\mat R \mat I_0 \mat R\Tr \bvec\omega)]\\
&= q \mat I_0^{-1} q^{-1} \qty[\bvec \tau  - \bvec\omega\cross(q \mat I_0 q^{-1}\bvec\omega)]~.
\end{aligned}
\end{equation}
其中 $\mat I_0$ 是体坐标系中的惯性张量， $\mat R$ 是体坐标系到实验室坐标系的旋转矩阵， $\bvec\tau$ 是力矩（已知）。 这样就得到了所有的运动方程。

用数值计算来解这个方程组见 “\enref{刚体转动数值模拟}{RBRNum}”。

\subsection{体坐标系的运动方程}
\addTODO{说明}
由于 $\bvec\omega = q\bvec\omega_0 q$，
\begin{equation}
\dv{q}{t} = \frac12 q \bvec \omega_0~,
\end{equation}
以及欧拉方程（\autoref{eq_RBEqM_9}  \autoref{eq_RBEqM_16}）。
