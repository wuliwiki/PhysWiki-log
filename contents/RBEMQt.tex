% 刚体运动方程（四元数）
% 刚体|转动|运动方程|四元数

\begin{issues}
\issueAbstract
\end{issues}

\pentry{刚体的运动方程\upref{RBEqM}， 四元数与旋转矩阵\upref{QuatN}}

我们用四元数 $\bvec q$ 和角速度 $\bvec \omega$ （共 7 个标量）来表示刚体绕固定点旋转的运动状态． 下面来列运动方程（7 元一阶微分方程组）．

\autoref{QuatN_eq1}~\upref{QuatN} 中已经给出了 4 条（$\bvec q$ 关于时间的导数）
\begin{equation}
\dv{\bvec q}{t} = \frac12 (0, \bvec \omega) \bvec q
\end{equation}

而之前的\autoref{RBEqM_eq6}~\upref{RBEqM} 给出了另外 3 条（$\bvec\omega$ 关于时间的导数）
\begin{equation}
\dv{\bvec \omega}{t} = \mat R \mat I_0^{-1} \mat R\Tr \qty[\bvec \tau  - \bvec\omega\cross(\mat R \mat I_0 \mat R\Tr \bvec\omega)]
\end{equation}
其中 $\mat I_0$ 是体坐标系中的惯性张量， $\mat R$ 是体坐标系到实验室坐标系的旋转矩阵， $\bvec\tau$ 是力矩（已知）． 注意现在我们可以用四元数 $\bvec q$ 表示 $\mat R$ （\autoref{QuatN_eq2}~\upref{QuatN}）． 这样就得到了所有的运动方程．

用数值计算来解这个方程见 “刚体转动数值模拟\upref{RBRNum}”．
