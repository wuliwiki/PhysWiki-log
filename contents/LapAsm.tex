% 拉普拉斯方法
% license Xiao
% type Tutor

\pentry{极值\upref{DerMax}， 积分换元\upref{IntCV}， 高斯积分\upref{GsInt}， 渐近展开\upref{Asympt}，  Gamma函数\upref{Gamma}}

在分析数学中，拉普拉斯渐近方法是一种计算含参数积分的渐近展开式的办法。 所考察的积分一般具有如下形式：
\begin{equation}\label{eq_LapAsm_1}
L(s)=\int_a^b\E^{-s\Phi(x)}\psi(x)\,\dd x~,
\end{equation}
其中 $s$ 是正的实参数，考察当 $s\to+\infty$ 时积分的变化趋势。 拉普拉斯方法背后的想法很简单： 如果函数 $\Phi$ 在某点处达到极小值， 那么当 $s$ 充分大时， 只有极小值点附近的贡献才比较可观， 其余部分相比起来都要小得多。

\subsection{Watson 引理}
拉普拉斯方法基于 Watson 引理。 它本身也是很有用的。

\begin{lemma}{Watson 引理}

设函数 $\phi:X\to Y$ 在 $\mathbb{R}^+$ 上连续，序列 $\left\{\lambda_n\right\}_0^\infty\left(\lambda_n>0\right)$ 单调递增，且存在 $\delta$ 右邻域 $B_{+}(0,\delta)\;(0<\delta<\pi/2)$，使得
\begin{equation}\label{eq_LapAsm_2}
  \phi\left(t\right)\sim\sum_{n=0}^{\infty}{c_nt^{\lambda_n-1}}\quad t\to0~.
\end{equation}

若有常数 $c,m>0$，满足 $\phi\left(t\right) \le me^{ct},t\to+\infty$，则当 $s\to+\infty,z\in{\left\{z:\left|\arg{z}\right|\le\pi/2-\delta\right\}}$ 时，有
\begin{equation}\label{eq_LapAsm_3}
\int_{\mathbb{R}^+}\E^{-zt}\phi(t)\dd t\sim\sum_{n=0}^{\infty}{c_n}\frac{\Gamma(\lambda_n)}{z^{\lambda_n}}  ~.
\end{equation}
\end{lemma}

证：
由Laplace的理论可知， 
\[
F\left(z\right)=\int_{\mathbb{R}^+}{\E^{-zt}\phi\left(t\right)}\,\dd t~.
\]
若函数 $\phi$ 满足定理中提到的三个条件，则 $F(z)$ 变换对于 $\operatorname{Re} z>c$ 是存在的。即：当 $\operatorname{Re} z>c$ 时，积分收敛。注意 \autoref{eq_LapAsm_2} 意味着存在正整数 $N$，当 $n>N$ 时，对一切的 $t\in B_{+}(0,\delta)$，总有
\[
  \left|\phi\left(t\right)-\sum_{n=0}^{N-1}{c_nt^{\lambda_n-1}}\right|\le Mt^{\lambda_N-1}~,
\]
其中 $M>0$ 且为常数。同时 \autoref{eq_LapAsm_3} 表明当时，存在正整数 $N$，当 $n>N$ 时，对一切的 $t$，总有
\[
  \left|\phi\left(t\right)-\sum_{n=0}^{N-1}{c_nt^{\lambda_n-1}}\right|\le K\E^{ct}t^{\lambda_N-1}~,
\]
其中 $K>0$ 且为常数。于是就有
\begin{align*}
  \left|\int_{\mathbb{R}^+}{\E^{-zt}\phi\left(t\right)}\,\dd t-\sum_{n=0}^{N-1}{c_n\int_   {\mathbb{R}^+}{\E^{-zt}t^{\lambda_n-1}}\,\dd t}\right|\\
  \le K\int_{\mathbb{R}^+}\E^{[-\operatorname{Re}z-c]t}t^{\lambda_N-1}\,\dd t~.
\end{align*}
注意到当 $\operatorname{Re}z>0$ 时
\[
  \int_{\mathbb{R}^+}{\E^{-zt}t^{\lambda_n-1}}\,\dd t
  =\frac{1}{z^{\lambda_n}}\int_{\mathbb{R}^+}{\E^{-u}u^{\lambda_n-1}}\,\dd u
  =\frac{\Gamma\left(\lambda_n\right)}{z^{\lambda_n}}~,
\]
因此
\begin{align*}
  \left|F(z)-\sum_{n=0}^{N-1}{c_n\frac{\Gamma\left(\lambda_n\right)}{z^{\lambda_n}}}\right|
  &\le K {\Gamma(\lambda_{N})\over \operatorname{[Re}z-c]^{\lambda_N}}\nonumber\\
  &=K{\Gamma(\lambda_{N})\over |z|^{\lambda_N}}\left(|z|\over \operatorname{Re}z-c\right)^{\lambda_N}\nonumber~.
\end{align*}
由于 $z\in{\left\{z:\left|\arg{z}\right|\le\pi/2-\delta\right\}}$，于是 $\operatorname{Re}z\geq |z|\sin \delta$。这表明当 $\left|z\right|$ 足够大时，$\operatorname{Re}z-c\geqslant1/2|z|\sin \delta$。因此
\[
F\left(z\right)-\sum_{n=0}^{N-1}{c_n\frac{\Gamma\left(\lambda_n\right)}{z^{\lambda_n}}}=O\left(z^{-\lambda_N}\right)~,
\]
这就证明了Watson's 引理。

\subsection{拉普拉斯方法}
拉普拉斯方法是将 Watson 引理用于\autoref{eq_LapAsm_1} 得到的。 作出如下假设：

\begin{enumerate}
  \item 函数 $\Phi,\psi:X\to Y$ 都是光滑函数。
  \item 函数 $\Phi(x)$ 在积分区间 $I=[a,b]$ 内部仅有一个严格的极小值点 $x_0\in(a,b)$，同时 $\Phi''(x_0)>0$， 且 $x_0$ 是整个区间上的最小值点。

  \item \autoref{eq_LapAsm_1} 对于 $s=s_0$ 绝对收敛。
\end{enumerate}

\begin{figure}[ht]
  \centering
  \includegraphics[width=12cm]{./figures/b982996542fb11a4.pdf}
  \caption{函数 $\Phi(x)$ 示意图} \label{fig_LapAsm_1}
\end{figure}

于是 $\Phi'(x_0)=0$。 由泰勒公式可知， 存在正数 $\delta>0$ ，使得对于任意的 $x\in B(x_0,\delta)~,$  
\[
  \Phi(x)=\Phi(x_0)+\frac{1}{2}\Phi''(x_0)(x-x_0)^2+\varphi(x)(x-x_0)^3~,
\]

其中存在正数 $M>0$，使得函数 $|\varphi|\leq M$ 。 当 $s$ 充分大时， 邻域 $B(x_0,\delta)$ 以外的积分的贡献比 $s$ 的任何负幂次衰减得都快：根据假定 2，当 $x\in I\setminus B(x_0,\delta)$ 时， 存在正数 $\varepsilon_0>0$ 使得 $\Phi(x)>\Phi(x_0)+\varepsilon_0$， 从而邻域 $B(x_0,\delta)$ 之外的积分估计为
\begin{align*}
    \left|\int\limits_{I\setminus B(x_0,\delta)}\psi(x)\E^{-s\Phi(x)}\,\dd x\right|
    &\leq \E^{-\epsilon_0(s-s_0)}\int_I|\psi(x)|\E^{-s_0\Phi(x)}\,\dd x\nonumber\\
    &\leq \E^{-s_0\Phi(x_0)-\varepsilon_0s}\int_{I}|\psi(x)|\,\dd x\nonumber~.
\end{align*}
而在邻域 $B(x_0,\delta)$ 内， 可作如下换元： $y^2=\Phi(x)-\Phi(x_0)$， 即
\[
  y=\sqrt{\frac{\Phi''(x_0)}{2}}(x-x_0)\left(1+\frac{2}{\Phi''(x_0)}(x-x_0)\varphi(x)\right)^{1/2}~.
\]
令 $\alpha<\beta$ 分别等于 $\pm\sqrt{\Phi(x_0\pm\delta)-\Phi(x_0)}$， 又设当 $y\to0$ 时，函数 $\tilde{\psi}$ 有泰勒展开
\begin{equation}\label{eq_LapAsm_4}
  \tilde{\psi}(y):=\psi(x(y))\frac{\dd}{\dd x}[x(y)]\sim c_0+c_1y+\cdots \quad ~
  \end{equation}
  （这里是进行了拉格朗日反演，显然有 $c_0=\psi(x_0)\sqrt{2/\Phi''(x_0)}$）， 则当 $s\to+\infty$
  $$
  \begin{aligned}
  \int_{B(x_0,\delta)}\psi(x)\E^{-s\Phi(x)}\,\dd x
  &=\E^{-s\Phi(x_0)}\int_{\alpha}^{\beta}\tilde \psi(y)\E^{-sy^2}\,\dd y\\
  &\sim\E^{-s\Phi(x_0)}\int_{0}^{\varepsilon_0}[\tilde \psi(y)+\tilde \psi(-y)]\E^{-sy^2}\,\dd y~.
\end{aligned}
$$
应用 Watson 引理， 最后终于得到\autoref{eq_LapAsm_1} 当 $s\to+\infty$ 时的渐近展开：
\begin{equation}\label{eq_LapAsm_5}
  L(s)\sim \E^{-s\Phi(x_0)}\sum_{n=0}^\infty c_{2n}\Gamma\left(n+\frac{1}{2}\right)s^{-n-1/2}~,
\end{equation}
其中 $c_n$ 由\autoref{eq_LapAsm_4} 给出。 特别地， 由于 $\Gamma(1/2)=\sqrt{\pi}$， \autoref{eq_LapAsm_1} 渐近公式的首项是
\[
  L(s)=\E^{-s\Phi(x_0)}\left(As^{-1/2}+O(s^{-1/2})\right)~\quad (s\to+\infty)~,
\]
其中
\[
  A=\sqrt{2\pi}\frac{\psi(x_0)}{(\Phi''(x_0))^{1/2}}~.
\]

\subsection{斯特林公式}
拉普拉斯方法最基本的应用就是导出 $\Gamma$ 函数的\textbf{斯特林公式（Stirling formula）}。 按照定义，
\[
  \Gamma(s+1)
  =\int_0^\infty x^s\E^{-x}\,\dd x
  =e^{(s+1)\log s}\int_0^\infty \E^{-s(x-\log x)}\,\dd x~.
\]
最后一步换元 $x\mapsto sx$。 最后这个积分刚好符合上一小节所要求的三条假设：这里 $\psi(x)\equiv1$，$\Phi(x)=x-\log x$。于是 $x=1$ 是 $\Phi(x)$ 唯一的极小值点，同时也是唯一的最小值点。代入\autoref{eq_LapAsm_5}， 就得到渐近公式
\[
  \Gamma(s+1)\sim\sqrt{2\pi s}\left(\frac{s}{\E}\right)^s\quad (s\to+\infty)~.
\]
\autoref{eq_LapAsm_5} 还给出了更精细的渐近级数：
\[
  \Gamma(s+1)
  =\sqrt{2\pi s}\left({s\over \E}\right)^s
  \left(
   1+{1\over12s}+{1\over288 s^2}+ \cdots
  \right)\quad (s\to+\infty)~,
\]
毫无疑问这是一个可以对大的 $n$ 来近似计算 $n!$ 的公式。
