% 电多极展开（球坐标）
% keys 偶极子|多极子|球谐函数|电势
% license Xiao
% type Tutor

\pentry{球谐函数\upref{SphHar}， 电偶极子\upref{eleDpl}}{nod_f626}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Multipole_expansion}{相关页面}， 以及 \cite{Jackson}。}若空间中的一个球内（$r < a$） 存在静止的电荷分布 $\rho(\bvec r)$， 那么球外的电势 $V(\bvec r)$（$r > a$）可以展开为径向函数和球谐函数之积的形式
\begin{equation}\label{eq_EMulPo_2}
V(\bvec r) = \frac{1}{4\pi\epsilon_0}\sum_{l = 0}^\infty \frac{1}{r^{l+1}}\sum_{m = -l}^l C_{l,m} Y_{l,m}(\uvec r) \qquad (r \geqslant a)~.
\end{equation}
其中常数 $C_{l,m}$ 为（证明见下文）
\begin{equation}
C_{l,m} = \frac{4\pi}{2l+1} \int_{r\leqslant a} r^l \rho(\bvec r) Y_{l,m}^*(\uvec r) \dd[3]{r}~.
\end{equation}
当电荷分布关于极轴对称时， 求和中只需要 $m=0$ 的项，也就是说只有 $C_{l,0}$ 不为零，且为实数。 此时式中 $l = 0$ 的项就是\textbf{电单极子（electric monopole）} 具有球对称的电荷分布和势能分布， $l = 1$ 的项就是\textbf{电偶极子（dipole）}\upref{eleDP2}（$\propto\cos \theta$）， $l = 2$ 的项是\textbf{电四极子（quadrupole）}……  $l = N$ 的项叫做电 $2^N$ 极子。

当电荷分布不关于极轴对称时， 由于势能函数是一个实数， 有（\autoref{eq_SphHar_13}~\upref{SphHar}）
\begin{equation}
C_{l,m} = (-1)^m C_{l,-m}^*~.
\end{equation}
这其实相当于使用实球谐函数\upref{RYlm}作为基底。
\addTODO{什么样的分布满足只有某个 $l$ 不为零？}

为什么这么叫呢？ 因为电 $2^N$ 极子产生的势能项可以用 $2^{N-1}$ 个电荷为 $q$ 的点电荷以及 $2^{N-1}$ 个电荷为 $-q$ 的点电荷按照一定空间位置摆放后， 取 $r \to \infty$ 得到。 用数学归纳法的思想， 我们可以认为若电 $2^{N-1}$ 极子是一个点， 渐进势能为 $\sim 1/r^N$， 那么把两个电荷相反的 $2^{N-1}$ 极子放在一根短棍的两端组成电 $2^N$ 极子， 那么渐进势能就必须是更高阶无穷小， 即 $\sim 1/r^{N+1}$。

电多极展开的优势在于只需要预先算出系数 $C_{l,m}$ 就可以无需积分得到球外任意位置的电势分布。 而如果用常规的方法， 则计算每个位置的电势都需要重新做一次积分（\autoref{eq_EMulPo_5}）。 而它的缺点在于实际计算中必须取\autoref{eq_EMulPo_2} 中的有限项， 会产生截断误差。 另一点是无法计算球内的电势分布。

\subsubsection{对比直角坐标电偶极子}
令 $l=0$， 对比\autoref{eq_eleDP2_2}~\upref{eleDP2} 可得（参考\autoref{eq_SphHar_4}~\upref{SphHar}）
\begin{align}\label{eq_EMulPo_6} % 已小心推导若干次
p_z &= \int\rho(\bvec r)z\dd[3]{r} = \frac12\sqrt{\frac{3}{\pi}} C_{1,0}~,\\
p_x &= \int\rho(\bvec r)x\dd[3]{r} = \sqrt{\frac{3}{2\pi}} \frac{C_{1,-1}-C_{1,1}}{2} = -\sqrt{\frac{3}{2\pi}} \Re[C_{1,1}]~,\\
p_y &= \int\rho(\bvec r)y\dd[3]{r} = \sqrt{\frac{3}{2\pi}} \frac{C_{1,-1}+C_{1,1}}{2\I} = \sqrt{\frac{3}{2\pi}} \Im[C_{1,1}]~.
\end{align}
\addTODO{高阶项如何对应到直角坐标版本？}
\begin{equation}
V(\bvec r) = \frac{1}{4\pi\epsilon_0} \qty[\frac{Q}{R} - (\bvec{p} \vdot \Nabla)\frac{1}{R} + \frac{1}{2}\qty(\sum_{i,j} D_{ij}\pdv{}{x_i}{x_j})\frac{1}{R} + \dots]~.
\end{equation}
\begin{equation}
D_{ij}= \int x_i x_j \rho(\bvec r) \dd[3]{r}~.
\end{equation}
这是一个实对称矩阵。

\begin{equation}
\pdv{x_i}\frac{1}{r} = -\frac{x_i/r}{r^2}~.
\end{equation}
\begin{equation}
\pdv{}{x_i}{x_j}\frac{1}{r} = \frac{3x_ix_j/r^2 - \delta_{ij}}{r^3}~.
\end{equation}
（提示： $\pdv{x_i}\frac{1}{r^3} = -\frac{3x_i}{r^5}$）

根据 \href{https://en.wikipedia.org/wiki/Table_of_spherical_harmonics}{Wikipedia} 的球鞋函数表，可以把 $l=2$ 的球谐函数对应到 $x_ix_j$。 所以对 $l=2$， 球谐函数的多级展开和直角坐标版本也可以一一对应（但貌似只能凑出 $3x_i^2-r^2$）。

\subsection{电场}
对\autoref{eq_EMulPo_2} 求负梯度即可得到球外的电场分布
\begin{equation}
\bvec E(\bvec r) = -\grad V(\bvec r)~.
\end{equation}
使用球坐标中的梯度算符（\autoref{eq_SphNab_1}~\upref{SphNab}）
\begin{equation}
\grad V = \pdv{V}{r}\uvec r + \frac{1}{r} \pdv{V}{\theta}\uvec \theta  + \frac{1}{r\sin \theta }\pdv{V}{\phi}\uvec \phi~.
\end{equation}
\addTODO{引用勒让德多项式求导性质}

\subsubsection{内展开}
相反， 若电荷分布 $\rho(\bvec r)$ 只存在于 $r \geqslant a$ 的球外空间， 那么可以把球内部任意点的电势 $V(\bvec r)$ 展开为
\begin{equation}\label{eq_EMulPo_4}
V(\bvec r) = \sum_{l = 0}^\infty r^l \sum_{m = -l}^l D_{l,m} Y_{l,m}(\uvec r)~, \qquad (r \leqslant a)~.
\end{equation}
其中（证明见下文）
\begin{equation}\label{eq_EMulPo_3}
D_{l,m} = \frac{1}{(2l+1)\epsilon_0} \int_{r\geqslant a} \frac{1}{r^{l+1}} \rho(\bvec r) Y_{l,m}^*(\uvec r) \dd[3]{r}~.
\end{equation}

\subsubsection{一般展开}
要求任意给定点 $\bvec r$ 的电势， 可取过该点的球面 $a = r$， 并把\autoref{eq_EMulPo_2} 和\autoref{eq_EMulPo_4} 合并就可以得到 $r$ 取任意值的展开
\begin{equation}
V(\bvec r) = \sum_{l = 0}^\infty\sum_{m = -l}^l \qty[\frac{1}{r^{l+1}} C_{l,m}(r) + r^l D_{l,m}(r)] Y_{l,m}(\uvec r)~.
\end{equation}
但这计算起来比较麻烦， 因为现在 $C_{l,m}, D_{l,m}$ 成了 $r$ 的函数， 对每个在 $\rho(r)\ne 0$ 范围的 $r$ 都需要计算一次积分， 当 $r$ 大于 $\rho(r)$ 的最大半径（如果存在）， $C_{l,m}$ 重新变为常数， $D_{l,m}= 0$， 就回到\autoref{eq_EMulPo_2}。 当 $r$ 小于 $\rho(r)$ 的最小半径（如果不为零）， $D_{l,m}$ 重新变为常数， $C_{l,m} = 0$， 就回到\autoref{eq_EMulPo_4}。

\subsection{证明}
\pentry{库仑势能的球谐展开\upref{PChYlm}}{nod_bdb0}
首先我们给出单个点电荷势能的球谐展开公式\upref{PChYlm}
\begin{equation}\label{eq_EMulPo_1}
\frac{1}{\abs{\bvec r - \bvec r'}} = 4\pi \sum_{l=0}^{\infty} \frac{1}{2l+1} \frac{r_<^l}{r_>^{l+1}} \sum_{m = -l}^l Y_{l,m}^*(\uvec r') Y_{l,m}(\uvec r)~.
\end{equation}
其中 $r_< = \min\qty{r, r'}$， $r_> = \max\qty{r, r'}$。 另外连续电荷分布的库仑势能公式为（\autoref{eq_QEng_14}~\upref{QEng}）
\begin{equation}\label{eq_EMulPo_5}
V(\bvec r) = \frac{1}{4\pi\epsilon_0}\int \frac{\rho(\bvec r')}{\abs{\bvec r - \bvec r'}} \dd[3]{r'}~.
\end{equation}

若我们要求电荷必须在球内（$r' \leqslant a$）而 $V(\bvec r)$ 中的 $\bvec r$ 必须在球外（$r \geqslant a$）， 那么始终有 $r_> = r, r_< = r'$， 代入\autoref{eq_EMulPo_1} 再代入\autoref{eq_EMulPo_5} 可得\autoref{eq_EMulPo_2}。

反之， 若电荷分布 $r' \geqslant a$， 场点 $r \leqslant a$， 那么始终有 $r_> = r', r_< = r$。 代入\autoref{eq_EMulPo_1} 再代入\autoref{eq_EMulPo_5} 得\autoref{eq_EMulPo_4}。
