% 球谐展开中径向函数的归一化
% keys 球谐波|球面波|归一化|球贝塞尔函数
% license Xiao
% type Tutor

\pentry{球贝塞尔函数\upref{SphBsl}， 平面波的的正交归一化\upref{EngNor}}

若一组径向函数基底 $u_{l,m}(k, r)$ 满足归一化条件
\begin{equation}
\int_0^\infty u^*_{l,m}(k',r) u_{l,m}(k, r) \dd{r} = \delta(k - k')~,
\end{equation}
则球坐标中一组完备正交归一的函数基底为
\begin{equation}\label{eq_FrNorm_1}
\ket{s_{l,m}(k)} = \frac{1}{r} u_{l,m}(k, r) Y_{l,m}(\uvec r)~,
\end{equation}
满足正交归一条件
\begin{equation}\ali{
&\quad \braket{s_{l,m}(k)}{s_{l',m'}(k')}\\
&= \int_0^\infty \frac{1}{r} u_{l,m}^*(k, r)  \frac{1}{r} u_{l',m'}(k', r)  r^2 \dd{r} \int Y_{l,m}^*(\uvec r) Y_{l',m'}(\uvec r) \dd{\Omega}\\
&= \delta_{l,l'}\delta_{m,m'}\delta(k-k')~.
}\end{equation}

\subsection{推导}
空间中任意复函数可以用\autoref{eq_FrNorm_1} 中的基底展开为
\begin{equation}\ali{
f(\bvec r) &= \sum_{l,m} \int_0^\infty c_{l,m}(k) \ket{s_{l,m}(k)} \dd{k}\\
&= \frac{1}{r}\sum_{l,m} \qty(\int_0^\infty c_{l,m}(k) u_{l,m}(k, r) \dd{k}) Y_{l,m}(\uvec r)~.
}\end{equation}
函数在任意基底上的投影为
\begin{equation}\ali{
\braket{s_{l,m}(k)}{f(\bvec r)} &= \sum_{l',m'} \int_0^\infty \dd{k'} c_{l',m'}(k') \braket{s_{l,m}(k)}{s_{l',m'}(k')}\\
& = \sum_{l',m'} \int_0^\infty \dd{k'} c_{l',m'}(k') \delta_{l,l'}\delta_{m,m'}\delta(k-k')\\
& = c_{l,m}(k)~.
}\end{equation}
令 $\ket{f}$ 的分波展开形式为
\begin{equation}
f(\bvec r) = 
\frac{1}{r}\sum_{l,m} g_{l,m}(r) Y_{l,m}(\uvec r)~.
\end{equation}
则 $g_{l,m}(r)$ 和 $c_{l,m}(k)$ 有类似傅里叶变换的关系
\begin{equation}
g_{l,m}(r) = \int_0^\infty c_{l,m}(k) u_{l,m}(k, r) \dd{k}~,
\end{equation}
\begin{equation}
c_{l,m}(k) = \int_0^\infty u_{l,m}^*(k, r) g_{l,m}(r) \dd{r}~.
\end{equation}

\begin{example}{归一化的球贝塞尔函数}
由于 $\E^{\I kx}$ 从负无穷到正无穷的归一化积分为 $2\pi\delta(k-k')$， 易得 $\sin(kx)$ 的积分为 $\pi\delta(k-k')$ （先表示成指数形式）， 从 0 到正无穷的积分为 $\pi\delta(k-k')/2$。

注意归一化只需要渐进表达式即可（因为局部的不同相对于无穷积分来说可以忽略）。 球贝塞尔函数的渐进形式为 $j_l(kr) \to \sin(kr - l\pi/2)/(kr)$， 所以 $kr j_l(kr)$ 从 0 到正无穷的归一化积分同样是 $\pi\delta(k-k')/2$。 所以归一化的球贝塞尔函数为
\begin{equation}
u_{l,m}(k, r) = \sqrt{\frac{2}{\pi}} kr j_l(kr)~,
\end{equation}
渐进形式为
\begin{equation}
u_{l,m}(k, r) \to  \sqrt{\frac{2}{\pi}} \sin(kr - l\pi/2)~.
\end{equation}
\end{example}
