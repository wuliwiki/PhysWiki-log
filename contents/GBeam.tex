% 高斯光束 3
% keys 光学|激光
% license Usr
% type Art

\begin{issues}
\issueDraft
\end{issues}

你可能在很多地方都听说过高斯光束，例如在光学课上，或者激光器的说明书里，但它们不会完整介绍高斯光束，因为这是高等光学的内容，即使高斯光束的应用非常普遍。本文将介绍高斯光束最重要的特性，也就是经过透镜等光学器件后，光斑的空间分布维持不变的这一特性，涉及近轴近似和惠更斯定理。%本文的主要参考是Svelto、Orazio等人的著作《Principles of Lasers》，以及汪凯戈的著作《高等物理光学》。

\subsubsection{前言}
光斑当然是应该有空间分布的。一开始学习的平面波的表达式是$\bvec E(x,y,z,t)=\bvec {E_0}\E^{-\I\omega t}$，你可能觉得$\bvec E_0$可能是个常数，这显然是错误的，因为根据隔壁词条\enref{电场的能量}{EEng}，单位空间内平面波的能量是$u=\frac{1}{2}\epsilon_0 \bvec E_0^{\;2}$，这是个常数，那么对$u$全空间积分之后，就能得知该平面波携带了无穷大的能量，这显然是不合理的。那么$\bvec E_0$会不会只局限在某个局域呢？比如光斑只在一个圆形的截面里，就像我们日常看到的那样？这也是不行的，因为光会衍射，如果某个截面的光是局域的，那么就相当于在光路上放一个小孔，光就会在孔后形成衍射图样，当然，衍射图样是全空间的。这说明真实情况下光一定会有一个全空间分布。

\subsection{近轴近似和ABCD矩阵}
在谈论高斯光束之前需要先谈到一般情况下光线如何在光学器件上传播。为简单起见，这里只涉及几何光学的内容，也就是先忽略光斑的空间分布，把光看成是一条光线。如\autoref{fig_GBeam_1} 是一个任意的光学器件，例如是凸透镜，玻璃片或者什么都没有。
\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/d7d39c0c7c232184.png}
\caption{光学器件的定义。光线在$z_1$平面以$\bvec r_1$角度入射，在$z_2$平面以$\bvec r_2$角度出射。} \label{fig_GBeam_1}
\end{figure}
我们定义了几个参数以表示这些光学器件对光线的作用，也就是图中的$r_1,\theta_1$和$r_2,\theta_2$（这里的$r$是图中的那个标量。注意，我们需要标记一下标量的符号，图中$r_1$和$r_2$是正的，图中注明了$r$轴；角度以旋转顺逆时针为准，所以图中$\theta_1$是正的，$\theta_2$则是负的）。

我们认为$r_2,\theta_2$和$r_1,\theta_1$是有线性关系的，也就是有：

\begin{equation}
\begin{cases}
r_2=Ar_1+B\theta_1\\
\theta_2=Cr_1+D\theta_1~
\end{cases},
\quad\text{即：}\quad\pmat{r_2\\ \theta_2}=\pmat{A&B\\C&D}\pmat{r_1\\ \theta_1}~.
\end{equation}
这里就出现了所谓的ABCD矩阵（这命名有点随意）。对于特定的光学器件，A、B、C、D都是常数。为什么会有这样的关系？这需要用到近轴近似，或者说，\enref{小角极限}{LimArc}。我们举例解释。
\begin{example}{}\label{ABCD_Sample_1}
\begin{figure}[ht]
\centering
\includegraphics[width=11cm]{./figures/f9fab19a959a860f.png}
\caption{举例，一块“玻璃”} \label{fig_GBeam_2}
\end{figure}
这是一块折射率$n$的介质，长度为$L$，那么就应当有：
\begin{equation}
r_2=r_1+L\cdot\tan\varphi\approx r_1+L\varphi\approx r_1+\frac{L}{n}\theta_1,\quad\theta_2=\theta_1~.
\end{equation}
所以该光学器件的ABCD矩阵就是：
\begin{equation}
\pmat{1&L/n\\0&1}~.
\end{equation}
\end{example}

\begin{example}{}\label{ABCD_Sample_2}
\begin{figure}[ht]
\centering
\includegraphics[width=11cm]{./figures/a63b61aceb8114af.png}
\caption{举例，一块理想薄透镜} \label{fig_GBeam_3}
\end{figure}
这是一块焦距为$f$的薄透镜。它很薄，所以有$r_2=r_1$，同时，根据隔壁词条\enref{薄透镜}{ThnLen}，还有（不要忘记正负号）：
\begin{equation}
\frac{1}{p}+\frac{1}{q}=\frac{1}{f}\quad\text{即：}\quad\frac{\theta_1}{r_1}+\frac{-\theta_2}{r_2}=\frac{1}{f}\quad\text{即：}\quad\theta_2=\theta_1-\frac{r_1}{f}~
\end{equation}
所以理想薄透镜的ABCD矩阵即为：
\begin{equation}
\pmat{1&0\\-1/f&1}~.
\end{equation}
\end{example}

\begin{exercise}{}\label{ABCD_Sample_3}
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/a4463c38ba9f9416.png}
\caption{举例，一块球面反射镜} \label{fig_GBeam_4}
\end{figure}
证明半径为$R$的球面反射镜的ABCD矩阵为：
\begin{equation}
\pmat{1&0\\-2/R&1}~.
\end{equation}
\end{exercise}

有了ABCD矩阵我们就可以很容易描述光学过程。显然，如果光线穿过了多个光学组件，那就相当于将它们的矩阵相乘。例如光线先穿过了长度为$L_1$，折射率为$n$的玻璃，接着又马上穿过了另一块长度为$L_2$，折射率也为$n$的玻璃，那么新的ABCD矩阵就是：
\begin{equation}
\pmat{1&L_2/n\\0&1}\pmat{1&L_1/n\\0&1}=\pmat{1&(L_1+L_2)/n\\0&1}~.
\end{equation}
太好了，两块一样的玻璃拼起来就相当于一块更长的玻璃！这说明我们的理论暂时还没有出错！

\subsection{近轴近似下的衍射}
上面的推导都建立在“光线”的前提下，可惜光不能总看成一条直线，好在ABCD矩阵可以用在更多地方，比如衍射理论里。纯色光的传播的方程是亥姆霍兹方程，你可以从隔壁词条\enref{麦克斯韦方程组}{MWEq}里轻易推导出来，它是：
\begin{equation}\label{eq_HHeq}
(\nabla^2+k^2)\bvec E=0~.
\end{equation}
这里的$\bvec E$是指电场的空间分量，即$\bvec E(x,y,z)$。完整的表达式是$\bvec E(x,y,z,t)=\bvec E(x,y,z)\E^{\I \omega t}$，但我们研究的是空间分布，所以不需要管电场随时间的变化，下文中的$\bvec E$均指得是不带时间分量的那个，即$\bvec E(x,y,z)$。

此外，在我们的推导中，光线都是在均匀介质中的，没有色散，也没有非线性，所以\autoref{eq_HHeq} 成立，并且适用于电场任何一个空间分量，下文中将用$E$来指代$\bvec E$的其中一个空间分量。

原则上根据\autoref{eq_HHeq} 就可以推导出高斯光束的表达形式，但是过程太抽象也太不物理了，后面我们再介绍这个方法。使用惠更斯-菲涅尔定律可以更形象地推导出高斯光束的空间分布方程，关于惠更斯定理的简明描述，可以参考隔壁词条\enref{惠更斯原理}{Huygen}。我们需要用到它的数学形式，也就是：

\begin{equation}\label{eq_HF}
E(x,y,z)=\frac{\I}{\lambda}\iint_s E\left(x_1,y_1,z_1\right)\frac{\E^{-\I kr}}{r}\cos\theta\, dx_1 dy_1~
\end{equation}

该式子描述了$z_1$平面的光斑，传播到$z$平面时的电场的演化，也就是下图：

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/1803eadff440e764.png}
\caption{衍射示意图} \label{fig_GBeam_5}
\end{figure}

接下来需要简化\autoref{eq_HF}。使用近轴近似，也就是可以认为$z_1$平面到$z$平面的距离远远大于光斑本身的"大小"，或者说，大部分的光组成的光斑的大小——实验上观测到的光斑往往只有几毫米大小，而光路却是分米级的——那么，可以认为$\theta \approx 0$，也就是$\cos \theta \approx 1$，$r \approx z-z_1$，但由于$\E^{\I kr}$中$k$是一个很大的数，需要对其中的$r$进行更精细的近似，也就是：

\begin{equation}\label{eq_appr}\ali{
r=&\sqrt{\left(x-x_1\right)^2+\left(y-y_1\right)^2+\left(z-z_1\right)^2}\\
=&\left(z-z_1\right)\left(1+\frac{\left(x-x_1\right)^2}{\left(z-z_1\right)^2}+\frac{\left(y-y_1\right)^2}{\left(z-z_1\right)^2}\right)^{1/2}\\
=&z-z_1+\frac{\left(x-x_1\right)^2+\left(y-y_1\right)^2}{2\left(z-z_1\right)}~.}
\end{equation}

将这些近似代入，就可以化简为（不需要对$z_1$积分）：
\begin{equation}\label{eq_HFappr}
E(x,y,z)=\frac{\I\E^{-\I k(z-z_1)}}{\lambda(z-z_1)}\iint_s E\left(x_1,y_1,z_1\right)\E^{-\I k\frac{(x-x_1)^2+(y-y_1)^2}{2(z-z_1)}}\,dx_1dy_1~
\end{equation}
%简便起见令$L=z-z_1$，
%\begin{equation}
%\bvec{E}(x,y,z)=\frac{\I\E^{-\I kL}}{\lambda L}\iint_s\bvec{E}\left(x_1,y_1,z_1\right)\E^{-\I k\left(\frac{(x-x_1)^2+(y-y_1)^2}{2L}\right)}\,dx_1dy_1~
%\end{equation}

\begin{example}{用亥姆霍兹方程的推导}
从\autoref{eq_HFappr} 就可以看出，$E$的函数表达式中应该含有$\E^{-\I kz}$这一项，我们把它提取出来，并令：
\begin{equation}\label{eq_EandU}
E(x,y,z)=u(x,y,z)\E^{-\I kz}~.
\end{equation}
将\autoref{eq_EandU} 代入到\autoref{eq_HHeq} 中去，就能得到：
\begin{equation}
\left(\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}\right)u+\frac{\partial^2}{\partial z^2}u-2\I k\frac{\partial}{\partial z}u=0~.
\end{equation}
中间的$\frac{\partial^2}{\partial z^2}u$被认为由于$u$是关于$z$的缓变函数，所以可以舍去二阶项，只保留一阶项，也就是：
\begin{equation}\label{eq_u}
\left(\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}\right)u-2\I k\frac{\partial}{\partial z}u=0~.
\end{equation}

这个说法可能不是很好理解，但是\autoref{eq_u} 和\autoref{eq_HFappr} 本质上是一样的，我们可以如下验证：首先，用\autoref{eq_EandU} 改写\autoref{eq_HFappr} 得到：
\begin{equation}\label{eq_HFinU}
u(x,y,z)=\frac{\I}{\lambda(z-z_1)}\iint_s u\left(x_1,y_1,z_1\right)\E^{-\I k\frac{(x-x_1)^2+(y-y_1)^2}{2(z-z_1)}}\,dx_1dy_1~
\end{equation}
接下来，把\autoref{eq_HFinU} 代入到\autoref{eq_u} 即可验证。
\end{example}
\begin{exercise}{}
把\autoref{eq_HFinU} 代入到\autoref{eq_u} ，验证缓变函数的假设。
\end{exercise}

\subsection{光学器件中的衍射}
上述的衍射是发生在自由空间上的，也就是真空中。那么当光通过光学器件时，衍射公式会发生相应的变化，我们接下来将讨论衍射公式与ABCD矩阵的结合，最重要的就是得到\autoref{eq_HHeq} 中的相位项$\E^{-\I kr}$。

如\autoref{fig_GBeam_6}（图片来自\footnote{A.E. Siegman, Lasers (Oxford University Press, Oxford, U. K.), Chapt. 20.}。对参数的定义不同，所以图中的标注会有些许区别），假设衍射光中的一束光从点$p_1$出发，在$z_1$平面在$r_1$处以$\theta_1$角度入射，在$z_2$平面以$r_2,\theta_2$出射，最后到达点$p_2$。
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/3ab969bd13c685de.png}
\caption{光线通过光线器件} \label{fig_GBeam_6}
\end{figure}
根据光程最短原理\footnote{光程最短原理的正确表述应该是光程平稳原理，光在两点间的光程是极小值或极大值，甚至是拐点。下面的推导是不严谨的，但推导的结果是正确的。}，如果没有光学元件的存在，那么从点$p_1$到点$p_2$的光就只能走一种路径，也就是直线$p_1p_2$。但光学元件的存在使得光走了另外一条路径，也就是图中的$p_1-x_1-x_2-p_2$。但$p_1x_1$明显大于$R_1$，$x_2p_2$也明显大于$R_2$，而光的两条路径都是最小光程路径，那么真相就只有一个，也就是光在通过光学器件时，相比于直接通过真空，光学器件对应的光程“居然”更小。该光程也就是前面提到的相位项$\E^{-\I kr}$中的$r$，现在来推导出它的具体数值。

由于两条路径的光程相等，就有：

\begin{equation}\label{eq_r}\ali{
&\quad\,\,\, p_1x_1+r+p_2x_2=R_1+L_0+R_2\\
&\Rightarrow r=L_0+R_1-\sqrt{R_1^2+r_1^2}+R_2-\sqrt{R_2^2+r_2^2}\\
&\text{利用一次近轴近似}\\
&\Rightarrow r\approx L_0-\frac{r_1^2}{2R_1}-\frac{r_2^2}{2R_2}}~
\end{equation}
而
\begin{equation}\label{eq_r1r2}
R_1\approx \frac{r_1}{\theta_1},\qquad R_2\approx \frac{-r_2}{\theta_2}~.
\end{equation}
观察\autoref{eq_appr} ，我们希望$r$中只含有$r_1$和$r_2$。同时，注意到ABCD矩阵中有
\begin{equation}
AD-BC=1~,
\end{equation}
事实上，只要光学器件的两个表面的折射率一致——一般来讲都是空气，所以它总是成立的——则该式子成立。在接下来的推导中我们默认它成立。
根据定义，有：
\begin{equation}\label{eq_t1t2}\ali{&\quad\,\,\,r_2=Ar_1+B\theta_1\\
&\quad\,\,\,\theta_2=Cr_1+D\theta_1\\
&\Rightarrow \theta_1=\frac{r_2-Ar_1}{B}\\
&\Rightarrow \theta_2=\frac{Dr_2-r_1}{B}}~
\end{equation}
将\autoref{eq_t1t2} 代入\autoref{eq_r1r2} 再代回到\autoref{eq_r} ，就能得到：
\begin{equation}
r\approx L_0+\frac{Ar_1^2-2r_1r_2+Dr_2^2}{2B}~
\end{equation}
这是二维时的推导，在这里我们直接写出三维时的表达式：
\begin{equation}
r\approx L_0+\frac{A(x_1^2+y_1^2)-2x_1x-2y_1y+D(x^2+y^2)}{2B}~
\end{equation}
那么，类似的我们就可以直接写出$u(x,y,z)$形式的经过光学器件的衍射方程：
\begin{equation}\label{eq_uABCD}
u(x,y,z)=\frac{\I}{B\lambda }\iint_s u\left(x_1,y_1,z_1\right)\E^{-\I k\frac{A(x_1^2+y_1^2)-2x_1x-2y_1y+D(x^2+y^2)}{2B}}\,dx_1dy_1~
\end{equation}

可以简单进行一下验证。真空其实是玻璃的“一种”，其折射率为1，那么它的ABCD矩阵也就是：
\begin{equation}
\pmat{1&L\\0&1}~.
\end{equation}
将它代入到\autoref{eq_uABCD} 里，就能得到：
\begin{equation}
u(x,y,z)=\frac{\I}{L\lambda }\iint_s u\left(x_1,y_1,z_1\right)\E^{-\I k\frac{(x-x_1)^2+(y-y_1^2)}{2L}}\,dx_1dy_1~
\end{equation}
鉴于$L=z-z_0$，所以上式实际上就是\autoref{eq_HFinU} 。所以\autoref{eq_HFinU} 其实是\autoref{eq_uABCD} 的一种特例。

\subsection{低模高斯光束}
回想最开始时的描述，高斯光束通过光学器件时，光斑的空间分布不变，也就是说\autoref{eq_uABCD} 中的$u(x,y,z)$应该和$u(x_1,y_1,z_1)$具有类似的函数表达式。我们现在需要找到这样一个合适的函数。%鉴于物理学家都是失败的考不上数学系的半吊子，解微积分方程基本是不可能的，我们现在只能猜一个答案。
观察\autoref{eq_uABCD} ：
\begin{equation}
u(x,y,z)=\frac{\I}{B\lambda }\iint_s u\left(x_1,y_1,z_1\right)\E^{-\I k\frac{A(x_1^2+y_1^2)-2x_1x-2y_1y+D(x^2+y^2)}{2B}}\,dx_1dy_1~
\end{equation}

一般来说光学器件的通光孔径一般都能覆盖绝大多数的光斑，所以积分区域$s$可以改成全空间，那么此时式中的$\E^{-\I kx_1}dx_1$就相当于给函数做傅里叶变换，而高斯曲线（正态分布标准曲线）在傅里叶变换后函数形式是基本不变的，可以参考词条\enref{傅里叶变换}{FTExp}。同时式中的$\E^{-\I kD(x^2+y^2)}$也给出了类似的提示。那么我们就可以猜测$u$的一种可能的形式：
\begin{equation}\label{eq_Gbeam}
u(x,y,z)=\E^{-\I k\frac{x^2+y^2}{2q}}~
\end{equation}
其中的$q=q(z)$，是关于$z$的函数。这里的$u$没有归一化处理。把它代回到\autoref{eq_uABCD} 中的$u(x_1,y_1,z_1)$，进行一些简单的重新排列式子，就能得到:
\begin{equation}
\ali{
u(x,y,z)&=\frac{\I}{B\lambda }\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}dx_1dy_1\,\E^{-\I k\frac{x_1^2+y_1^2}{2q_1}}\E^{-\I k\frac{A(x_1^2+y_1^2)-2x_1x-2y_1y+D(x^2+y^2)}{2B}}\\
&=\frac{\I}{B\lambda }\E^{-\I k\frac{D}{2B}(x^2+y^2)}\times \int_{-\infty}^{+\infty}dx_1\,\E^{-\I k\frac{x_1^2}{2q_1}}\E^{-\I k\frac{Ax_1^2-2x_1x}{2B}}\\
&\times \int_{-\infty}^{+\infty}dy_1\,\E^{-\I k\frac{y_1^2}{2q_1}}\E^{-\I k\frac{Ay_1^2-2y_1y}{2B}}\\
&=\frac{\I}{B\lambda }\E^{-\I k\frac{D}{2B}(x^2+y^2)}\times \int_{-\infty}^{+\infty}dx_1\,\E^{-\I k(\frac{1}{2q_1}+\frac{A}{2B})x_1^2}\E^{\I k\frac{x}{B}x_1}\\
&\times \int_{-\infty}^{+\infty}dy_1\,\E^{-\I k(\frac{1}{2q_1}+\frac{A}{2B})y_1^2}\E^{\I k\frac{y}{B}y_1}~
}~
\end{equation}
积分符号内都是傅里叶变换，所以可以直接带入公式，公式来源是隔壁词条\enref{傅里叶变换}{FTExp} ，即：
\begin{equation}
\int_{-\infty}^{+\infty}dx_1\,\E^{-\I k(\frac{1}{2q_1}+\frac{A}{2B})x_1^2}\E^{\I k\frac{x}{B}x_1}=\frac{1}{\sqrt{-2jk(\frac{1}{2q_1}+\frac{A}{2B})}}\exp{\frac{\I k\frac{x^2}{B^2}}{2(\frac{1}{q_1}+\frac{A}{B})}}~
\end{equation}
也就是：
\begin{equation}\label{eq_GbeamABCD}
u(x,y,z)=\frac{-1}{2\pi B (\frac{1}{q_1}+\frac{A}{B})}\E^{-\I k\frac{x^2+y^2}{2q_2}}~
\end{equation}
其中$q_2=\frac{D}{B}-\frac{1}{\frac{1}{q_1}+\frac{A}{B}}$，再次利用$AD-BC=1$，可以得到：
\begin{equation}\label{eq_qABCD}
q_2=\frac{Aq_1+B}{Cq_1+D}~.
\end{equation}

\autoref{eq_GbeamABCD} 的函数形式与\autoref{eq_Gbeam} 一致，这证明了我们的猜测是正确的：\autoref{eq_Gbeam} 这样一个分布的光就是我们要找的，通过光学元件后光斑分布不变的一种光，写回成$E$的形式，也就是：
\begin{equation}\label{eq_GbeamE}
E(x,y,z)=A\E^{-\I k(z+\frac{x^2+y^2}{2q(z)})}\qquad (A\text{是归一化系数})~
\end{equation}

继续深入。观察上式，可以发现相位$z+\frac{x^2+y^2}{2q(z)}$非常类似于我们之前经常使用的近轴近似的结果。联想到球面波的形式$E=\E^{-\I kR}/R$，对相位的$R$进行近轴近似可以得到$R\approx z+\frac{x^2+y^2}{2R}$，两者的形式非常类似。我们有理由认为\autoref{eq_GbeamE} 所代表的光也是一种球面波，但球面半径是复数。将$1/q(z)$分成：
\begin{equation}
\frac{1}{q}=\frac{1}{R}-\I\frac{\lambda}{\pi w^2}~
\end{equation}
那么\autoref{eq_GbeamE} 就可以写成：
\begin{equation}\label{eq_Gbeam0}
E(x,y,z)=A\E^{-\I k(z+\frac{x^2+y^2}{2R})}\E^{-\frac{x^2+y^2}{w^2}}~
\end{equation}
现在一切都明了了。\autoref{eq_Gbeam0} 所代表的就是零阶高斯光束，其相位项是和球面波一致的，相位项前面乘上了一个高斯分布的因子。

可以做出在某一截面（$z=z_0$）上的光强分布以及相位变化，能更加提示出其特点：
\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/4a2a52c13d6a25b5.png}
\caption{} \label{fig_GBeam_11}
\end{figure}

\subsection{低模高斯光束的传播}
占位符。

\subsection{高模高斯光束}
占位符。