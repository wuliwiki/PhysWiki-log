% 熵的微观定义与玻尔兹曼公式
% 玻尔兹曼公式|熵|统计力学

\pentry{热力学第二定律\upref{Td2Law}}

\subsection{玻尔兹曼熵公式} 
当我们讨论一个固定能量 $E$，体积 $V$，粒子数 $N$ 的一个\textbf{处于平衡态的孤立热力学系统} ，它的熵可以被系统的微观状态数来定义：
\begin{equation}
S(E,V,N) = k_B \ln \Omega(E,V,N)~.
\end{equation}
这被称为\textbf{玻尔兹曼公式}，被刻在了玻尔兹曼的墓碑上。其中 $\Omega$ 为总能量 $E$、体积 $V$、总粒子数 $N$ 的系统的微观状态数。在经典统计力学的理论体系中，$N$ 个粒子组成的系统的微观状态由 $6N$ 个自由度来描述（$3N$ 个空间自由度，$3N$ 个动量自由度），即相空间维度为 $6N$。
更严格地，它可以被表示为
\begin{equation}\label{eq_entro2_1}
\Omega(E,V,N)=\frac{\Omega_{\le}(E+\delta E,V,N)-\Omega_{\le}(E,V,N)}{\delta E}~,
\end{equation}
这里 $\Omega_{\le}(E,V,N)$ 被定义为相空间中能量小于等于 $E$ 的微观状态数。因此 $\Omega(E,V,N)$ 可以被理解为 $E$ 处的一个能壳的系统状态数除以能壳的厚度。微观状态数越大，系统的熵越大。

当我们讨论粒子之间不可分辨的\textbf{量子系统}，即粒子之间的交换对称性（全同粒子效应）。且此时我们通常需要考虑量子效应，不能简单地用相空间的坐标和动量来表示粒子或系统的状态。此时微观状态数则对应于系统的能级密度，即体积为 $V$，粒子数为 $N$ 的孤立系统在能量 $E$ 处的能级密度。因此对于有相互作用的复杂的量子系统，原则上我们也可以定义微观状态数并利用玻尔兹曼熵公式得到熵的表达式。

当我们讨论平衡态热力学时，上文的\textbf{玻尔兹曼熵}的定义普遍适用于一切的热力学系统，且可以帮助我们基于此建立热力学三大定律及其他宏观状态量的公式，由此可以看到玻尔兹曼公式的伟大。
\subsection{非平衡态的熵、分布与无序度}
在处理一些特殊问题时，我们常常会自由地选择定义新的微观状态数和新的熵来思考特定的问题，这可以帮助我们对系统的\textbf{有序、无序度}进行定量的描述。

在上文中，玻尔兹曼熵的定义只依赖于三个参数 $E,V,N$，它代表特定能量、体积、粒子数的系统微观状态数。也就是说，在玻尔兹曼熵的定义中，所有可能的这些系统微观状态都被考虑了进去。但事实上我们可以对满足 $E,V,N$ 条件的这些系统微观状态进一步地划分。

例如对于近独立子系\upref{depsys}（粒子间近似无相互作用，可视为互相独立）而言，我们可以用不同单粒子态能级 $\epsilon_l$ （简并度 $\omega_l$）的占据数 $0\le a_l\le \omega_l$（也就是说 $N$ 个粒子在不同单粒子态上的\textbf{分布}）来对系统微观状态进行分类，计算新的微观状态数。

以下是一种计算的例子：
\begin{example}{}
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/f65015db35dba716.pdf}
\caption{给外地来的游客分配酒店房间} \label{fig_entro2_1}
\end{figure}
我们先来思考一个更直观的例子：如何给外地来的游客分配酒店房间？假设一共有$N$个游客前来度假（心照不宣的假设：每个人都是不一样的、且可区分的）；同时，酒店共有$l$层，第$l$层有$\omega_l$个房间，并且每个房间都可以容纳任意多的人。

我们先制定一个方案，订出各层的入住人数：第一层入住$a_1$人，第二层入住$a_2$人，...或写为 $\{a_1,a_2,...\}=\{a_l\}$。这个方案只订出了每层的人数，但没有订出具体是谁在哪间房间。

我们先从$N$位游客中选取$a_1$位游客住在第一层，有$C_N^{a_1}$种选法。于此同时，对于这$a_1$位游客，每位游客都可以随意入住本层的一间房间，由于本层有$\omega_1$间房可选，因此有${\omega_1}^{a_1}$种选法。现在，我们分配完了第一层，并产生了
$$\Omega_1 = C_N^{a_1} {\omega_1}^{a_1}~$$
种更具体的入住方式。

别急，我们得继续分配第二层：由于已有$a_1$位游客入住了第一层，因此我们只能从剩余的$(N-a_1)$位游客中选取$a_2$位游客住在第二层，有$C_{N-a_1}^{a_2}$种选法。同时，对于这$a_2$位游客，每一位游客都可以随意选取本层的一间房间入住，因此有${\omega_2}^{a_2}$种入住方式...
$$\Omega_2 = C_{N-a_1}^{a_2} {\omega_2}^{a_2}~.$$

以此类推，总的入住方式是
$$
\begin{aligned}
\Omega^* &= C_N^{a_1} {\omega_1}^{a_1} C_{N-a_1}^{a_2} {\omega_2}^{a_2} C_{N-a_1-a_2}^{a_3} {\omega_3}^{a_3}...\\
&=C_N^{a_1} C_{N-a_1}^{a_2} C_{N-a_1-a_2}^{a_3} ... {\omega_1}^{a_1}{\omega_2}^{a_2}  {\omega_3}^{a_3}...\\
& = C_N^{a_1} C_{N-a_1}^{a_2} C_{N-a_1-a_2}^{a_3} ... \Pi_l{\omega_l}^{a_l}~,\\
\end{aligned}
$$
运用组合数的定义展开前半部分。
$$
\begin{aligned}
& C_N^{a_1} C_{N-a_1}^{a_2} C_{N-a_1-a_2}^{a_3} ...\\
&= \frac{N!}{a_1!(N-a_1)!} 
\frac{(N-a_1)!}{a_2!(N-a_1-a_2)!}
\frac{(N-a_1-a_2)!}{a_3!(N-a_1-a_2-a_3)!}
...\\
&=\frac{N!}{a_1!a_2!a_3!...} \\
&=\frac{N!}{\Pi_l a_l!} ~.\\
\end{aligned}
$$
代回原式，得
$$
\Omega^* = \frac{N!}{\Pi_l a_l!}  \Pi_l{\omega_l}^{a_l}~.
$$
这就是给定每层人数$\{a_l\}$的情况下，具体的入住方式的个数。我们惊奇地发现，这个结论形式上与玻尔兹曼分布中的微观态个数完全相同！

在这个比喻中，
\begin{itemize}
\item 游客总数$N$代表粒子总数，
\item 酒店的楼层代表能级，
\item 每层的房间数$\omega_l$代表每个能级的简并态个数，
\item 每层的入住人数$a_l$代表该能级上的粒子个数，
\item 制定每层人数的方案$\{a_l\}$代表一种分布，
\item 每一种具体的入住方式代表这种分布下的一种微观态，
\item 入住方式的总数$\Omega^*$就是这种分布下的微观态总个数。
\end{itemize}
\end{example}
从这个例子中我们可以看出，有一些分布所对应的微观状态数 $\Omega^*$ 小，另一些分布所对应的微观状态数 $\Omega^*$ 大。所有这些满足能量 $E$，体积 $V$，粒子数 $N$ 的分布的微观状态数的总和就是\autoref{eq_entro2_1} 中的 $\Omega(E,V,N)$。在这里我们对这些系统微观状态利用\textbf{分布}的概念进行人为划分以后，可以利用玻尔兹曼熵公式 $S=k_B\ln \Omega^*$ 再为每种分布赋予\textbf{新的熵含义}，即我们认为，$\Omega^*$ 小的分布对应的熵小，系统更有序；$\Omega^*$ 大的分布对应的熵大，系统更无序。我们通过定义\textbf{什么是分布和微观状态数}，定义了\textbf{什么是有序，什么是无序}，最后定义了\textbf{什么是熵}（注意这有区别于\autoref{eq_entro2_1} 的玻尔兹曼熵）。下一节我们将看到，对于平衡态系统而言，我们这里定义的熵与玻尔兹曼熵公式给出的熵是相同的。

注意，除了基于这种能级占据数分布定义熵，我们还可以其他的定义方式，例如基于粒子的空间位置定义熵，例如将空间划分为左边和右边两个格子，设左侧格子分布有 $a$ 个粒子，右侧格子分布有 $N-a$ 个粒子，那么微观状态数为 $N!/[a!\times(N-a)!]$，这种定义方式与上文的定义方式显然是不同的，并且它给出了描述“无序度”的一种新的定量方式。但是当我们讨论\textbf{平衡态系统与最概然分布}时，这些不同的定义方式殊途同归\footnote{其背后最根本的原理是玻尔兹曼提出的\textbf{各态历经假设}和\textbf{等概率原理}。}。

\subsection{平衡态系统与最概然分布}
热力学第二定律告诉我们\textbf{绝热或孤立系统的熵永不减少}，这也告诉了我们孤立系统处于平衡态的熵判据\footnote{参考热动平衡判据\upref{equcri} 词条。}，即孤立系统处于平衡态当且仅当它的熵处于极大值。

那么如果将此处的经典热力学体系中的熵（有时候也称它为宏观熵，因为熵的宏观定义\upref{Entrop}不涉及系统的微观性质）与玻尔兹曼公式给出的微观熵相联系起来，那么就可以得到平衡态系统所需满足的微观状态数的条件了。在下一节我们会证明，在热力学极限下，宏观熵等于微观熵，那么系统处于平衡态时我们可以认为系统的状态处于\textbf{最概然分布}，即微观状态数最大的状态。

因此，在热力学极限（$N\rightarrow \infty$）下，既然一个平衡态孤立系统的熵处于极大值，利用玻尔兹曼熵公式我们可以证明它所对应的\textbf{微观状态数一定是最大的}，且在热力学极限下，最概然分布的微观状态数一定是远大于其他系统状态的微观状态数的。也就是说，我们只需要分析系统的最概然分布，就可以得到平衡态的统计力学性质了。一个例子是词条玻尔兹曼分布（统计力学）\upref{MBsta}中\autoref{eq_MBsta_9}~\upref{MBsta}和\autoref{eq_MBsta_10}~\upref{MBsta}给出了从\textbf{最概然分布}出发得到了近独立经典系统、玻色系统和费米系统的麦克斯韦玻尔兹曼分布、玻色分布与费米分布公式。
\begin{exercise}{}
通过分布的微观状态数定义的熵和玻尔兹曼熵是否相同？
\end{exercise}
回顾上一节的内容，我们通过定义\textbf{什么是分布和微观状态数}，定义了\textbf{什么是有序，什么是无序}，最后定义了\textbf{什么是熵}（注意这有区别于\autoref{eq_entro2_1} 的玻尔兹曼熵）。其中 $\Omega$ 最大的情况，即\textbf{最概然分布}。通常可以证明，在热力学极限（$N\rightarrow \infty$）下，最概然分布的微观状态数 $\Omega$ 近似等于玻尔兹曼熵公式中的 $E,V,N$ 条件下微观状态数 $\Omega(E,V,N)$，也就是说偏离最概然分布的其他分布的微观状态数可以忽略不计。也就是说，对于最概然分布所对应的平衡态系统，由 $S=k_B\ln \Omega^*$ 得到的熵和由玻尔兹曼公式 $S=k_B\ln \Omega(E,V,N)$ 得到的熵是相同的。

\subsection{等概率原理}
对于处在平衡态的系统，在满足固定能量 $E$，体积 $V$，粒子数 $N$ 的约束条件下，任何可能的系统微观状态发生的概率都是相同的。
\begin{exercise}{}
由等概率原理证明：在热力学极限（$N\rightarrow \infty$）下，平衡态系统的统计性质可以由最概然分布描述。
\end{exercise}
这是因为，偏离最概然分布的微观状态数远小于最概然分布的状态数，且在热力学极限下可以忽略不计，因此若每个状态出现概率相同，那么系统的统计性质几乎由最概然分布来描述。

可以由\textbf{刘维尔定理}证明，等概率原理给出的系统的确能保持在平衡态。刘维尔定理说的是经典力学系统的相空间随时间演化的过程中，相空间体积元的体积大小不随时间演化而改变。除了经典版本的刘维尔定理，实际上还有量子版本的刘维尔定理，可以由密度算符的时间演化方程表示。

当然对于实际情况的系统会在不同的状态之间游走，因此等概率假设的证明还需要各态历经假设，这不在本文的讨论范围之内了。