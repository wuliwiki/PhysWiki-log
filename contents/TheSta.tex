% 热力学量的统计表达式（玻尔兹曼分布）
% keys 热力学量|统计力学|配分函数|玻尔兹曼分布|近独立子系
% license Xiao
% type Tutor


\pentry{玻尔兹曼分布（统计力学）\nref{nod_MBsta}，熵\nref{nod_Entrop}}{nod_c96a}

\subsection{配分函数，热力学第一定律}

满足经典极限\footnote{在\enref{玻尔兹曼分布}{MBsta} 文章中谈到了玻色分布和费米分布的表达式，式中如果 $e^\alpha\gg 1$，那么将过度到经典情况的玻尔兹曼分布。我们称这个条件为经典极限。}的大量粒子组成的\enref{近独立子系}{depsys}\footnote{近独立子系：组成系统的粒子之间的相互作用很弱以至于可以近似忽略。由粒子全同性导致的交换力是由量子效应导致的，不考虑在这个范围内。因此近独立子系一般有三种分布：玻尔兹曼分布，费米狄拉克分布，玻色爱因斯坦分布，其中玻尔兹曼分布是经典极限情形下的分布。}中，粒子遵从玻尔兹曼分布。我们可以试图用统计力学中配分函数来推出一切热力学量。

配分函数表达式为：
\begin{equation}
Z_1=\sum_l \omega_l e^{-\beta \epsilon_l}~.
\end{equation}

式中 $\omega_l$ 为能级的简并度。根据玻尔兹曼分布，每个能级上的粒子数为 $e^{-\alpha-\beta\epsilon_l}$。于是有
\begin{equation}\label{eq_TheSta_4}
\begin{aligned}
&N=\sum_l \omega_l e^{-\alpha-\beta\epsilon_l}=e^{-\alpha} Z_1~,\\
&E=\sum_l \epsilon_l \omega_l e^{-\alpha-\beta\epsilon_l}=-e^{-\alpha}\frac{\partial Z_1}{\partial \beta}=-\frac{N}{Z_1}\frac{\partial Z_1}{\partial \beta}=-N\frac{\partial \ln Z_1}{\partial \beta}~,
\end{aligned}
\end{equation}

这里 $\alpha,\beta$ 仍然是待定的参量。但对于一个粒子数 $N$ 和内能 $E$ 确定的系统，当我们知道了它的能级信息 $\epsilon_l,\omega_l$，我们就可以写出它的配分函数 $Z_1(\beta)$，并代入上面的公式联立两个方程，最终确定 $\alpha,\beta$。这种方法理论上可行，但实际上较为复杂。下面我们将继续从配分函数出发分析系统的其他热力学量，并最终用温度、化学势来表达 $\alpha,\beta$。
\subsubsection{做功与热量传递}
由热力学第一定律，系统可以通过功和热量两种方式与外界交换能量。例如在可逆过程中做功可以写为 $Y\dd y$，$Y$ 为广义力，$y$ 为广义位移\footnote{例如，$Y$ 取 $-P$,$y$ 取 $V$ 对应体积压缩做功；$Y$ 取电场强度 $E$,$y$ 取电极化强度 $P$ 可以表示外界使介质极化需要做的功}。当系统发生广义位移，能级也会发生变化。外界对能级 $\epsilon_l$ 上一个粒子的力为 $\frac{\partial \epsilon_l}{\partial y}$。因此可以表示出 $Y$：
\begin{equation}
\begin{aligned}
Y&=\sum_l a_l\frac{\partial \epsilon_l}{\partial y}=\sum_l \frac{\partial \epsilon_l}{\partial y}\omega_le^{-\alpha-\beta\epsilon_l}\\
&=e^{-\alpha}\qty(-\frac{1}{\beta}\frac{\partial }{\partial y})Z_1\\
&=-\frac{N}{\beta}\frac{\partial }{\partial y}\ln Z_1~.
\end{aligned}
\end{equation}
例如将上面的 $y$ 替换成 $V$，可以得到压强 $P$ 的表达式。

假设系统发生一个 $\dd y$ 的广义位移的变化。则外界对系统做的功为
\begin{equation}
Y\dd y=\sum_l a_l\dd \epsilon_l=-\frac{N}{\beta}\frac{\partial }{\partial y}\ln Z_1~,
\end{equation}
注意到上面我们将做功定义为了广义位移对粒子所对应能级 $\epsilon_l$ 的移动。这部分当然是对系统内能有贡献的，但另一部分对系统内能的贡献来自于粒子在各个能级上的重新分布，即 $a_l$ 的变化量。也就是说，对于无穷小的广义位移 $\dd y$，内能的改变量（全微分）为：
\begin{equation}
\dd E=\sum_l a_l\dd \epsilon_l+\sum_l\epsilon_l\dd a_l=\delta W+\delta Q=Y\dd y+\delta Q~.
\end{equation}
由此可以推出热量的传递：
\begin{equation}\label{eq_TheSta_2}
\delta Q=\dd E-Y\dd y=
-N\dd{\qty(\frac{\partial \ln Z_1}{\partial \beta})}+\frac{N}{\beta}\frac{\partial \ln Z_1}{\partial y}\dd y~.
\end{equation}
\subsection{熵的统计表达式，玻尔兹曼关系}
\subsubsection{从配分函数得到熵}
用 $\beta$ 乘\autoref{eq_TheSta_2} 得到
\begin{equation}\label{eq_TheSta_1}
\begin{aligned}
\beta \delta Q&=-N\beta\dd{\qty(\frac{\partial \ln Z_1}{\partial \beta})}+N\frac{\partial \ln Z_1}{\partial y}\dd y\\
&=-N\dd{\qty(\beta\frac{\partial \ln Z_1}{\partial \beta})}+N\frac{\partial \ln Z_1}{\partial \beta}\dd \beta+N\frac{\partial \ln Z_1}{\partial y}\dd y\\
&=N\dd{\qty(\ln Z_1-\beta\frac{\partial }{\partial \beta}\ln Z_1)}~.
\end{aligned}
\end{equation}
根据热力学量\enref{熵}{Entrop}的相关知识，我们知道 $\delta Q$ 乘上积分因子 $1/T$ 就可以变成全微分 $\dd S$。于是\autoref{eq_TheSta_1} 表明 $\beta$ 式 $1/T$ 乘上一个常数，熵就是等式右侧括号内的表达式乘以一个常数。我们令
\begin{equation}
\beta=\frac{1}{kT}~.
\end{equation}
$k$ 称为玻尔兹曼常量，其数值为
\begin{equation}
k=1.381\times 10^{-23} \rm{J\cdot K^{-1}}~.
\end{equation}
并且可以验证，如此设定 $\beta$ 后，对单原子理想气体系统的配分函数进行计算，得到的各热力学量结果与已知结论相符，例如内能是 $E=\frac{3}{2}NkT$\upref{IdgEng}，有状态方程 $PV=NkT$…… 

因为 $\dd S=\delta Q/T$，再对 \autoref{eq_TheSta_1} 积分得：
\begin{equation}\label{eq_TheSta_3}
S=Nk(\ln Z_1-\beta\frac{\partial }{\partial \beta}\ln Z_1)~.
\end{equation}

至此，我们用配分函数表达出了熵 $S$。还可以从另一个角度来看式\autoref{eq_TheSta_3} 的含义。由于 $N=e^{-\alpha}Z_1$，对它取对数可以得到 $\ln Z_1=\ln N+\alpha$，
将\autoref{eq_TheSta_4} 代入熵的表达式，有
\begin{equation}
\begin{aligned}
S&=k(N\ln N+\alpha N+\beta E)
\\&=k[N\ln N+\sum_l(\alpha+\beta\epsilon_l)a_l]~.
\end{aligned}
\end{equation}
其中 $a_l=\omega_le^{-\alpha-\beta\epsilon_l}$，所以$\alpha+\beta\epsilon_l=\ln(\omega/a_l)$，所以 $S$ 可以表示为
\begin{equation}
S=k(N\ln N+\sum_l a_l\ln\omega_l-\sum_l a_l\ln a_l)~,
\end{equation}
与\autoref{eq_MBsta_6}~\upref{MBsta} 相比较，可以得到著名的\textbf{玻尔兹曼关系}\footnote{这个公式被刻在了玻尔兹曼的墓碑上。}：
\begin{equation}\label{eq_TheSta_7}
S=k\ln \Omega~.
\end{equation}
\subsubsection{全同粒子假设，吉布斯佯谬的解决}
为了使 $S$ 满足广延量要求（即固定温度、粒子数密度的平衡态热力学系统的熵与它的粒子数成正比），还要对上式减去 $k\ln (N!)\approx k N(\ln N-1)$，相当于将微观状态数除去 $N!$。在量子力学出现以前吉布斯（Gibbs）为了解决吉布斯佯谬，就曾提倡减去这一项。直到\textbf{全同粒子假设} 给了这个理论一个充分解释。正确的表达式应为
\begin{equation}\label{eq_TheSta_5}
\begin{aligned}
&S=k\ln \frac{\Omega_{M.B.}}{N!}~,\\
&S=Nk(\ln Z_1-\beta\frac{\partial }{\partial \beta}\ln Z_1)-k\ln N!
\end{aligned}
\end{equation}
\subsubsection{确定 $\alpha$ 与 $\beta$}
之前我们求得 $\beta=1/kT$，现在考虑求解 $\alpha$ 与热力学量的联系。我们假定体系可以和外界交换粒子，即体系的粒子数 $N$ 能发生改变。那么内能的全微分式应该写成 $\dd E=\delta W+\delta Q+\mu\dd N$，可以写成 $T\dd S=\dd E-Y\dd y-\mu\dd N$。将 $S,E,Y\dd y$ 用配分函数的表达式代入，令 $\dd T=\dd \beta=0$，即温度不变，进行化简。可以得到
\begin{equation}
\begin{aligned}
&T\dd(Nk(\ln Z_1-\beta\frac{\partial }{\partial \beta}\ln Z_1)-k\ln N!)=-\dd(N \frac{\partial \ln Z_1}{\partial \beta})+\frac{N}{\beta}\frac{\partial \ln Z_1}{\partial y}\dd y-\mu\dd N\\
\Rightarrow &\dd(NkT\ln Z_1-kT\ln N!)=NkT \dd \ln Z_1 -\mu \dd N\\
\Rightarrow & kT\ln Z_1 \dd N-kT\ln N\dd N=-\mu\dd N\\
\Rightarrow &\mu=-\frac{\alpha}{\beta}~.
\end{aligned}
\end{equation}

因此
\begin{equation}
\alpha=-\frac{\mu}{kT},\beta=\frac{1}{kT}~.
\end{equation}
玻尔兹曼分布可以写为：
\begin{equation}
n_l=\omega_l e^{-\frac{\epsilon_l-\mu}{kT}}~.
\end{equation}

或者我们直接利用推导玻尔兹曼分布时用的拉格朗日乘子公式\autoref{eq_MBsta_7}~\upref{MBsta}，可以得到
\begin{equation}
\delta(S/k)-\alpha \delta N-\beta \delta E=0~,
\end{equation}
由此可得
\begin{equation}
\qty(\frac{\partial S}{\partial N})_{V,E}=k\alpha,\qty(\frac{\partial S}{\partial E})_{V,N}=k\beta~.
\end{equation}
再根据 $E$ 的全微分公式 $T\dd S=\dd E-Y\dd y-\mu\dd N$ 容易求得
\begin{equation}
\alpha=-\frac{\mu}{kT}~.
\end{equation}

\subsection{自由能}
\enref{亥姆霍兹自由能}{HelmF} $F=E-TS$，将\autoref{eq_TheSta_4} 和\autoref{eq_TheSta_5} 代入，自由能的表达式为
\begin{equation}\label{eq_TheSta_6}
F=-NkT\ln Z_1+kT\ln(N!)~.
\end{equation}

根据自由能的全微分式，我们可以用它的偏微商表示化学势 $\mu$：
\begin{equation}
\begin{aligned}
\mu&=\left(\frac{\partial F}{\partial N}\right)_{T,V}=-kT\ln Z_1+kT\ln N\\
&=kT\ln N/Z_1=-kT\alpha=\frac{-\alpha}{\beta}~,
\end{aligned}
\end{equation}
由这个关系式我们又重新得到了 $\alpha$ 和化学势的关系。

代入系统的配分函数进行计算，可以发现理想气体的化学势是负的。对于量子效应显著（不能作经典近似）的气体，例如金属的自由电子气体，则配分函数要根据费米分布修改，可以得到，金属中自由电子的化学势是正的。类似的，对于玻色气体，配分函数要根据玻色分布进行修改。

\subsection{玻尔兹曼分布与正则系综}
在前面的推导中我们为了让熵成为广延量，解决 Gibbs 佯谬，手动地从熵的表达式中减去了 $k\ln N!$，这在数学上实际上是不自然和突兀的。实际上我们存在更自然的方式：在写出配分函数的时候就将全同粒子效应考虑进来。
考虑整个多体系统的能级，此时系统的量子态被定义为 $N$ 粒子的张量积（的对称化），而这个大的量子态能够按照系统哈密顿量的本征值划分为多个能级，这个大的量子态的能量是其中各个粒子的能量之和。假设量子态 $|S\rangle$ 被粒子占据的概率仍正比于 $e^{-\beta E_S}$（这是正则系综的一个基本假设，能够从等概率原理出发证明\autoref{eq_CEsb_2}~\upref{CEsb}）。 因此我们能够在经典意义下粗略地写出它的配分函数：
\begin{equation}
\begin{aligned}
Z&=\sum_{S} \exp(-\beta E_S)=\sum_{S=\{\epsilon_1,\epsilon_2,\cdots,\epsilon_N\}}\exp(-\beta(\epsilon_1+\epsilon_2+\cdots+\epsilon_N))\\
&=\frac{1}{N!} \sum_{\epsilon_1}\exp(-\beta \epsilon_1) \sum_{\epsilon_2}\exp(-\beta\epsilon_2)\cdots\\
&=\frac{1}{N!}Z_1^N~.
\end{aligned}
\end{equation}
正则系综考虑的是一个\textbf{固定温度、体积以及粒子数}的系统。
从新的配分函数出发，熵、自由能这些热力学量就可以简单地被表达为（直接将\autoref{eq_TheSta_5} 和 \autoref{eq_TheSta_6} 中的 $Z_1$ 用 $Z$ 的表达式替换）：
\begin{equation}
\begin{aligned}
&E=-\pdv{\beta}\ln Z~,\\
&F=-kT\ln Z,\quad S=k(\ln Z-\beta \pdv{\beta}\ln Z)~.
\end{aligned}
\end{equation}
关于正则系综的更加具体的讨论可以参考文章\enref{正则系综法}{CEsb}。
