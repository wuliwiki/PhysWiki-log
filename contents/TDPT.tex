% 含时微扰理论（束缚态）
% keys 微扰理论|量子力学|薛定谔方程|近似
% license Xiao
% type Tutor
% 未完成：考虑把第一节的内容开新词条

\pentry{薛定谔方程\nref{nod_TDSE}}{nod_bf98}

\subsection{薛定谔方程的矩阵形式}
\footnote{本文参考 \cite{GriffQ}。}在讲微扰理论之前，我们先来看如何把含时薛定谔方程写为矩阵的形式。含时薛定谔方程的一般形式为
\begin{equation}\label{eq_TDPT_1}
H \ket{\psi(t)} = \I\hbar \pdv{t} \ket{\psi(t)}~,
\end{equation}
我们把哈密顿算符分为不含时部分 $H_0$ 和含时部分 $H'(t)$
\begin{equation}
H = H_0 + H'(t)~.
\end{equation}

为简单起见我们暂时假设 $H_0$ 只有离散的束缚， 例如简谐振子\upref{QSHOop}。 我们假设已经知道 $H'(t) = 0$ 的情况下含时薛定谔方程的通解：先解出对应的定态薛定谔方程的波函数 $\ket{n}$ 和能级 $E_n$，通解可表示为（\autoref{eq_TDSE_5}~\upref{TDSE}）
\begin{equation}
\ket{\psi_0(t)} = \sum_n c_n \ket{n} \E^{-\I E_n t/\hbar}~.
\end{equation}
注意其中 $c_n$ 为常数，由初始波函数决定。我们可以定义一组\textbf{含时}基底
\begin{equation}
\ket{n(t)} = \ket{n} \E^{-\I E_n t/\hbar}~.
\end{equation}
注意任何时刻这组基底都正交归一， 可用于展开\autoref{eq_TDPT_1} 的解
\begin{equation}
\ket{\psi(t)} = \sum_n c_n(t) \ket{n(t)} = \sum_n c_n(t) \ket{n} \E^{-\I E_n t/\hbar}~.
\end{equation}
由于基底并不是总哈密顿算符 $H$ 的本征矢，系数需由常数拓展为时间的函数 $c_n(t)$。 许多时候， $H'(t)$ 只在一段有限的时间内不为零， 那么 $c_n(t)$ 也只在这段时间内变化， 在其他时间不变。

选择了基底后，就可以把薛定谔方程表示为矩阵的形式。 % 链接未完成
把上式代入薛定谔方程（\autoref{eq_TDPT_1}）得
\begin{equation}
\begin{aligned}
&\sum_n c_n(t) H_0 \ket{n(t)} + \sum_n c_n(t) H'(t) \ket{n(t)} \\ 
={} &\I\hbar \sum_n \dot c_n(t) \ket{n(t)}
+ \I\hbar \sum_n c_n(t) \dv{t} \ket{n(t)}~.
\end{aligned}
\end{equation}
考虑到
\begin{equation}
H_0\ket{n(t)} = \I\hbar \dv{t} \ket{n(t)}~,
\end{equation}
% 引用公式未完成
可化简为
\begin{equation}\label{eq_TDPT_11}
\sum_n c_n(t) H'(t) \ket{n(t)}
= \I\hbar \sum_n \dot c_n(t) \ket{n(t)}~.
\end{equation}
要写成矩阵形式， 两边左乘 $\bra{m(t)} = \E^{\I E_m t/\hbar}\bra{m}$ （即要求每个分量相等）， 且令
\begin{equation}
\omega_{mn} = \frac{E_m-E_n}{\hbar}~,
\end{equation}
\begin{equation}\label{eq_TDPT_7}
\tilde H_{mn}(t) = \bra{m(t)} H'(t) \ket{n(t)} = \mel{m}{H'(t)}{n} \E^{\I\omega_{mn}t/\hbar}~,
\end{equation}
得
\begin{equation}\label{eq_TDPT_2}
\sum_n \tilde H_{mn}(t) c_n(t)
= \I\hbar \dv{t} c_m(t)~.
\end{equation}
写成矩阵形式为（对矢量求导即对每个分量分别求导\upref{DerV}）
\begin{equation}\label{eq_TDPT_3}
\tilde{\mat {H}} \bvec c = \I\hbar \dv{t} \bvec c~,
\end{equation}
到此为止我们还没有做任何近似，该式和\autoref{eq_TDPT_1} 完全等效。

\subsection{含时微扰理论}
\pentry{一阶不含时微扰理论\nref{nod_TIPT}}{nod_193c}

若哈密顿算符中的势能包含时间，只有极少数情况下存在解析解。这时我们可以用\textbf{含时微扰理论}来近似求解。类比不含时微扰理论\upref{TIPT}，我们引入一个常数 $\lambda$ 来分离不同阶数的近似，最后只需令 $\lambda = 1$ 即可。 理论上当阶数足够高且 $H'$ 足够弱时，近似解将会收敛到精确解。

令哈密顿算符，系数矢量分别为
\begin{equation}
H = H_0 + \lambda H'(t)~,
\end{equation}
\begin{equation}
\bvec c(t) = \bvec c^{(0)}(t) + \lambda\bvec c^{(1)}(t) + \lambda^2\bvec c^{(2)}(t) \dots~
\end{equation}
\autoref{eq_TDPT_3} 变为
\begin{equation}
\lambda\tilde{\mat {H}} [\bvec c^{(0)}(t) + \lambda\bvec c^{(1)}(t) + \dots] = \I\hbar \dv{t} [\bvec c^{(0)}(t) + \lambda\bvec c^{(1)}(t) + \dots]~.
\end{equation}
根据 $\lambda$ 的阶数分离方程，得
\begin{align}
&\dv{t} \bvec c^{(0)}(t) = \bvec 0 &&\text{（0 阶近似）}\label{eq_TDPT_4}~,\\
&\dv{t} \bvec c^{(1)}(t) = \frac{1}{\I\hbar} \tilde{\mat H}(t) \bvec c^{(0)}(t) &&\text{（1 阶近似）} \label{eq_TDPT_5}~,\\
&\dv{t} \bvec c^{(n)}(t) = \frac{1}{\I\hbar} \tilde{\mat H}(t) \bvec c^{(n-1)}(t) &&\text{（$n$ 阶近似）} \label{eq_TDPT_6}~.
\end{align}

为了求解各阶近似，我们假设 $t=0$ 时只有 0 阶系数 $\bvec c^{(0)}(0)$ 不为零。若给出初始波函数 $\ket{\psi(0)}$，可用 $\ket{n(0)} = \ket{n}$ 展开得到 $\bvec c^{(0)}(0)$。\autoref{eq_TDPT_4} 说明零阶系数矢量为常数，所以零阶近似解就是 $\bvec c^{(0)}(t) = \bvec c^{(0)}(0)$。继续把 $\bvec c^{(0)}(t)$ 代入\autoref{eq_TDPT_5}，两边对时间从 0 到 $t$ 定积分（矢量的积分即对每个分量分别积分）得
\begin{equation}
\bvec c^{(1)}(t) - \bvec c^{(1)}(0) = \frac{1}{\I\hbar} \int_{0}^{t}  \tilde{\mat H}(t) \bvec c^{(0)}(t) \dd{t}~,
\end{equation}
代入 $\bvec c^{(1)}(0) = 0$，$\bvec c^{(0)}(t) = \bvec c^{(0)}(0)$，得一阶近似解为
\begin{equation}\label{eq_TDPT_9}
\bvec c^{(1)}(t) = \frac{1}{\I\hbar} \int_{0}^{t}  \tilde{\mat H}(t)\bvec c^{(0)}(0) \dd{t}~.
\end{equation}
类似地，对\autoref{eq_TDPT_6} 积分，若已知 $\bvec c^{(n-1)}(t)$， 有
\begin{equation}\label{eq_TDPT_8}
\bvec c^{(n)}(t) = \frac{1}{\I\hbar} \int_{0}^{t}  \tilde{\mat H}(t) \bvec c^{(n-1)}(t) \dd{t}~.
\end{equation}
所以要想得到 $n$ 阶近似解，积分 $n$ 次即可。 为了明确起见，\autoref{eq_TDPT_8} 的分量表达式为
\begin{equation}\label{eq_TDPT_10}
c_i^{(n)}(t) = \frac{1}{\I\hbar} \sum_j \int_{0}^{t} \mel{i}{H'(t)}{j} \E^{\I\omega_{ij}t} c_j^{(n-1)}(t) \dd{t}~.
\end{equation}

\subsection{简单的一阶微扰}
大多数情况下我们只使用一阶近似，一种简单且常见的情况是，若初态为 $H_0$ 的某个本征态 $\ket{j}$
\begin{equation}
c_i^{(1)}(t) = \frac{1}{\I\hbar} \int_0^t \mel{i}{H'(t)}{j} \E^{\I\omega_{ij} t} \dd{t}~.
\end{equation}
我们把 $c_i(t)$ 叫做\textbf{跃迁幅（transition amplitude）}。 所以在一阶近似中，波函数在 $t$ 时刻出现在 $\ket{i}$ 的概率约为
\begin{equation}
P_{ij}(t) = \abs{c_i^{(1)}(t)}^2~,
\end{equation}
注意一阶微扰仅当 $P_{ij} \ll 1$ 时有效。

在此基础上， 一种更简单的情况是： 如果 $H'(t)$ 中的时间函数可以分离出来
\begin{equation}
H'(t) = W f(t)~,
\end{equation}
其中 $W$ 是一个不含时的算符
\begin{equation}
H'_{ij}(t) = \mel{i}{H'}{j} = \mel{i}{W}{j}f(t)~,
\end{equation}
此时一阶微扰公式（\autoref{eq_TDPT_9}） 变为 $f(t)$ 的反傅里叶变换\upref{FTExp}。 末态 $\ket{i}$ （$i \neq j$）的系数为
\begin{equation}
c_i^{(1)}(t) = \frac{\mel{i}{W}{j}}{\I\hbar} \int_0^t f(t)\E^{\I\omega_{ij} t} \dd{t}~.
\end{equation}
当 $f(t)$ 只在有限时间段不为零时候， 令 $t\to+\infty$ （或者 $t$ 在波包 $f(t)$ 结束以后）该积分就是 $f(t)$ 的傅里叶变换\upref{FTExp} $\sqrt{2\pi}\tilde f(-\omega_{ij})$。
\begin{equation}\label{eq_TDPT_12}
c_i^{(1)}(+\infty) = \frac{\sqrt{2\pi}}{\I\hbar} \mel{i}{W}{j}\tilde f(-\omega_{ij})~.
\end{equation}
注意 $H'(t)$ 消失后， 系数 $c_i$ 就不再随时间变化。
