% 多普勒效应
% keys 多普勒效应|波源|相位|振幅|角频率
% license Xiao
% type Tutor

\pentry{多普勒效应（一维变速）}{nod_c6eb}% \addTODO{文章}

我们相对波介质静止建立参考系，令移动的波源位置为 $\bvec r_0(t)$， 振动相位为 $\phi_0(t)$， $t$ 时刻波源到位矢 $\bvec r$ 的距离为 $\abs{\bvec r - \bvec r_0(t)}$. 令点观测点接收到的相位为 $\phi(\bvec r, t)$， 而这个相位是波源在 $t_0$ 时刻发出得， 则有
\begin{equation}\label{eq_Dopler_1}
\abs{\bvec r - \bvec r_0(t-\Delta t)} = v\Delta t~.
\end{equation}
其中 $v$ 为波在介质中传播的速度， $\Delta t$ 是波从波源 $\bvec r_0(t - \Delta t)$ 处传到 $\bvec r(t)$ 所需要的时间。 $t - \Delta t$ 时刻波源发出的波阵面（相位不变）在 $t$ 时刻到达 $\bvec r$， 所以
\begin{equation}\label{eq_Dopler_2}
\phi(\bvec r, t) = \phi_0(t - \Delta t)~,
\end{equation}
根据\autoref{eq_Dopler_1} 和\autoref{eq_Dopler_2} 可以求出空间中的相位场 $\phi(\bvec r, t)$。 如果观察者在 $\bvec r$ 处不动，对时间求导即可得到振动的角频率。

若观察者移动，令位置为 $\bvec r_1(t)$， 相位为 $\phi_1(t)$， 则
\begin{equation}\label{eq_Dopler_3}
\phi_1(t) = \phi(\bvec r_1(t), t)~.
\end{equation}
对时间求导， 可得任意时刻点观察者接收到的角频率。

% \addTODO{先推导一维的情况， 再看二维.}

\subsection{频率公式}
对\autoref{eq_Dopler_3} 求时间 $t$ 得全导数\upref{TotDer}， 得
\begin{equation}
\dv{\phi_1}{t} = \grad\phi \vdot \bvec v_1 + \pdv{\phi}{t}~.
\end{equation}
为了书写方便， 我们令 $t - \Delta t = t_0$， 即波源在 $t_0$ 时刻发出的波阵面在 $t$ 到达 $\bvec r$。 $t_0$ 可以看成 $t$ 和 $\bvec r$ 的函数  $t_0(t, \bvec r)$
\begin{equation}
\phi(\bvec r, t) =  \phi_0(t_0) = \omega t_0(\bvec r, t)~,
\end{equation}
\begin{equation}
\pdv{\phi}{t} = \omega \pdv{t_0}{t} \qquad
\grad \phi = \omega \grad t_0~.
\end{equation}
由几何关系
\begin{equation}
\abs{\bvec r - \bvec r_0(t_0)} = v(t - t_0)~,
\end{equation}
上式约束了 $t_0, t, \bvec r$ 三者的关系。 两边的增量可以写为（令 $\bvec r - \bvec r_0$ 的单位矢量为 $\uvec u$）
\begin{equation}
\dd{\abs{\bvec r - \bvec r_0(t_0)}} = \uvec u \vdot \dd{\bvec r} - \bvec u \vdot \dd{\bvec r_0} = \uvec u \vdot \dd{\bvec r} - \uvec u \vdot \bvec v_0 \dd{t_0}~.
\end{equation}
若要求 $\partial t_0 / \partial t$ （隐含 $\bvec r$ 不变）， 令 $\dd{\bvec r} = 0$
\begin{equation}
-\uvec u \vdot \bvec v_0 \dd{t_0} = v(\dd{t} - \dd{t_0})~.
\end{equation}
两边除以 $\dd{t}$， 得
\begin{equation}
\pdv{t_0}{t} = \frac{1}{1 + \uvec u \vdot \bvec v_0/v}~.
\end{equation}
要求 $\grad t_0$， 先令 $\dd{t} = 0~,$
\begin{equation}
\uvec u \vdot \dd{\bvec r} = -(v - \uvec u \vdot \bvec v_0) \dd{t_0}~.
\end{equation}
若假设波源速度不超过波速， 可以看出 $\dd{\bvec r}$ 沿 $-\uvec u$ 方向时 $\dd{t_0}$ 最大。 所以根据梯度的几何意义， $\grad t_0$ 的方向是 $-\uvec u$。 为了求梯度大小， 令 $\dd{\bvec r} = -\uvec u \dd{r}$， 代入得
\begin{equation}
\grad t_0 = -\uvec u \pdv{t_0}{r} = \frac{ - \uvec u}{v - \uvec u \vdot \bvec v_0}~.
\end{equation}
现在带回， 得
\begin{equation}
\omega_1 = \dv{\phi_1}{t} = \omega\qty(\grad t_0 \vdot \bvec v_1 + \pdv{t_0}{t}) = \omega \frac{v - \uvec u \vdot \bvec v_1}{v - \uvec u \vdot \bvec v_0}~,
\end{equation}
这就是一般的普勒效应公式。
