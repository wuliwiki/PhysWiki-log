% 分圆多项式和分圆域
% 分圆域|cyclotomy|域扩张|单位根|本原根|原根|primitive element|切圆域|割圆域|分圆多项式|切圆多项式|割圆多项式

\addTODO{预备知识待确定}

\pentry{本原多项式（线性代数）\upref{PPlyR}，Galois扩张\upref{GExt}}



$n$次\textbf{单位根}即形如$x^n-1$的多项式在$\mathbb{C}$中的根，可以理解为$1$的$n$次根。$\pm 1$都是$1$的$2^n$次根，$\pm \I$都是$1$的$4$次单位根，而$\omega=\frac{1}{2}\qty(-1+\I\sqrt{3})$是$1$的$3$次根。

本节将使用Galois理论来处理单位根及其最小多项式对有理数域的扩张，作为Galois理论的应用。


\subsection{分圆多项式}

任意$n$次单位根都形如$\exp{(2\pi\I\cdot  k/n)}$，其中$k$取从$1$到$k$的全体整数，即包括了所有$n$次单位根。如$4$次单位根构成的集合是$\{1, -1, \I, -\I\}$，而这四个元素又可以两两分组：$\pm 1$都可以是$2$次单位根\footnote{更细节些，$1$也是$1$次单位根。}，$\pm \I$是$4$次单位根。显然两组性质是不同的：$\mathbb{Q}(\pm 1)=\mathbb{Q}\subsetneq \mathbb{Q}(\pm\I)$。我们将这分类表述为以下定义：

\begin{definition}{本原单位根}\label{def_Cycltm_2}

当$n$与$k$互素时，称单位根$\exp{(2\pi\I\cdot  k/n)}$是\textbf{本原（primitive）}的。

\end{definition}

由互素的概念易知，$n$次\textbf{本原单位根}的全体幂，包含了全体$n$次\textbf{单位根}，即$n$次本原单位根至少要自乘$n$次才能变成$1$；而非本原的单位根则不然，如$3$次单位根自乘$3$次即可得到$1$，但它同时也是$6$次单位根。因此由分裂域的知识可知，非本原的单位根，其最小多项式不可能是$x^n-1$。为此，我们需要明确本原根所属的最小多项式。

\begin{definition}{分圆多项式}\label{def_Cycltm_1}

设$\{\varepsilon_i\}_{i\in S}$是全体$n$次\textbf{本原单位根}的集合，则称
\begin{equation}
\Phi_n(x)\in \mathbb{C}[x] = \prod_{i\in S}(x-\varepsilon_i)~.
\end{equation}
为$n$次\textbf{分圆多项式（cyclotomic polynomials）}，有时也译作“\textbf{切圆多项式}”或“\textbf{割圆多项式}”。

\end{definition}

取“分圆”之名，是指其将单位圆分割。英文cyclotomy取自“cycl-”和“-tomy”的组合，“cycl-”指“圆形的、环形的或旋转的”，而-tomy源自古希腊语“tomia”或其变形“tomnein”，指“切割”。




\begin{example}{分圆多项式的例子}\label{ex_Cycltm_1}

\begin{equation}
\Phi_1(x) = x-1
\end{equation}

\begin{equation}\label{eq_Cycltm_2}
\Phi_2(x) = x+1
\end{equation}

\begin{equation}
\Phi_3(x) = (x^3-1)/(x-1) = x^2+x+1
\end{equation}

\begin{equation}
\Phi_4(x) = (x^4-1)/(x^2-1) = x^2+1
\end{equation}

\begin{equation}
\Phi_5(x) = (x^5-1)/(x-1) = x^4+x^3+x^2+x+1~.
\end{equation}

% 注意后三个例子里，都除以了一个多项式。为什么这么做？

\end{example}

\begin{exercise}{}\label{exe_Cycltm_1}
请尝试算几个\autoref{ex_Cycltm_1} 中未列出的分圆多项式的例子。
\end{exercise}

更多的例子，可以参见维基百科\href{https://en.wikipedia.org/wiki/Cyclotomic_polynomial#Examples}{分圆域}，这也是\autoref{exe_Cycltm_1} 的部分答案。





\subsubsection{分圆多项式的基本性质}


下面列出分圆多项式的几个基本性质。

\begin{theorem}{}
任取正整数$n\geq 2, q\geq 2$，则$\Phi_n(x)\in\mathbb{R}[x]$，且$\Phi_n(q)>q-1$。
\end{theorem}

\textbf{证明}：

首先证明$\Phi_n(x)\in\mathbb{R}[x]$。

任取小于$n$的正整数$k$，则$k$与$n$互素当且仅当$n-k$与$n$互素。因此，$\exp{(2\pi\I\cdot  k/n)}$是本原的，当且仅当$\exp{(2\pi\I\cdot  (n-k)/n)}$是本原的。所以本原元素$\varepsilon_k$的共轭$\varepsilon_{n-k}$还是本原元素，从而
\begin{equation}\label{eq_Cycltm_1}
(x-\varepsilon_k)(x-\varepsilon_{n-k})=x^2-(\varepsilon_k+\varepsilon_{n-k})x+\varepsilon_n\varepsilon_{n-k}
\end{equation}
是\textbf{实系数}多项式。于是分圆多项式是由若干形如\autoref{eq_Cycltm_1} 或者形如$x+1$\footnote{即本原单位元的共轭就是自身的情况，而该情况只有\autoref{eq_Cycltm_2} 一种，所以$n>3$的情况都是本原元素成对出现的。}的多项式相乘而得，从而$\Phi_n(x)\in\mathbb{R}[x]$。

由于$q\geq 2$，且各$\Phi_n$的本原根$\varepsilon_k$满足$\abs{\varepsilon_k}=1$，$\varepsilon_k\neq 1$。因此$\abs{q-\varepsilon_k}>\abs{q-1}=q-1$，从而得$\Phi_k(q)>q-1$。


\textbf{证毕}。




\begin{theorem}{}\label{the_Cycltm_1}
\begin{equation}
x^n-1 = \prod_{d\mid n}\Phi_d(x)~.
\end{equation}

等价表述：不同次的\textbf{本原单位根}之间无交集，且全体满足$d\mid n$的$d$次\textbf{本原单位根}构成的集合，恰为全体$n$次\textbf{单位根}之集合。
\end{theorem}

\textbf{证明}：

\textbf{一个}$d_i$次\textbf{本原单位根}的幂遍历所有$d_i$次单位根，因此“一个$d_1$的本原单位根也是$d_2$的本原单位根”，当且仅当“$d_1=d_2$”，当且仅当“$d_1$和$d_2$的本原单位根完全一样”。于是得证“不同的次的\textbf{本原单位根}之间无交集”。

任取一个$n$次单位根$\varepsilon_k=\exp{(2\pi\I\cdot  k/n)}$，取$d=\opn{gcd}(n, k)$\footnote{即$n$与$k$的最大公因子（greatest common divisor）。}，则$\varepsilon_k$是一个$d$次本原单位根。从而任意$n$次单位根都是某个$d$次本原单位根，满足$d\mid n$，结合上一段的结论得证定理。

\textbf{证毕}。



\begin{theorem}{}\label{the_Cycltm_2}
$\Phi_n(x)$是首一整系数多项式。
\end{theorem}

\textbf{证明}：

由\autoref{def_Cycltm_1} ，首一是显然的。接下来用归纳法证明“整系数”。

由\autoref{ex_Cycltm_1} ，$\Phi_1$和$\Phi_2$都是整系数的。假设对于正整数$d$，所有满足$k<d$的$\Phi_k$都是整系数的，那么由\autoref{the_Cycltm_1} ，
\begin{equation}
x^{2d}-1 = f(x)\Phi_d(x)~,
\end{equation}
其中$f(x)$是首一整系数多项式。

由于$x^{2d}-1$和$f(x)$是\textbf{本原多项式}（\autoref{def_PPlyR_1}~\upref{PPlyR}），故$\Phi_d(x)$也是本原多项式，从而是整系数的。

\textbf{证毕}。




\begin{theorem}{}\label{the_Cycltm_5}
各$\Phi_n$皆是$\mathbb{Q}$上的不可约多项式。
\end{theorem}

\textbf{证明}：

反设$\Phi_n=f(x)g(x)$，其中$f$和$g$都是次数大于$0$的有理系数多项式。不妨\footnote{总可以选择$f$使之不可约，并且可以乘以一个正整数，将它化为本原多项式。}设$f$是\textbf{不可约本原多项式}，首项系数是$s$，则$g$的首项系数是$1/s$。

首先讨论$f$和$g$的关系。

由\autoref{the_Cycltm_2} ，$\Phi_n$也是本原多项式。于是由\autoref{lem_PPlyR_2}~\upref{PPlyR}，知$g(x)$应为本原多项式，故$1/s$也是整数，故$s=1$。因此$g$和$f$都是\textbf{首一}整系数多项式。

任取$\Phi_n$的一根$\varepsilon_i$，则由\autoref{def_Cycltm_2} 的互素条件可知，$\varepsilon_i$的全体幂包含了全体$n$次单位根。于是，任取$f$的一根$\alpha$和$g$的一根$\beta$，总存在正整数$k$使得$\beta=\alpha^k$，且$k$与$n$互素（因为$\beta$是本原单位根）。遍历$f$和$g$的所有根，挑出其中使得$k$\textbf{最小}的情况，设该情况为“取$f$的根$\alpha_0$和$g$的根$\beta_0$，则$\beta_0=\alpha_0^k$”。由于$\alpha_0\neq \beta_0$，知$k>1$。

设素数$p$满足$p\mid k$，则$p\not\mid n$\footnote{这一条会在证明的最后一段用到。}，因此$\alpha_0^p$是$n$次本原单位根。显然，$\Phi_n(\alpha_0^p)=0$，即$f(\alpha_0^p)$和$g(\alpha_0^p)$中至少一个为零。

设$\alpha_0^p$是$f$的根，那么$\beta_0=\alpha_0^k=(\alpha_0^p)^{k/p}$。由于$k/p<k$，故这违反了“$k$最小”的假设，因此$f(\alpha_0^p)\neq 0$。因此$\alpha_0^p$是$g$的根。又因为“$k$最小”的假设，知$k=p$。

由于$f$不可约，可知$f=\opn{Irr}(\alpha_0, \mathbb{Q})$；又因为$g(\alpha_0^p)=0$，可知$f(x)\mid g(x^p)$。设$g(x^p)=f(x)h(x)$。由于$g(x)$是首一整系数的，故$g(x)$是本原多项式，故$g(x^p)$是本原多项式。由\autoref{lem_PPlyR_2}~\upref{PPlyR}，$h(x)$也是本原多项式。

接下来利用上述讨论所得，完成证明。

考虑商映射$\pi:\mathbb{Z}\to\mathbb{Z}/p\mathbb{Z}$，其中$\pi(a)=\bar{a}$。于是$\pi$可以扩展为$\mathbb{Z}[x]\to\mathbb{Z}/p\mathbb{Z}[x]$的映射，也用$\bar{f}$来表示$\pi(f)$。设$g(x)=\sum_i c_ix^i$，记$\bar{g}(x)=\pi(g)(x)=\sum_i \bar{c_i}x^i$。

由于$\mathbb{Z}/p\mathbb{Z}$上任意元素$\bar{a}$都满足$\bar{a}^p=\bar{a}$，故$\qty(\bar{g}(x))^p=\sum_i\bar{c_i}^px^{pi}=\sum_i \bar{c_i}(x^p)^i=\bar{g}(x^p)$。

由于$f(x)\mid g(x^p)$，故$\bar{f}(x)\mid \bar{g}(x^p)$，故$\bar{f}(x)\mid \qty(\bar{g}(x))^p$。所以，$\bar{\Phi}=\bar{f}\bar{g}$在\textbf{其}在$\mathbb{Z}/p\mathbb{Z}$的分裂域上\textbf{有重根}。

已知$\Phi$是可分多项式，无重根，因此由\autoref{cor_SprbEx_2}~\upref{SprbEx}，知$\opn{D}\Phi\neq 0$。由于$p\not\mid n$，而$\Phi(x)$的最高次单项式为$x^n$，故$\opn{D}x^n=nx^{n-1}\implies \opn{D} \bar{1}x^n=\bar{n}x^{n-1}\neq 0$，故$\opn{D}\bar{\Phi}\neq 0$。因此$\bar{\Phi}$也\textbf{无重根}。这和上一段的结论矛盾，因此整个反设不成立。

\textbf{证毕}。



\begin{theorem}{}
对于素数$p$，$\Phi_p(x)=x^{p-1}+x^{p-2}+\cdots+x+1$。
\end{theorem}

\textbf{证明}：

由于$p$是素数，因此除了$1$以外的所有$p$次单位根都是本原单位根。因此
\begin{equation}
\Phi_p(x) = (x^p-1)/(x-1) = x^{p-1}+x^{p-2}+\cdots+x+1~.
\end{equation}

\textbf{证毕}。






\begin{theorem}{}
$\Phi_n(0)=\pm 1$，且对于$n>1$，总有$\Phi(0)=1$。
\end{theorem}

\textbf{证明}：

$\Phi_n(0)$就是全体$n$次本原单位根的积。记$\varepsilon=\exp{2\pi\I/n}$，则$\varepsilon^k$是$n$次本原单位根，当且仅当$k$与$n$互素。

由于单位根的模都是$1$，故其积的模也是$1$。全体$n$次本原单位根之积是$\Phi_n(x)$的常数项，由\autoref{the_Cycltm_2} ，是整数。因此必为$\pm 1$。

由于$k$与$n$互素当且仅当$n-k$与$n$互素，故本原单位根的还是本原单位根。当$n>1$时，要么$n$为奇数，则$(-1)^n\neq 0$；要么$n$为偶数，则$2$和$n$不互素，故$-1$不是$n$次本原单位根。所以$n>1$时$-1$不是$n$次本原单位根。于是本原单位根以共轭形式成对出现，每对的乘积都是$1$。

\textbf{证毕}。















为了进一步讨论分圆多项式的性质，我们需要回顾\textbf{Möbius函数（数论）}\upref{MbusF}中的一些概念：




\begin{definition}{Möbius函数\footnote{见\autoref{def_MbusF_1}~\upref{MbusF}。}}
Möbius函数$\mu:\mathbb{N}\to\{-1, 0, 1\}$定义为：
\begin{equation}
\mu(\prod_{k=1}^r p_k^{f_k})=
\leftgroup{
    1, \quad\text{如果}\prod_{k=1}^r p_k^{f_k}=1\\
    (-1)^r, \quad\text{如果}f_k=1\text{恒成立}\\
    0, \quad\text{如果有一个}f_k>1
}~.
\end{equation}

其中各$f_k$为正整数，$p_k$为互不相同的素数。

\end{definition}




\begin{lemma}{Möbius反演公式\footnote{见\autoref{the_MbusF_3}~\upref{MbusF}}}\label{lem_Cycltm_1}
取映射$f:\mathbb{Z}^+\to\mathbb{Z}^+$，令$S(n)=\sum_{d\mid n}f(d)$，$P(n)=\prod_{d\mid n}f(d)$。则有
\begin{equation}
f(n) = \sum_{s\mid n}\mu(s)S\qty(\frac{n}{s})~,
\end{equation}
和
\begin{equation}
f(n) = \prod_{s\mid n}\qty(P(\frac{n}{s}))^{\mu(s)}~.
\end{equation}
\end{lemma}






有了Möbius函数的概念，我们可以得到一个重要的性质：



\begin{theorem}{Möbius函数表示分圆多项式}\label{the_Cycltm_4}
\begin{equation}\label{eq_Cycltm_5}
\Phi_n(x) = \prod_{d\mid n}(x^d-1)^{\mu(n/d)}~.
\end{equation}
\end{theorem}


\textbf{证明}：

由\autoref{the_Cycltm_1} ，
\begin{equation}\label{eq_Cycltm_4}
x^n-1 = \prod_{d\mid n}\Phi_d(x)~.
\end{equation}

又由\autoref{lem_Cycltm_1} ，令$f(n)=\Phi_n(x)$，其中$x$是\textbf{任意}正整数，于是有
\begin{equation}\label{eq_Cycltm_3}
\begin{aligned}
\Phi_n(x)&=\prod_{s\mid n}\qty(\prod_{k\mid \frac{n}{s}}\Phi_k(x))^{\mu(s)}\\
&=\prod_{s\mid n}\qty(x^{n/s}-1)^{\mu(s)}\\
&=\prod_{d\mid n}\qty(x^{d}-1)^{\mu(n/d)}~,
\end{aligned}
\end{equation}

再由$x$的任意性得证。

\autoref{eq_Cycltm_3} 第二个等号即为\autoref{eq_Cycltm_4} ；第三个等号是作代换$d=n/s$的结果，这也说明\autoref{eq_Cycltm_5} 有两种表达方式，另一种右边是$\prod_{s\mid n}\qty(x^{n/s}-1)^{\mu(s)}$。

\textbf{证毕}。











\begin{theorem}{}\label{the_Cycltm_3}
设$n$是一正整数，其质因数分解为$n=\prod_{k=1}^r p_k^{f_k}$，其中$f_k$是正整数，$p_k$是互不相同的素数。

任取$m=\prod_{k=1}^r p_k^{g_k}$，其中$1\leq g_k\leq f_k$，则有
\begin{equation}
\Phi_n(x) = \Phi_m(x^{n/m})~.
\end{equation}
\end{theorem}

\textbf{证明}：

由\autoref{the_Cycltm_4} ，
\begin{equation}
\Phi_n(x) = \prod_{d\mid n}(x^d-1)^{\mu(n/d)}~.
\end{equation}
故
\begin{equation}\label{eq_Cycltm_6}
\begin{aligned}
\Phi_m(x^{n/m}) &= \prod_{s\mid m}(x^{ns/m}-1)^{\mu(m/s)}\\
&=\prod_{d\mid n}(x^{d}-1)^{\mu(n/d)}~,
\end{aligned}
\end{equation}

\autoref{eq_Cycltm_6} 第三个等号是进行代换$d=ns/m$的结果。

% 由此定义，任取正整数$d\mid n$，如果$d\not\mid m$，那么必有$\mu(d)=0$。

\textbf{证毕}。








由\autoref{the_Cycltm_3} 直接可得以下推论：

\begin{corollary}{}\label{cor_Cycltm_1}
对于素数$p$，$\Phi_{p^k}(x) = \Phi_p(x^{p^{k-1}})$
\end{corollary}




\begin{example}{\autoref{cor_Cycltm_1}  的实例}
\begin{equation}
\leftgroup{
    \Phi_2(x) &= x+1\\
    \Phi_4(x) &= x^2+1\\
    \Phi_8(x) &= x^4+1\\
    \Phi_{16}(x) &= x^8+1
}~.
\end{equation}
\begin{equation}
\leftgroup{
    \Phi_3(x) &= x^2+x+1\\
    \Phi_9(x) &= x^6+x^3+1\\
    \Phi_{27}(x) &= x^{18}+x^9+1
}~.
\end{equation}
\end{example}




\subsection{分圆域}

\begin{definition}{}
设$\varepsilon_n$是一个$n$次本原单位根，则$\mathbb{Q}(\varepsilon_n)$被称为$n$次\textbf{分圆域（cyclotomic field）}。
\end{definition}


\begin{theorem}{}
分圆域$\mathbb{Q}(\varepsilon_n)$是有理数域$\mathbb{Q}$的Galois扩张，$[\mathbb{Q}(\varepsilon_n):\mathbb{Q}]=\deg \Phi_n$，且$\opn{Gal}(\mathbb{Q}(\varepsilon_n):\mathbb{Q})\cong U_n$。

其中$U_n$是环$\mathbb{Z}/n\mathbb{Z}$中全体有乘法逆元的元素\footnote{这样的元素又称\textbf{单位}（\autoref{def_FctTre_3}~\upref{FctTre}）。}。
\end{theorem}

\textbf{证明}：

由\autoref{the_Cycltm_5} ，$\opn{Irr}(\varepsilon_n, \mathbb{Q})=\Phi_n$。由于$\varepsilon_n$的幂能生成所有$n$次单位根，也包括$\Phi_n$的所有根，故$[\mathbb{Q}(\varepsilon_n):\mathbb{Q}]$是正规扩张。由于$\mathbb{Q}$是完美域，故$[\mathbb{Q}(\varepsilon_n):\mathbb{Q}]$是正规扩张。因此$[\mathbb{Q}(\varepsilon_n):\mathbb{Q}]$是Galois扩张。

又由\autoref{the_FldExp_1}~\upref{FldExp}，得证$[\mathbb{Q}(\varepsilon_n):\mathbb{Q}]=\deg \Phi_n$。

记$\mathbb{Z}/n\mathbb{Z}=\{\bar{i}\}_{i=0}^{n-1}$。它同构于$C=\langle \varepsilon_n \rangle$，全体$n$次单位根构成的乘法群。

$\Phi_n$的根的置换，必是$C$到自身的一个自同构。又因为$C$到自身的自同构不改变元素的阶，且$n$次单位根本原当且仅当它是$n$阶的，故$C$到自身的自同构都是本原单位根的置换。因此$\opn{Gal}(\mathbb{Q}(\varepsilon_n):\mathbb{Q})\cong \opn{Aut}C$，即$C$的自同构群。

又由于$\varepsilon_n$是本原单位根，是$C$的生成元，因此$C$的自同构$\sigma$由$\sigma(\varepsilon_n)$唯一确定。记$\sigma_k(\varepsilon_n)=\varepsilon_n^{k+1}$，则$\sigma_k(\alpha)=\alpha\varepsilon_n^k$。

则$\sigma\in \opn{Aut}C$当且仅当$k$与$n$互素（保证$\varepsilon_n^k$是本原单位根）。于是各$\sigma_k$对应各$\bar{k}\in\mathbb{Z}/n\mathbb{Z}$，而“$k$与$n$互素”当且仅当$\bar{k}$有乘法逆元。从而得证$\opn{Aut}C=U_n$。

\textbf{证毕}。
































