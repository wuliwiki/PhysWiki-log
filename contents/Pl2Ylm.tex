% 平面波的球谐展开
% 复数|平面波|球谐波|归一化|球谐展开函数|傅里叶变换

\pentry{球谐函数\upref{SphHar}， 球贝塞尔函数\upref{SphBsl}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Plane_wave_expansion}{相关页面}及参考文献．}复数形式的归一化平面波可以展开为\autoref{SphHar_eq9}~\upref{SphHar} 的形式：
\begin{equation}\label{Pl2Ylm_eq1}
\ket{\bvec k} = \frac{1}{(2\pi)^{3/2}}\E^{\I \bvec k \vdot \bvec r} = \sqrt{\frac{2}{\pi}} \sum_{l=0}^{\infty} \I^l  j_l(kr) \sum_{m=-l}^l Y_{l,m}^*(\uvec k) Y_{l,m}(\uvec r)
\end{equation}
推导见下文． 由 $Y_{l,m}^* = (-1)^m Y_{l,-m}$ 易证这里的复共轭可以加在任意一个球谐函数上． 另外由 $Y_{l,m}(-\uvec k) = (-1)^l Y_{l,m}(\uvec k)$ 易得 $\ket{\bvec k}\Cj = \ket{-\bvec k}$．

可以证明， 一组正交归一的球面波基底为（见 “径向函数的归一化\upref{FrNorm}”）
\begin{equation}
\ket{s_{l,m}(k)} = s_{l,m}(k,\bvec r) = \frac{1}{r}\sqrt{\frac{2}{\pi}}kr j_l(kr) Y_{l,m}(\uvec r)
\end{equation}
平面波\autoref{Pl2Ylm_eq1} 可以表示为相同能量球谐波的线性组合
\begin{equation}\label{Pl2Ylm_eq3}
\ket{\bvec k} = \sum_{l,m}\frac{\I^l}{k} Y_{l,m}^*(\uvec k)\ket{s_{l,m}(k)} 
\end{equation}

\subsubsection{其他形式}
根据\autoref{SphHar_eq10}~\upref{SphHar}， 令 $\alpha$ 为 $\uvec k, \uvec r$ 的夹角， \autoref{Pl2Ylm_eq1} 也可以记为
\begin{equation}\label{Pl2Ylm_eq2}
\ket{\bvec k} = \frac{1}{(2\pi)^{3/2}} \sum_{l=0}^{\infty} \I^l (2l+1) j_l(kr) P_l(\cos\alpha)
\end{equation}

\subsection{球谐展开函数的傅里叶变换}
\pentry{多元傅里叶变换\upref{NFTran}}

若三维函数具有球谐展开的形式
\begin{equation}
f(\bvec r) = \frac{1}{r}\sum_{l,m} u_{l,m}(r) Y_{l,m}(\uvec r)
\end{equation}
要做三维傅里叶变换
\begin{equation}
g(\bvec k) = \braket{\bvec k}{f} =  \frac{1}{(2\pi)^{3/2}} \int f(\bvec r) \E^{-\I \bvec k \bvec r} \dd[3]{r}
\end{equation}
将\autoref{Pl2Ylm_eq3} 代入上式得
\begin{equation}
g(\bvec k) = \frac{1}{k} \sum_{l,m} g_{l,m}(k)  Y_{l,m}(\uvec k) 
\end{equation}
其中
\begin{equation}
g_{l,m}(k) = \sqrt{\frac{2}{\pi}} \I^{-l} \int_0^{+\infty} u_{l,m}(r) kr j_l(kr) \dd{r}
\end{equation}
于是 $f(\bvec r)$ 可分解为平面波
\begin{equation}
f(\bvec r) = \int g_{l,m}(k) \ket{\bvec k} \dd[3]{k}
\end{equation}

\begin{example}{类氢原子基态的动量谱}\label{Pl2Ylm_ex1}
类氢原子基态的波函数为（见\autoref{HWF_eq3}~\upref{HWF}， 使用原子单位）
\begin{equation}
\psi(\bvec r) = \frac{Z^{3/2}}{\sqrt\pi} \E^{-Zr}
\end{equation}
显然只有 $l = 0, m = 0$ 球谐项． 而 $Y_{0,0} = 1/\sqrt{4\pi}$， 所以径向波函数为
\begin{equation}
R_{00}(r) = 2 Z^{3/2} \E^{-Zr}
\end{equation}
所以傅里叶变换为（注意 $j_0(x) = \sin x/x$）
\begin{equation}
g(\bvec k) = \frac{\sqrt{2}}{k\pi} \int_0^\infty \E^{-r} \sin(kr) r \dd{r} = \frac{2\sqrt{2}}{\pi(k^2+1)^2}
\end{equation}
\begin{equation}
g(\bvec k) = \qty(\frac{2}{Z})^{3/2} \frac{1}{\pi(k^2/Z^2 + 1)^2}
\end{equation}
我们也可以将沿 $z$ 轴正方向的三维平面波用球坐标表示（不使用球谐函数）， 再在球坐标中与波函数积分， 结果相同．
\end{example}

\subsection{推导}
理论上， \autoref{Pl2Ylm_eq1} 可以通过计算\autoref{SphHar_eq7}~\upref{SphHar} 得到， 但这个积分较为复杂， 可能需要借助 Mathematica 等工具\footnote{其实 Mathematica 也只能算给定的 $l, m$．}
\begin{equation}
\begin{aligned}
&\quad \int Y_{l,m}^*(\uvec r)\E^{\I \bvec k \vdot \bvec r} \dd{\Omega}\\
&= A_{l,m}\int_0^\pi \sin\theta\dd{\theta} \int_0^{2\pi} \dd{\phi} \,\,P_l^m(\cos\theta) \E^{-\I m \phi}\\
&\times \exp[\I (k_x r \sin\theta\cos\phi + k_y r \sin\theta\sin\phi + k_z r \cos\theta)]
\end{aligned}
\end{equation}
但从\autoref{Pl2Ylm_eq2} 可以知道我们只需要证明 $\bvec k$ 延 $\uvec z$ 方向的情况， 令 $\theta = \alpha$ 即可， 也就是上式中 $k_x = 0, k_y = 0, k_z = k$． 由对称性， $m \ne 0$ 时积分都是 0， 所以
\begin{equation}
\begin{aligned}
\int Y_{l,0}^*(\uvec r)\E^{\I \bvec k \vdot \bvec r} \dd{\Omega}
&= 2\pi A_{l,m}\int_0^\pi P_l(\cos\theta) \exp[\I (k r \cos\theta)] \sin\theta\dd{\theta}\\
&= 2\pi A_{l,m}\int_{-1}^1 P_l(x) \exp[\I (k r x)] \dd{x}
\end{aligned}
\end{equation}
由\autoref{Legen_eq3}~\upref{Legen} 得
\begin{equation}
\int Y_{l,0}^*(\uvec r)\E^{\I \bvec k \vdot \bvec r} \dd{\Omega}
= 4\pi A_{l,m} \I^l j_l(\rho)
= \sqrt{4\pi (2l + 1)}\ \I^l j_l(\rho)
\end{equation}
所以
\begin{equation}
\E^{\I \bvec k \vdot \bvec r} = \sum_{l,m} \sqrt{4\pi (2l + 1)}\ \I^l j_l(\rho) Y_{l,m}(\uvec r)
=\sum_{l,m} (2l + 1) \I^l j_l(\rho) P_l(\cos\alpha)
\end{equation}
证毕．

\subsection{推导 2}
另一种方法是把平面波看作三维亥姆霍兹方程的解
\addTODO{引用三维直角坐标的亥姆霍兹方程}
\begin{equation}
\laplacian \psi_{\bvec k}(\bvec r) + k^2 \psi_{\bvec k}(\bvec r) = 0
\end{equation}
的解． 这也是定态薛定谔方程\upref{SchEq}势能为零的一个解． 在球坐标系中解亥姆霍兹方程\upref{SphHHz} 得通解为
\begin{equation}
f(\bvec r) = \sum_{l,m} [A_l j_l(kr) + B_l y_l(kr)] Y_{l,m}(\uvec r)
\end{equation}
由于第二类球贝塞尔函数\upref{SphBsl} $y_l(kr)$ 在 $r\to 0$ 时有奇点， 所以 $B_l = 0$． 而第一类球贝塞尔函数 $j_l$ 在 $r\to \infty$ 时有渐进形式（\autoref{SphBsl_eq2}~\upref{SphBsl}）
\begin{equation}
j_l(x) \to \sin(x - l\pi /2)/x
\end{equation}
在 $r\to 0$ 匹配相位即可得到 $A_l$．
\addTODO{具体如何匹配？}
