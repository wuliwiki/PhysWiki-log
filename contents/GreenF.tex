% 格林函数解线性非齐次微分方程

\pentry{狄拉克 delta 函数\upref{Delta}}

区间 $(a,b)$ 的非齐次线性微分方程可记为
\begin{equation}\label{GreenF_eq5}
\Q Q y(x) = f(x)
\end{equation}
其中 $\Q Q$ 是线性微分算符． 令格林函数为 $G(x', x)$ 满足
\begin{equation}\label{GreenF_eq7}
\Q Q G(x', x) = \delta(x - x') \qquad (a < x' < b)
\end{equation}
那么方程的解为
\begin{equation}\label{GreenF_eq4}
y(x) = \int_a^b f(x') G(x', x) \dd{x'}
\end{equation}
证明见下文．

对偏微分方程， 把以上的 $f(x), y(x)$ 变为多元函数 $f(\bvec r), y(\bvec r)$， 算符 $\Q Q$ 变为线性偏微分算符， $\delta$ 函数变为多元狄拉克 $\delta$ 函数\upref{deltaN} $\delta(\bvec r - \bvec r')$， 积分变为重积分即可．

\subsection{例子： 弦的受力平衡}
\pentry{分部积分法\upref{IntBP}， 方程 $y^{(N)}=f(x)$\upref{ynfx}}

一根两端固定的弦两端固定在 $x$ 轴上， 区间为 $[0, L]$， 张力为 $T$， 形状为 $y(x)$， 边界条件为 $y(0) = y(L) = 0$． 在弦上有 $y$ 方向的连续受力分布， 若弦的受力密度函数为 $f(x)$， 即单位长度受到的 $y$ 方向的力， 那么当 $\abs{f(x)} \ll T$ 时有方程（推导过程类比 “一维波动方程\upref{WEq1D}”）
\begin{equation}\label{GreenF_eq1}
-T y'' = f(x)
\end{equation}

虽然该方程可以直接对两边积分两次得到解（两个积分常数由边界条件确定）
\begin{equation}\label{GreenF_eq14}
y(x) = -\frac{1}{T}\iint f(x) \dd{x}\dd{x} + C_1 x + C_2
\end{equation}
但为了教学我们用格林函数法． 先令格林函数 $G(x', x)$ 满足
\begin{equation}\label{GreenF_eq2}
-T G''(x', x) = \delta(x - x') \qquad (0 < x' < L)
\end{equation}
方程右边是狄拉克 $\delta$ 函数\upref{Delta}． 且同样有边界条件 $G(x', a) = G(x', b) = 0$． 这相当于弦上只有一点 $x'$ 受大小为 $F = 1$ 的力．

解出格林函数后， $f(x)$ 可以分解为许多不同位置的 $\delta$ 函数的线性组合（积分）
\begin{equation}
f(x) = \int_0^L f(x') \delta(x - x') \dd{x'}
\end{equation}
由于\autoref{GreenF_eq1} 的方程是线性的， 那么把 $G(x', x)$ 做同样的线性组合就是满足边界条件的解
\begin{equation}\label{GreenF_eq3}
y(x) = \int_0^L f(x') G(x', x) \dd{x'}
\end{equation}

现在来解\autoref{GreenF_eq2}， 事实上我们可以直接从受力分析上得出格林函数 $G(x', x)$ 是一个三角形， 顶点的位置为 $x = x'$， 令高为 $h = y(x')$ 由受力分析可得
\begin{equation}
T\frac{h}{x'} + T\frac{h}{L - x'} = F = 1
\end{equation}
\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/GreenF_1.pdf}
\caption{受力分析示意图} \label{GreenF_fig1}
\end{figure}
即
\begin{equation}\label{GreenF_eq11}
h = \frac{x' (L - x')}{LT}
\end{equation}
即格林函数为
\begin{equation}
G(x', x) = \leftgroup{
&\frac{L-x'}{LT}x \qquad (0 < x \le x')\\
&\frac{L-x}{LT}x' \qquad (0 < x \le x') \qquad (x' < x)
}\end{equation}
代入\autoref{GreenF_eq3} 得
\begin{equation}\label{GreenF_eq12}
y(x) = \int_0^x f(x') \frac{L-x}{LT}x'\dd{x'} + \int_x^L f(x')\frac{L-x'}{LT}x \dd{x'}
\end{equation}
由分部积分法\upref{IntBP} （对 $f(x')$ 积分， 剩下部分求导）可得\autoref{GreenF_eq14}． 分部积分留做习题， 其中 $C_1$ 和 $C_2$ 的取值需要保证边界条件 $y(0) = y(L) = 0$．

\subsubsection{不用受力分析求解格林函数}
对\autoref{GreenF_eq2} 在 $(0, x')$ 做两次定积分可以得到一条以 $(0,0)$ 为起点的斜线， 同理， 在 $(x', L)$ 两次定积分可以得到以 $(L, 0)$ 为终点的斜线． 而在 $(x-\epsilon, x+\epsilon)$ 积分 并取 $\epsilon\to 0$ 可以得到斜率 $y'$ 在 $x'$ 左侧到右侧的变化
\begin{equation}
-T\Delta y' = 1 \Longrightarrow \Delta y' = -\frac{1}{T}
\end{equation}
解三角形可得\autoref{GreenF_eq11}．

\begin{exercise}{受力均匀的弦}
若\autoref{GreenF_eq1} 中， $f(x) = 1$， 即弦均匀向上受力， 求弦的方程 $y(x)$． 分别使用\autoref{GreenF_eq12} 和\autoref{GreenF_eq14} 两种方法．

答案： 开口向下的抛物线．
\end{exercise}

\subsection{证明}
要证明\autoref{GreenF_eq4} 是方程\autoref{GreenF_eq5} 的解， 把前者代入后者， 即证
\begin{equation}
\Q Q \int_a^b f(x') G(x', x) \dd{x'} = f(x)
\end{equation}
$\Q Q$ 是关于 $x$ 的微分算符， 与 $x'$ 无关， $f(x')$ 对 $\Q Q$ 来说可以看作线性组合的常系数， 又由于 $\Q Q$ 是线性算符， 可以放到线性组合（积分）内部
\begin{equation}\label{GreenF_eq6}
\begin{aligned}
&\Q Q \int_a^b f(x') G(x', x) \dd{x'} = \int_a^b f(x') \Q QG(x', x)\dd{x'}\\
&= \int_a^b f(x') \delta(x - x') \dd{x'} = f(x)
\end{aligned}
\end{equation}
证毕．

\subsubsection{形象的证明}
若 $G_i(x)$ 是非齐次项 $f_i(x)$ 的解（$i = 1,2,\dots, n$）， 即
\begin{equation}\label{GreenF_eq8}
\Q Q G_i(x) = f_i(x)
\end{equation}
那么因为算符 $\Q Q$ 是线性的， 就有
\begin{equation}\label{GreenF_eq9}
\Q Q\sum_i c_i G_i(x) = \sum_i c_i \Q Q G_i(x) = \sum_i c_i f_i(x)
\end{equation}
如果我们能找到满足条件的 $c_i$ 和 $f_i(x)$ 使得
\begin{equation}\label{GreenF_eq10}
f(x) = \sum_i c_i f_i(x)
\end{equation}
那么根据\autoref{GreenF_eq9}， 方程的解就是 $G_i$ 做同样的线性组合
\begin{equation}
y(x) = \sum_i c_i G_i(x)
\end{equation}

当我们像定积分那样用许多小长方形来代替函数 $f(x)$： 每个 $f_i(x)$ 看成一个宽为 $\Delta x$， 中心位置在 $x'$ 的长方形函数， 面积为 1． 那么方程的解就是每个小长方形对应的解 $G_i(x)$ 做同样的线性组合． 当小长方形越来越细， $f_i(x)$ 就变成了 $\delta(x - x')$ 以上的求和就变为了积分．

于是\autoref{GreenF_eq8} 就变为\autoref{GreenF_eq7}， 而\autoref{GreenF_eq9} 和\autoref{GreenF_eq10} 变为积分就是\autoref{GreenF_eq6}． 
