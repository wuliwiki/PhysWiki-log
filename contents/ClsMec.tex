% 正则变换 2
% keys 正则动量|拉格朗日方程形式不变性|泊松括号|正则坐标
% license Xiao
% type Tutor

\begin{issues}
\issueDraft
\end{issues}

\pentry{泊松括号\upref{poison}}

首先回顾拉格朗日方程\upref{Lagrng}为
\begin{equation}
\dv{t} \pdv{L}{\dot q_i}  = \pdv{L}{q_i} ~, \qquad L(q,\dot q, t) = T - V~.
\end{equation}
正则动量为 $p_i = \pdv*{L}{\dot q_i}$， 广义力为 $\pdv*{L}{q_i}$，  拉氏方程就是广义力与正则动量的牛顿第二定律。 对于任何广义坐标， 拉格朗日方程的形式不变。

勒让德变换后， 得到哈密顿正则方程为
\begin{equation}
\dot q_i = \pdv{H}{p_i} ~,\qquad
\dot p_i = -\pdv{H}{q_i}~,
\end{equation} 
其中 $H(p,q) = T + V$。 我们通常简记 $q_1, \dots, q_N$ 为 $q$， 简记 $\dot q_1, \dots, \dot q_N$ 为 $\dot q$。

\subsection{正则变换}

若广义坐标 $q$ 变换到另一套广义坐标 $q'$， 假设变换不显含时间， 每个 $q_k$ 都是新坐标的函数 $q_k(q')$， 有
\begin{equation}
\dot q_i = \sum_j \pdv{q_i}{q'_j} \dot q'_j~,
\end{equation}
所以
\begin{equation}
\pdv{\dot q_k}{\dot q'_i} = \pdv{q_k}{q'_i}~.
\end{equation}
另外可见广义速度的变换也和广义坐标有关： $\dot q_i = \dot q_i(q', \dot q')$。

拉格朗日量是系统的状态量， 所以 $L(q',\dot q', t) = L[q(q'),\dot q(q',\dot q'), t]$，  所以
\begin{equation}
p'_i = \pdv{L}{\dot q'_i} = \sum_k \pdv{L}{\dot q_k} \pdv{\dot q_k}{\dot q'_i}  = \sum_k \pdv{q_k}{q'_i} p_k~,
\end{equation}
这就从坐标变换推出了动量变换。 对于任何广义坐标以及对应的正则动量， 哈密顿方程的形式不变（因为拉格朗日方程的形式不变， 哈密顿方程是由拉格朗日方程推出来的）， 也有其他情况也不变。 所有使正则方程成立的坐标叫做\textbf{正则坐标（canonical coordinates）}。 下面推导判断正则坐标的一般条件。

对于不显含时的物理量 $\omega(q, p)$， 有（\autoref{eq_poison_10}~\upref{poison}）
\begin{equation}
\dot \omega  = \pb{\omega}{H}  = \sum_i \qty(\pdv{\omega}{q_i}\pdv{H}{p_i} - \pdv{H}{q_i} \pdv{\omega}{p_i})~.
\end{equation}
现在若把 $H$ 看成是 $H[q'(q,p),p'(q,p)]$，  
\begin{equation}
\pdv{H}{p_i} = \sum_k \pdv{H}{q'_k} \pdv{q'_k}{p_i} + \pdv{H}{p'_k} \pdv{p'_k}{p_i}~,
\end{equation}
\begin{equation}
\pdv{H}{q_i} = \sum_k \pdv{H}{q'_k} \pdv{q'_k}{q_i} + \pdv{H}{p'_k} \pdv{p'_k}{q_i}~.
\end{equation}
代入并对 $H$ 的偏微分合并同类项得
\begin{equation}
\dot \omega  = \pb{\omega}{H} = \sum_k \qty[ \pdv{H}{q'_k} \pb{\omega}{q'_k} + \pdv{H}{p'_k} \pb{\omega}{p'_k}]~.
\end{equation}
注意泊松括号是对 $q,p$ 进行偏微分， 记为 $\{ {}\}_{q,p}$。  分别代入 $\omega  = q'_i, p'_i$，  得到转换坐标后的哈密顿方程的一般形式。 为了保持正则方程的形式， 必须要求
\begin{equation}
\pb{q'_i}{q'_k}_{q,p} = \pb{p'_i}{p'_k}_{q,p} = 0~,
\end{equation}
\begin{equation}\label{eq_ClsMec_2}
\pb{q'_i}{p'_k}_{q,p} = \delta_{ik}~,
\end{equation}
这就是\textbf{判断正则变换的一般条件}。

可以证明， 用任何正则坐标作为泊松括号的角标， 其值都不变：
\begin{equation}\label{eq_ClsMec_1}
\pb{u}{v}_{q,p} = \sum_i \qty( \pdv{u}{q_i}\pdv{v}{p_i} - \pdv{v}{q_i}\pdv{u}{p_i} ) ~.
\end{equation}
其中
\begin{equation}
\pdv{u}{q_i} \pdv{v}{p_i} = \sum_j \qty( \pdv{u}{q'_j} \pdv{q'_j}{q_i} + \pdv{u}{p'_j}\pdv{p'_j}{q_i} ) \sum_k \qty(\pdv{v}{q'_k}\pdv{q'_k}{p_i} + \pdv{v}{p'_k}\pdv{p'_k}{p_i}) ~,
\end{equation}
\begin{equation}
\pdv{v}{q_i} \pdv{u}{p_i} = \sum_k \qty( \pdv{v}{q'_k}\pdv{q'_k}{q_i} + \pdv{v}{p'_k}\pdv{p'_k}{q_i} ) \sum_j \qty(\pdv{u}{q'_j}\pdv{q'_j}{p_i} + \pdv{u}{p'_j}\pdv{p'_j}{p_i})~.
\end{equation}
 
现在我们要得到 $\pb{u}{v}_{q',p'} = \sum_i \qty(\pdv{u}{q'_i}\pdv{v}{p'_i} - \pdv{v}{q'_i} \pdv{u}{p'_i})$，  可以把上两式代入\autoref{eq_ClsMec_1} 后对 $\pdv{u}{q'}\pdv{v}{p'}$ 和 $\pdv{v}{q'_i}\pdv{u}{p'_i}$ 合并同类项， 得
\begin{equation}\ali{
\pb{u}{v}_{q,p} & = \sum_{jk} \pdv{u}{q'_j} \pdv{v}{p'_k} \sum_i \qty( \pdv{q'_j}{q_i}\pdv{p'_k}{p_i} -\pdv{p'_k}{q_i}\pdv{q'_j}{p_i} )  \\
& -\sum_{jk} \pdv{v}{q'_k}\pdv{u}{p'_j} \sum_i \qty( \pdv{q'_k}{q_i}\pdv{p'_j}{p_i} - \pdv{p'_j}{q_i}\pdv{q'_k}{p_i} )   \\
&= \sum_{jk} \pdv{u}{q'_j} \pdv{v}{p'_k} \pb{q'_j}{p'_k}_{q,p}  - \sum_{jk} \pdv{v}{q'_k} \pdv{u}{p'_j} \pb{q'_k}{p'_j}_{q,p}~.
}\end{equation}
代入正则坐标条件（\autoref{eq_ClsMec_2} ）， 得
\begin{equation}\ali{
\pb{u}{v}_{q,p} & = \sum_{jk} \pdv{u}{q'_j}\pdv{v}{p'_k}\delta_{jk}  - \sum_{jk}\pdv{v}{q'_k} \pdv{u}{p'_j} \delta_{jk} = \sum_j \qty( \pdv{u}{q'_j}\pdv{v}{p'_j} - \pdv{v}{q'_j}\pdv{u}{p'_j} )  \\
&= \pb{u}{v}_{q',p'}~.
}\end{equation}
证毕。
