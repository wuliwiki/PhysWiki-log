% 正交归一基底
% keys 线性代数|向量|克罗内克 delta 函数
% license Xiao
% type Tutor

\begin{issues}
\issueTODO
\end{issues}

\pentry{基底（线性代数）\nref{nod_VecSpn}，内积、内积空间\nref{nod_InerPd}}{nod_f662}

\addTODO{目前写的是有限维度版本，需要调整成一般的内积空间}

\subsection{正交归一基底}

我们已经知道了向量基底的概念， 如果内积空间中一组向量基底中的每个向量模长都为 $1$ 且每两个向量都正交， 则我们把这组基底称为\textbf{正交归一基底（orthonormal bases）}，也叫\textbf{单位正交基}。 若把这组正交归一基底记为 $x_1, x_2 \dots x_N$， 则正交归一可以用内积表示为
\begin{equation}\label{eq_OrNrB_3}
\langle x_i, x_j \rangle = \delta_{ij} ~,\qquad i,j = 1,\dots, N~.
\end{equation}
其中 $\delta_{ij}$ 是\enref{克罗内克 delta 函数}{Kronec}。简单来说就是任意两个不同的基底内积为零， 以及任意基底与自身的内积为 1。

单位正交基是某个空间的\enref{基底}{Gvec2}，所以该空间中任意向量 $v$ 在单位正交基上的展开
\begin{equation}\label{eq_OrNrB_1}
v = \sum_{i = 1}^N c_i \, x_i ~,\qquad i = 1, \dots, N~.
\end{equation}
其中 $c_i$ 就是 $v$ 的各个坐标。 由正交归一性可以证明（见下文）
\begin{equation}\label{eq_OrNrB_4}
c_i = \langle v, x_i \rangle ~,\qquad i = 1, \dots, N~.
\end{equation}
或者把\autoref{eq_OrNrB_1} 记为
\begin{equation}\label{eq_OrNrB_5}
v = \sum_{i = 1}^N (\langle v, x_i \rangle) \, x_i~, \qquad i = 1, \dots, N~.
\end{equation}

最常见的例子就是几何向量在直角坐标系的 $x, y, z$ 三个单位正交向量上的展开：
\begin{equation}
v = (\langle v, x \rangle)\, x + (\langle v, y \rangle)\, y + (\langle v, z \rangle)\, z = x \, x + y \, y + z \, z~.
\end{equation} 

\subsubsection{证明}
我们来证明\autoref{eq_OrNrB_4} ： 用 $x_k$ 同时乘以\autoref{eq_OrNrB_1} 两边，得
\begin{equation}\label{eq_OrNrB_2}
\langle v, x_k \rangle = \sum_{i = 1}^N c_i \langle x_i, x_k \rangle = \sum_{i = 1}^N c_i \delta_{ik} = c_k ~,\qquad k = 1, \dots, N~.
\end{equation}
最后一步使用了\autoref{eq_Kronec_1}~\upref{Kronec}。 证毕。

\autoref{eq_OrNrB_2} 的过程可以看作是用 “与 $x_k$ 内积” 的操作把\autoref{eq_OrNrB_2} 求和中需要的一项筛选出来。 注意只有使用正交归一基底才可以进行这样的筛选。 一个反例是斜坐标系（\autoref{ex_Gvec2_1}~\upref{Gvec2}）不能使用\autoref{eq_OrNrB_1} 计算坐标， 因为它的基底不正交。


\subsection{施密特正交归一化}\label{sub_OrNrB_1}

\addTODO{目前写的是有限维度版本，需要增加无限维度的情况}

若在 $M$ 维向量空间中任意给出 $N \leqslant M$ 个线性无关的向量， 如何得到一组正交归一化的基底呢？ 我们可以用\textbf{施密特正交归一化（Schmidt orthonormalization）}。 先看一个二维的例子

\begin{example}{二维空间中的几何向量}
已知两个几何向量 $v_1, v_2$ 坐标分别为 $(2, 1)$， $(1, 2)$。 这两个向量不共线， 说明它们线性无关。 但容易看出它们既不归一也不正交， 下面来进行施密特正交归一化。

先把 $v_1$ 归一化， 并记为 $u_1$
\begin{equation}
u_1 = \frac{v_1}{\norm{v_1}} = \frac{1}{\sqrt{5}} (2, 1)~.
\end{equation}
然后， 用内积来计算 $v_2$ 在 $v_1$ 方向的投影长度
\begin{equation}
\langle v_2, u_1 \rangle = \frac{4}{\sqrt{5}}~,
\end{equation}
所以 $v_2$ 在平行于 $v_1$ 方向的分量为
\begin{equation}
v_2^\parallel = (\langle v_2, u_1 \rangle)u_1 = \frac{4}{5} (2, 1)~.
\end{equation}
将 $v_2$ 减去和 $v_1$ 平行的分量， 就是和 $v_1$ 垂直的分量
\begin{equation}
v_2^\bot = v_2 - v_2^\parallel = \qty(-\frac35, \frac65)~,
\end{equation}
归一化并记为
\begin{equation}
u_2 = \frac{v_2^\bot}{\norm{v_2^\bot}} = \frac{1}{3\sqrt{5}} (-3, 6)~.
\end{equation}
现在可以验证， 基底 $u_1$ 和 $u_2$ 是正交归一的， 即 $\norm{u_1} = \norm{u_2} = 1$， 且 $\langle u_1, u_2 \rangle = 0$。
\end{example}

若给出 $M$ 维向量空间中的 $N$ 个（$N \leqslant M$）线性无关向量
\begin{enumerate}
\item 将第 1 个向量归一化得到第 1 个基底
\item 将第 2 个向量分解为与第 1 个向量平行和垂直的两个分量， 并将垂直分量归一化得到第 2 个基底
\item 将第 3 个向量分解为三个部分， 即分别平行于前两个基底的分量和一个垂直分量， 并将垂直分量归一化得到第 3 个基底
\item 对第 $n = 4, \dots , N$ 个基底重复该步骤， 得到第 $n$ 个基底
\end{enumerate}

用公式来表示这个过程， 就是：
\begin{equation}
v_1^\bot = v_1~.
\end{equation}
\begin{equation}
u_i = \frac{v_i^\bot}{\norm{v_i^\bot}} \qquad i = 1, \dots ,N~,
\end{equation}
\begin{equation}\label{eq_OrNrB_6}
v_i^\parallel = \sum _{j=1}^{i-1} (\langle v_i, u_j \rangle) u_j \qquad (i = 2, \dots N)~,
\end{equation}
\begin{equation}\label{eq_OrNrB_7}
v_i^\bot = v_i - v_i^\parallel \qquad i = 2, \dots N~.
\end{equation}

\begin{exercise}{}
对三维空间中的向量 $(2, 1, 1)$， $(1, 2, 1)$ 和 $(1, 1, 2)$ 进行施密特正交归一化。
\end{exercise}

\subsubsection{推导}
这里来解释\autoref{eq_OrNrB_6} 和\autoref{eq_OrNrB_7}。 我们假设已经知道 $i-1$ 个正交归一的向量， 由于 $N$ 维空间中必然存在 $N$ 个正交归一基底， 我们可以设剩下 $u_i$ 的也已经知道（或者可以任意取）。 于是 $v_i$ 可以用基底展开为
\begin{equation}
v_i = \sum _{j=1}^N c_j u_j~.
\end{equation}
\autoref{eq_OrNrB_6} 得到前 $i-1$ 项之和
\begin{equation}
v_i^\parallel = \sum _{j=1}^{i-1} c_ju_j~,
\end{equation}
所以\autoref{eq_OrNrB_7} 就是第 $i$ 项到第 $N$ 项之和
\begin{equation}
v_i^\bot = \sum _{j=i}^{N} c_ju_j~.
\end{equation}
所以对 $j = 1, \dots , i-1$， 都有 $\langle v_i^\bot, u_j \rangle = 0$。 也就是说和已有的 $i-1$ 个基底都正交。