% 球坐标系中的拉普拉斯方程
% keys 球坐标系|拉普拉斯方程|连带勒让德方程|球谐函数
% license Xiao
% type Tutor

\pentry{球坐标系中的拉普拉斯算符\nref{nod_SphNab}， 分离变量法解偏微分方程\nref{nod_SepVar}}{nod_cd81}

三维空间的拉普拉斯方程为
\begin{equation}\label{eq_SphLap_2}
\laplacian f(\bvec r) = 0~.
\end{equation}
使用球坐标系中的拉普拉斯算子\upref{SphNab} 得
\begin{equation}
\pdv{r} \qty(r^2 \pdv{u}{r}) + \frac{1}{\sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{u}{\theta}) + \frac{1}{\sin^2 \theta} \pdv[2]{u}{\phi} = 0~,
\end{equation}
其通解为
\begin{equation}\label{eq_SphLap_7}
f(r, \theta, \phi) = \sum_{l,m} \qty(A_{l,m} r^l + \frac{B_{l,m}}{r^{l+1}}) Y_{l,m} (\theta, \phi)~,
\end{equation}
其中 $Y_{l,m}$ 是球谐函数\upref{SphHar}。

\subsection{推导}
球坐标系中， 可以将拉普拉斯算子分解为径向和角向两部分（\autoref{eq_SphNab_3}~\upref{SphNab}）
\begin{equation}\label{eq_SphLap_5}
\laplacian = \laplacian_r + \frac{\laplacian_{\Omega}}{r^2} = \frac{1}{r^2} \pdv{r} \qty(r^2 \pdv{u}{r}) + \frac{1}{r^2\sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{u}{\theta}) + \frac{1}{r^2\sin^2 \theta} \pdv[2]{u}{\phi}~,
\end{equation}
则\autoref{eq_SphLap_2} 两边乘以 $r^2$ 得
\begin{equation}
\qty(r^2\laplacian_r + \laplacian_\Omega) f = 0~.
\end{equation}
注意第一项只含有 $r$ 的偏导， 第二项只含有 $\theta,\phi$ 的偏导。 用分离变量法， 令 $f(\bvec r) = R(r) Y(\uvec r)$（$\uvec r$ 是 $\theta, \phi$ 的简写）， 则分离后的\textbf{径向方程}和\textbf{角向方程}分别为
\begin{equation}\label{eq_SphLap_4}
r^2\laplacian_r R(r) = l(l+1)R(r)~,
\end{equation}
\begin{equation}\label{eq_SphLap_1}
\laplacian_{\Omega} Y(\uvec r) = -l(l+1) Y(\uvec r)~.
\end{equation}
角向方程还可以进一步分离变量， 令 $Y(\theta,\phi) = \Theta(\theta)\Phi(\phi)$，有
\begin{equation}\label{eq_SphLap_3}
l(l+1)\sin^2 \theta + \left. \sin\theta\pdv{\theta} \qty(\sin \theta \pdv{\Theta}{\theta}) \middle/ \Theta + \pdv[2]{\Phi}{\phi} \middle/ \Phi = 0~. \right.
\end{equation}
注意前二项只含 $\theta$， 第三项只含 $\phi$。 一般令前两项之和为常数 $m^2$， 则第三项为 $-m^2$。 这样我们就成功分离出了三个常微分方程， 下面分别介绍。

径向方程是\textbf{欧拉型方程}\upref{Eulequ}
%addTODO{未完成}
\begin{equation}
r^2\dv[2]{R}{r} + 2r\dv{R}{r} - l(l+1)R = 0~,
\end{equation}
使用变量代换 $t = \ln r$ 解得
\begin{equation}
R(r) = C_1 r^l + \frac{C_2}{r^{l+1}}~.
\end{equation}

关于 $\theta$ 的方程是
\begin{equation}
\sin^2\theta \dv[2]{\Theta}{\theta} + \sin\theta\cos\theta\dv{\Theta}{\theta} + [l(l+1)\sin^2\theta - m^2] \Theta = 0~.
\end{equation}
使用变量代换 $x = \cos\theta$ 得
\begin{equation}
(1-x^2)\dv[2]{\Theta}{x} - 2x\dv{\Theta}{x} + \qty[l(l+1) - \frac{m^2}{1-x^2}]\Theta = 0~,
\end{equation}
或
\begin{equation}
\dv{x} \qty[(1-x^2)\dv{\Theta}{x}] + \qty[l(l+1) - \frac{m^2}{1-x^2}]\Theta = 0~.
\end{equation}
该式被称为\textbf{连带勒让德方程}\upref{AsLgdr}， 解为连带勒让德函数 $P_l^m(x) = P_l^m(\cos\theta)$。

关于 $\phi$ 的方程是
\begin{equation}
\dv[2]{\Phi}{\phi} = -m^2 \Phi~,
\end{equation}
该方程的解为 $\E^{\I m\phi}$。 原则上 $m$ 可以取任意实数， 但由于球坐标中的\textbf{循环边界条件}要求 $\Phi(\phi + 2\pi) = \Phi(\phi)$， $m$ 只能取任意整数。

综上， 球坐标中拉普拉斯方程的通解为
\begin{equation}\label{eq_SphLap_6}
f(r, \theta, \phi) = \sum_{l = 0}^\infty \sum_{m = -l}^l \qty(C_{l,m} r^l + \frac{C'_{l,m}}{r^{l+1}})P_l^m(\cos\theta)\E^{\I m\phi}~.
\end{equation}
我们一般把在单位球面上归一化后的 $\Theta(\theta)\Phi(\phi)$ 称为\textbf{球谐函数}\upref{SphHar}， 记为 $Y_{l,m}(\theta,\phi)$ （满足角向方程\autoref{eq_SphLap_1} ）， 则通解也可记为\autoref{eq_SphLap_7}。

如果考虑的问题具有 $\phi$ 方向的对称性，那么 $f(r,\theta,\phi)$ 的展开式中将只涉及到 $m=0$ 的球鞋函数，这时连带勒让德函数就退化为勒让德多项式。这对求解具体的静电边值问题有很大帮助\upref{EPoiEQ}。
