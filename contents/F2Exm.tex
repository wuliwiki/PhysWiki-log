% 二元函数的极值（简明微积分）
% keys 多元微积分|二元函数|导数|方向导数|极值
% license Xiao
% type Tutor

\pentry{导数与函数极值\nref{nod_DerMax}， 方向导数\nref{nod_DerDir}}{nod_f0fb}

\footnote{本文参考： \cite{同济高} 下册的 “多元函数的极值及其求法” 一节。}类似一元函数， 二元函数的极值与其偏导数密切相关。 以下讨论中， 我们假设在某区域内二元函数二阶可导且二阶导数连续。

\subsection{极值点与驻点}
\begin{definition}{二元函数的极值点}
以一点为圆心在 $xy$ 平面上作一个圆形区域， 若当半径足够小时， $f(x_i, y_i)$ 是该圆形区域的最大值或最小值， 那么该点就是极大值点或极小值点。 
\end{definition}

\begin{definition}{驻点}
如果二元函数 $f(x,y)$ 在某点 $(x_i, y_i)$ 处对 $x, y$ 的偏导数都为零， 那么 $(x_i, y_i)$ 就叫做函数 $f(x,y)$ 的\textbf{驻点}。 
\end{definition}
根据\autoref{eq_DerDir_7}， 驻点处各个方向的\enref{方向导数}{DerDir}也都为零。
\begin{equation}
\pdv{f}{x}=\pdv{f}{y}=0 \Longleftrightarrow \grad f=\bvec0~.
\end{equation}

与一元函数类似， 极值点一定是驻点，但驻点不一定是极值点。例如 $f(x,y) = xy$ 在坐标原点的两个一阶偏导都为零， 但原点并不是极值点。 

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/385a975ab374474f.png}
\caption{原点是$f(x,y)=x^2+y^2$的极值点} \label{fig_F2Exm_1}
\end{figure}


\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/4cab7dd2bbaf1dcc.png}
\caption{但原点不是$f(x,y)=xy$的极值点} \label{fig_F2Exm_2}
\end{figure}

\subsection{极值点判别法（充分非必要条件）}
在驻点处，设
\begin{equation}
A=\pdv[2]{f}{x},\qquad B=\pdv{f}{x}{y},\qquad C=\pdv[2]{f}{y}~.
\end{equation}
\begin{equation}
D=AC-B^2=
\vmat{
A&B\\
B&C}~.
\end{equation}

\begin{itemize}
\item 若 $D<0$, 则该驻点不是极值点
\item 若 $D>0$ 且 $A>0$, 则该驻点为$f(x,y)$ 的极小值点
\item 若 $D>0$ 且 $A<0$, 则该驻点为 $f(x,y)$ 的极大值点
\item 否则，该点可能是也可能不是极值，不能使用该判别法判定
\end{itemize}

\begin{exercise}{二次函数}
求以下二次函数的极值
\begin{equation}
f(x, y) = ax^2 + 2bxy + cy^2 + px + qy~.
\end{equation}
部分答案： 存在唯一极小值当且仅当 $a>0$, $c>0$, 且 $ac>b^2$； 存在唯一极大值当且仅当 $a<0$, $c<0$, 且 $ac>b^2$。
\end{exercise}

\subsection{推导}

类比一元函数的证明， 要证明二元函数的某点是极值点， 就要证明该点的任意二阶方向导数都大于零或都小于零\footnote{否则延一个方向前进函数值会越来越大， 而延另一个方向前进函数值会越来越小， 这个点就不是极值点}。 令某方向为 $\uvec n = \uvec x \cos\theta + \uvec y \sin\theta$， 由\autoref{eq_DerDir_7}  得该方向的方向导数为
\begin{equation}
\qty(\cos\theta\pdv{x} + \sin\theta\pdv{y}) f~,
\end{equation}
再次求方向导数得二阶方向导数为
\begin{equation}
\qty(\cos\theta\pdv{x} + \sin\theta\pdv{y})^2 f
= \pdv[2]{f}{x} \cos^2\theta + 2\pdv{f}{x}{y} \sin\theta\cos\theta + \pdv[2]{f}{y} \sin^2\theta~.
\end{equation}
如果你还不习惯看算符的平方， 可以把上式的括号项平方看做两个括号项， 依次作用在函数上。 以极小值为例， 令上式恒大于零， 并除以 $\cos^2\theta$ 得
\begin{equation}
\pdv[2]{f}{y} \tan^2\theta + 2\pdv{f}{x}{y} \tan\theta + \pdv[2]{f}{x} > 0~.
\end{equation}
上式左边是关于 $\tan\theta$ 的二次函数， 若要恒大于零， 则二次项系数要大于零， 且判别式需小于零， 立即可得$AC-B^2>0$ 。 同理可得极大值条件。

当判别式（$AC-B^2$）小于零时， 必然存在不同方向的二阶方向导数具有相反的符号， 所以必定不是极值点。 而当判别式等于零时， 存在某些方向的二阶导数为零， 无法判断是否为极值点。

