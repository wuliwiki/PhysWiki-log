% 求和符号（高中）
% license Xiao
% type Tutor


\pentry{数列\nref{nod_HsSeFu}，集合\nref{nod_HsSet}，函数\nref{nod_functi}}{nod_571f}

想象一下这样一个场景，老师要求你计算从1到100的所有自然数的和，这时，你旁边的一个名叫高斯的同学脱口而出5050。当然，这篇文章的内容不是介绍如何快速的计算这个和的，于是这个故事里，你不是高斯，而是他旁边那个看起来“笨笨”的同学。你和其他的同学一样，从$1$开始一个一个往上加。

时过境迁，对于计算机随处可见的现在，这样的操作不再像当时那样看起来笨笨的，计算机每天都在进行着类似的操作。不仅如此，通过对这个过程抽象得到的求和符号，不仅能只用一个比较简短的记号就描述之前你的求和过程，在理论上提供了强大的表达能力，还能够推广到远比高斯当时使用的方法广泛的场景中，展现了高效和便捷的特性。

当然，这个符号与之前学习过的其他符号（$+,\times$等）相比都复杂一些，但了解熟练之后，相信你再看到它，也会像看到老朋友那样自然。


\subsection{初次接触求和符号}

假设有人给了你一项任务，他希望你求出一些数字的和是多少（这个过程的名字叫\textbf{累加}），比如一辆车从始发站到某一站，每站都会上一些人，再下一些人，问到这一站的时候车上有多少人。想一想这个过程，你会需要他给你哪些信息呢？

你需要知道第一个数是多少，并且要他依次把这些数字给你，而且最终需要有一个停止的条件，即这些数字会最终停止在某一个数字上。对于已经接触过数列的同学一定意识到了，这些数字可以构成一个数列。第一个数就是首项，最后一个数就是末项。下面假设这个数列是$\{a_n\}$，它的第一项是$a_1$，末项是$a_n$。于是这个求和结果就是：

\begin{equation}
a_1+a_2+\cdots+a_{n-1}+a_{n}.~
\end{equation}

为了避免每次都要写一堆点来表达这个求和过程，通常会设这个数列的所有项的和是$S$，即：

\begin{equation}
S=a_1+a_2+\cdots+a_{n-1}+a_{n}.~
\end{equation}

但是，尽管使用$S$避免了写一堆点，但却带来了一些其他的问题：
\begin{enumerate}
\item 如果涉及到很多个数列或者很多个求和过程，光是设这些变量，就要花掉很大篇幅，就像上面做的：需要构造一个数列，给这个数列一个符号，然后给这个数列的和一个符号。
\item $S$这个符号太泛用了，在使用的时候也会因为记不清之前都用了哪些符号造成阅读上的困难。
\item $S$这个符号本身并没有包含其他的信息，他只是给这个过程起了一个名字而已，从这个字符没有办法反映出求和过程的性质，任何记号都可以替代它，毕竟只是个名字。
\end{enumerate}

由于累加过于常用，上面的三个问题就显得尤为突出，因此，迫切需要一个新的手段来避免出现这些问题，数学家们设计了求和符号，用求和符号来表现累加过程的定义如下\footnote{更多的关于此符号的内容可意参见\enref{大型运算符}{LgOper}}：

\begin{equation}\label{eq_SumSym_1}
\sum_{i=1}^n a_i:=a_1+a_2+\cdots+a_{n-1}+a_{n}~.
\end{equation}


下面大概的解释一下求和符号在做什么：
\begin{enumerate}
\item 求和符号的下面表示求和过程的\textbf{指标}（index，也译为索引）和指标下限，通过指标你就可以像看目录一样，找到对应的那一项是哪个。
\item 求和符号的上面表示指标上限，由于指标只要指明一次就可以了，所以上面就不再重新写一遍指标号是什么。
\item 求和符号的右侧代表了这些数字的通项，它通常需要包含指标（这里包含在下标中）。
\item 求和的过程分成两步：第一步是“得到指标集”，通过自增，即指标从下限开始，不断加$1$（递增），直到上限，得到所有的指标（也即确定所有指标构成的集合，称作\textbf{指标集}）；第二步是“求和”，根据指标集找到每一个需要求和的数字，并把他们加起来。
\end{enumerate}

对照着刚才的那些问题，可以发现，用它来代替$S$不仅避免了写“$\cdots$”，也完全解决了$S$带来的问题。随着使用的深入，人们还发现，求和符号带来了一些其他的便利。不过我们先停一停，好好研究一下这个符号的几种使用方式。

\subsubsection{*递归定义}

对于递增情况的累加过程，参考自然数的公理，可以采用递归定义，特别地，参考\autoref{eq_SumSym_5} 初始条件为“空和”，即：

\begin{definition}{递归定义的求和符号}
\begin{equation}
\sum_{i=1}^n a_i = a_n + \sum_{i=1}^{n-1} a_i,\sum_{i=1}^0 a_i=0.~
\end{equation}
\end{definition}


\subsection{求和符号的几种使用方式}

在实际使用时，为了让求和符号能在在不同的情况下表示累加的概念，发明了一些其他的表达方法\footnote{在印刷排版中，行内的求和符号也经常写成 $\sum_{i=1}^n a_i$，为了保持行高。小时百科仍然会尽量使用 $\sum\limits_{i=1}^n a_i$。}。标题中带*的内容只做拓展视野使用，在高中阶段不涉及。

\subsubsection{更换指标}

\autoref{eq_SumSym_1} 是最常用的一种表示方法。但事实上不论是指标，还是它的下限或是上限都可以根据实际情况有其他的选择。相较之前更泛用的记法定义如下：

\begin{equation}
\sum_{k=p}^q a_k := a_p + a_{p+1} + \dots +a_{q-1}+ a_q~.
\end{equation}
其中 $k$ 是指标，$p,q$分别为下限和上限。

指标通常会使用 $i,j,k$ 等字母。若求和过程涉及多个指标为免歧义会使用多个字母。

关于下限和上限，与刚才相同，不一定会从$1$开始，也不一定到$n$终止，因此在使用时需要注意这两个条件，尤其是下限，很多错误就在下意识地以$1$为开始中产生。

注意，求和符号所代表的累加过程一共有$q-p+1$项。

\subsubsection{使用表达式}

如果$a_i$的表达式是$f(i)$，即$a_i=f(i)$，则求和符号可以直接写作：

\begin{equation}
\sum_{i=1}^n f(i) .~
\end{equation}

这样做的好处是彻底脱离了之前提到的“给这个数列一个符号”的操作，直接用一个具体的表达式就可以写出来了，这样的表达方法使用最广泛。

\begin{example}{用求和符号表达从1开始的10个奇数的和}
第一个数是$1$，设指标为$n$，指标从1开始，则这些奇数的表达式是：$2n-1$。一共有$10$个数，因此，这个和是：
$$\sum_{n=1}^{10}(2n-1).~$$
\end{example}

\begin{example}{用求和符号表达从4开始的6个偶数的和}
第一个数是$4$，设指标为$k$，指标从$2$开始，则这些偶数的表达式是：$2n$。一共有$6$个数，因此，这个和是：
$$\sum_{k=2}^{7}{2k} .~$$
\end{example}

通过上面的例题可以看到，如果求和的表达式如果是一个单项式的话，直接写出即可，但如果是一个多项式的话，那么在书写时必须要用括号把它扩起来，以免引发歧义。

\subsubsection{*无穷情况}
\addTODO{预备知识或者上文没有出现极限符号，另外不要在本文出现微积分内容，这不是综述类百科，标题显示为高中内容}
有时会出现，下限位置为$-\infty$，上限位置为$+\infty$等情况，比如级数等情况。这种情况并非实指去到对应点，而是指取相应极限，即：

\begin{equation}
\sum_{i=-\infty}^n a_i:= \lim_{a\to-\infty}\sum_{i=a}^n a_i.~
\end{equation}

\begin{equation}
\sum_{i=0}^{+\infty} a_i:= \lim_{a\to+\infty}\sum_{i=0}^a a_i.~
\end{equation}

特殊地：
\begin{equation}
\sum_{i=-\infty}^{+\infty} a_i:= \lim_{a\to+\infty\atop b\to-\infty}\sum_{i=b}^a a_i.~
\end{equation}

\begin{example}{设等比级数通项$a_n=a_1q^{n-1}$，用求和符号表示等比级数和}
$$
\sum_{i=1}^{+\infty} a_i=
\leftgroup{
{a_1\over 1-q},\qquad |q|<1\\  
\text{发散},\qquad |q|\geq1
} ~.
$$
\end{example}

\subsubsection{*指标集记法}

上面介绍的求和过程，指标集都是$\mathbb{Z}$与某个区间的交集（这样可以保证自增），对于某些不需要自增或无法使用自增的场合，可以直接给定指标集，求和过程记作：

\begin{equation}
\sum_{i\in I} a_i~.
\end{equation}
其中，$I$为指标集。特别的，若$I$为空集，一般称为“空和”，并定义为0，即：
\begin{equation}\label{eq_SumSym_5}
\sum_{i\in \varnothing} a_i=0~.
\end{equation}

同时，若通过上下文可以明确指标集$I$或只为表述记号的运算特点而不强调指标集时，在不引起歧义的情况下，为了方便可以直接记作：

\begin{equation}\label{eq_SumSym_2}
\sum_i a_i.~
\end{equation}

这样使用时通常不会涉及指标的运算。



综上，\autoref{eq_SumSym_1} 到\autoref{eq_SumSym_2} 介绍了常用的几种求和符号的使用方法，它们各有特点，具体使用时需要根据情况进行选择，需要做到能认能写。

\subsection{常用的求和结论}

下面不加证明地给出一些常用的求和结论，感兴趣的读者可以自行证明。

\begin{itemize}
\item $\displaystyle\sum\limits_{i=a}^a f(i) = f(a)$
\item $\displaystyle\sum\limits_{i=1}^n 1 = n$
\item $\displaystyle\sum\limits_{i=1}^n i = \frac{n(n+1)}{2}$
\item $\displaystyle\sum\limits_{i=1}^n i^2 = \frac{n(n+1)(2n+1)}{6}$
\item $\displaystyle\sum\limits_{i=1}^n i^3 = \left( \frac{n(n+1)}{2} \right)^2$
\item $\displaystyle\sum\limits_{i=1}^n \frac{1}{i(i+1)} = 1 - \frac{1}{n+1}$
\end{itemize}



\subsection{*单个求和符号的运算技巧}

很多刚刚接触这个符号的人，在见到写成求和符号时，会下意识地想要把它展开成熟悉的累加形式。但是事实上，有一些运算技巧可以保证在运算过程中快速地进行变换。当然，觉得理解困难时，随时都可以展开再计算，但熟练了下面提到的这些技巧，相信你可以“不畏浮云遮望眼”。

\subsubsection{线性}

求和符号内部是线性的。

\begin{equation}
\sum_{i} (C_aa_i \pm C_bb_i) =\sum_{i} C_aa_i \pm \sum_{i} C_bb_i=C_a\sum_{i} a_i \pm C_b\sum_{i} b_i.~
\end{equation}

上式意味着，不仅可以将求和符号内的加号两侧拆成两部分，数乘在求和符号内外也相等。

对于指标递增的求和符号，指标集也是可以分拆的，假设$a_i$在$1$到$m$上有定义，且$k,n$均不大于$m$，则：

\begin{equation}
\sum_{i=1}^n a_i  = \leftgroup{
&\sum\limits_{i=1}^k a_i  +\sum\limits_{i=k+1}^n a_i \quad (1\leq k\leq n) \\
&\sum\limits_{i=1}^k a_i  -\sum\limits_{i=n+1}^k a_i \quad (1\leq n\leq k)~.
}\end{equation}

\subsubsection{指标换元}


指标换元时，根据换元的关系，分别更换指标的下限、上限，以及求和通项中的指标。设$k = i+m(m\in{\mathbb Z})$，则：
\begin{equation}
\sum_{i=a}^b g(i) = \sum_{k=a+m}^{b+m} g(k-m).~
\end{equation}

\begin{example}{将$\sum\limits_{i=m}^n a_i$的指标$i$替换为$j$，且满足替换后的下限为$j=0$。}
解答：
\begin{enumerate}
\item 由于原本的下限为$i=m$，替换后的下限为$j=0$，可知，换元关系为$j=i-m$。
\item 将$i$的上限$i=n$带入$j=i-m$可知，换元后的上限为$j=n-m$。
\item 由$j=i-m$可知$i=j+m$，代入原来的通项可知换元后的通项为$a_{j+m}$。
\end{enumerate}

因此，换元前后为:
$$\sum_{i=m}^n a_i = \sum_{j=0}^{n-m} a_{j+m}~.$$
\end{example}

特别的，可以通过换元来得到倒序求和，只要保证$k+i=a+b$即可得到：
\begin{equation}\label{eq_SumSym_4}
\sum_{i=a}^b g(i) = \sum_{k=a}^{b} g(a+b-k).~
\end{equation}
此时，若称$i$为指标的求和顺序为正序，则以$k$为指标的求和顺序即为倒序。

\subsubsection{分组求和}

这个过程可以理解成将一列数按一定顺序放到一个表里面后，按照表的行求和后再按列求和。这样做可以在行求和时不考虑列的影响，反之亦然。

\begin{equation}
\sum_{i=1}^{nk} a_i = \sum_{j=0}^{k-1} \sum_{i=1}^n a_{i+jn}.~
\end{equation}

它的一个特例是，分成两列，并利用\autoref{eq_SumSym_4} 使得两列的顺序相反，即：

\begin{equation}\label{eq_SumSym_3}
\sum_{i=1}^n a_i = \sum_{i=1}^{n/2} (a_i + a_{n+1-i}).~
\end{equation}

\begin{example}{求1到100的自然数的和}
所求目标的表达式为$\sum\limits_{i=1}^{100} i$，根据\autoref{eq_SumSym_3} 可得：
$$\sum\limits_{i=1}^{100} i= \sum_{i=1}^{50} [i + (100+1-i)]=50\times101=5050.~$$
\end{example}

\subsubsection{积分近似}
\addTODO{本文不要出现微积分内容}
对于求和项数量非常多的情况，可以利用黎曼和的思想来近似化简，将求和过程转化成\enref{定积分}{DefInt}。

\begin{equation}
\sum_{i=a}^b f(i) \approx \int_a^b f(x) \, dx.~
\end{equation}


\subsection{*多个求和符号的运算技巧}

有一些场合会出现一个表达式中出现多个求和符号的情形。一如上面所说，展开仍然是通用的方法，但过于复杂会让人望而却步。下面的运算技巧绝对会让化简过程如虎添翼。

\subsubsection{交换求和次序}
类似于一个表格中，不论是先求行和再求和，还是先求列和再求和，结果都是将所有的数字求一遍。

\begin{equation}
\sum_{i,j} a_{ij}=\sum_{i} \sum_{j} a_{ij} = \sum_{j} \sum_{i} a_{ij}.~
\end{equation}
其中 $\sum\limits_{i,j}$ 表示按任意顺序遍历所有$(i,j)$。

\subsubsection{双重求和}
两个求和符号的积可以展开为它们每一项组合的积的和。

\begin{equation}
\qty(\sum_i a_i) \qty(\sum_j b_j) = \sum_{i,j} a_i b_j = \sum_i \qty(a_i \sum_j b_j) = \sum_j \qty(b_j \sum_i a_i)~.
\end{equation}

注意：第一个等号从左到右没有条件，但从右到左时需要保证每个变量的独立性，即$a_i$中不包含$j$，$b_j$中不包含$i$。

\begin{example}{用求和符号计算数列$\{a_n\}$的和的平方}
$$\qty(\sum_i a_i)^2 = \sum_{i,j} a_i a_j = \sum_i a_i^2 + 2\sum_{i<j} a_i a_j~.$$
注意区分求和指标，第二步如果写成 $\sum\limits_{i,i} a_i a_i$ 将产生混乱。
\end{example}

总结一下，求和符号有下面几点明确的好处：

\begin{enumerate}
\item 提高表达的简洁性：使用求和符号可以大幅减少公式的长度和复杂度，便于书写和理解。
\item 注重通项公式的表达：求和符号通过明确的通项公式，着眼于求和这个过程更本质的内容，方便直观地理解和分析求和过程。
\item 适用范围广泛：求和符号不仅可以表达连续自然数的求和，还适用于包括等差数列、等比数列等在内的各种数列的求和情况，它甚至可以推广到无穷级数。
\item 快速化简：在熟练掌握求和符号的性质和技巧后，可以快速地对求和过程进行变形。
\item 便于计算机实现：求和符号与编程语言中的循环语句的条件一一对应，这使得计算过程可以容易转换为程序并通过计算机完成。
\item 与定积分的紧密联系：求和符号与定积分有着密切的关系，特别是在离散与连续的彼此转换中，它们之间可以快速相互转化。
\end{enumerate}

相信认真阅读完本页内容的你，已经感受到了前三点。其他的内容或许对高中的你而言会觉得不知所谓，但相信随着学习的深入，你会一点一点感受到这些好处，并受用终身。