% 球坐标系
% 坐标系|球坐标系|位矢|方位角

\pentry{位置矢量\upref{Disp}， 三维直角坐标系}

\subsection{球坐标的定义}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Spherical_coordinate_system}{相关页面}。}球坐标往往在直角坐标的基础上定义， 三维直角坐标系中的一点 $P$ 的位置可以用 $(r,\theta ,\phi )$ 这 3 个有序实数来表示，称为该点的\textbf{球坐标（spherical coordinates）}（\autoref{Sph_fig1}）。其中 $r$ 表示该点到原点的距离 （$r \geqslant 0$）， 即位矢\upref{Disp}的\textbf{模长}； $\theta$ 表示该点的位矢与 $z$ 轴的夹角 （$\theta  \in [0,\pi]$）， 即\textbf{极角（polar angle）}； $\phi$ 表示该点的位矢在 $x$-$y$ 平面上的投影与 $x$ 轴的夹角 （$\phi  \in [0,2\pi)$ 或 $(- \pi,\pi]$）， 即\textbf{方位角（azimuthal angle）}。

\begin{figure}[ht]
\centering
\includegraphics[width=9cm]{./figures/Sph_1.pdf}
\caption{球坐标系}\label{Sph_fig1}
\end{figure}

以上定义的球坐标系符合 \href{https://www.iso.org/standard/64973.html}{ISO 国际标准}， 本书使用该定义。 一些其他文献或软件\footnote{如 Matlab 的 \lstinline|sph2cart| 和 \lstinline|cart2sph| 函数。}中时常把 $\theta$ 取补角， 即和 $x$-$y$ 平面的夹角。 另一些教材中也可能用 $\theta $ 表示方位角， $\phi $ 表示极角，或者将 $\phi $ 记为 $\varphi $，  $r$ 记为 $\rho $ 等，需要通过上下文判断每个坐标符号的具体含义。

\subsection{球坐标系中的单位矢量}
三个球坐标分别有对应的单位矢量 $\uvec r, \uvec\theta, \uvec\phi$ （如\autoref{Sph_fig1} ）。定义它们的方向分别指向对应坐标增加的方向，例如 $r$ 增加时，点 $P(r,\theta ,\phi )$ 就向 $\uvec r$ 的方向移动， $\theta$ 增加时 $P(r,\theta ,\phi )$ 就向 $\uvec \theta$ 方向移动。三个单位矢量两两垂直，形成一组正交归一基底\upref{OrNrB}，任意三维矢量都可以表示成它们的线性组合（\autoref{OrNrB_eq5}~\upref{OrNrB}）
\begin{equation}\label{Sph_eq1}
\bvec v = (\bvec v \vdot \uvec r)\,\uvec r + (\bvec v \vdot \uvec \theta)\,\uvec \theta  + (\bvec v \vdot \uvec \phi)\,\uvec \phi  = v_r \,\uvec r + v_\theta \,\uvec \theta  + v_\phi \,\uvec \phi 
\end{equation}
注意根据\autoref{Sph_fig1} 对三个单位矢量的定义， 当 $P$ 取不同位置时， 三个单位矢量一般也会改变方向。 所以与直角坐标系的一个显著不同是， 球坐标的三个单位矢量是关于 $\theta$ 和 $\phi$ 的函数。 具体表示出来， 就是 $\uvec r(\theta ,\phi )$，  $\uvec \theta (\theta ,\phi )$，  $\uvec \phi (\phi )$。 
例如 $P$ 的球坐标为 $(1, \pi/2, 0)$， 直角坐标为 $(1, 0, 0)$ 时，
$\uvec r = \uvec x$， $\uvec \theta  =  - \uvec z$， $\uvec \phi  = \uvec y$。 
但是球坐标为 $(1, \pi/2, \pi/2)$， 直角坐标为 $(0, 1, 0)$ 时， $\uvec r = \uvec y$， $\uvec \theta  =  - \uvec z$， $\uvec \phi  =  - \uvec x$。

三个坐标按照 $(r, \theta , \phi )$ 排序，是为了使对应的单位矢量满足叉乘\upref{Cross}关系 $\uvec r \cross \uvec \theta  = \uvec \phi $。 这可以类比直角坐标系的三个单位矢量必须满足 $\uvec x \cross \uvec y = \uvec z$。 这也是对所有正交曲线坐标系\upref{CurCor}的要求， 球坐标系是正交曲线坐标系\upref{CurCor} 的一种。

\subsection{球坐标和直角坐标的转换}
对于球坐标为 $(r, \theta , \phi )$ 的任意点， 球坐标和直角坐标间的转换以及单位矢量 $\uvec r, \uvec \theta, \uvec \phi$  与 $\uvec x, \uvec y, \uvec z$ 之间的转换见详见 “球坐标与直角坐标的转换\upref{SphCar}”， 这里引用（\autoref{SphCar_eq1}~\upref{SphCar} 和\autoref{SphCar_eq2}~\upref{SphCar}）：
\begin{equation}
\begin{cases}
x = r\sin \theta \cos \phi \\
y = r\sin \theta \sin \phi \\
z = r\cos \theta 
\end{cases}
\end{equation}
\begin{equation}
\leftgroup{
r &= \sqrt {x^2 + y^2 + z^2} \\
\theta  &= \Arctan\qty(\sqrt{x^2 + y^2}, z)\\
\phi  &= \Arctan(y, x)
}\end{equation}


 
\subsection{球坐标系中矢量的两种表示方法}
球坐标系中， 表示矢量的一种简单方法是直接规定矢量以原点为起点，以球坐标 $(r, \theta, \phi)$ 的点为终点。 但这样表示的缺点是两个矢量相加（减）不能直接表示为三个分量的加， 而是要经过一些繁琐的变换， 例如先变换到直角坐标系中， 相加后再变回球坐标中。

更常见的方法，是将矢量投影到球坐标的 3 个单位矢量 $\uvec r, \uvec \theta, \uvec \phi$ 上， 用单位矢量的线性组合来表示（\autoref{Sph_eq1}）。 但由于单位矢量的方向取决于坐标， 要说明是关于哪个点的单位矢量。 在矢量分析中，这种方法常用于表示\textbf{矢量场}\upref{Vfield}， 即每个位置对应一个矢量。

\begin{example}{}
\begin{enumerate}
\item 任意一点 $P(r, \theta, \phi)$ 的位置矢量\upref{Disp}都可以表示为 $\bvec r = r\,\uvec r$。
\item 原点处电荷 $q$ 产生的电场为 $\bvec E = k q \,\uvec r/r^2$， 详见 “电场\upref{Efield}” 的\autoref{Efield_eq4}。
\item 一个绕 $z$ 轴逆时针旋转（ 角速度 $\omega $） 的圆柱，在圆柱内任意一点的速度矢量为（详见 “圆周运动的速度\upref{CMVD}”）
\begin{equation}
\bvec v(r, \theta, \phi) = \omega r_\bot \,\uvec \phi = \omega r\sin \theta \,\uvec \phi 
\end{equation}
\end{enumerate}
可见一些具有球对称性或柱对称性的场在球坐标系中具有更简单的形式， 对具体问题选取合适的坐标系往往能大大简化计算。
\end{example}
