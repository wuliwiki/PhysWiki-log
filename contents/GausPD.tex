% 高斯分布（正态分布）
% keys 统计|随机变量|微积分|定积分|分布函数|平均值|标准差|方差|高斯分布|Gaussian Distribution|正态分布|Normal Distribution|偶函数|对称性
% license Xiao
% type Tutor

\pentry{分布函数\upref{RandF}， 误差函数\upref{Erf}}

\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/0b6e2e5e73181b09.pdf}
\caption{正态分布图， 来自 Wikipedia} \label{fig_GausPD_1}
\end{figure}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Normal_distribution}{相关页面}。}\textbf{高斯分布}也叫\textbf{正态分布}， 概率密度函数为
\begin{equation}\label{eq_GausPD_1}
f(x) = \frac{1}{\sqrt{2\pi}\ \sigma} \exp\qty[-\frac{(x - \mu )^2}{2\sigma ^2}]~,
\end{equation}
其中 $\mu$ 是分布的的\textbf{平均值}， $\sigma^2$ 是\textbf{方差}， $\sigma$ 是标准差。 上式也通常记为 $x \sim N(\mu,\sigma^2)$， 且满足归一化条件
\begin{equation}\label{eq_GausPD_7}
\int_{-\infty}^{+\infty} f(x) \dd{x} = 1~.
\end{equation}
$N(0,1)$ 被称为\textbf{标准正态分布}。

正态分布中， $x$ 落在区间 $[\mu-a,\mu+a]$ 内的概率可以用\textbf{误差函数}\upref{Erf} $\erf$ 表示：
\begin{equation}
% 已数值验证
P\{\abs{x-\mu} \leqslant a\} = \int_{-a}^a f(x)\dd{x} = \erf\qty(\frac{a}{\sqrt{2}\ \sigma})~.
\end{equation}
若已知 $P\{\abs{x-\mu} \leqslant a\}$， 也可以用\textbf{反误差函数} $\erf^{-1}$ 求出 $a$。

\subsection{特殊值}
高斯分布的\textbf{半峰全宽（FWHM）}为
\begin{equation}\label{eq_GausPD_8}
\text{FWHM} = 2\sqrt{2\ln 2}\ \sigma \approx 2.3548\ \sigma~.
\end{equation}
也就是在 $\abs{x - \mu} = \text{FWHM}/2$ 处， 函数值为峰值的一半。

另外当 $\abs{x - \mu} = \sigma$ 处， 函数值为峰值的 $\exp(-1/2) \approx 0.6065$。

其他特殊函数值以及对应的概率如下
\begin{table}[ht]
\centering
\caption{高斯分布的特殊值和概率}\label{tab_GausPD1}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
$x$ & $\sigma$ & $2\sigma$ & $3\sigma$ & $4\sigma$ & $5\sigma$ & $6\sigma$ \\
\hline
$f(x)/f_\text{max}$ &0.6065 & 0.1353 & 1.111e-2 & 3.355e-4 & 3.727e-6 & 1.523e-8 \\
\hline
$1-\int_{-x}^x f(t)\dd{t}$ & 0.3173 & 4.550e-2 & 2.700e-3 & 6.334e-5 & 5.733e-7 & 1.973e-9 \\
\hline
\end{tabular}
\end{table}

\subsection{推导}
若已知高斯分布具有如下形式
\begin{equation}\label{eq_GausPD_2}
f(x) = A\exp\qty[-a (x - x_0)^2]~,
\end{equation}
可见其主要特征就是指数函数中含有 $\Delta x^2$ 项。由对称性，分布函数关于 $x =x_0$ 对称，所以平均值显然为 $\mu = x_0$。

现在我们补充两个积分， 由换元积分法\upref{IntCV}（$x=\sqrt{t}$）以及 $\Gamma$ 函数\upref{Gamma} 的性质得
\begin{equation}\label{eq_GausPD_3}
\int_{-\infty }^{+\infty } \E^{-x^2}\dd{x}  = \int_0^{+\infty} t^{-1/2}\E^{ - t} \dd{t}  = \qty(-\frac12)! = \sqrt \pi ~,
\end{equation}
\begin{equation}\label{eq_GausPD_4}
\int_{-\infty}^{+\infty} x^2 \E^{-x^2}\dd{x}  = \int_0^{+\infty} t^{1/2}\E^{-t} \dd{t}  = \frac12 ! = \frac12 \qty(-\frac12)! = \frac{\sqrt\pi}{2}~.
\end{equation}

根据归一化条件\autoref{eq_GausPD_7}，结合\autoref{eq_GausPD_3} 得
\begin{equation}\label{eq_GausPD_5}
1 = \int_{-\infty}^{+\infty} f(x) \dd{x}  = A\int_{-\infty}^{+\infty} \exp\qty[-a (x - x_0)^2] \dd{x}  = A\sqrt{\frac{\pi}{a}}~,
\end{equation}
即 $A = \sqrt{a/\pi}$。 再来计算高斯分布的方差，结合\autoref{eq_GausPD_4} 得
\begin{equation}\label{eq_GausPD_6}
\sigma ^2 = \int_{-\infty}^{+\infty} (x - x_0)^2 A\exp\qty[-a (x - x_0)^2] \dd{x}  = \frac{1}{2a}~.
\end{equation}
用\autoref{eq_GausPD_5} 和\autoref{eq_GausPD_6} 解得 $a = 1/(2\sigma^2)$ 和 $A = 1/(\sqrt{2\pi}\ \sigma)$，代入\autoref{eq_GausPD_2} 可得高斯分布\autoref{eq_GausPD_1}。
