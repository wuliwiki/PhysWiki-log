% 连带勒让德函数
% keys 连带勒让德方程|归一化
% license Xiao
% type Tutor

\pentry{勒让德多项式\nref{nod_Legen}}{nod_fd56}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Associated_Legendre_polynomials}{相关页面}。}连带勒让德方程来源于在球坐标系中使用分离变量法解拉普拉斯方程（\enref{球坐标系中的拉普拉斯方程}{SphLap}）中， 连带勒让德方程为
\begin{equation}
\dv{x} \qty[(1-x^2)\dv{x} P_l^m(x)] + \qty[l(l+1) - \frac{m^2}{1-x^2}]P_l^m(x) = 0~.
\end{equation}
当 $m = 0$ 时， 该方程变为勒让德方程（\autoref{eq_Legen_1}~\upref{Legen}）。 其中参数 $l, m$ 分别叫做\textbf{次数（degree）}和\textbf{阶数（order）}。

最广义的情况下， $l,m$ 都可以是任意复数。 本文中我们只讨整数 $l,m$，且 $l\geq 0$， $\abs{m} \leq l$ 的情况， 且只讨论区间 $x\in [-1,1]$。 这些限制在实际应用中是最常见的。 此时方程的解是\textbf{连带勒让德函数（associated Legendre function）} $P_l^m(x)$ 可用\enref{勒让德多项式}{Legen} $P_l(x)$ 生成
\begin{equation}\label{eq_AsLgdr_1}
P_l^m(x) = (-1)^m (1 - x^2)^{m/2} \dv[m]{x} P_l(x)~.
\end{equation}
注意当 $m = 0$ 时有
\begin{equation}
P_l^0(x) = P_l(x)~.
\end{equation}
当 $m$ 为奇数时， $P_l^m(x)$ 并不是一个多项式， 但习惯上我们仍经常称之为\textbf{连带勒让德多项式}。 式中 $(-1)^m$ 叫做 \textbf{Shortley-Condon 相位}， 量子力学中通常会使用该相位， 但在一些文献中不包含这个相位（同样满足微分方程）。
% \addTODO{画函数图}

\subsection{归一化}
连带勒让德函数的归一化系数为（证明略）
\begin{equation}\label{eq_AsLgdr_3}
A_{l,m} = \sqrt{\frac{2l+1}{2}\frac{(l-m)!}{(l+m)!}}~.
\end{equation}
满足正交归一条件
\begin{equation}\label{eq_AsLgdr_4}
\int_{-1}^1 [A_{l',m} P_{l'}^{m}(x)] [A_{l,m} P_l^{m}(x)] \dd{x} = \delta_{l,l'}~.
\end{equation}
注意只有同一个 $m$ 的多项式之间正交。 另外当 $m = 0$ 时， 就回到了\autoref{eq_Legen_4}~\upref{Legen}。

\subsection{其他性质}
\begin{itemize}
\item 当 $m = 0$ 时， 见\enref{勒让德多项式}{Legen}的性质。

\item \textbf{端点值}： 对任意 $l, m$ 有
\begin{equation}\label{eq_AsLgdr_2}
P_l^m(1) = \delta_{m, 0}~,
\qquad
P_l^m(-1) = (-1)^l \delta_{m, 0}~.
\end{equation}
\item 奇偶性
\begin{equation}
P_l^m(-x) = (-1)^{l+m}P_l^m(x)~.
\end{equation}
\item $m$ 取相反数时， 对称或反对称关系为
\begin{equation}
A_{l,-m} P_l^{-m}(x) = (-1)^m A_{l,m} P_l^m(x)~,
\end{equation}
或者
\begin{equation}
P_l^{-m}(x) = (-1)^m \frac{(l-m)!}{(l+m)!} P_l^m(x)~.
\end{equation}
也就是，当把 $m$ 取相反数，归一化的连带勒让德函数会不变（$m$ 为偶）或取相反数（$m$ 为奇）。
\item 求导
\begin{equation}\label{eq_AsLgdr_7} % Mathematica 已验证
\dv{x} P_l^m(x) = \frac{1}{x^2-1} [(l-m+1)P_{l+1}^m(x) - (l+1)xP_l^m(x)]~.
\end{equation}
\begin{equation}\label{eq_AsLgdr_8} % Mathematica 已验证
\dv{x} P_l^m(x) = \frac{1}{(2l+1)(x^2-1)} [l(l-m+1)P_{l+1}^m(x) - (l+1)(l+m)P_{l-1}^m(x)]~.
\end{equation}
\item 特殊值
\begin{equation}\label{eq_AsLgdr_5} % Mathematica 已验证
P_m^m(x) = (-1)^m (2m-1)!! (1-x^2)^{m/2}~.
\end{equation}
\item 递归关系
\begin{equation} % Mathematica 已验证
P_{m+1}^m(x) = x (2m + 1) P_m^m(x)~,
\end{equation}
\begin{equation}\label{eq_AsLgdr_6} % Mathematica 已验证
(l-m) P_l^m = (2l-1) x P_{l-1}^m - (l+m-1) P_{l-2}^m~.
\end{equation}
在数值计算中， 一般使用\autoref{eq_AsLgdr_5} 到\autoref{eq_AsLgdr_6} 求 $P_l^m$。
\end{itemize}


\addTODO{Gaunt' Formula}
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/7bdf34725614dfc8.png}
\caption{Gaunt' Formula} \label{fig_AsLgdr_1}
\end{figure}
这应该可以用 3j 系数来表示。
