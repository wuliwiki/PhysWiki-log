% 施密特正交归一化
% 正交归一基底|线性代数|施密特正交化

\pentry{正交归一基底\upref{OrNrB}}

若在 $M$ 维矢量空间中任意给出 $N \leqslant M$ 个线性无关的矢量， 如何得到一组正交归一化的基底呢？ 我们可以用\textbf{施密特正交归一化（Schmidt orthonormalization）}． 先看一个二维的例子

\begin{example}{二维空间中的几何矢量}
已知两个几何矢量 $\bvec v_1, \bvec v_2$ 坐标分别为 $(2, 1)$， $(1, 2)$． 这两个矢量不共线， 说明它们线性无关． 但容易看出它们既不归一也不正交， 下面来进行施密特正交归一化．

先把 $\bvec v_1$ 归一化， 并记为 $\bvec u_1$
\begin{equation}
\bvec u_1 = \frac{\bvec v_1}{\abs{\bvec v_1}} = \frac{1}{\sqrt{5}} (2, 1)
\end{equation}
然后， 用内积来计算 $\bvec v_2$ 在 $\bvec v_1$ 方向的投影长度
\begin{equation}
\bvec v_2 \vdot \bvec u_1 = \frac{4}{\sqrt{5}}
\end{equation}
所以 $\bvec v_2$ 在平行于 $\bvec v_1$ 方向的分量为
\begin{equation}
\bvec v_2^{||} =  (\bvec v_2 \vdot \bvec u_1)\bvec u_1 = \frac{4}{5} (2, 1)
\end{equation}
将 $\bvec v_2$ 减去平行的分量， 就是垂直的分量
\begin{equation}
\bvec v_2^\bot = \bvec v_2 - \bvec v_2^{||} = \qty(-\frac35, \frac65)
\end{equation}
归一化并记为
\begin{equation}
\bvec u_2 = \frac{\bvec v_2^\bot}{\abs{\bvec v_2^\bot}} = \frac{1}{3\sqrt{5}} (-3, 6)
\end{equation}
现在可以验证， 基底 $\bvec u_1$ 和 $\bvec u_2$ 是正交归一的， 即 $\abs{\bvec u_1} = \abs{\bvec u_2} = 1$， 且 $\bvec u_1 \vdot \bvec u_2 = 0$．
\end{example}

若给出 $M$ 维矢量空间中的 $N$ 个（$N \leqslant M$）线性无关矢量
\begin{enumerate}
\item 将第 1 个矢量归一化得到第 1 个基底
\item 将第 2 个矢量分解为与第 1 个矢量平行和垂直的两个分量， 并将垂直分量归一化得到第 2 个基底
\item 将第 3 个矢量分解为三个部分， 即分别平行于前两个基底的分量和一个垂直分量， 并将垂直分量归一化得到第 3 个基底
\item 对第 $n = 4, \dots , N$ 个基底重复该步骤， 得到第 $n$ 个基底
\end{enumerate}

用公式来表示这个过程， 就是：
\begin{equation}
\bvec v_1^\bot = \bvec v_1
\end{equation}
\begin{equation}
\bvec u_i = \frac{\bvec v_i^\bot}{\abs{\bvec v_i^\bot}} \qquad (i = 1, \dots ,N)
\end{equation}
\begin{equation}\label{SmdtOt_eq1}
\bvec v_i^{||} = \sum _{j=1}^{i-1} (\bvec v_i \vdot \bvec u_j) \bvec u_j \qquad (i = 2, \dots N)
\end{equation}
\begin{equation}\label{SmdtOt_eq2}
\bvec v_i^\bot = \bvec v_i - \bvec v_i^{||} \qquad (i = 2, \dots N)
\end{equation}

\begin{exercise}{}
对三维空间中的矢量 $(2, 1, 1)$， $(1, 2, 1)$ 和 $(1, 1, 2)$ 进行施密特正交归一化．
\end{exercise}

\subsection{推导}
这里来解释\autoref{SmdtOt_eq1} 和\autoref{SmdtOt_eq2}． 我们假设已经知道 $i-1$ 个正交归一的矢量， 由于 $N$ 维空间中必然存在 $N$ 个正交归一基底， 我们可以设剩下 $u_i$ 的也已经知道（或者可以任意取）． 于是 $v_i$ 可以用基底展开为
\begin{equation}
\bvec v_i = \sum _{j=1}^N c_j \bvec u_j
\end{equation}
\autoref{SmdtOt_eq1} 得到前 $i-i$ 项之和
\begin{equation}
\bvec v_i^{||} = \sum _{j=1}^{i-1} c_j\bvec u_j
\end{equation}
所以\autoref{SmdtOt_eq2} 就是第 $i$ 项到第 $N$ 项之和
\begin{equation}
\bvec v_i^\bot = \sum _{j=i}^{N} c_j\bvec u_j
\end{equation}
所以对 $j = 1, \dots , i-1$， 都有 $\bvec v_i^\bot \vdot \bvec u_j = 0$． 也就是说和已有的 $i-1$ 个基底都正交．
