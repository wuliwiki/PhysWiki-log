% 欧几里得矢量空间的正交化、同构及正交群
% 欧氏矢量空间|正交化|同构|正交矩阵|正交群

\begin{issues}
\issueTODO 需说明欧几里得矢量空间和 $\mathbb{R}^n$ 的关系．
\end{issues}

\pentry{欧几里得矢量空间\upref{EuVS}}
\footnote{柯斯特利金,代数学引论,第二卷.}对欧几里得矢量空间 $V$（\autoref{EuVS_def1}~\upref{EuVS}），其上任一基底都可正交标准化，而空间 $V$ 上的对称双线性型 $(*|*)$ 实际上给出了 $V$ 中的度量性质，即长度（\autoref{EuVS_def2}~\upref{EuVS}）和夹角（\autoref{EuVS_def3}~\upref{EuVS}），这意味着就度量性质来说，欧几里得矢量空间 $V$ 和 $\mathbb{R}^n$ 没有差别．由于标准正交基底的重要作用，往往要研究不同标准正交基底之间的转换关系，即两基底对应的过渡矩阵（或转换矩阵），与两标准正交基底对应的过渡矩阵称为正交矩阵，它们将构成一个群，称之正交群．
\subsection{正交化过程}
\begin{theorem}{标准正交化过程}\label{EVOIOG_the1}
设 $\{\bvec e_1,\cdots,\bvec e_m\}$ 是 $n$ 维欧几里得矢量空间 $V$ 中的一组 $m$ 个线性无关的矢量．那么，存在一个标准正交矢量组 $\{\uvec e'_1,\cdots,\uvec e'_m\}$ ，使得线性包络（或称张成空间\autoref{VecSpn_def1}~\upref{VecSpn}）
\begin{equation}
L_i=\langle\bvec e_1,\cdots,\bvec e_i\rangle
\end{equation}
和
\begin{equation}
L'_i=\langle\uvec e'_1,\cdots,\uvec e'_i\rangle
\end{equation}
当 $i=1,\cdots,m$ 时都重合，$m\leq n$．
\end{theorem}
\textbf{证明：}令 $\uvec e'_1=\lambda\bvec e_1,\;\lambda=\norm{\bvec e_1}^{-1}$，则 $L_1=\langle\bvec e_1\rangle=\langle \uvec e'_1\rangle=L'_1$ 显然成立，即 $m=1$ 的情形．

设当 $1\leq k<m$ 时，已构造出所需的矢量组 $\{\uvec e'_1,\cdots,\uvec e'_k\}$，使得 $L_1=L'_i,\;i=1,\cdots,k$．我们来找出 $\uvec e'_{k+1}$．

首先，矢量 $\bvec e_{k+1}$ 不包含在 $L_k=L'_k$ 中（否则，$\bvec e_{k+1}$ 可用 $\bvec e_1,\cdots,\bvec e_k$ 线性表示）．令
\begin{equation}
\bvec v=\bvec e_{k+1}-\sum_{i=1}^{k}\lambda_i\uvec e'_i
\end{equation}
而 $\lambda_1,\cdots,\lambda_k$ 是任意纯量（显然 $\bvec v\neq\bvec 0$）．于是
\begin{equation}
L_{k+1}=\langle\bvec e_1,\cdots,\bvec e_k,\bvec e_{k+1}\rangle=\langle\bvec e_1,\cdots,\bvec e_k,\bvec v\rangle
\end{equation}
如果 $\bvec v\perp L'_k$，那么便找到了 $\uvec e'_{k+1}=\frac{\bvec v}{\norm{\bvec v}}$ ．而做到这一点的充要条件是，对任意 $j=1,\cdots,k$，成立
\begin{equation}
\begin{aligned}
&0=\qty(\bvec v|\uvec e'_j)=\qty(\bvec e_{k+1}|\uvec e'_j)-\qty(\sum_{i=1}^k\lambda_i\uvec e'_i|\uvec e'_j)\\
&=\qty(\bvec e_{k+1}|\uvec e'_j)-\sum_{i=1}^k\lambda_i(\uvec e'_i|\uvec e'_j)=\qty(\bvec e_{k+1}|\uvec e'_j)-\lambda_j
\end{aligned}
\end{equation}
故只需取 $\lambda_j=\qty(\bvec e_{k+1}|\uvec e'_j)$ 即可．于是，便得到了标准正交组 $\uvec e'_1,\cdots,\uvec e'_k$，且 $L_{k+1}=L'_{k+1}$．

由数学归纳法，\textbf{定理得证}！

\begin{theorem}{}\label{EVOIOG_the2}
设 $L$ 是有限维欧几里得矢量空间 $V$ 的一个子空间，$L^{\perp}$ 是它的正交补，那么
\begin{equation}
V=L\oplus L^{\perp},\quad L^{\perp\perp}=L.
\end{equation}
\end{theorem}
\textbf{证明：}在 $L$ 中取任一标准正交基 $(\bvec e_1,\cdots,\bvec e_m)$，如\autoref{EVOIOG_the1} 中找出 $\bvec v$ 的过程一样，可知对 $\forall \bvec w\in V$，矢量 $\bvec v$:
\begin{equation}
\bvec v=\bvec w-\sum_{i=1}^m(\bvec w|\bvec e_i)\bvec e_i
\end{equation}
正交于 $L$，即 $\bvec w=\bvec u+\bvec v$，其中 $\bvec u=\sum_{i=1}^m(\bvec w|\bvec e_i)\bvec e_i\in L$ ，而 $\bvec v\in L^{\perp}$，亦即 $V=L+L^{\perp}$．

要证 $V=L\oplus L^{\perp}$ ，只需证 $L\cap L^{\perp}=\bvec 0$．设 $\bvec x\in L\cap L^{\perp}$，则 $(\bvec x|L)=0$，又 $\bvec x\in L$，于是 $(\bvec x|\bvec x)=0$，由纯量积的正定性，$\bvec x=\bvec 0$，从而 $V=L\oplus L^{\perp}$ ．

任意 $\bvec w\in L^{\perp\perp}$，由 $V=L\oplus L^{\perp}$ ，有 $\bvec w=\bvec u+\bvec v(\bvec u\in L,\bvec v\in L^{\perp})$，于是 $(\bvec w|\bvec v)=\norm{\bvec v}^2=0$，故 $\bvec w=\bvec u\in L$，于是 $L^{\perp\perp}\subset L$ ．其次，由 $L^{\perp\perp}=(L^{\perp})^{\perp}$ ，而 $(L|L^{\perp})=0$，从而 $L\subset L^{\perp\perp}$．于是 $L^{\perp\perp}=L$．

\textbf{证毕！}
\subsection{欧几里得矢量空间的同构}
\begin{theorem}{}
任意两个维数相同的欧几里得矢量空间 $V,V'$ 都是同构的．即存在矢量空间的同构映射 $f:V\rightarrow V'$，它还保持纯量乘积：
\begin{equation}
(\bvec x|\bvec y)=(f(\bvec x)|f(\bvec y))'
\end{equation}
其中，$(*|*)'$ 是 $V'$ 上的纯量乘积．
\end{theorem}
\textbf{证明：} 取 $V,V'$ 的标准正交基底 $\{\uvec e_i\}$ 和 $\{\uvec e'_i\}$ ．则映射：
\begin{equation}
f:\bvec x=\sum_{i=1}^{n}x_i\uvec e_i\mapsto\bvec x'=\sum_{i=1}^{n}x_i\uvec e'_i
\end{equation}
显然是个线性的双射\footnote{若线性的双射 $f$ 将矢量空间 $V$ 映到矢量空间 $W$，则 $f$ 就称为 $V$ 到 $W$ 的同构映射，而称 $V$ 和 $W$ 同构．}．并且由于选取的基底皆为标准正交基，所以纯量乘积 $(\bvec x|\bvec y)$ 和 $(\bvec x'|\bvec y')'$ 都按同一公式进行．

\textbf{证毕!}

若固定矢量 $\bvec v$，则映射
\begin{equation}
\varphi_\bvec{v}=(\bvec v|*):V\rightarrow\mathbb{R}
\end{equation}
是 $V$ 上的线性映射，即 $(\bvec v|*)\in V^*$\footnote{$V^*$即 $V$ 的对偶空间．}．
\begin{theorem}{}\label{EVOIOG_the3}
映射 $\varphi:\bvec v\mapsto (\bvec v|*)=\varphi_\bvec v$ 是矢量空间 $V$ 到 $V^*$ 的自然同构\footnote{即该同构不依赖于基的选择}．在此同构下，$V$ 的基底 $\uvec e_1,\cdots,\uvec e_n$ 被映射到 $V^*$ 中与其对偶的基底 $e^1,\cdots,e^n$，即 $\varphi_\uvec{e_i}=e^i$．
\end{theorem}
\textbf{证明：}$\varphi$ 是线性的：
\begin{equation}
\varphi_{(\alpha\bvec u+\beta\bvec v)}=(\alpha\bvec u+\beta\bvec v|*)=\alpha(\bvec u|*)+\beta(\bvec v|*)=\alpha\varphi_\bvec{u}+\beta\varphi_\bvec{v}.
\end{equation}
因为 
\begin{equation}
\bvec v\in \mathrm{Ker}\,\varphi\Rightarrow(\bvec v|\bvec x)=0,\forall\bvec x\in V
\end{equation}
所以 $(\bvec v|\bvec v)=0\Rightarrow\bvec v=\bvec 0$ ，故$\mathrm{Ker}\,\varphi=\bvec 0$ ，于是 $\varphi$ 为单射．

$V^*$ 上任意元素必可由 $V^*$ 的基底线性表示，故若 $V^*$ 的任一基底都有 $V$ 的元与之对应，则 $\varphi$ 为满射．特别地
\begin{equation}
\varphi_{\uvec e_i}=(\uvec e_i|*)=\sum_{j=1}^{n} a_{ij}e^j
\end{equation}
因为  $\uvec e_1,\cdots,\uvec e_n$ 是标准正交基底，所以
\begin{equation}
a_{ij}=\sum_{k=1}^n a_{ik}e^k(\uvec e_j)=(\uvec e_i|\uvec e_j)=\delta_{ij}
\end{equation}
于是有 $\varphi_{\uvec e_i}=e^i$．这就证明了满射性．进而，$\varphi$ 是双射．显然，定义 $\varphi$ 的过程并没有选择特定的基底，即 $\varphi$ 是矢量空间 $V$ 到 $V^*$自然同构．

\textbf{证毕！}

由于同构的双方可认为是同一事物的不同表现形式，这意味着，欧几里得矢量空间中每一矢量 $\bvec v$ 都可看成是一个线性函数 $\bvec v:V\rightarrow\mathbb{R}$．（即把 $\bvec v$ 看成 $V$ 的线性函数时，$\bvec v$ 相当于 $\varphi_{\bvec v}=(\bvec v|*)$）．
\subsection{正交群}\label{EVOIOG_sub1}
设 $(\uvec e_1,\cdots,\uvec e_n)$ 和 $(\uvec e'_1,\cdots,\uvec e'_n)$ 是矢量空间 $V$ 的不同标准正交基底．设 $\uvec e'_i$ 到 $\uvec e_i$ 的转换矩阵为 $\mat A=(a_{ij})$，即
\begin{equation}\label{EVOIOG_eq3}
\uvec e'_j=\sum_{i=1}^n a_{ij}\uvec e_i
\end{equation}
由于
\begin{equation}
\begin{aligned}
\delta_{ij}&=(\uvec e'_i|\uvec e'_j)=\qty(\sum_{k=1}^n a_{ki}\uvec e_k|\sum_{l=1}^n a_{lj}\uvec e_l)=\sum_{k,l}a_{ki}a_{lj}(\uvec e_k|\uvec e_l)\\
&=\sum_{k}a_{ki}a_{kj}
\end{aligned}
\end{equation}
所以 
\begin{equation}\label{EVOIOG_eq1}
\mat A^T \mat A=\mat E.
\end{equation}
从而 $\mat A^T=\mat A^{-1}$．而 $\mat{AA}^{-1}=\mat E$ ，故又有
\begin{equation}\label{EVOIOG_eq2}
\mat{AA}^T=\mat E
\end{equation}
\begin{definition}{正交矩阵}
满足\autoref{EVOIOG_eq1} 和\autoref{EVOIOG_eq2} 的任一矩阵 $\mat A$ 称为\textbf{正交矩阵}．所有 $n$ 阶正交矩阵的集合记为 $O(n)$．
\end{definition}
这就是说，两个标准正交基之间的转换矩阵为正交矩阵．反过来，设 $\mat A$ 是正交矩阵，那么由标准正交基底 $(\uvec e_1,\cdots,\uvec e_n)$ 按\autoref{EVOIOG_eq3} 得到的矢量组也是标准正交基底，即下面定理成立
\begin{theorem}{}
由一个标准正交基底到另一个标准正交基底的转换矩阵是正交矩阵，而且，所有正交矩阵都可以是这种转换矩阵．
\end{theorem}

设 $\mat A,\mat B$ 是两正交矩阵，则 $\mat{(AB)}^T\mat{(AB)}=\mat B^T\mat A^T\mat{AB}=\mat E$（几何意义就是将一个标准正交基底 $\{ \uvec e_i\}$ 通过 $B$ 转换到另一标准正交基底 $\{\uvec e'_i\}$，再将 $\{\uvec e'_i\}$ 通过 $\mat A$ 转到另一标准正交基底 $\{\uvec e''_i\}$），即正交矩阵的矩阵乘法也是正交矩阵（封闭性）．由于矩阵乘法满足结合律，并且 $\mat A$ 有逆元 $\mat A^T$ ，且 $\mat E$ 也是正交矩阵，所以 $O(n)$ 构成一个群\upref{Group}．
\begin{definition}{正交群}
所有正交矩阵构成的集合 $O(n)$ 称为\textbf{正交群}．
\end{definition}

由\autoref{EVOIOG_eq3} 
\begin{equation}
a_{ij}=(\uvec e_i|\uvec e'_j)=\cos{\theta_{ij}}
\end{equation}
其中 $\theta_{ij}$ 是基底矢量 $\uvec e_i$ 和 $\uvec e'_j$ 的夹角．这便是正交矩阵元的几何解释．由正交矩阵的定义\autoref{EVOIOG_eq1} ，显然，所有正交矩阵行列式为 1 或 -1．