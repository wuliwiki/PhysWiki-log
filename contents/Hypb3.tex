% 双曲线（高中）
% keys 极坐标系|直角坐标系|圆锥曲线|双曲线|渐近线
% license Xiao
% type Tutor

\begin{issues}
\issueDraft
\end{issues}

\pentry{解析几何\nref{nod_JXJH}，圆\nref{nod_HsCirc}，椭圆\nref{nod_Elips3}，复数\nref{nod_CplxNo}}{nod_fd80}

在发电厂中，有一种高大耸立的冷却装置，叫作“冷却塔”（见 \autoref{fig_Hypb3_3} 右侧）。乍一看，它像是两个圆台底朝底叠在一起，但仔细看会发现，它的边缘并非直线，而是略微弯曲的曲线。而与圆台相似，冷却塔的外形也通过一条特定的曲线绕着一条轴旋转得到。它之所以设计成这样，并不单单是为了好看，而是因为这样可以更好地抵抗大风、减少材料使用，还能提高散热效率。而这些效果，其实都和这条曲线在数学上的一些特殊性质有关。

\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/9d8f8fdb10436630.png}
\caption{冷却塔} \label{fig_Hypb3_3}
\end{figure}

在数学中，这类曲线早就被深入研究过。它由两条对称、互不相交的分支组成，虽然共用同一个坐标原点，但却分别朝着相反的方向无限延伸，永远不会相遇。这种曲线被称为“双曲线”。很多读者第一次听到“双曲线”这个词，可能是在初中学习反比例函数的时候。当时常听到一句话：“反比例函数的图像是双曲线。”那时候的理解可能还很简单，只是觉得图像上有“两根”弯曲的线条，所以叫“双曲线”。至于它更深层的结构和性质，课堂上一般不会讲太细，学生自然也无从深入探究。

不过，相信读者还记得，反比例函数的图像有两条渐近线。那么，既然它是双曲线的图像，就可以合理猜想：双曲线也应该有两条渐近线。后面会说明，这个猜想是对的。虽然在高中阶段，“渐近线”这个概念不常被强调，但它其实在双曲线中非常重要，前面所说冷却塔的特性，很大一部分就是基于双曲线与渐近线的关系。双曲线的两个分支会越来越靠近各自的渐近线，但始终不会真正相交。本文在介绍双曲线的过程中，也会进一步分析它和渐近线之间的关系，帮助读者更全面地理解这种特殊的曲线。

\subsection{“反比例函数的图像是双曲线”}\label{sub_Hypb3_1}

虽然“双曲线”作为一个几何概念相对陌生，但反比例函数却早已很熟悉了。既然反比例函数的图像其实就是双曲线的一种特殊情形，那么不妨从它出发，来看看这个熟悉的图像是如何逐步变化成 \autoref{fig_Hypb3_3} 中冷却塔那样的形状。

\begin{example}{求反比例函数$\displaystyle y={1\over x}$的图像逆时针旋转$45^\circ$后的表达式。}\label{ex_Hypb3_1}
根据\aref{图像旋转的规律}{sub_FunTra_3}，将$\displaystyle y={1\over x}$逆时针旋转$45^\circ$，即$\displaystyle\theta=-{\pi\over4}$。
\begin{equation}\label{eq_Hypb3_2}
\begin{cases}
\displaystyle
X_0&=X_1 \cos \left(-{\displaystyle\frac{\pi}{4}}\right) + Y_1 \sin  \left(-{\displaystyle\frac{\pi}{4}}\right)\\
Y_0&=Y_1 \cos  \left(-{\displaystyle\frac{\pi}{4}}\right) - X_1 \sin  \left(-{\displaystyle\frac{\pi}{4}}\right)\\
\end{cases}\implies
\begin{cases}
X_0&={\displaystyle\frac{1}{\sqrt{2}}}(X_1 - Y_1)\\
Y_0&={\displaystyle\frac{1}{\sqrt{2}}}(Y_1+ X_1) \\
\end{cases}~.
\end{equation}
将\autoref{eq_Hypb3_2} 代入$xy=1$有：
\begin{equation}
\displaystyle
{1\over\sqrt{2}}(X_1 - Y_1)\cdot{1\over\sqrt{2}}(Y_1+ X_1)=1\implies {X_1^2\over2}- {Y_1^2\over2}=1~.
\end{equation}
即旋转后的方程是：
\begin{equation}\label{eq_Hypb3_5}
{x^2\over2}- {y^2\over2}=1~.
\end{equation}
\begin{figure}[ht]
\centering
\includegraphics[width=14.25cm]{./figures/41b35b712da2eb8d.png}
\caption{旋转前后的图像} \label{fig_Hypb3_4}
\end{figure}
\end{example}

从 \autoref{fig_Hypb3_4} 可以看出，旋转后的图像在 $y = 1$ 以下的部分，看起来就像一个矮胖的“冷却塔”。由于旋转变换不会改变图形的形状，原本反比例函数图像的两条渐近线——$x$ 轴和 $y$ 轴，在旋转后变成了 $y = \pm x$。换句话说，图像虽然向两个方向无限延伸，但始终不会越过 $y = \pm x$ 这两条直线所形成的“边界”。

再来看 \autoref{eq_Hypb3_5}，这个式子的结构可能会让人感到眼熟。它和半径为 $\sqrt{2}$ 的圆的方程非常相似，唯一的不同是 $y^2$ 前的符号变了。这种细微的差异不禁让人联想到椭圆：椭圆的方程与圆的方程之间，也只是系数不同而已。然而，双曲线的图像与圆或椭圆看起来差别却很大，双曲线甚至都不是封闭的曲线，它们之间会存在什么联系呢？

\subsection{双曲线的几何定义}

在研究椭圆时曾提到，若从圆的定义出发尝试推广，就需要对定义的表达方式进行调整。圆可以看作是满足 $|O_1P| = |O_2P| = r$ 的点的集合，其中第二个等号打开时，即只保证$|O_1P| = |O_2P|$可以得到所有点关于两个定点的垂直平分线的集合；而如果“打开”第一个等号，将 $|O_1P| = r$ 和 $|O_2P| = r$ 视为两个独立的初始条件，而不再要求它们始终相等，那么就可以得到新的图形。

此时，如果固定两段距离的和为常数，即 $|O_1P| + |O_2P| = m$，就得到了椭圆。那么，如果将关注点转向两段距离的差，例如 $|O_1P| - |O_2P| = 0$，这看起来只是重新回到了 $|O_1P| = |O_2P|$，即垂直平分线的情形。但如果像椭圆那样固定这两个距离的差为一个非零常数 $m$，也就是说：$\left||O_1P| - |O_2P|\right| = m$，将会得到什么样的图形？

\begin{example}{对两定点 $F_1(c, 0)$ 和 $F_2(-c, 0),(c>0)$，若点$P$满足$|PF_1| - |PF_2| = m,(0<m <2c)$，求$P$方程。}
解：

设椭圆上的任意点为 $P(x, y)$，根据题意有：
\begin{equation}
\sqrt{(x + c)^2 + y^2} - \sqrt{(x - c)^2 + y^2} = m~.
\end{equation}
移项后，两边平方有：
\begin{equation}
(x + c)^2 + y^2 = m^2 + 2m\sqrt{(x - c)^2 + y^2} + (x - c)^2 + y^2~.
\end{equation}
打开整理有：
\begin{equation}
2m\sqrt{(x - c)^2 + y^2}= 4cx - m^2~.
\end{equation}
两边平方，打开有：
\begin{equation}\label{eq_Hypb3_6}
4m^2(x^2 - 2cx+c^2) + 4m^2y^2= m^4-4m^2\cdot2cx+16c^2x^2~.
\end{equation}
整理后得到：
\begin{equation}
4(m^2 -4c^2)x^2 + 4m^2y^2= m^2(m^2-4c^2)~.
\end{equation}
两侧同时除以$(m^2-4c^2)m^2$后得到：
\begin{equation}\label{eq_Hypb3_3}
\frac{x^2}{\left(\displaystyle\frac{m}{2}\right)^2} -\frac{y^2}{\displaystyle c^2-\left(\frac{m}{2}\right)^2}=1~.
\end{equation}
由于$2c>m>0$，也就是$\displaystyle c^2-\left(\frac{m}{2}\right)^2>0$。

需要注意的是，题目中的条件 $|PF_1| - |PF_2| = m > 0$ 隐含了一个默认关系，即：
\begin{equation}
|PF_1| > |PF_2|~.
\end{equation}
，因此题目的最终答案应该只包含 $x > 0$ 的区域，既：
\begin{equation}
\frac{x^2}{\left(\displaystyle\frac{m}{2}\right)^2} -\frac{y^2}{\displaystyle c^2-\left(\frac{m}{2}\right)^2}=1,\qquad(x>0)~.
\end{equation}

但显然，\autoref{eq_Hypb3_3} 中的$x$只有偶次方项，也就是说，它的图像应该是关于$y$轴对称的。因此，在 $x< 0$ 的区域，还应该存在一个与右侧对称的图像，而这对应的其实就是 $|PF_2| > |PF_1|$ 的情况。因此，如果将条件改为 $||PF_1| - |PF_2|| = m$，其中 $0 < m < 2c$，就可以完整对应 \autoref{eq_Hypb3_3} 的表达式，图像呈左右对称分布，包含两条曲线。
\end{example}

可以看到，虽然题目把原本椭圆里“不变量是两个距离的和”改成了“不变量是两个距离的差”，但对比 \aref{椭圆的推导过程}{ex_Elips3_1} 会发现，从 \autoref{eq_Hypb3_6} 开始，两边推导出来的过程其实是一样的。真正的区别，只是参数的大小关系变了：椭圆里是 $m>2c$，而这里变成了 $m<2c$。为了让公式里的分母保持正数，最终\autoref{eq_Hypb3_3} 和 \aref{椭圆的推导结果}{eq_Elips3_4} 的样子看上去才有了点差别。通常，为了方便记录，也为了与椭圆的写法统一，规定正号对应的参数记作 $a^2$，负号对应的参数记作 $b^2$。需要注意的是，这里的 $a$ 和 $b$ 的定义与椭圆中略有不同，没有要求两者绝对值的大小关系。根据这个约定，有：
\begin{equation}\label{eq_Hypb3_10}
\left(\displaystyle\frac{m}{2}\right)^2=a^2\qquad c^2-\displaystyle\left(\frac{m}{2}\right)^2=b^2~.
\end{equation}
整理可得：
\begin{equation}\label{eq_Hypb3_12}
m=2a\qquad a^2+b^2=c^2~.
\end{equation}
熟悉的平方和形式再次出现，不过这一次，$a,b,c$的位置发生了变化，这一点需要特别留意。

对比推导得到的 \autoref{eq_Hypb3_3} 和 \autoref{eq_Hypb3_5}，可以看到它们在形式上完全一致\footnote{例如 $\displaystyle\left( \frac{m}{2} \right)^2 = c^2 - \left( \frac{m}{2} \right)^2 = 2\implies m = 2\sqrt{2}, c = 4$}。这也说明，\autoref{eq_Hypb3_3} 的两条曲线其实就是双曲线。就这样，\autoref{sub_Hypb3_1} 是从反比例函数的角度认识双曲线，而此处则是从几何条件出发，推导出了双曲线的表达式。而题目中给出的条件，实际上正是双曲线的几何定义，也称为\textbf{双曲线的第一定义}。

\begin{definition}{双曲线的几何定义}
在平面上，所有满足到两个定点 $F_1$ 与 $F_2$ 的距离之差的绝对值为常数 $2a$ 的点 $P$ 的轨迹，构成一个几何图形，称为\textbf{双曲线（hyperbola）}。即，对于双曲线上的任意一点 $P$，都有：
\begin{equation}
||PF_1| - |PF_2|| = 2a ,\qquad(2a<|F_1F_2|)~.
\end{equation}
其中，$F_1$ 和 $F_2$ 被称为双曲线的两个\textbf{焦点（focus）}，两焦点之间的距离 $|F_1F_2|$ 称为椭圆的\textbf{焦距（focal distance）}，记作 $2c$，其中 $c$ 被称为\textbf{半焦距（semi-focal distance）}，也称为双曲线的\textbf{线性离心率（linear eccentricity）}。
\end{definition}

如之前所说，这个定义和椭圆的定义几乎没有什么区别。类似地，如果将 \autoref{ex_Hypb3_1} 中两个定点设为 $F_1(0,-c)$ 和 $F_2(0,c)$，其中 $c>0$，相当于将原先的 $x$ 轴与 $y$ 轴互换，得到的表达式为：
\begin{equation}\label{eq_Hypb3_7}
\frac{y^2}{\left(\displaystyle\frac{m}{2}\right)^2}-\frac{x^2}{\displaystyle c^2-\left(\frac{m}{2}\right)^2} =1~.
\end{equation}
与椭圆不同的是，这里不仅分母位置发生了变化，参数的符号也需要随之调整。

与标准椭圆的图像与坐标轴有四个交点存在显著区别的是，双曲线与坐标轴只有两个交点。对于 \autoref{eq_Hypb3_3}，令 $y=0$ 时，得到图像与 $x$ 轴的两个交点，采用\autoref{eq_Hypb3_10} 的记法为：
\begin{equation}
x = \pm a~.
\end{equation}
双曲线与坐标轴的交点称为\textbf{顶点（vertex）}，连接两个顶点的线段称为\textbf{实轴（transverse axis）}\footnote{注意区分这里与复平面中“实轴”和“虚轴”的含义不同。}，长度为 $2a$，其中 $a$ 被称为\textbf{半实轴（semi-transverse axis）}。与椭圆类似，双曲线的焦点也始终位于实轴上。

而令 $x=0$ 时，在实数范围内无解，这说明双曲线与y轴并无交点。不过在复数范围内有解：
\begin{equation}
y = \pm  b\I~.
\end{equation}
将复数解中虚部所对应的位置标在另一条坐标轴上，得到\textbf{虚顶点（co-vertex）}，连接两虚顶点的线段称为\textbf{虚轴（conjugate axis）}，长度为 $2b$，其中 $b$ 被称为\textbf{半虚轴（semi-conjugate axis）}。

将虚、实顶点及\autoref{eq_Hypb3_12} 中得到的$a,b,c$的关系标记在图上，如\autoref{fig_Hypb3_9} 所示。其中：$A_1,A_2$为实顶点，$B_1,B_2$为虚顶点，$F_1,F_2$为焦点。
\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/f22e7cc467ae1fb5.png}
\caption{$a,b,c$关系及虚、实顶点} \label{fig_Hypb3_9}
\end{figure}

相信读者在这里可能会好奇：既然是“虚”的，为什么还要在图上标出来？虚顶点与双曲线，在图上看上去好像没什么关系？虚轴到底有什么用呢？其实，在更高阶段的数学中，比如复变函数的理论里，这些虚轴和虚顶点是有真实几何意义的。当把函数的定义域从实数扩展到复数后，它们对应的\aref{图形结构}{fig_Hypb3_2}就会真正出现。当然这也与后面会介绍到的共轭双曲线有关系\footnote{对比\autoref{fig_Hypb3_2} 中左上角的图和\autoref{fig_Hypb3_8}，可以发现它们的形状非常相似，这并不是巧合，而是共轭的含义背后自然体现出来的结果。}。不过因为高中阶段暂时不涉及复变函数，所以这里只是简单提一提，满足一下对数学结构感兴趣的读者的好奇心。

\begin{figure}[ht]
\centering
\includegraphics[width=14.2cm]{./figures/457f263feb62b8e9.png}
\caption{复数域下的双曲线} \label{fig_Hypb3_2}
\end{figure}

\subsection{双曲线的方程}

从\autoref{eq_Hypb3_3} 和\autoref{eq_Hypb3_7} 下手，整理代换后可以得到双曲线的标准方程：

\begin{theorem}{双曲线的标准方程}
\begin{itemize}
\item 实轴在$x$轴上，虚轴在$y$轴上的双曲线标准方程\footnote{也称为焦点在$x$轴上的双曲线标准方程，下面同理。}为：
\begin{equation}\label{eq_Hypb3_4}
\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1~.
\end{equation}
\item 实轴在$y$轴上，虚轴在$x$轴上的双曲线标准方程为：
\begin{equation}
\frac{y^2}{a^2} -\frac{x^2}{b^2}  = 1~.
\end{equation}
\end{itemize}
\end{theorem}

需要特别注意 $a,b$ 与虚实轴的对应关系。另外，如果保持 $x,y$ 对应的参数不变，只改变符号，也就是说，让虚轴和实轴交换位置，就会得到：
\begin{equation}\label{eq_Hypb3_14}
\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1,\qquad \frac{y^2}{b^2} - \frac{x^2}{a^2} = 1 ~.
\end{equation}
这时，称两条双曲线互为\textbf{共轭双曲线（conjugate hyperbola）}，如\autoref{fig_Hypb3_8} 所示。这里的“共轭”一词，与复数中提到的共轭概念是同一个意思。简单来说，可以把 \autoref{eq_Hypb3_14} 中右边的方程，看作是左边的方程等号右侧的 $1$ 变成 $-1$得到的。

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/2df97e773936c1ed.png}
\caption{共轭双曲线} \label{fig_Hypb3_8}
\end{figure}



就像其他的方程那样，只要得到的表达式符合标准方程的形式，那么就可以确定其图像为双曲线。而已知的三角关系里面，并没有能够用来直接得到双曲线参数方程的关系。因此，尽管下面为了知识的完整性会给出双曲线的参数方程，但在高中阶段并不要求。

\begin{theorem}{*双曲线的参数方程}
\begin{itemize}
\item 实轴在$x$轴上，虚轴在$y$轴上的双曲线参数方程\footnote{也称为焦点在$x$轴上的双曲线标准方程，下面同理。}为：
\begin{equation}
\begin{cases}
x(\theta) = a \cosh \theta\\
y(\theta) = b \sinh \theta
\end{cases},\quad \theta \in [0, 2\pi) ~.
\end{equation}
\item 实轴在$y$轴上，虚轴在$x$轴上的双曲线标准方程为：
\begin{equation}
\begin{cases}
x(\theta) = b \sinh \theta\\
y(\theta) = a \cosh \theta
\end{cases},\quad \theta \in [0, 2\pi) ~.
\end{equation}
\end{itemize}
其中：$\cosh t$ 和 $\sinh t$等为\textbf{双曲函数（hyperbolic functions）}\footnote{类似于三角函数，双曲函数也有一些恒等关系。因而借用了正弦、余弦、正切等名称}，分别称作\textbf{双曲余弦（hyperbolic cosine）}和\textbf{双曲正弦（hyperbolic sine）}。它们的定义分别是
\begin{equation}
\cosh t = \frac{e^t + e^{-t}}{2}, \quad \sinh t = \frac{e^t - e^{-t}}{2}~.
\end{equation}
满足恒等关系：
\begin{equation}
\cosh^2 t - \sinh^2 t = 1~.
\end{equation}
\end{theorem}


\subsubsection{双曲线族}

与\aref{椭圆族}{eq_Elips3_10}类似，如果把双曲线的标准方程右侧的1替换为参数$\lambda$，就可以得到双曲线族：

\begin{equation}\label{eq_Hypb3_8}
\frac{x^2}{a^2} - \frac{y^2}{b^2} = \lambda~.
\end{equation}

同样，它代表着与双曲线$\displaystyle\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1$具有相似性质的一族双曲线。

\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/1c4d60c29492e547.png}
\caption{\autoref{eq_Hypb3_8} 取$\lambda=0.5,1,1.5,1.75,2$时的图像} \label{fig_Hypb3_5}
\end{figure}


不过与椭圆不同的是，这里并不限制$\lambda$必须为正，事实上只要$\lambda\neq0$都能得到一条双曲线。假设$\lambda<0$，取$\eta=-\lambda$就能得到：
\begin{equation}\label{eq_Hypb3_9}
\frac{y^2}{b^2}-\frac{x^2}{a^2} = \eta~.
\end{equation}
\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/4f4a940b64b83563.png}
\caption{\autoref{eq_Hypb3_9} 取$\eta=0.5,1,1.5,1.75,2$时的图像} \label{fig_Hypb3_6}
\end{figure}

将他们放在同一个图中时，就可以非常明显地看出，这些双曲线拥有的一个共同性质就是渐近线相同\footnote{当然，还有一个共同性质就是它们的\aref{离心率}{def_HsCsFD_1}也相同。}。

\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/190e2dbb571796b2.png}
\caption{\autoref{fig_Hypb3_5} 与\autoref{fig_Hypb3_6} 放在同一个图片中的图像} \label{fig_Hypb3_7}
\end{figure}
\subsection{渐近线}
\begin{figure}[ht]
\centering
\includegraphics[width=4.8cm]{./figures/eb70b650d9fa932b.pdf}
\caption{双曲线的渐近线} \label{fig_Hypb3_1}
\end{figure}
\textbf{渐近线（asymptotes）}

当 $x,y$ 都无穷大时， \autoref{eq_Hypb3_4} 中的 $1$ 可以忽略不计，有 $y/x = \pm b/a$，\enref{渐近线}{Asmpto}与 $x$ 轴夹角为
\begin{equation}\label{eq_Hypb3_1}
\theta_0 = \arctan(b/a)~.
\end{equation}
两条渐近线到两个焦点的距离都为
\begin{equation}\label{eq_Hypb3_11}
c\sin\theta_0 = c\cdot b/c = b~.
\end{equation}

事实上这么推导渐近线并不严谨， 在学习了高数的相关内容（见“\enref{泰勒展开}{Taylor}”）后，由\autoref{eq_Hypb3_4} 得
\begin{equation}
y = \frac{bx}{a} \sqrt{1-\frac{a^2}{x^2}}~.
\end{equation}
把根号部分关于 $a^2/x^2$ 进行泰勒展开， 有
\begin{equation}\label{eq_Hypb3_13}
y = \frac ba x - \frac{ab}{2x} + \order{\frac{1}{x^3}}~.
\end{equation}
所以当 $x\to\infty$ 时， 就有渐进线 $y = bx/a$。 之所以要这样做， 是为了防止\autoref{eq_Hypb3_13} 右边出现常数项。 如果存在常数项 $\lambda$， 那么双曲线的渐近线就是 $y = bx/a + \lambda$ 了。

\subsection{双曲线的性质}
面积









