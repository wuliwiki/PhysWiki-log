% 虚位移、虚功、虚功原理
% license Xiao
% type Tutor

\begin{issues}
\issueTODO
\end{issues}

\pentry{广义力\nref{nod_LagEqQ}}{nod_5e18}

在拉格朗日方程（\autoref{eq_LagEqQ_1}~\upref{LagEqQ}）（$i=1,\dots,N$， 下同）
\begin{equation}\label{eq_VirWrk_1}
\dv{t} \pdv{L}{\dot q_i} = \pdv{L}{q_i} + Q_i^{(e)}~.
\end{equation}
描述的系统中， 假设系统中只有稳定约束\footnote{例如\autoref{ex_Lagrng_3}~\upref{Lagrng}和\autoref{ex_Lagrng_4}~\upref{Lagrng}中具有不稳定约束， 所以虚功原理不适用。}， 即每个质点的位置 $\bvec r_i$ 不显含时， 且 $V$ 不显含 $\dot q$。 若系统不随时间变化（即每个广义坐标 $q_i$ 不随时间变化）， 那么每个广义力（包括势能产生的）都恒为零
\begin{equation}\label{eq_VirWrk_2}
Q_i = -\pdv{V}{q_i} + Q_i^{(e)} = 0~.
\end{equation}
而根据广义力的定义（\autoref{eq_LagEqQ_3}~\upref{LagEqQ}）， 有
\begin{equation}
Q_i = \sum_j \bvec F_j^{(a)} \vdot \pdv{\bvec r_j}{q_i} = 0~,
\end{equation}
其中 $\bvec F_j^{(a)}$ 是作用于点 $\bvec r_j$ 的所有主动力（即非约束力）的合力。 也可以写成类似于微分形式
\begin{equation}\label{eq_VirWrk_3}
\sum_j \bvec F_j^{(a)} \vdot \delta \bvec r_j = 0~.
\end{equation}
其中
\begin{equation}
\delta \bvec r_j = \pdv{\bvec r_j}{q_i}\delta{q_i}~,
\end{equation}
这里之所以把 $\bvec r_j$ 的微小增量记为 $\delta \bvec r_j$ 而不是微分 $\dd{\bvec r_j}$， 是因为他们是把时间暂停后一些假想的位移， 叫做\textbf{虚位移（virtual displacement）}。 而现实中系统中 $\bvec r_j$ 的微分为
\begin{equation}
\dd{\bvec r_j} = \pdv{\bvec r_j}{q_i}\dot{q}_i\dd{t} + \pdv{\bvec r_j}{t}\dd{t}~,
\end{equation}
系统静止时所有的点 $\bvec r_j$ 都不随时间变化， 有 $\dd{\bvec r_j} = \bvec 0$， 所以要加以区分。

\autoref{eq_VirWrk_3} 左边的求和就叫做\textbf{虚功（virtual work）}， 可记为 $\delta W$， 下文会详细讨论。 所以\autoref{eq_VirWrk_3} （或者等价的\autoref{eq_VirWrk_2}）称为\textbf{虚功原理（principle of virtual work）}。 虚功原理给出了\textbf{使系统保持静止（平衡）的必要条件}。

概括起来， 虚功原理就是说， 若一个系统达到平衡静止， 那么（假想）稍微改变任意一个广义坐标 $q_i$， 主动力做的虚功之和都为零。
\addTODO{例题： 高低不同的两点间悬挂一条质量不计的细线， 线比两点之间的距离要长。 一个质点在细线上无摩擦滑动， 求平衡点。}

\subsubsection{证明虚功原理}
\textbf{方法 1}： 用达朗贝尔原理\upref{dAlbt}证明。 当系统平衡时， 每个质点都受力平衡， 即 $\bvec F_j^{(a)}+\bvec F_j^{(c)} = \bvec 0$。 其中第一项表示主动力，  第二项表示约束力。 所以
\begin{equation}
\sum_j \qty(\bvec F_j^{(a)}+\bvec F_j^{(c)}) \vdot \pdv{\bvec r_j}{q_i} = 0~.
\end{equation}
根据\autoref{eq_dAlbt_3}~\upref{dAlbt}， 第二项求和后为零， 所以
\begin{equation}
Q_i = \sum_j \bvec F_j^{(a)} \vdot \pdv{\bvec r_j}{q_i} = 0~.
\end{equation}
证毕。

\textbf{方法 2}： 用拉格朗日方程证明。 在静止的系统中， 显然\autoref{eq_VirWrk_1} 左边第一项为零， 而右边第一项中
\begin{equation}
\eval{\pdv{T}{q_i}}_{\dot q = 0} = 0~.
\end{equation}
这是因为 $\dot q = 0$ 时， 动能 $T$ 恒为零（每个质点位置不显含时间）。 所以\autoref{eq_VirWrk_2} 成立。 证毕。

\subsection{虚功}\label{sub_VirWrk_1}
虚功是指， 暂停时间， 然后人为地在满足约束条件的前提下人为地让系统做某个运动的过程中某些力所作的功。

例如在\autoref{ex_Lagrng_3}~\upref{Lagrng}和\autoref{ex_Lagrng_4}~\upref{Lagrng}中， 需要先暂停杆的转动， 才能讨论虚功。 由于暂停了时间， 一切运动都是假想的， $\pdv*{\bvec r_j}{t} = \bvec 0$， 一切微小增量都用 $\delta$ 代替微分符号 $\dd{}$。
\begin{equation}\label{eq_VirWrk_4}
\begin{aligned}
\delta{W} &= \sum_j \bvec F_j \vdot \delta{\bvec r}_j
= \sum_{i,j} \bvec F_j \vdot \pdv{\bvec r_j}{q_i}\delta q_i\\
&= \sum_i Q_i \delta q_i = \sum_i \delta{W_i}~,
\end{aligned}
\end{equation}
注意这里的 $\bvec F_i$ 和 $Q_i$ 都只能是 $q$ 的函数。 可以用该式对比广义力的真实做功（\autoref{sub_LagEqQ_1}~\upref{LagEqQ}）以加深理解。 在一个假想的过程中， 同样可以对\autoref{eq_VirWrk_4} 做类似线积分\upref{IntL}的积分
\begin{equation}
W_i = \int_{q=q_1}^{q=q_2} Q_i(q) \dd q_i~.
\end{equation}
根据数学符号的习惯， 积分中的 $\dd{}$ 还是保留原样看起来比较自然。
