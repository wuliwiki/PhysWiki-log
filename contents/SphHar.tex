% 球谐函数
% 球坐标系|拉普拉斯方程|球谐函数|正交归一性

\pentry{球坐标的拉普拉斯方程\upref{SphLap}， 连带勒让德多项式\upref{AsLgdr}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Spherical_harmonics}{相关页面}。}当球坐标中的拉普拉斯方程\upref{SphLap}分离变量后， 关于极角 $\theta$ 的函数为连带勒让德多项式 $P_l^m(\cos\theta)$， 方向角函数为 $\E^{\I m\phi}$。 我们定义\textbf{球谐函数（spherical harmonics）}为\footnote{有些教材也将球谐函数记为 $Y_l^m$}\footnote{特殊地， $Y_{l,0}(\uvec r) = \sqrt{(2l + 1)/(4\pi)}P_l(\cos\theta)$， $P_l$ 是勒让德多项式\upref{Legen}。}
\begin{equation}\label{eq_SphHar_1}
Y_{l, m} (\uvec r) = Y_{l, m}(\theta, \phi) = A_{l,m} P_l^m(\cos \theta) \E^{\I m\phi}~.
\end{equation}
其中 $\uvec r$ 表示一个单位矢量\upref{GVec}， 指向球坐标中的点 $(1, \theta, \phi)$。 $l, m$ 为整数， $l \geqslant 0$， $-l \leqslant m \leqslant l$。 $A_{l,m}$ 是归一化系数， 使得 $\abs{Y_{l, m} (\uvec r)}^2$ 在单位球面上的面积分等于 1 （\autoref{eq_SphHar_12}）。
\begin{equation}\label{eq_SphHar_2}
A_{l,m} =  \sqrt{\frac{2l + 1}{4\pi }\frac{(l - m)!}{(l + m)!}}~.
\end{equation}
球谐函数可以看作是将单位球面上的每一点（或者三维空间中的每个方向）映射到一个复数函数值。 常见的球谐函数见 “球谐函数列表\upref{YlmTab}”， 函数图常用\autoref{fig_SphHar_1} 的方式绘制。

\begin{figure}[ht]
\centering
\includegraphics[width=13cm]{./figures/2b6a809418952ca8.pdf}
\caption{$\abs{Y_{l,m}(\uvec r)}$ 在 $x$-$z$ 平面的极坐标曲线\upref{PolCrd}（$\phi$ 不会影响球谐函数的绝对值）。 红色代表 $Y_{l,m}(\uvec r) > 0$， 蓝色代表 $Y_{l,m}(\uvec r) < 0$。 第 1 行到第 4 行分别为 $l = 0$ 到 $3$， 每行从左到右分别为 $m = -l$ 到 $l$。 图中的右上角标明了 $r$ 的单位长度。} \label{fig_SphHar_1}
\end{figure}

当 $m = 0$ 时球谐函数可以用勒让德多项式表示为关于 $z$ 轴对称的函数
\begin{equation}\label{eq_SphHar_11}
Y_{l,0}(\uvec r) = \sqrt{\frac{2l+1}{4\pi}} P_l(\cos\theta)~.
\end{equation}
另外根据\autoref{eq_SphHar_1} 和\autoref{eq_AsLgdr_2}~\upref{AsLgdr}可得
\begin{equation}
Y_{l,m}(\uvec z) = \sqrt{\frac{2l+1}{4\pi}} \delta_{m,0}~.
\end{equation}

\subsection{偏微分方程}
球谐函数同时满足偏微分方程
\begin{align}
\laplacian_\Omega Y_{l,m} &= -l(l+1)Y_{l,m}~,\\
\pdv{\phi} Y_{l,m} &= \I m Y_{l,m}~.
\end{align}
其中
\begin{equation}
\laplacian_\Omega = \frac{1}{\sin\theta}\pdv{\theta} \qty(\sin \theta \pdv{\theta}) + \frac{1}{\sin^2 \theta} \qty(\pdv[2]{\phi})
\end{equation}
是球坐标系拉普拉斯算子中与 $r$ 无关的部分（\autoref{eq_SphNab_3}~\upref{SphNab}）。

\subsection{归一化系数}
由球谐函数的归一化条件， 对单位球面积分（\autoref{ex_CrIntN_1}~\upref{CrIntN}）得
\begin{equation}\label{eq_SphHar_12}\ali{
1 &= \int \abs{Y_{l, m}(\uvec r)}^2 \dd{\Omega} = \int_0^\pi  \int_0^{2\pi}  \abs{Y_{l, m}(\theta, \phi)}^2 \sin\theta\dd{\theta}\dd{\phi} \\
&= \abs{A_{l,m}}^2 \int_{-1}^1  \abs{P_l^m(\cos\theta)}^2 \dd{(\cos \theta)} \int_0^{2\pi } \abs{\E^{\I m\phi}}^2  \dd{\phi}\\
&= \frac{2\pi}{\abs{A_{l,m}'}^2} \abs{A_{l,m}}^2
}\end{equation}
其中 $A_{l,m}'$ 是 $P_l^m(x)$ 的归一化系数（见\autoref{eq_AsLgdr_3}~\upref{AsLgdr}）， 代入后可得 $A_{l,m}$。

\subsection{Condon–Shortley 相位}\label{sub_SphHar_1}
与连带勒让德多项式相同， 在定义球谐函数时我们也可以选择是否包含 \textbf{Condon–Shortley 相位} $(-1)^m$。 物理中一般选择包含， 包括本书。 如果包含， 我们可以选择将其包含在连带勒让德多项式中（如\autoref{eq_AsLgdr_1}~\upref{AsLgdr}）， 或者包含在球谐函数的定义中。 如果不包含， 该相位在两个定义中都不出现。

\subsection{正交归一性}
由勒让德函数的正交归一性（\autoref{eq_AsLgdr_4}~\upref{AsLgdr}）以及 $\E^{\I m \phi}$  的正交归一性（\autoref{eq_FSExp_4}~\upref{FSExp}）， 不难证明球谐函数的正交归一性
\begin{equation}
\int Y_{l', m'}^*(\uvec r) Y_{l, m} (\uvec r) \dd{\Omega} = \delta_{l,l'}\delta_{m,m'}~.
\end{equation}
其中 $\delta_{i,j}$ 是克罗内克 delta 函数\upref{Kronec}。 与多元函数的傅里叶级数\upref{NdFuri}类似， 球谐函数可以展开所有性质良好的二元函数：
\begin{equation}
f(\uvec r) = f(\theta, \phi) = \sum_{l = 0}^\infty\sum_{m=-l}^l C_{l,m}Y_{l,m}(\theta, \phi) \quad (\theta \in [0, \pi], \phi \in [2, 2\pi])~,
\end{equation}
\begin{equation}
C_{l,m} = \int Y^*_{l,m}(\uvec r) f(\uvec r) \dd{\Omega}~.
\end{equation}
由\autoref{eq_SphHar_6} 可得： 若 $f(\uvec r)$ 是实函数， 那么
\begin{equation}
C_{l,-m} = (-1)^m C_{l,m}
\end{equation}

性质良好的三维函数 $f(\bvec r)$ 也可以展开为径向函数 $f_{l,m}(r)$ 和球谐函数的乘积
\begin{equation}\label{eq_SphHar_9}
f(\bvec r) = f(r, \theta, \phi) = \sum_{l = 0}^\infty\sum_{m=-l}^l f_{l,m}(r) Y_{l,m}(\theta, \phi)~,
\end{equation}
\begin{equation}\label{eq_SphHar_7}
f_{l,m}(r) = \int Y^*_{l,m}(\uvec r) f(\bvec r) \dd{\Omega}~.
\end{equation}
若 $f(\bvec r)$ 是实函数， 那么
\begin{equation}
f_{l,-m}(r) = (-1)^m f_{l,m}(r)~.
\end{equation}

\subsection{旋转变换}
\begin{equation}
Y_{l,m}(\uvec r') = \sum_{m'=-l}^l D_{m,m'}^{(l)} (\mathcal R)^* Y_{l,m'}(\uvec r)~.
\end{equation}
其中 $\mat D^{(l)}$ 是 Wigner D 矩阵\upref{WigDmt}。 从量子力学的角度来说， 总角动量是与方向无关的， 只有角动量在某方向的分量有关。

\subsection{中心对称}
$l$ 为偶数时， 球谐函数是中心对称的（偶宇称\upref{IntPry}）， 否则是反对称的（奇宇称）。
\begin{equation}\label{eq_SphHar_8}
Y_{l,m}(-\uvec r) = (-1)^l Y_{l,m}(\uvec r)~,
\end{equation}
可以用\autoref{fig_SphHar_1} 验证。

\subsection{积分}
三个球谐函数之积的积分可以表示成两个 CG 系数\upref{SphCup}或 3j 符号\upref{ThreeJ}相乘\footnote{见 Bransden 附录 A4， 以及 Wikipedia 的 3j/CG coefficients 页面}
\begin{equation}\label{eq_SphHar_3}
% 已反复验证
\ali{
&\quad \int Y_{l_1 m_1} (\uvec r) Y_{l_2 m_2} (\uvec r) Y_{l_3 m_3}(\uvec r) \dd{\Omega}\\
&= (-1)^{m_3} \sqrt{\frac{(2l_1+1)(2l_2+1)}{4\pi(2l_3+1)}} \bmat{l_1& l_2& l_3\\ 0 & 0 & 0}\bmat{l_1 & l_2 & l_3\\  m_1 & m_2 & -m_3}\\
&= \sqrt{\frac{(2l_1+1)(2l_2+1)(2l_3+1)}{4\pi}}  \pmat{l_1& l_2& l_3\\ 0 & 0 & 0}\pmat{l_1 & l_2 & l_3\\  m_1 & m_2 & m_3}
}~.\end{equation}
使用\autoref{eq_SphHar_6} 把第一个球谐函数变为复共轭得
\begin{equation}\label{eq_SphHar_5}
\begin{aligned}
&\quad \int Y_{l_1 m_1}^*(\uvec r) Y_{l_2 m_2} (\uvec r) Y_{l_3 m_3}(\uvec r) \dd{\Omega}\\
& = (-1)^{m_1}\sqrt{\frac{(2l_1+1)(2l_2+1)(2l_3+1)}{4\pi}} \pmat{l_1& l_2& l_3\\ 0 & 0 & 0}\pmat{l_1 & l_2 & l_3\\  -m_1 & m_2 & m_3}~,
\end{aligned}
\end{equation}
该式在量子力学中有一些应用， 如 “氢原子的选择定则\upref{SelRul}”。

\subsection{矢量相加定理}
这里的\textbf{矢量相加定理（vector addition theorem）}是指把勒让德多项式展开为两个球谐函数的乘积
\begin{equation}\label{eq_SphHar_10}
P_l(\cos\theta) = \frac{4\pi}{2l+1} \sum_{m=-l}^l Y_{l,m}^*(\uvec u) Y_{l,m}(\uvec v)~,
\end{equation}
其中 $\theta$ 是两个单位矢量 $\uvec u, \uvec v$ 的夹角。
\addTODO{为什么叫做矢量相加？ 以及证明}

\subsection{其他性质}
\begin{equation}\label{eq_SphHar_6}
Y_{l,m}(\uvec r) = (-1)^m Y_{l,-m}^*(\uvec r)~.
\end{equation}
这里的 $(-1)^m$ 是由连带勒让德多项式的性质而来， 而共轭由 $\exp(\I m\phi)$ 因子而来。

根据 “球坐标与直角坐标的转换\upref{SphCar}” 中定义的直角坐标系以及球谐函数表\upref{YlmTab}可得
\begin{equation}\label{eq_SphHar_4}
x = \sqrt{\frac{2\pi}{3}} r (Y_{1,-1} - Y_{1,1})~, \qquad
y = \I \sqrt{\frac{2\pi}{3}} r (Y_{1,-1}+Y_{1,1})~, \qquad
z =2\sqrt{\frac{\pi}{3}} rY_{1,0}~.
\end{equation}

\subsection{应用}
平面波的球谐展开\upref{Pl2Ylm}， 电多极子展开\upref{EMulPo}， 球坐标系中的拉普拉斯方程\upref{SphLap}， 类氢原子的定态波函数\upref{HWF}等。
