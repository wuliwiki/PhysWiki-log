% 李纳维谢尔势
% 李纳维谢尔势|带电粒子的辐射

\pentry{电磁场推迟势\upref{RetPt0}}

对于一个给定的电荷电流分布（作为关于时空坐标 $x^\mu$ 的函数），可以根据\textbf{推迟势}算出电磁势$\phi,\bvec A$（作为关于时空坐标 $x^\mu$ 的函数）。
\begin{equation}
\phi(\bvec r,t)=\frac{1}{4\pi\epsilon_0}\int \frac{\rho(\bvec r',t-|\bvec r-\bvec r'|/c)}{|\bvec r-\bvec r'|}\dd \phi'
\end{equation}

\begin{equation}
\bvec A(\bvec r,t)=\frac{\mu_0}{4\pi}\int \frac{\bvec J(\bvec r',t-|\bvec r-\bvec r'|/c)}{|\bvec r-\bvec r'|}\dd \phi'
\end{equation}

或者写成四维形式：设四维电磁势 $A^\mu=(\phi/c,\bvec A)$，四维电荷电流密度 $J^\mu=(\rho c,\bvec J)$，那么
\begin{equation}\label{LWP_eq3}
A^\mu(\bvec r,t)=\frac{1}{4\pi\epsilon_0c^2}\int \frac{J^\mu(\bvec r',t-|\bvec r-\bvec r'|/c)}{|\bvec r-\bvec r'|}\dd V'
\end{equation}

我们继续使用自然单位制，令 $\mu_0=\epsilon_0=c=1$ 来简化表达。依照习惯，上下标使用希腊字母如 $\mu, \nu$ 时，取值范围为 $\{0, 1, 2, 3\}$；使用拉丁字母如 $i, j$ 时，取值范围为 $\{1, 2, 3\}$。约定闵氏时空度规为 $(-1,1,1,1)$。
在自然单位制下，\autoref{LWP_eq3} 变为
\begin{equation}\label{LWP_eq4}
A^\mu(\bvec r,t)=\int \frac{J^\mu(\bvec r',t-|\bvec r-\bvec r'|)}{|\bvec r-\bvec r'|}\dd V'
\end{equation}

如果要考察一个带电粒子的辐射，带电粒子的电荷密度为 $\rho(\bvec r,t)=q\delta(\bvec r-\bvec r''(t))$，电流密度为 $q\bvec v''(t) \delta(\bvec r-\bvec r''(t))$。此时可以对推迟势进行化简，得到\textbf{李纳-维谢尔势}：
\subsection{李纳-维谢尔势}

对于电荷密度为 $\rho(\bvec r,t)=q\delta(\bvec r-\bvec r''(t))$，电流密度为 $q\bvec v''(t) \delta(\bvec r-\bvec r''(t))$ 的带电粒子，它产生的电磁势可以由下式给出
\begin{equation}\label{LWP_eq1}
\phi(\bvec r,t)=\frac{q}{|\bvec r-\bvec r'|-\bvec v'\cdot (\bvec r-\bvec r')}
\end{equation}

\begin{equation}\label{LWP_eq2}
\bvec A(\bvec r,t)=\frac{q\bvec v'}{|\bvec r-\bvec r'|-\bvec v'\cdot (\bvec r-\bvec r')}
\end{equation}

其中 $\bvec r',\bvec v'$ 是 $\bvec t'$ 时刻粒子的位置和速度，且满足 $\bvec |\bvec r-\bvec r'|=t-t'$（$\bvec r',t'$ 恰好以光速传播到 $\bvec r,t$，满足推迟势条件）。\autoref{LWP_eq1} \autoref{LWP_eq2} 可以合并为四维协变形式：
\begin{equation}
A^\mu(x)=\frac{-e u'^\mu}{u^\nu (x_\nu-x'_\nu)}
\end{equation}

\autoref{LWP_eq1} \autoref{LWP_eq2} 称为\textbf{李纳-维谢尔势}。可以利用推迟势公式进行推导。以\autoref{LWP_eq1} 为例，将电荷密度 $\rho(\bvec r,t)=q\delta(\bvec r-\bvec r''(t))$ 代入 
\autoref{LWP_eq4} ：
\begin{equation}\label{LWP_eq5}
\begin{aligned}
\phi(\bvec r,t)&=\int \frac{\rho(\bvec r',t-|\bvec r-\bvec r'|)}{|\bvec r-\bvec r'|}\dd V'\\
&=\int \frac{q\delta(\bvec r'-\bvec r''(t-|\bvec r-\bvec r'|))}{|\bvec r-\bvec r'|}\dd V'\\
&=\int \int \frac{q\delta(\bvec r'-\bvec r''(t''))}{|\bvec r-\bvec r'|}\delta (t-t''-|\bvec r-\bvec r'|)\dd V'\dd t''\\
&=\int \frac{q}{|\bvec r-\bvec r''(t'')|}\delta (t-t''-|\bvec r-\bvec r''(t'')|)\dd t''
\end{aligned}\\
\end{equation}

由于 $\delta(f(t))=\delta(t)\cdot \left|\frac{\dd f}{\dd t}\right|^{-1}$，所以
\begin{equation}
\begin{aligned}
\delta (t-t''-|\bvec r-\bvec r''(t'')|)&=\delta(t''-t')\cdot \left|-1+\frac{\bvec v'(t')\cdot (\bvec r-\bvec r')}{|\bvec r-\bvec r'|}\right|^{-1}\\
&=\delta(t''-t')\frac{|\bvec r-\bvec r'|}{|\bvec r-\bvec r'|-\bvec v'\cdot (\bvec r-\bvec r')}
\end{aligned}
\end{equation}
其中 $t'$ 满足 $t-t'-|\bvec r-\bvec r'(t')|=0$。最终 \autoref{LWP_eq5} 可以化简为
\begin{equation}
\phi(\bvec r,t)=\frac{q}{|\bvec r-\bvec r'|}\frac{|\bvec r-\bvec r'|}{|\bvec r-\bvec r'|-\bvec v'\cdot (\bvec r-\bvec r')}=\frac{q}{|\bvec r-\bvec r'|-\bvec v'\cdot (\bvec r-\bvec r')}
\end{equation}

用类似的方法可以推导出\autoref{LWP_eq2}。

\subsection{用格林函数推导}
我们也可以用格林函数的方法进行推导。由于 $\phi$ 满足二阶偏微分方程：
\begin{equation}
\frac{\partial^2 \phi}{\partial t^2}-\nabla^2 \phi= 4\pi \rho
\end{equation}
\addTODO{格林函数的推导方法}

\subsection{运动场源推迟时刻的初步理解}
\pentry{电磁场推迟势\upref{RetPt0}}
\footnote{本节参考了\cite{GriffE}}
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/LWP_1.pdf}
\caption{$t=t_a$时刻，场源发出一个信号} \label{LWP_fig1}
\end{figure}
\begin{figure}[ht]
\centering
\includegraphics[width=8cm]{./figures/LWP_2.pdf}
\caption{$t=t_b$时刻，场点接受到信号} \label{LWP_fig2}
\end{figure}
同理，在$t=t_a$时，场源向场点发出一个速度为c的信号；在$t=t_b$时，场点才收到场源的信号。因此，场点在$t=t_b$时刻得知的信息只是$t_a$时刻场源的信息，即$t=t_b$时刻场点只知道场源在$\bvec r'(t=t_a)$，却不知道他“其实”已经运动到了$\bvec r'(t=t_b)$。

那么，要如何确定$t$时刻的推迟时刻$t_r=t-R/c$呢？麻烦的是，$R$（“场源与场点的相对距离”）到底指的是什么？在场源固定时，R与时间无关，可以被很清晰地描述；但在场源运动时，R应该指什么？事实上，R应该指\textsl{场点所知道的场源}$\bvec r'(t=t_r)$到自己的距离： $\bvec R = \bvec r - \bvec r'(t=t_r)$。
那么，推迟时刻就被隐性描述为$t_r=t-\frac{\abs{\bvec r - \bvec r'(t=t_r)}}{c}$，或整理为$c(t-t_r)=\abs{\bvec r - \bvec r'(t=t_r)}$。

在本例中，当$t=t_b$时，$t_r=t_a$，即场点只感受到了$t=t_a$时的场源。
