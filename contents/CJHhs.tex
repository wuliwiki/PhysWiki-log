% 超几何函数（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Hypergeometric_function}{相关文章}。

\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/d7c2f81e451fe639.png}
\caption{超几何函数 ${}_2F_1(a, b; c; z)$ 在复平面上从 $-2 - 2i$ 到 $2 + 2i$ 的图像，其中参数取值为 $a = 2$、$b = 3$、$c = 4$，图像的颜色由 Mathematica 13.1 的函数 ComplexPlot3D 生成。} \label{fig_CJHhs_1}
\end{figure}
在数学中，高斯或普通超几何函数 ${}_2F_1(a,b;c;z)$ 是由超几何级数表示的特殊函数，它包含了许多其他特殊函数作为特例或极限情形。它是一个二阶线性常微分方程（ODE）的解。任何具有三个正规奇点的二阶线性常微分方程都可以转化为该方程。

关于超几何函数所涉及的成千上万条恒等式的系统整理，可以参见 Erdélyi 等人（1953年）和 Olde Daalhuis（2010年）的参考著作。至今尚无已知的体系可以组织所有这些恒等式；事实上，也没有已知的算法可以生成所有恒等式。目前已知的算法各自能生成不同系列的恒等式。发现恒等式的算法理论仍是一个活跃的研究课题。
\subsection{历史}
“超几何级数”这一术语最早由约翰·沃利斯在其1655年的著作《无穷算术》中提出。

超几何级数曾被莱昂哈德·欧拉研究过，但最早对其进行系统全面研究的是卡尔·弗里德里希·高斯，时间是在1813年。

19世纪的研究包括恩斯特·库默尔（Ernst Kummer，1836年）的工作，以及伯恩哈德·黎曼（Bernhard Riemann，1857年）通过超几何函数所满足的微分方程对其进行的基本刻画。

黎曼证明，对于 ${}_2F_1(z)$ 的二阶微分方程，在复平面上可以通过其在黎曼球面上的三个正规奇点来进行刻画。

而当超几何方程的解为代数函数的情形，则由赫尔曼·施瓦茨确定下来，这就是著名的“施瓦茨表”。
\subsection{超几何级数}
在 $|z| < 1$ 的范围内，超几何函数定义为幂级数：
$$
{}_2F_1(a, b; c; z) = \sum_{n=0}^{\infty} \frac{(a)_n (b)_n}{(c)_n} \frac{z^n}{n!} = 1 + \frac{ab}{c} \frac{z}{1!} + \frac{a(a+1)b(b+1)}{c(c+1)} \frac{z^2}{2!} + \cdots~
$$
当 $c$ 是非正整数时，函数未定义（或发散）。其中 $(q)_n$ 表示递增阶乘（Pochhammer 符号）\(^\text{[note 1]}\) ，定义如下：
$$
(q)_n =
\begin{cases}
1 & \text{若 } n = 0 \\
q(q+1)\cdots(q+n-1) & \text{若 } n > 0
\end{cases}~
$$
当 $a$ 或 $b$ 是非正整数时，级数终止，此时超几何函数退化为多项式，例如：
$$
{}_2F_1(-m, b; c; z) = \sum_{n=0}^{m} (-1)^n \binom{m}{n} \frac{(b)_n}{(c)_n} z^n~
$$
对于模长 $|z| \geq 1$ 的复数参数 $z$，该函数可以通过解析延拓定义于整个复平面上（避开分支点 1 和无穷大）。实际应用中，大多数计算机实现会在实轴上 $z \geq 1$ 的区间上引入一条分支切割线。

当 $c \to -m$（$m$ 为非负整数）时，${}_2F_1(z)$ 会发散。但如果除以伽玛函数 $\Gamma(c)$，可以得到如下极限：
$$
\lim_{c \to -m} \frac{{}_2F_1(a, b; c; z)}{\Gamma(c)} = \frac{(a)_{m+1} (b)_{m+1}}{(m+1)!} z^{m+1} {}_2F_1(a + m + 1, b + m + 1; m + 2; z)~
$$
${}_2F_1(z)$ 是广义超几何级数 ${}_pF_q$ 中最常见的一类，通常简写为 $F(z)$。
\subsection{微分公式}
利用恒等式$(a)_{n+1} = a(a+1)_n$可以推出以下结果：

一阶导数为：
$$
\frac{d}{dz} \ {}_2F_1(a, b; c; z) = \frac{ab}{c} \ {}_2F_1(a+1, b+1; c+1; z)~
$$
更一般地，$n$ 阶导数为：
$$
\frac{d^n}{dz^n} \ {}_2F_1(a, b; c; z) = \frac{(a)_n (b)_n}{(c)_n} \ {}_2F_1(a+n, b+n; c+n; z)~
$$
\subsection{特殊情形}
许多常见的数学函数可以用超几何函数来表示，或者是它的极限情形。以下是一些典型例子：
$$
{}_2F_1(1, 1; 2; -z) = \frac{\ln(1 + z)}{z}~
$$
$$
{}_2F_1(a, b; b; z) = (1 - z)^{-a}\text{（其中 b 为任意值）}~
$$
$$
{}_2F_1\left(\frac{1}{2}, \frac{1}{2}; \frac{3}{2}; z^2\right) = \frac{\arcsin(z)}{z}~
$$
$$
{}_2F_1\left(\frac{1}{3}, \frac{2}{3}; \frac{3}{2}; -\frac{27x^2}{4} \right) = \frac{
\sqrt[3]{\dfrac{3x\sqrt{3} + \sqrt{27x^2 + 4}}{2}} - \sqrt[3]{\dfrac{2}{3x\sqrt{3} + \sqrt{27x^2 + 4}}}
}{x\sqrt{3}}~
$$
当 $a = 1$、$b = c$ 时，超几何级数退化为普通的几何级数，即：
$$
{}_2F_1(1, b; b; z) = {}_1F_0(1;\ ;z) = 1 + z + z^2 + z^3 + z^4 + \cdots~
$$
因此，得名“超几何函数”。这个函数可以被看作是几何级数的一种推广。

合流超几何函数（也称为Kummer 函数）可以通过超几何函数的极限形式表示为：
$$
M(a, c, z) = \lim_{b \to \infty} \ {}_2F_1\left(a, b; c; b^{-1}z\right)~
$$
因此，所有本质上是它特例的函数（例如贝塞尔函数）都可以表示为超几何函数的极限。这类函数包括了大多数常见的数学物理函数。

勒让德函数是具有三个正规奇点的二阶微分方程的解，因此可以通过多种方式用超几何函数表示，例如：
$$
{}_2F_1(a, 1 - a; c; z) = \Gamma(c) \, z^{\frac{1 - c}{2}} (1 - z)^{\frac{c - 1}{2}} P_{-a}^{1 - c}(1 - 2z)~
$$
多个正交多项式，包括雅可比多项式 $P_n^{(\alpha, \beta)}$ 及其特例如勒让德多项式、切比雪夫多项式、Gegenbauer 多项式、Zernike 多项式等，都可以用超几何函数表示，具体形式为：
$$
{}_2F_1(-n, \alpha + 1 + \beta + n; \alpha + 1; x) = \frac{n!}{(\alpha + 1)_n} \, P_n^{(\alpha, \beta)}(1 - 2x)~
$$

其他作为超几何函数特例的多项式还包括 Krawtchouk 多项式、Meixner 多项式 和 Meixner–Pollaczek 多项式。

令

$$
z \in \mathbb{C} \setminus \{0, 1\}~
$$

并设：

$$
\tau = i \cdot \frac{{}_2F_1\left(\tfrac{1}{2}, \tfrac{1}{2}; 1; 1 - z\right)}{{}_2F_1\left(\tfrac{1}{2}, \tfrac{1}{2}; 1; z\right)}~
$$

则有：
$$
\lambda(\tau) = \frac{\theta_2^4(\tau)}{\theta_3^4(\tau)} = z~
$$
这里的 $\lambda(\tau)$ 是模$\lambda$函数，其中：
$$
\theta_2(\tau) = \sum_{n \in \mathbb{Z}} e^{\pi i \tau (n + \tfrac{1}{2})^2}, \quad
\theta_3(\tau) = \sum_{n \in \mathbb{Z}} e^{\pi i \tau n^2}~
$$
j-不变量是一个模函数，它是 $\lambda(\tau)$ 的有理函数。
不完全贝塔函数 $B_x(p, q)$ 与超几何函数的关系为：
$$
B_x(p, q) = \frac{x^p}{p} \cdot {}_2F_1(p, 1 - q; p + 1; x)~
$$
完全椭圆积分 $K(k)$ 和 $E(k)$ 可表示为：\(^\text{1}\)
$$
K(k) = \frac{\pi}{2} \cdot {}_2F_1\left(\tfrac{1}{2}, \tfrac{1}{2}; 1; k^2\right)~
$$
$$
E(k) = \frac{\pi}{2} \cdot {}_2F_1\left(-\tfrac{1}{2}, \tfrac{1}{2}; 1; k^2\right)~
$$
\subsection{超几何微分方程}
超几何函数是欧拉提出的超几何微分方程的解，该方程为：
$$
z(1 - z) \frac{d^2 w}{dz^2} + \left[ c - (a + b + 1)z \right] \frac{d w}{dz} - ab\,w = 0~
$$
此微分方程具有三个正规奇点：0、1 和无穷大。

该方程向三个任意正规奇点推广的形式称为黎曼微分方程。任何具有三个正规奇点的二阶线性微分方程都可以通过变量代换转化为超几何微分方程。
\subsubsection{奇点处的解}
超几何微分方程的解由超几何级数 ${}_2F_1(a, b; c; z)$ 构造而成。该方程具有两个线性无关的解。在每一个奇点（0、1、∞）处，通常存在两个特解，形式为 $x^s$ 乘以 $x$ 的一个全纯函数，其中 $s$ 是特征方程的两个根之一，$x$ 是在该奇点处消失的局部变量。这样总共有 $3 \times 2 = 6$ 个典型特解，具体如下：

在 $z = 0$ 附近，如果 $c$ 不是非正整数，则两个线性无关的解为：
$$
{}_2F_1(a, b; c; z)~
$$
以及在 $c$ 不是整数的条件下：
$$
z^{1 - c} \cdot {}_2F_1(1 + a - c, 1 + b - c; 2 - c; z)~
$$
如果 $c = 1 - m$ 是一个非正整数，则第一个解不存在，必须替换为：
$$
z^m \cdot F(a + m, b + m; 1 + m; z)~
$$
第二个解在 $c$ 是大于 1 的整数时不存在；当 $c$ 是其他整数时，它等于第一个解或其替代形式。因此，当 $c$ 为整数时，第二个线性无关解需要使用更复杂的表达式：它等于第一个解乘以 $\ln(z)$，再加上一个关于 $z$ 的幂级数，其中涉及双伽马函数。更多细节可参见 Olde Daalhuis（2010）。

在 $z = 1$ 附近，如果 $c - a - b$ 不是整数，则有两个线性无关的解：
$$
{}_2F_1(a, b; 1 + a + b - c; 1 - z)~
$$
和
$$
(1 - z)^{c - a - b} \cdot {}_2F_1(c - a, c - b; 1 + c - a - b; 1 - z)~
$$
在 $z = \infty$ 附近，如果 $a - b$ 不是整数，则有两个线性无关的解：
$$
z^{-a} \cdot {}_2F_1\left(a, 1 + a - c; 1 + a - b; z^{-1}\right)~
$$
和
$$
z^{-b} \cdot {}_2F_1\left(b, 1 + b - c; 1 + b - a; z^{-1}\right)~
$$
同样地，当上述非整数的条件不满足时，存在其他形式更复杂的解。

由于该方程的解空间是二维的，上述六个特解中任意三个都满足一个线性关系，因此一共存在 $\binom{6}{3} = 20$ 个这样的线性关系，这些被称为连接公式。
\subsubsection{库默的 24 个解}
一个具有 $n$ 个奇点的二阶 Fuchs 型微分方程，其解集在投影意义下存在一个对称变换群，该群同构于 Coxeter 群 $W(D_n)$，其阶为 $2^{n-1} n!$。当 $n = 3$ 时，对应的就是超几何方程，其对称群阶为 24，与 4元对称群 $S_4$ 同构，这一结构最早由库默发现并描述。

出现对称群 $S_4$ 的现象在这里是偶然的，对于三个以上奇点的情形则没有对应的类似结构。有时更合适的做法是将该群理解为 三元对称群 $S_3$（用于对三个奇点的置换）与 Klein 四元群 的扩展，其中 Klein 四元群的元素会改变指数差的符号（但必须在偶数个奇点处发生）。

库默的 24 个变换由以下三种基本变换生成，它们将超几何函数 $F(a, b; c; z)$ 映射为：
$$
(1 - z)^{-a} F\left(a, c - b; c; \frac{z}{z - 1}\right)~
$$
$$
F\left(a, b; 1 + a + b - c; 1 - z\right)~
$$
$$
(1 - z)^{-b} F\left(c - a, b; c; \frac{z}{z - 1}\right)~
$$
这三种变换在与 4元对称群 $S_4$ 的同构下，分别对应于换位 (12)、(23) 和 (34) 的置换。其中，第一个和第三个变换实际上与原函数 $F(a, b; c; z)$ 相等，而第二个变换则是微分方程的另一个线性无关解。

对超几何函数应用库默的 24 个变换（即 $6 \times 4 = 24$）后，可得到前文提到的 6 个基本解（对应于每个奇点的两个特征指数解，共 $2 \times 3 = 6$ 个）。每个解会重复出现 4 次，这是由于以下恒等变换所致：

欧拉变换：
  $$
  {}_2F_1(a, b; c; z) = (1 - z)^{c - a - b} \cdot {}_2F_1(c - a, c - b; c; z)~
  $$
Pfaff 变换（两种形式）：
  $$
  {}_2F_1(a, b; c; z) = (1 - z)^{-a} \cdot {}_2F_1\left(a, c - b; c; \frac{z}{z - 1}\right)~
  $$
  $$
  {}_2F_1(a, b; c; z) = (1 - z)^{-b} \cdot {}_2F_1\left(c - a, b; c; \frac{z}{z - 1}\right)~
  $$
\subsubsection{Q-形式}
超几何微分方程可以化为如下的Q-形式：
$$
\frac{d^2 u}{dz^2} + Q(z) u(z) = 0~
$$
这是通过代换 $u = wv$ 并消去一阶导数项得到的。最终可以推得：
$$
Q(z) = \frac{
z^2[1 - (a - b)^2] + z[2c(a + b - 1) - 4ab] + c(2 - c)
}{
4z^2(1 - z)^2
}~
$$
其中，函数 $v(z)$ 满足：
$$
\frac{d}{dz} \log v(z) = -\frac{c - z(a + b + 1)}{2z(1 - z)} = -\frac{c}{2z} - \frac{1 + a + b - c}{2(z - 1)}~
$$
这意味着：
$$
v(z) = z^{-c/2} (1 - z)^{(c - a - b - 1)/2}~
$$
Q-形式的重要性在于它与Schwarz 导数的关系（详见 Hille 1976，第 307–401 页）。该形式在微分方程的对称性、解析延拓及其在复变函数理论中的应用中具有关键作用。
\subsubsection{施瓦茨三角映射}
施瓦茨三角映射或称为 Schwarz $s$-函数是一对超几何微分方程解的比值：
$$
s_k(z) = \frac{\phi_k^{(1)}(z)}{\phi_k^{(0)}(z)}~
$$
其中 $k$ 是三个奇点之一：0、1 或 ∞。有时也记作：
$$
D_k(\lambda, \mu, \nu; z) = s_k(z)~
$$
需要注意的是，连接系数在三角映射中会变成 Möbius 变换（即复射变换）。

每个三角映射在对应的奇点 $z \in \{0, 1, \infty\}$ 附近都是正则的，并具有如下渐近展开式：
$$
s_0(z) = z^\lambda \left(1 + \mathcal{O}(z)\right)~
$$
$$
s_1(z) = (1 - z)^\mu \left(1 + \mathcal{O}(1 - z)\right)~
$$
$$
s_\infty(z) = z^\nu \left(1 + \mathcal{O}\left(\frac{1}{z}\right)\right)~
$$
当 $\lambda, \mu, \nu$ 都是实数，且 $0 \leq \lambda, \mu, \nu < 1$ 时，这些 $s$-映射将上半平面 $\mathbb{H}$共形地映射为黎曼球面上的一个三角形区域，该区域边界为圆弧。这种映射是 Schwarz–Christoffel 映射的推广，适用于具有圆弧边界的三角形。奇点 0、1 和 ∞ 分别被映射到三角形的三个顶点，三角形内角分别为 $\pi\lambda, \pi\mu, \pi\nu$。

进一步地，当 $\lambda = 1/p$、$\mu = 1/q$、$\nu = 1/r$，其中 $p, q, r$ 为正整数时，这个三角形可以铺满整个球面、复平面或上半平面，具体取决于 $\lambda + \mu + \nu - 1$ 是正、零还是负。此时，$s$-映射是三角群 $\langle p, q, r \rangle = \Delta(p, q, r)$ 所对应的自守函数的反函数。
\subsubsection{单值解析延拓群}
超几何方程的单值解析延拓性描述的是：当沿着复平面中的一条闭合路径将基本解进行解析延拓（即绕着奇点转一圈再回到原点）时，解函数的取值会如何变化。具体来说，当路径绕过超几何函数 ${}_2F_1$ 的某个奇点时，终点处的解值通常会与起点处不同。

超几何方程的两个基本解之间存在一个线性关系，因此单值解析延拓可视为一个群同态映射：
$$
\pi_1(\mathbf{C} \setminus \{0, 1\}, z_0) \to \mathrm{GL}(2, \mathbf{C})~
$$
其中 $\pi_1$ 是基本群，也就是说，超几何方程的单值解析延拓给出了一个该基本群的二维线性表示。单值群即该映射的像，也就是由所有单值矩阵生成的矩阵群。

该表示可以通过奇点处的指数值显式计算出来。设：$(\alpha, \alpha')$ 是 $z = 0$ 处的两个指数；$(\beta, \beta')$ 是 $z = 1$ 处的指数；$(\gamma, \gamma')$ 是 $z = \infty$ 处的指数。

取基点 $z_0$ 接近 $z = 0$，则绕点 0 和 1 的路径所对应的单值矩阵为：
$$
g_0 =
\begin{pmatrix}
e^{2\pi i \alpha} & 0 \\
0 & e^{2\pi i \alpha'}
\end{pmatrix}~
$$
$$
g_1 =
\begin{pmatrix}
\frac{\mu e^{2\pi i \beta} - e^{2\pi i \beta'}}{\mu - 1}
&
\frac{\mu (e^{2\pi i \beta} - e^{2\pi i \beta'})}{(\mu - 1)^2}
\\[6pt]
e^{2\pi i \beta'} - e^{2\pi i \beta}
&
\frac{\mu e^{2\pi i \beta'} - e^{2\pi i \beta}}{\mu - 1}
\end{pmatrix}~
$$
其中：
$$
\mu = \frac{
\sin \pi(\alpha + \beta' + \gamma') \cdot \sin \pi(\alpha' + \beta + \gamma')
}{
\sin \pi(\alpha' + \beta' + \gamma') \cdot \sin \pi(\alpha + \beta + \gamma')
}~
$$
此外，如果 $1 - a$、$c - a - b$、$a - b$ 是分母分别为 $k, l, m$ 的有理数，则当且仅当满足：$1/k + 1/l + 1/m> 1$时，单值群是有限群。这个判定条件可以参考Schwarz 列表或 Kovacic 算法。
\subsection{积分公式}
\subsubsection{欧拉型公式}

若 $B(b, c - b)$ 是**贝塔函数**，则有：

$$
B(b, c - b) \cdot {}_2F_1(a, b; c; z) = \int_0^1 x^{b - 1}(1 - x)^{c - b - 1}(1 - zx)^{-a} \, dx \quad \text{当 } \Re(c) > \Re(b) > 0
$$

前提是 $z$ 不能是大于等于 1 的实数。该公式可以通过将 $(1 - zx)^{-a}$ 按二项式定理展开，在 $|z| < 1$ 的条件下逐项积分得到；在其他区域则通过解析延拓来证明。

当 $z$ 是一个大于等于 1 的实数时，$(1 - zx)$ 在积分区间内某点为零，导致被积函数出现奇点，此时积分值可能不再良定义，必须借助解析延拓来处理。

这一结果最早由**欧拉（Euler）**于 1748 年提出，它直接引出了**欧拉变换**和**Pfaff 变换**等超几何函数恒等式。

此外，还存在一些对应于其他分支的积分表达式，它们使用相同的被积函数，但积分路径则取为封闭的**Pochhammer 回路**，该路径围绕奇点按不同顺序封闭。这类积分路径体现了超几何函数的**单值延拓作用**（monodromy action）。
