% 理想气体的熵：纯微观分析
% 理想气体|熵|统计力学|动能|玻尔兹曼|状态方程

\pentry{熵\upref{Entrop}}

设某理想气体由 $N $ 个原子组成，体积为 $V$，能量为 $U$，现在，我们利用玻尔兹曼熵公式计算它的熵（可以加上一个常量）。假设 $N $ 为定值，但是 $U $ 和 $V $ 可以变化。我们要求的量是 $S(U,V)$。

理想气体的能量全部为动能，与粒子的位置无关。我们必须求与 $U$ 和 $V$ 相对应的状态数 $\Omega(U,V)$ 的对数。

我们已经知道，
\begin{equation}
\Omega \left( U,V \right) =\left( \frac{V}{a^3} \right) ^N\times \Omega _p\left( U \right) ~,
\end{equation}
式中 $V/a^3$ 是每个原子可占据的位置的数量；$\Omega_p(U)$ 是内能为 $U$ 的气体中，动量微观分布的数目。（计算自由膨胀的\textbf{熵变}时，膨胀前后内能不变，因此，我们忽略了 $\Omega_p(U)$。现在 $U$ 可以变化，所以需要计算 $\Omega_p(U)$，这使得我们的工作会更艰苦一些）。
内能为（对容器内每个原子的所有可能组态）
\begin{equation}
U=\sum_{i=1}^N{\frac{1}{2}m\left| \boldsymbol{v}_i \right|^2}=\sum_{i=1}^N{\frac{\left| \boldsymbol{p}_i \right|^2}{2m}}=\sum_{i=1}^N{\frac{p_{ix}^{2}+p_{iy}^{2}+p_{iz}^{2}}{2m}}~,
\end{equation}
式中 $\boldsymbol p = m\boldsymbol v$ 是动量。

现在我们构造一个 $3N $ 维的矢量 $\mathbf P$：
\begin{equation}
\mathbf{P}=\left( p_{1x},p_{1y},p_{1z},p_{2x},\cdots ,p_{Nz} \right) ~.
\end{equation}
它不过是 $N$ 个动量矢量 $\boldsymbol p_i$ 的 $3 $ 个分量的集合。如果我们将 $P $ 的分量重新编号为 $j=1, \cdots , 3N$，则
\begin{equation}
\mathbf{P}=\left( p_{1x},p_{1y},p_{1z},p_{2x},\cdots ,p_{Nz} \right) ~,
\end{equation}
这就是说
\begin{equation}
P_1=p_{1x},P_2=p_{1y},P_3=p_{1z},P_4=p_{2x},\cdots ,P_{3N}=p_{Nz}~.
\end{equation}
内能可以写成
\begin{equation} \label{eq_IdeaS_1}
U=\sum_{j=1}^{3N}{\frac{P_{j}^{2}}{2m}}~.
\end{equation}
不考虑位置的话，原子的动量可以取满足 \autoref{eq_IdeaS_1} 的任意值，所以我们必须看看满足条件的动量值有多少个。我们将该条件改写为
\begin{equation}
\sum_{j=1}^{3N}{P_{j}^{2}}=2mU~.
\end{equation}
这是 $3N$ 维空间中半径为 $R=\sqrt{2mU}$ 的超球方程，就像
\begin{equation}
x^2+y^2=R^2 \quad \text{圆或者1维球}~,
\end{equation}
或
\begin{equation}
x^2+y^2+z^2=R^2 \quad \text{普通的球或者2维球}~.
\end{equation}
在数学文献中，$ d=2 $ 的圆和 $d=3 $ 的普通球都被叫作球，周长和表面积都统称为面积。对千我们熟悉的这两个例子，面积是 $2\pi R$ 和 $4\pi R^2$。对于半径为 $R $ 的 $d $ 维球，借助量纲分析可得，其面积按 $R^{d-1}$ 关系变化。在我们的问题中，$R=\sqrt{2mU}$ 且 $d-1 = 3N-1 \approx 3N$。如果将各个动址分为大小为 $b^3$ 的单元，就像 $a^3$，很小且可以任意选取，那么气体可能具有的总状态数为
\begin{equation}
\Omega \left( V,U \right) =V^NU^{3N/2}F\left( m,N,a,b \right) ~.
\end{equation}
式中，我们专注于它随 $U $ 和 $V $ 的变化，将其他因素 $m, a, b $ 和 $N $ 合并，写入了函数 $F(m, N. a, b) $。我们不需要详细地了解 $F$，因为我们仅要将
\begin{equation}
S=k\ln \Omega =k\left[ N\ln V+\frac{3}{2}N\ln U \right] +k\ln F\left( m,N,a,b \right) ~.
\end{equation}
对 $U $ 和 $V $ 求偏导，而 $F $ 对此没有贡献。偏导数为
\begin{equation}
\left. \frac{\partial S}{\partial V} \right |_{U}^{}=\frac{kN}{V}~,
\end{equation}
\begin{equation}
\left. \frac{\partial S}{\partial U}\right |_{V}^{}=\frac{3kN}{2U}~.
\end{equation}
而我们又知道上面的两个导数分别等于 $P/T$ 和 $1/T$，这是由热力学得到的相应结果。于是
\begin{equation}
\dfrac{kN}{V}=\dfrac{P}{T}~,
\end{equation}
\begin{equation}
\dfrac{3kN}{2U} = \dfrac{1}{T}~.
\end{equation}
这样，从玻尔兹曼熵公式我们可以得到理想气体状态方程，并且我们注意到前面的推导过程中未曾利用温度 $T$ 的概念，因此玻尔兹曼熵公式给出了温度的统计力学定义（温度、温标 \autoref{eq_tmp_1}~\upref{tmp}）。