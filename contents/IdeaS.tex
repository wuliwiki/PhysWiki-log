% 理想气体的熵：纯微观分析
% keys 理想气体|熵|统计力学|动能|玻尔兹曼|状态方程
% license Xiao
% type Tutor

\pentry{熵\nref{nod_Entrop}，理想气体的状态密度（相空间）\nref{nod_IdSDp}}{nod_f86a}

\subsection{理想气体的熵与气体状态方程}
\subsubsection{微观状态数计算}
设某理想气体由 $N $ 个原子组成，体积为 $V$，能量为 $U$，现在，我们利用玻尔兹曼熵公式计算它的熵（可以加上一个常量）。假设 $N $ 为定值，但是 $U $ 和 $V $ 可以变化。我们要求的量是 $S(U,V)$。为了计算熵，我们利用玻尔兹曼公式\footnote{具体的内容参考熵的微观定义与玻尔兹曼公式\upref{entro2}。}转化为求系统的微观状态数 $\Omega(U,V)$，再求 $S=k\ln \Omega$。

理想气体的能量全部为动能，与粒子的位置无关。我们必须求与 $U$ 和 $V$ 相对应的状态数 $\Omega(U,V)$ 的对数。

我们已经知道，
\begin{equation}
\Omega \left( U,V \right) =\left( \frac{V}{a^3} \right) ^N\times \Omega _p\left( U \right) ~,
\end{equation}
式中 $V/a^3$ 是每个原子可占据的位置的数量；$\Omega_p(U)$ 是内能为 $U$ 的气体中，动量微观分布的数目。（计算自由膨胀的\textbf{熵变}时，膨胀前后内能不变，因此，我们忽略了 $\Omega_p(U)$。现在 $U$ 可以变化，所以需要计算 $\Omega_p(U)$，这使得我们的工作会更艰苦一些）。
内能为（对容器内每个原子的所有可能组态）
\begin{equation}
U=\sum_{i=1}^N{\frac{1}{2}m\left| \boldsymbol{v}_i \right|^2}=\sum_{i=1}^N{\frac{\left| \boldsymbol{p}_i \right|^2}{2m}}=\sum_{i=1}^N{\frac{p_{ix}^{2}+p_{iy}^{2}+p_{iz}^{2}}{2m}}~,
\end{equation}
式中 $\boldsymbol p = m\boldsymbol v$ 是动量。

现在我们构造一个 $3N $ 维的矢量 $\mathbf P$：
\begin{equation}
\mathbf{P}=\left( p_{1x},p_{1y},p_{1z},p_{2x},\cdots ,p_{Nz} \right) ~.
\end{equation}
它不过是 $N$ 个动量矢量 $\boldsymbol p_i$ 的 $3 $ 个分量的集合。如果我们将 $P $ 的分量重新编号为 $j=1, \cdots , 3N$，则
\begin{equation}
\mathbf{P}=\left( p_{1x},p_{1y},p_{1z},p_{2x},\cdots ,p_{Nz} \right) ~,
\end{equation}
这就是说
\begin{equation}
P_1=p_{1x},P_2=p_{1y},P_3=p_{1z},P_4=p_{2x},\cdots ,P_{3N}=p_{Nz}~.
\end{equation}
内能可以写成
\begin{equation} \label{eq_IdeaS_1}
U=\sum_{j=1}^{3N}{\frac{P_{j}^{2}}{2m}}~.
\end{equation}
不考虑位置的话，原子的动量可以取满足 \autoref{eq_IdeaS_1} 的任意值，所以我们必须看看满足条件的动量值有多少个。我们将该条件改写为
\begin{equation}
\sum_{j=1}^{3N}{P_{j}^{2}}=2mU~.
\end{equation}
这是 $3N$ 维空间中半径为 $R=\sqrt{2mU}$ 的超球方程，就像
\begin{equation}
x^2+y^2=R^2 \quad \text{圆或者1维球}~,
\end{equation}
或
\begin{equation}
x^2+y^2+z^2=R^2 \quad \text{普通的球或者2维球}~.
\end{equation}
在数学文献中，$ d=2 $ 的圆和 $d=3 $ 的普通球都被叫作球，周长和表面积都统称为面积。对千我们熟悉的这两个例子，面积是 $2\pi R$ 和 $4\pi R^2$。对于半径为 $R $ 的 $d $ 维球，借助量纲分析可得，其面积按 $R^{d-1}$ 关系变化。在我们的问题中，$R=\sqrt{2mU}$ 且 $d-1 = 3N-1 \approx 3N$。如果将各个动址分为大小为 $b^3$ 的单元，就像 $a^3$，很小且可以任意选取，那么气体可能具有的总状态数为
\begin{equation}
\Omega \left( V,U \right) =V^NU^{3N/2}F\left( m,N,a,b \right) ~.
\end{equation}
式中，我们专注于它随 $U $ 和 $V $ 的变化，将其他因素 $m, a, b $ 和 $N $ 合并，写入了函数 $F(m, N. a, b) $。最终得到理想气体熵的公式
\begin{equation}
S=k\ln \Omega =k\left[ N\ln V+\frac{3}{2}N\ln U \right] +k\ln F\left( m,N,a,b \right) ~.
\end{equation}
\subsubsection{用熵推导理想气体状态方程}
我们不需要详细地了解 $F$ 就可以从中推出理想气体状态方程，因为我们仅要将熵的公式对 $U $ 和 $V$ 求偏导，而 $F$ 对此没有贡献。偏导数为
\begin{equation}
\left. \frac{\partial S}{\partial V} \right |_{U}^{}=\frac{kN}{V}~,
\end{equation}
\begin{equation}
\left. \frac{\partial S}{\partial U}\right |_{V}^{}=\frac{3kN}{2U}~.
\end{equation}
而我们又知道上面的两个导数分别等于 $P/T$ 和 $1/T$，这是由熵的微分关系式 $\dd S=\dd U/T+P\dd V/T-\mu \dd N/T$ 得到的相应结果。于是
\begin{equation}
\dfrac{kN}{V}=\dfrac{P}{T}\Rightarrow PV=NkT~,
\end{equation}
\begin{equation}
\dfrac{3kN}{2U} = \dfrac{1}{T}\Rightarrow U=\frac{3}{2}NkT~.
\end{equation}
这样，从玻尔兹曼熵公式我们可以得到理想气体状态方程，并且我们注意到前面的推导过程中未曾利用温度 $T$ 的概念，因此玻尔兹曼熵公式给出了温度的统计力学定义 $1/T=\partial S/\partial U$（温度、温标 \autoref{eq_tmp_1}~\upref{tmp}）。
\subsection{理想气体熵的精确计算}
具体地求解微观状态数需要利用 $3N$ 维空间中球的体积公式。为了便于计算，我们舍去前面引入的 $a,b$ 变量，而是将 $6N$ 维相空间\upref{PhSpace}中每个体积为 $h^{3N}$ 的相格看作是一个微观状态，$h$ 是普朗克常数，将相空间划分为一个个相格可以理解为，在量子力学中坐标和动量的不确定性原理 $[x,p]=i\hbar$ 使得系统的能级是分立的。那么微观状态数密度\footnote{具体定义的细节参考理想气体的状态密度（相空间）\upref{IdSDp}。}就可以利用 \autoref{eq_PhSpace_2}~\upref{PhSpace}表达为：
\begin{equation}
\begin{aligned}
\Omega(U,V,N)&=\frac{\dd }{\dd U}\left(\frac{V^N}{N! h^{3N}}\int \dd[3]{p_1}\cdots \dd[3]{p_N} \theta(U-[p_1^2+p_2^2+\cdots p_N^2]/2m)\right) ~.
\\
&=\frac{V^N}{N! h^{3N}} \frac{\dd}{\dd U} \frac{(2\pi m U)^{3N/2}}{\Gamma(3N/2+1)}
\end{aligned}
\end{equation}
其中 $\theta(x)=1$ 当且仅当 $x>0$，$\theta$ 被称为阶跃函数。最后一行的推导利用了多维球体的体积公式\footnote{参考多维球体的体积公式 \upref{NSphV}}。代入熵公式可以得到
\begin{equation}
\begin{aligned}
S&=kN\log \frac{V(2\pi mU)^{3/2}}{h^3}-k\log (N! (3N/2)!)~,
\\
&=kN\log \frac{V(4\pi m U/(3N))^{3/2}}{Nh^3}+\frac{5}{2}kN ~.
\end{aligned}
\end{equation}
上面的推导利用了斯特林近似公式 $\log(N!)\approx N\log N-N$。

引入新的变量 $\lambda$，可以视作体系的德布罗意波长 $\lambda\sim h/p$：
\begin{equation}
\lambda \equiv \frac{h}{\sqrt{4\pi mE/(3N)}} = \frac{h}{\sqrt{2\pi mkT}}~,
\end{equation}
那么熵就可以表示为
\begin{equation}\label{eq_IdeaS_2}
S(U, V, N) = k\ln \Omega  = Nk \qty(\ln \frac{V}{N\lambda^3} + \frac52)~,
\end{equation}
该式被称为 \textbf{Sackur-Tetrode 公式}。 

从上式还可以看到熵是广延量，也就是当 $N,V$ 翻倍时，$S$ 也翻倍。利用 $\mu=-T(\partial S/\partial N)_{V,U}$ 可以计算理想气体的化学势：
\begin{equation}
\begin{aligned}
\mu&=-\left.\frac{\partial S}{\partial N}\right|_{V,U}=-kT\ln \frac{V}{N\lambda^3}+\frac{5}{2}kT-\frac{5}{2}kT\\
&=-kT\ln \frac{V}{N\lambda^3}~.
\end{aligned}
\end{equation}
