% 棣莫弗公式（综述）
% license CCBYSA3
% type Wiki

本文根据 CC-BY-SA 协议转载翻译自维基百科\href{https://en.wikipedia.org/wiki/Laplace\%27s_equation}{相关文章}。

在数学中，德摩根公式（也称为德摩根定理或德摩根恒等式）表明，对于任何实数\( x \)和整数\( n \)，有
\[
(\cos x + i \sin x)^n = \cos(nx) + i \sin(nx),~
\]
其中\( i \)是虚数单位（\( i^2 = -1 \)）。该公式以亚伯拉罕·德摩根的名字命名\(^\text{[1]}\)，尽管他在自己的著作中并未明确提出该公式\(^\text{[2]}\)。表达式\( \cos x + i \sin x \)有时简写为\( \text{cis} \, x \)。

该公式非常重要，因为它将复数和三角学联系起来。通过展开左侧表达式，并在假设\( x \)为实数的情况下比较实部和虚部，可以推导出\( \cos(nx) \)和 \( \sin(nx) \)的有用表达式，形式为\( \cos x \)和\( \sin x \)的函数。

如所写，该公式对非整数幂\( n \)无效。然而，存在该公式的广义形式，适用于其他指数。这些广义形式可用于给出统一根的显式表达式，即使得\( z^n = 1 \)的复数\( z \)。

使用正弦和余弦函数对复数的标准扩展，该公式即使在\( x \)为任意复数时也成立。
\subsection{示例}  
对于\( x = 30^\circ \)和\( n = 2 \)，德摩根公式断言：
\[
\left( \cos(30^\circ) + i \sin(30^\circ) \right)^2 = \cos(2 \cdot 30^\circ) + i \sin(2 \cdot 30^\circ),~
\]
或者等效地：
\[
\left( \frac{\sqrt{3}}{2} + \frac{i}{2} \right)^2 = \frac{1}{2} + \frac{i \sqrt{3}}{2}.~
\]
在这个例子中，通过展开左侧表达式很容易验证该等式的有效性。

\subsection{与欧拉公式的关系}  
德摩根公式是欧拉公式的前身：
\[
e^{ix} = \cos x + i \sin x,~
\]
其中\( x \)以弧度而非度数表示，这建立了三角函数与复指数函数之间的基本关系。

可以通过使用欧拉公式和整数幂的指数法则推导出德摩根公式：
\[
(e^{ix})^n = e^{inx},~
\]
因为欧拉公式意味着左侧等于\(\left( \cos x + i \sin x \right)^n\),而右侧等于\(\cos(nx) + i \sin(nx)\).
\subsection{归纳法证明}
通过数学归纳法可以证明 de Moivre 定理的正确性，并由此将其扩展到所有整数。对于一个整数\( n \)，定义以下命题\( S(n) \)：
\[
(\cos x + i \sin x)^n = \cos(nx) + i \sin(nx).~
\]
对于\( n > 0 \)，我们通过数学归纳法进行证明。显然，\( S(1) \)是成立的。假设对于某个自然数\( k \)，\( S(k) \)成立。即，我们假设：
\[
(\cos x + i \sin x)^k = \cos(kx) + i \sin(kx)~
\]
现在，考虑\( S(k+1) \)：
\[
(\cos x + i \sin x)^{k+1} = (\cos x + i \sin x)^k (\cos x + i \sin x)~
\]
根据归纳假设：
\[
= (\cos kx + i \sin kx) (\cos x + i \sin x)~
\]
利用三角恒等式展开：
\[
= \cos kx\cos x - \sin kx\sin x + i(\cos kx\sin x + \sin kx\cos x)~
\]
通过三角函数的和角公式：
\[
= \cos((k+1)x) + i \sin((k+1)x)~
\]
这就证明了\( S(k+1) \)的成立。因此，由数学归纳法可得，定理对于所有自然数\( n \)成立。

我们推导出\( S(k) \)蕴含\( S(k+1) \)。根据数学归纳法原理，由此可得该结果对于所有自然数都成立。现在，显然\(S(0)\)成立，因为\( \cos(0x) + i \sin(0x) = 1 + 0i = 1 \)。最后，对于负整数的情况，我们考虑\( -n \)的指数，其中\( n \)为自然数。
\begin{equation}
\begin{aligned}
(\cos x + i \sin x)^{-n}
&= \left( (\cos x + i \sin x)^n \right)^{-1}\\
&= (\cos nx + i \sin nx)^{-1} \\
&= \cos nx - i \sin nx \quad (\ast)\\
&= \cos(-nx) + i \sin(-nx)
\end{aligned}~
\end{equation}
等式\( (\ast) \)是由恒等式
\[
z^{-1} = \frac{\bar{z}}{|z|^2}~
\]
得出的，其中\( z = \cos(nx) + i \sin(nx) \)。因此，\( S(n) \)对于所有整数\( n \)成立。
\subsection{余弦和正弦的单独公式}  
对于复数的等式，必须保证方程两边的实部和虚部都相等。如果\( x \)，因此\( \cos x \)和\( \sin x \)，都是实数，则这些部分的恒等式可以使用二项式系数来表示。这个公式是由16世纪法国数学家弗朗索瓦·维耶特提出的：
\[
\sin(nx) = \sum_{k=0}^{n} \binom{n}{k} (\cos x)^k (\sin x)^{n-k} \sin\frac{(n-k)\pi}{2}~
\]
\[
\cos(nx) = \sum_{k=0}^{n} \binom{n}{k} (\cos x)^k (\sin x)^{n-k} \cos \frac{(n-k)\pi}{2} ~
\]
在这两个方程中的每一个，最终的三角函数等于 1、-1 或 0，从而去除了每个求和式中的一半项。这些方程实际上即使对于复数值的\( x \)也是有效的，因为两边都是关于\( x \)的整函数（即在整个复平面上全纯），而两个在实轴上相等的全纯函数必然在整个复平面上相等。以下是这些方程在\( n = 2 \)和\( n = 3 \)时的具体实例：
\[
\cos 2x = (\cos x)^2 + \left( (\cos x)^2 - 1 \right) = 2(\cos x)^2 - 1~
\]
\[
\sin 2x = 2(\sin x)(\cos x)~
\]
\[
\cos 3x = (\cos x)^3 + 3\cos x \left( (\cos x)^2 - 1 \right) = 4(\cos x)^3 - 3\cos x~
\]
\[
\sin 3x = 3(\cos x)^2(\sin x) - (\sin x)^3 = 3\sin x - 4(\sin x)^3~
\]
实际上，\( \cos nx \)公式右侧的表达式是切比雪夫多项式\( T_n(\cos x) \)在\( \cos x \)处的值。
\subsection{对于非整数幂的失败与推广}  
德·莫夫尔公式不适用于非整数幂。上面对德·莫夫尔公式的推导涉及将复数提高到整数幂\( n \)。如果复数被提升到非整数幂，结果是多值的（参见幂和对数恒等式的失败）。
\subsubsection{复数的根}  
本文中给出的德·莫夫尔公式的一个适度扩展可以用来求一个复数的\(n\)-次根，其中\( n \)为非零整数。（这等价于将复数提升到\(1/n\)次幂）。

如果\( z \)是一个复数，可以表示为极坐标形式：
\[
z = r \left( \cos x + i \sin x \right)~
\]
则\( z \)的\( n \)-次根由以下公式给出：
\[
r^{\frac{1}{n}} \left( \cos \frac{x + 2\pi k}{n} + i \sin \frac{x + 2\pi k}{n} \right)~
\]
其中\( k \)取从 0 到\( |n| - 1 \)的整数值。

这个公式有时也被称为德·莫夫尔公式。\(^\text{[3]}\)
\subsubsection{复数提升到任意幂}  
一般来说，如果\(z = r (\cos x + i \sin x)\)（极坐标形式），并且\(w\)是一个任意复数，那么可能的值集为：
\[
z^w = r^w \left( \cos x + i \sin x \right)^w = \left\{ r^w \cos \left( xw + 2\pi kw \right) + i r^w \sin \left( xw + 2\pi kw \right) \mid k \in \mathbb{Z} \right\}~
\]
（注意，如果\( w \)是一个有理数，且可以表示为\(p/q\)的最简分数形式，那么这个集合将有恰好 \( q \) 个不同的值，而不是无限多个。特别地，如果\( w \)是整数，那么集合将只有一个值，如前所述。）  

与此相反，德·莫夫尔公式给出的是：
\[
r^w (\cos xw + i \sin xw)~
\]
这只是该集合中对应\( k = 0 \)的唯一值。
\subsection{其他设置中的类比}  
\subsubsection{双曲三角学}  
由于\( \cosh x + \sinh x = e^x \)，德·莫夫尔公式的类比也适用于双曲三角学。对于所有整数\(n\)，
\[
(\cosh x + \sinh x)^n = \cosh nx + \sinh nx~
\]
如果\( n \)是有理数（但不一定是整数），那么\(\cosh nx + \sinh nx\)将是\( (\cosh x + \sinh x)^n \)的一个值。\(^\text{[4]}\)
\subsubsection{扩展到复数}  
对于任何整数\( n \)，该公式对任何复数\( z = x + iy \)都成立：
\[
(\cos z + i \sin z)^n = \cos(nz) + i \sin(nz)~
\]
其中，
\[
\cos z = \cos(x + iy) = \cos x \cosh y - i \sin x \sinh y~
\]
\[
\sin z = \sin(x + iy) = \sin x \cosh y + i \cos x \sinh y~
\]
\subsubsection{四元数}  
为了求四元数的根，有一个类似的德·莫夫尔公式。一个四元数的形式为：
\[
q = d + a\hat{i} + b\hat{j} + c\hat{k}~
\]
可以表示为
\[
q = k (\cos \theta + \varepsilon \sin \theta) \quad \text{对于} \quad 0 \leq \theta < 2\pi~
\]
在这个表示中，
\[
k = \sqrt{d^2 + a^2 + b^2 + c^2}~
\]
并且三角函数定义为
\[
\cos \theta = \frac{d}{k} \quad \text{和} \quad \sin \theta = \pm \frac{\sqrt{a^2 + b^2 + c^2}}{k}~
\]
如果 \( a^2 + b^2 + c^2 \neq 0 \)，则
\[
\varepsilon = \pm \frac{a \hat{i} + b \hat{j} + c \hat{k}}{\sqrt{a^2 + b^2 + c^2}}~
\]
即单位向量。由此得出德·莫夫尔公式的变形\(^\text{[5]}\)：
\[
q^n = k^n (\cos n\theta + \varepsilon \sin n\theta)~
\]

\textbf{例子}  

为了求四元数
\[
Q = 1 + \hat{i} + \hat{j} + \hat{k}~
\]
的立方根，将四元数写成如下形式：
\[
Q = 2 \left( \cos \frac{\pi}{3} + \varepsilon \sin \frac{\pi}{3} \right)~
\]
其中
\[
\varepsilon = \frac{\hat{i} + \hat{j} + \hat{k}}{\sqrt{3}}.~
\]
然后，立方根由以下公式给出：
\[
\sqrt[3]{Q} = \sqrt[3]{2} \left( \cos \theta + \varepsilon \sin \theta \right) \quad \text{对于} \quad \theta = \frac{\pi}{9}, \frac{7\pi}{9}, \frac{13\pi}{9}.~
\]
\subsection{2 × 2 矩阵}  
对于矩阵，\(\begin{pmatrix} \cos \phi & -\sin \phi \\ \sin \phi & \cos \phi \end{pmatrix}^n = \begin{pmatrix} \cos n\phi & -\sin n\phi \\ \sin n\phi & \cos n\phi \end{pmatrix}\)当\( n \)为整数时。这是矩阵类型\(\begin{pmatrix} a & -b \\ b & a \end{pmatrix}\)与复平面之间同构的直接结果。
\subsection{参考文献}    
\begin{itemize}
\item Abramowitz, Milton; Stegun, Irene A. (1964). *Handbook of Mathematical Functions*. New York: Dover Publications. p. 74. ISBN 0-486-61272-4.  
\end{itemize}
\begin{enumerate}
\item Moivre, Ab. de (1707). "Aequationum quarundam potestatis tertiae, quintae, septimae, nonae, & superiorum, ad infinitum usque pergendo, in termimis finitis, ad instar regularum pro cubicis quae vocantur Cardani, resolutio analytica" [关于第三、第五、第七、第九次及更高次方程式的解析解法，通过在有限项内进行计算，类似于卡尔达诺为三次方程式所提出的规则，分析解法]。*Philosophical Transactions of the Royal Society of London*（拉丁文）。25 (309): 2368–2371. doi:10.1098/rstl.1706.0037. S2CID 186209627.
\begin{itemize}
\item 由 Richard J. Pulskamp（2009）翻译的英文版\\  
在第2370页，de Moivre 表示，如果一个级数具有如下形式：\(ny + \frac{1-nn}{2 \times 3} ny^3 + \frac{1-nn}{2 \times 3} \frac{9-nn}{4 \times 5} ny^5 + \frac{1-nn}{2 \times 3} \frac{9-nn}{4 \times 5} \frac{25-nn}{6 \times 7} ny^7 + \cdots = a\)其中 \( n \) 是任何给定的奇整数（正数或负数），而 \( y \) 和 \( a \) 可以是函数，解出 \( y \) 后，结果是同页中的方程 (2)：\(y = \frac{1}{2} \sqrt[n]{a + \sqrt{aa - 1}} + \frac{1}{2} \sqrt[n]{a - \sqrt{aa - 1}}\)如果 \( y = \cos x \) 且 \( a = \cos nx \)，则结果为：\(\cos x = \frac{1}{2} (\cos(nx) + i \sin(nx))^{1/n} + \frac{1}{2} (\cos(nx) - i \sin(nx))^{1/n}\)
\item 1676年，艾萨克·牛顿发现了两个弦之间的关系，且它们的比值为 \( n \) 对 1；这个关系通过上述级数表示。这个级数出现在牛顿写给皇家学会秘书亨利·奥尔登堡的信中——《Epistola prior D. Issaci Newton, Mathescos Professoris in Celeberrima Academia Cantabrigiensi; …》，该信于1676年6月13日发出；信的副本被送给了戈特弗里德·威廉·莱布尼茨。参见：Biot, J.-B.; Lefort, F., 编者（1856年）。*Commercium epistolicum J. Collins et aliorum de analysi promota, etc: ou …*（拉丁文）。法国巴黎：Mallet-Bachelier出版社，第102–112页。
\item 1698年，de Moivre 推导出了相同的级数。参见：de Moivre, A.（1698年）。“提取无限方程根的方法”。*Philosophical Transactions of the Royal Society of London*，20（240）：190–193。doi:10.1098/rstl.1698.0034。S2CID 186214144；参见第192页。
\item 1730年，de Moivre 明确考虑了当函数为\( \cos \theta \) 和 \( \cos n\theta \)时的情况。参见：Moivre, A. de (1730). Miscellanea Analytica de Seriebus et Quadraturis（拉丁文）。伦敦，英格兰：J. Tonson & J. Watts，第1页。从第1页开始：  
“引理 1. 若\( l \)和\( x \)为两个弧度\( A \)和\( B \)的余弦，且它们都由相同的半径 1 描述，且其中前者是后者的倍数，且倍数的比例为\( n \)对 1，则有\(x = \frac{1}{2} \sqrt[n]{l + \sqrt{l^2 - 1}} + \frac{1}{2} \frac{1}{\sqrt[n]{l + \sqrt{l^2 - 1}}}\)（如果\( l \)和\( x \)是两个弧度 \( A \)和\( B \)的余弦，并且它们都由相同的半径 1 描述，且前者是后者的倍数，倍数的比例为\( n \)对 1，那么将有\(x = \frac{1}{2} \sqrt[n]{l + \sqrt{l^2 - 1}} + \frac{1}{2} \frac{1}{\sqrt[n]{l + \sqrt{l^2 - 1}}}\)因此，如果弧 \( A = n \times \) 弧 \( B \)，那么 \( l = \cos A = \cos nB \) 和 \( x = \cos B \)。因此，\(\cos B = \frac{1}{2} \left( \cos(nB) + \sqrt{-1} \sin(nB) \right)^{1/n} + \frac{1}{2} \left( \cos(nB) + \sqrt{-1} \sin(nB) \right)^{-1/n}\)
\end{itemize}
另见：  
\begin{itemize}
\item Cantor, Moritz (1898). Vorlesungen über Geschichte der Mathematik[《数学史讲义》]。Bibliotheca mathematica Teuberiana, Bd. 8-9（德文）。第3卷。德国莱比锡：B.G. Teubner，第624页。  
\item Braunmühl, A. von (1901). "Zur Geschichte der Entstehung des sogenannten Moivreschen Satzes" [关于所谓 Moivre 定理起源的历史]。Bibliotheca Mathematica，第3系列（德文）。第2期：97–102；参见第98页。
\end{itemize}
\item Lial, Margaret L.; Hornsby, John; Schneider, David I.; Callie J., Daniels (2008). *College Algebra and Trigonometry* (第4版)。波士顿：Pearson/Addison Wesley，第792页。ISBN 9780321497444.  
\item "De Moivre formula", *Encyclopedia of Mathematics*, EMS Press, 2001 [1994]  
\item Mukhopadhyay, Utpal (2006年8月). "Some interesting features of hyperbolic functions"。*Resonance*，11（8）：81–85。doi:10.1007/BF02855783。S2CID 119753430.  
\item Brand, Louis (1942年10月). "The roots of a quaternion"。*The American Mathematical Monthly*，49（8）：519–520。doi:10.2307/2302858。JSTOR 2302858.  
\end{enumerate}
\subsection{外部链接}  
\begin{itemize}
\item De Moivre's Theorem for Trig Identities by Michael Croucher, Wolfram Demonstrations Project.
\end{itemize}