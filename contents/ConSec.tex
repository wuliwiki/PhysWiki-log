% 圆锥曲线和圆锥
% 椭圆|双曲线|抛物线|圆锥|圆锥曲线

\pentry{椭圆\upref{Elips3}， 抛物线\upref{Para3}， 双曲线\upref{Hypb3}， 右手定则\upref{RHRul}， 平面旋转矩阵\upref{Rot2D}}

圆锥曲线之所以叫做圆锥曲线， 是因为它们可以由平面截取圆锥面得到（\autoref{ConSec_fig1}）． 然而由于这涉及较为繁琐的计算， 所以初学圆锥曲线时我们往往先介绍更简单的定义， 例如 “圆锥曲线的极坐标方程\upref{Cone}” 中的定义， 或者直接在 $x$-$y$ 直角坐标系中使用二次方程定义（见预备知识）． 以下我们来证明双圆锥被平面截出的任意曲线都是圆锥曲线．

\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/ConSec_1.png}
\caption{圆锥的有限截面是一个椭圆（来自 Wikipedia）} \label{ConSec_fig1}
\end{figure}

双圆锥面如\autoref{ConSec_fig2} 所示． 在直角坐标系 $x$-$y$-$z$ 中， 为了方便我们使用顶角（两条母线的最大夹角）为 $\pi/2$ 的圆锥
\begin{figure}[ht]
\centering
\includegraphics[width=6cm]{./figures/ConSec_2.png}
\caption{\autoref{ConSec_eq4} 表示的双圆锥面（修改自 Wikipedia）} \label{ConSec_fig2}
\end{figure}
其方程为
\begin{equation}\label{ConSec_eq4}
z_1^2 = x_1^2 + y_1^2
\end{equation}
对其他顶角的圆锥， 我们只需要把 $z$ 轴缩放一下即可．

我们可以再列出一个一般的平面方程与\autoref{ConSec_eq4} 联立得到方程组， 但这样解出来的曲线将与 $x$-$y$ 平面未必平行． 所以更方便的办法是先把圆锥旋转一下， 再用某个和 $x$-$y$ 平面平行的平面 $z = z_0$ 去截出曲线． 这样就方便化为圆锥曲线的标准方程． 关于 $y$ 轴的旋转变换\upref{Rot2DT}为\footnote{\autoref{ConSec_eq1} 和\autoref{ConSec_eq2} 可以表示为 $3\times 3$ 的三维旋转矩阵\upref{Rot3D}．}
\begin{equation}\label{ConSec_eq1}
\pmat{x_1\\z_1} = \pmat{\cos\theta & -\sin\theta\\ \sin\theta & \cos\theta}\pmat{x\\z}
\end{equation}
\begin{equation}\label{ConSec_eq2}
y_1 = y
\end{equation}
代入\autoref{ConSec_eq4} 得
\begin{equation}\label{ConSec_eq3}
(\sin\theta\cdot x + \cos\theta\cdot z)^2 = (\cos\theta\cdot x - \sin\theta\cdot z)^2 + y^2
\end{equation}
这相当于把圆锥关于 $y$ 轴用右手定则\upref{RHRul}旋转了 $\theta$． 当 $\theta \ne \pi/4$ 时， 化成椭圆或双曲线的标准方程（\autoref{Elips3_eq3}~\upref{Elips3} \autoref{Hypb3_eq4}~\upref{Hypb3}）
\begin{equation}
\frac{(x - \tan2\theta \cdot z)^2}{(z/\cos2\theta)^2} + \frac{y^2}{z^2/\cos2\theta} = 1
\end{equation}
长半轴、短半轴和离心率分别为
\begin{equation}
a = \frac{z}{\cos2\theta}~,
\qquad
b = \frac{z}{\sqrt{\abs{\cos2\theta}}}~,
\qquad
e = \sqrt{2}\sin\theta
\end{equation}
当 $\theta < \pi/4$ 时， 式中 $\cos2\theta > 0$， 就得到了椭圆（$e < 1$）， 反之则得到双曲线．

当 $\theta = \pi/4$， \autoref{ConSec_eq3} 化为抛物线（$e = 1$）的标准方程（\autoref{Para3_eq2}~\upref{Para3}）
\begin{equation}
y^2 = 2zx
\end{equation}
