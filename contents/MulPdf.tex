% 多变量分布函数
% keys 概率分布|统计|分布函数|概率
% license Xiao
% type Tutor

% 未完成： 名字改为多维概率分布函数

\pentry{概率分布函数\nref{nod_RandF}， 重积分\nref{nod_IntN}}{nod_8e63}

\subsection{二维分布函数}
我们以打靶为例来引入二元概率分布函数， 以及在直角坐标系和极坐标系中如何分析各种平均值。 我们在靶上建立 $x$-$y$ 直角坐标系， 类比一维概率分布函数的定义， 二维概率分布可以用一个二元函数表示为 $f(x, y)$， 也叫\textbf{概率密度（probability density）}。 子弹落在一个长方形区域内（令 $x \in [x_1, x_2]$， $y \in [y_1, y_2]$） 的概率可以用二重积分表示
\begin{equation}
P = \int_{y_1}^{y_2} \int_{x_1}^{x_2} f(x, y) \dd{x} \dd{y}~.
\end{equation}
从几何上理解， $f(x, y)$ 可以看作一张三维空间中的曲面， 而这个二重积分则表示曲面和 $x$-$y$ 平面之间的一个体积（\autoref{fig_MulPdf_1}）。

\begin{figure}[ht]
\centering
\includegraphics[width=7cm]{./figures/5bea347882213c85.png}
\caption{$f(x, y)$ 曲面下的体积} \label{fig_MulPdf_1}
\end{figure}

类比一维情况， 概率归一化条件为
\begin{equation}
\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f(x, y) \dd{x} \dd{y} = 1~.
\end{equation}
由于概率的量纲是 1， $f(x, y)$ 的国际单位量纲就是 $\Si{m^{-2}}$， 即面积的倒数。

\subsection{平均值}
类比\autoref{eq_RandF_3}~\upref{RandF}， 离散情况下， 令 $P_i$ 是 $(x_i, y_i)$ 出现的概率， 函数 $g(x,y)$ 的平均值为
\begin{equation}
\ev{g} = \sum_{i=1}^N g(x_i, y_i) P_i~.
\end{equation}
拓展到连续的情况， 类比\autoref{eq_RandF_2}~\upref{RandF}， $g(x, y)$ 的平均值可以定义为
\begin{equation}
\ev{g} =  \int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} g(x, y) f(x, y) \dd{x} \dd{y}~.
\end{equation}
例如位置矢量的 $x$ 和 $y$ 分量平均值分别为
\begin{equation}\label{eq_MulPdf_2}
\ev{x} = \iint x f(x, y) \dd{x}\dd{y}~,
\end{equation}
\begin{equation}
\ev{y} = \iint y f(x, y) \dd{x}\dd{y}~.
\end{equation}
以上两式也可以用位置矢量 $\bvec r$ 表示为（这时 $\bvec g$ 的函数值是矢量）
\begin{equation}\label{eq_MulPdf_6}
\ev{\bvec r} = \iint \bvec r f(x, y) \dd{x}\dd{y}~,
\end{equation}
点 $(x,y)$ 到原点距离的距离 $r$ 的平均值
\begin{equation}
\ev{r} = \iint \sqrt{x^2 + y^2} f(x, y) \dd{x}\dd{y}~.
\end{equation}
注意区分该式和\autoref{eq_MulPdf_6} 式的意义， 平均位置和平均距离是两个不同的概念： 如果 $f(x, y)$ 是关于原点中心对称的函数， 则平均位置为 $(0, 0)$， 而平均距离不为零。

距离平方 $r^2$ 的平均值
\begin{equation}\label{eq_MulPdf_7}
\ev{r^2} = \iint (x^2 + y^2) f(x, y) \dd{x}\dd{y}~.
\end{equation}

\subsection{概率分布的极坐标表示}
\pentry{极坐标系\nref{nod_Polar}}{nod_76bb}

除了直角坐标系外， 我们也可以使用极坐标\upref{Polar} 表示分布函数， 记为\footnote{在数学上， 该式两边是两个不同的二元函数， 应该使用不同的函数名如 $g(r, \theta) = f(x, y)$， 但在一些物理教材中， 我们有时为了方便不区分函数名， 直接把 $g(r, \theta)$ 写成 $f(r, \theta)$。} $f(r, \theta)$， 那么概率归一化条件变为
\begin{equation}\label{eq_MulPdf_1}
\int_0^\infty \int_{0}^{2\pi} f(r, \theta)\,\, r\dd{\theta}\dd{r} = 1~,
\end{equation}
函数 $g(r, \theta)$ 的平均值变为
\begin{equation}
\ev{g} = \int_0^\infty \int_{0}^{2\pi} g(r, \theta) f(r, \theta)\,\, r\dd{\theta}\dd{r}~.
\end{equation}
例如\autoref{eq_MulPdf_7} 变为
\begin{equation}\label{eq_MulPdf_3}
\ev{r^2} = \int_0^\infty \int_{0}^{2\pi} r^2 f(r, \theta)\,\, r\dd{\theta}\dd{r}
= \int_0^\infty \int_{0}^{2\pi} r^3 f(r, \theta) \dd{\theta}\dd{r}~.
\end{equation}

% 习题未完成

\subsection{圆对称分布}
继续打靶的例子， 我们接下来讨论圆对称的概率分布（在三维情况下叫做球对称）， 即 $f(r, \theta)$ 的值只和 $r$ 有关而与 $\theta$ 无关的情况。 为了书写方便可记 $f(r) \equiv f(r, \theta)$。 归一化条件\autoref{eq_MulPdf_1} 化简为（先完成关于 $\theta$ 积分得 $2\pi$）
\begin{equation}
2\pi \int_0^\infty r f(r) \dd{r} = 1~.
\end{equation}

一个容易混淆的概念是， $f(r)$ 并不是变量 $r$ 的概率分布函数。 也就是说 $\int_a^b f(r) \dd{r}$ 并不是子弹落在圆环 $r \in [a, b]$ 内的概率。 若将 $r$ 的概率分布函数记为 $F(r)$， 子弹落在圆环中的概率应该是
\begin{equation}\label{eq_MulPdf_4}
P_{ab} = \int_a^b F(r) \dd{r} = \int_a^b 2\pi r f(r) \dd{r}~.
\end{equation}
由于两个定积分在任何区间都相等， 两个被积函数必须相等， 即
\begin{equation}\label{eq_MulPdf_5}
F(r) = 2\pi r f(r)~.
\end{equation}
这时以上的平均值也可以得到进一步化简， 例如\autoref{eq_MulPdf_3} 变为
\begin{equation}
\ev{r^2} = \int_0^\infty r^2 F(r) \dd{r}
= 2\pi \int_0^\infty r^3 f(r) \dd{r}~.
\end{equation}
\subsection{多随机变量的函数的分布}
我们在前面已经知道定义在随机变量X、Y上的函数$g(x,y)$的平均值$\bar{g}$如何计算，但实际上如果关注每次$g(x,y)$的值，我们会发现$g(x,y)$也满足一定的概率分布，那如何求解这个概率分布呢？我们以二元随机变量的几个例子为例说明。首先我们引入分布函数这个概念
\begin{definition}{分布函数与边缘分布函数}
对于一个随机变量X，我们定义分布函数为$F(\alpha)=P(x\leq \alpha) = \int_{-\infty}^{\alpha} f(x)dx$。对于一个二维连续随机变量(X,Y),其边缘分布函数有两个，X的边缘分布函数$F_X(x)$与Y的边缘分布函数$F_Y(y)$,定义为
\begin{align}
F_X(x) = \int_{-\infty}^{+\infty} dy^\prime \int_{-\infty}^{x} dx^\prime f(x^\prime,y^\prime)\\~
F_Y(y) = \int_{-\infty}^{+\infty} dx^\prime \int_{-\infty}^y dy^\prime f(x^\prime,y^\prime)~
\end{align}
\end{definition}
类似地我们可以定义边缘概率密度函数$f_X(x) = \frac{dF_X(x)}{dx}$,$f_Y(y) = \frac{dF_Y(y)}{dy}$。

\begin{example}{}
我们定义随机变量$Z=X+Y$,求$Z$的分布的概率密度函数，这时我们要先去求$Z$的分布函数，$F_Z(\alpha)=P(z\leq \alpha) = P(x+y\leq \alpha)$,而$P(x+y\leq \alpha) = \int_{-\infty}^{+\infty}dx \int_{-\infty}^{\alpha-x} dy f(x,y)$,当给定二元分布函数的概率密度$f(x,y)$后，$F_Z(\alpha)$即可积分算出。继而通过$f_Z(z) = \frac{d F_Z(z)}{dz}$即可求得。
\end{example}
