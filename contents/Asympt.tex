% 渐近展开
\pentry{泰勒展开\upref{Taylor}}

\subsection{定义辨析}
在数学中, \textbf{渐近展开 (asymptotic expansion)} 是用一列较简单的函数来逐次逼近给定的函数的办法. 它的形式定义如下:

\begin{definition}{渐近展开}
设自变量$x$趋于某点$a$ (有限或无限) 时, 函数序列$\{\phi_{n}(x)\}$满足
$$
\phi_{n+1}(x)=o(\phi_n(x)),\,x\to a.
$$
则对于给定的函数$f$, 称$f(x)$在$x\to a$时有渐近展开式
\begin{equation}\label{Asympt_eq1}
f(x)\simeq c_0\phi_0(x)+c_1\phi_1(x)+...+c_n\phi_n(x)+...,\,x\to a
\end{equation}
是指: 对于任何给定的$n$, 皆有
\begin{equation}\label{Asympt_eq2}
f(x)=c_0\phi_0(x)+c_1\phi_1(x)+...+c_n\phi_n(x)+o(\phi_n(x)),\,x\to a.
\end{equation}
\autoref{Asympt_eq1}中的级数称为$x\to a$时$f(x)$的渐近级数.
\end{definition}

一般常用的序列是单项式序列或者一般的幂函数序列. 渐近展开的四则运算性质是容易验证的.

有如下注意事项:
\begin{enumerate}
\item 一般来说, 从渐近展开不能将函数还原: 当$x\to0$时, 函数$f(x)\equiv 0$和函数$g(x)=\E^{-1/x^2}$都有渐近展开
$$
0+0x+0x^2+...
$$

\item 渐近级数可以收敛也可以发散. \autoref{Asympt_eq1}只是一个形式等式, 它的真正含义是\autoref{Asympt_eq2}, 而\autoref{Asympt_eq2}只表示对于\textbf{固定的$n$}, 当$x\to a$时, $f(x)$与渐近级数的第$n$项部分和相差一个高阶无穷小. 

\item 通过直接计算, 可以看出渐近展开式可以逐项积分. 但一般来说渐近展开式不可以逐项微分. 例如, $f(x)=e^{-x}\sin(e^{2x})$当$x\to+\infty$时趋于零, 但它的导数却根本没有极限.
\end{enumerate}

\subsection{基本例子}
\begin{example}{泰勒展开}
泰勒展开\upref{Taylor}就是渐近展开的例子. 泰勒级数不必收敛, 即便收敛也不必收敛到函数本身. 在函数$\E^{-1/x^2}$的例子中, 原点处的泰勒级数与函数本身的差永远是函数本身, 但显然这个差在$x\to0$时衰减得比$x$的任意正幂都快.
\end{example}

\begin{example}{发散级数部分和}
如果$f(x)$在$x\geq1$时是单调不减函数, 那么有$$
\sum_{k=1}^nf(k)=\int_1^n f(x)dx+O(f(n))+O(1),\,n\to\infty.
$$
例如, 如果取$f(x)=1/x$, 那么有熟知的公式
$$
\sum_{k=1}^n\frac{1}{k}=\log n+O(1).
$$
实际上当然还可以借助更复杂的分析技巧写得再精确些, 例如我们知道$-\log n+\sum_{k=1}^n1/k$的极限是存在的, 也就是欧拉常数$\gamma=0.57721566...$. 更精细的渐近展开式可以由欧拉-麦克劳林公式给出.
\end{example}

\subsection{欧拉的例子}
考察非初等的函数
$$
f(x)=\int_0^\infty\frac{e^{-t}}{x+t}dt
$$
当$x\to+\infty$时的行为. 欧拉将$1/(x+t)$展开为几何级数
$
\sum_{k=0}^\infty {(-1)^kt^k}/{x^{k+1}},
$
代入并计算得到如下的形式等式:
\begin{equation}\label{Asympt_eq3}
f(x)=\sum_{k=0}^\infty\frac{(-1)^kk!}{x^{k+1}}.
\end{equation}
当然, 欧拉的时代还没有收敛性的观念. \autoref{Asympt_eq3}右边的级数对于任何$x$都不收敛, 之所以出现这样的问题是因为$t$的几何级数收敛半径是有限的, 于是将几何级数逐项积分的计算违反分析学的准则. 

然而, 从今天的观点看, 这个等式仍然在渐近展开的意义下成立. 实际上, 通过换元可得
$$
f(x)=e^{x}\int_x^\infty \frac{e^{-t}}{t}dt.
$$
反复进行分部积分, 得到
$$
f(x)=\sum_{k=0}^n\frac{(-1)^kk!}{x^{k+1}}
+(n+1)!e^x\int_x^\infty\frac{e^{-t}}{t^{n+2}}dt.
$$
最后的这个积分可估算如下: 当$t>x$时$1/t^{n+2}<1/x^{n+2}$, 于是
\begin{equation}\label{Asympt_eq4}
\int_x^\infty\frac{e^{-t}}{t^{n+2}}dt
\leq\frac{1}{x^{n+2}}\int_x^\infty e^{-t}dt
=\frac{e^{-x}}{x^{n+2}}.
\end{equation}
这样就有
$$
f(x)=\sum_{k=0}^n\frac{(-1)^kk!}{x^{k+1}}
+O\left(\frac{1}{x^{n+2}}\right),\,x\to+\infty.
$$
这表示\autoref{Asympt_eq3}在渐近展开的意义下成立. 

特别地, 这个渐近级数尽管发散, 但对于大的$x$却可以很好地计算$f(x)$的值, 因为根据估计\autoref{Asympt_eq4}, $f(x)$同渐近级数$n$项部分和之差的绝对值不超过
$$
\frac{(n+1)!}{x^{n+2}},
$$
而对于大的$x$, 当$n<x$时这个误差项随着$n$的增大而减小, 只有当$n$大致超过$x$时误差才会重新开始增大. 因此, 如果将渐近级数截断到大约$x$项, 则部分和与$f(x)$之差将不超过$1/2^x$. 对于大的$x$来说, 这足以给出相当精确的近似值. 

由这个例子可以看出渐近展开的意义: 可以用一个发散级数去很好地逼近一个收敛的对象.