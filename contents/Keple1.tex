% 开普勒第一定律的证明
% 开普勒第一定律|圆锥曲线轨道|LRL矢量|比耐公式

\pentry{开普勒三定律\upref{Keple}}

行星轨道是以中心天体为焦点的任意圆锥曲线\footnote{行星轨道不一定是椭圆， 也可以是抛物线或者双曲线， 但是抛物线或双曲线轨道是从无穷远来到无穷远去的轨道， 不会绕中心天体旋转。 所以开普勒定律作为行星运动的经验公式，只描述了椭圆。}。 开普勒第一定律一般使用极坐标讲解， 圆锥曲线的极坐标方程\upref{Cone}为
\begin{equation}\label{Keple1_eq1}
r = \frac{p}{1 - e \cos \theta }~.
\end{equation}
令中心天体固定在坐标原点，则行星沿该轨道运行。

下面给出两种证明方式， 第一种 LRL 矢量法偏物理， 无需使用微分方程， 相对简单。 第二种在极坐标中解二阶微分方程， 即比耐公式。

\subsection{用 LRL 矢量证明}
\pentry{拉普拉斯—龙格—楞次矢量\upref{LRLvec}， 三矢量的混合积\upref{TriVM}}

将拉普拉斯—龙格—楞次（LRL）矢量 $\bvec A$ 点乘位矢 $\bvec r$ 得
\begin{equation}\label{Keple1_eq2}
\bvec A \vdot \bvec r = (\bvec p \cross \bvec L)\vdot \bvec r - mkr~.
\end{equation}
由矢量混合积\autoref{TriVM_eq1}~\upref{TriVM}， 右边第一项为
\begin{equation}
(\bvec p \cross \bvec L)\vdot \bvec r = (\bvec r \cross \bvec p)\vdot \bvec L = L^2~,
\end{equation}
令 $\theta$ 为从 $\uvec A$ 转向 $\uvec r$ 的夹角（令极轴与矢量 $\bvec A$ 平行，如\autoref{Keple1_fig1}），则\autoref{Keple1_eq2} 变为
\begin{figure}[ht]
\centering
\includegraphics[width=9cm]{./figures/Keple1_1.pdf}
\caption{LRL矢量与位置矢量夹角} \label{Keple1_fig1}
\end{figure}
\begin{equation}
Ar\cos\theta = L^2 - mkr~.
\end{equation}
可得极坐标中的轨道为圆锥曲线的极坐标方程\footnote{对比\autoref{Keple1_eq1} 会发现分母的正负号反了， 这相当于把圆锥曲线旋转了 $180^\circ$，并不影响形状。}
\begin{equation}
r(\theta) = \frac{p}{1 + e\cos\theta}~,
\end{equation}
其中通径为 $p = L^2/(mk)$， 离心率为 $e = A/(mk)$。

\subsection{用比耐公式证明}
\pentry{比耐公式\upref{Binet}， 二阶常系数非齐次微分方程的通解\upref{Ode2N}}

将平方反比力 $F(r) = -k/r^2$ 即 $F(1/u) = -ku^2$ 代入比耐公式
\begin{equation}
\dv[2]{u}{\theta} + u = -\frac{m}{L^2 u^2} F\qty(\frac 1u)~.
\end{equation}
通解\upref{Ode2N}为
\begin{equation}\label{Keple1_eq7}
u(\theta) = \frac{1}{p} \qty[1 - e\cos(\theta  + \phi_0)]~,
\end{equation}
其中
\begin{equation}
p = \frac{L^2}{mk}~,
\end{equation}
将\autoref{Keple1_eq7} 代入 $r = 1/u$， 得到圆锥曲线\autoref{Keple1_eq1}。 证毕。

\subsubsection{另一种推导}
在开普勒问题中，相互作用势为 $V(\rho)=-GMm/\rho=-k/\rho$。 那么 \autoref{Binet_eq3}~\upref{Binet} 变为
\begin{equation}
\begin{aligned}
\left|\frac{\dd u}{\dd \theta}\right|&=\sqrt{-u^2+\frac{2m k}{L^2}u+\frac{2m E}{L^2}}\\
&=\sqrt{-\qty(u-\frac{m k}{L^2})^2+\frac{2m E}{L^2}+\frac{m^2 k^2}{L^4}}
\end{aligned}~.
\end{equation}
该一阶偏微分方程的解的形式为
\begin{equation}
u-\frac{m k}{L^2}=\alpha\cos(\phi-\beta)~,
\end{equation}
可以解得
\begin{equation}
\begin{aligned}
\alpha=\sqrt{\frac{2m E}{L^2}+\frac{m^2 k^2}{L^4}}~,\\
\end{aligned}
\end{equation}
这样就求得了 $u$ 关于 $\phi$ 的表达式。最后将 $u$ 用 $\rho=1/u$ 表示，得到
\begin{equation}
\rho=\frac{p}{1+e\cos(\phi-\beta)}~,
\end{equation}
其中 $e$ 为轨道的偏心率（或者称离心率）。$p,e$ 由下式给出：
\begin{equation}
\begin{aligned}
&p=\frac{L^2}{m k}\\
&e=\frac{L^2}{m k}\alpha=\sqrt{1+\frac{2L^2E}{m k^2}}
\end{aligned}~.
\end{equation}

根据圆锥曲线的极坐标方程\upref{Cone}，可以知道开普勒问题的轨道呈椭圆、抛物线或双曲线形状。

\subsection{平方反比斥力}
当有心力从引力变为斥力时， 令 $F(r) = k/r^2$ 即 $F(1/u) = ku^2$ 代入比耐公式， 解得
\begin{equation}%\label{InvKep_eq3}
u(\theta) = -\frac{1}{p} \qty[1 + e\cos(\theta  + \phi_0)]~.
\end{equation}
与\autoref{Keple1_eq7} 相比， 中的常数项由正号变为负号， 这使得极坐标的双曲线方程表达双曲线离焦点较远的一支（见\autoref{Cone_eq6}~\upref{Cone}）。
