% 二次量子化
% 二次量子化|多体系统|玻色统计|费米统计

\pentry{全同粒子\upref{IdPar}，全同粒子的统计\upref{IdParS}}

薛定谔方程是关于单粒子的量子力学，而如果我们考虑一个多粒子体系，研究粒子间相互作用对多体系统的影响，则有必要建立一个关于多粒子的量子力学。一个直接的想法是，讲单个时空坐标变量的波函数拓展为 $N$ 个变量的波函数 $\psi(x_1,\cdots,x_N)$，波函数的模方具有概率的意义，因此可以乘上一个系数使它归一化。此外，如果某多体系统中两个电子可以被看作是两个独立的波函数 $\psi_1(x_1)$ 和 $\psi_2(x_2)$，那么这意味着 $\psi(x_1,x_2)$ 可以写成 $\psi_1(x_1)\psi_2(x_2)$ 也就是这两个单粒子波函数的乘积，此时这个量子态可以用 $\ket{\psi_1}\ket{\psi_2}$ 表示，它的坐标表象就是 $(\bra{x_1}\bra{x_2})(\ket{\psi_1}\ket{\psi_2})=\braket{x_1}{\psi_1} \braket{x_2}{\psi_2}=\psi_1(x_1)\psi_2(x_2)=\psi(x_1,x_2)$。

然而当我们讨论全同粒子的时候，例如 $N$ 个电子组成的体系，上述波函数的定义并没有体现粒子的全同性，波函数不具有交换对称性或交换反对称性\footnote{玻色统计满足交换对称性 $\psi(x_1,x_2,\cdots)=\psi(x_2,x_1,\cdots)$，而费米统计满足交换反对称性，$\psi(x_1,x_2,\cdots)=-\psi(x_2,x_1,\cdots)$。}。因此有必要将波函数对称化。我们令 $\xi=\pm 1$，$\xi=1$ 对应玻色统计，而 $\xi=-1$ 对应费米统计。那么可以定义新的对称化的波函数为
\begin{equation}
\psi'(x_1,\cdots,x_N)\propto \sum_{P\in S_N} \xi^P \psi(x_{P_1},x_{P_2},\cdots,x_{P_N})
\end{equation}
其中 $\xi^P$ 中的指数 $P$ 看作是排列 $P\in S_N$ 的逆序数，每交换排列 $P$ 的某两个 $P_i,P_j$，逆序数都会改变 $\pm 1$。

$N$ 体系统的波函数所在的 Hilbert 空间记为 $\mathcal{H}_N$。完整的 Hilbert 空间被称为 Fock 空间，记为 $\mathcal{F}$，那么我们可以将 $\mathcal{F}$ 表示为一切 $\mathcal{H}_N$ 的直和，即
\begin{equation}
\mathcal{F}=\mathcal{H}_1 \oplus \mathcal{H}_2 \oplus \cdots
\end{equation}
为了更清楚地了解 $\mathcal{F}$ 的结构，我们需要从几个方面进行研究：首先是研究 $\mathcal{H}_N$ 的一组正交完备基底，有了基底以后我们可以用这些基函数的线性组合来表示任意 $N$ 体系统，经过合适的基底构造还可以将单粒子态与多粒子态联系起来；然后我们需要研究产生算符和湮灭算符，它们将不同粒子数的 Hilbert 空间之间关联了起来。最后，我们需要研究多粒子系统的算符，这里面包括能量算符、动量算符、相互作用势能算符等等，这是二次量子化的一个非常重要的内容。
\subsection{Fock 空间的基底}
\subsubsection{多粒子态的内积}
Fock 空间的最简单的一组基底为坐标表象下的基底，我们将它记为 $\ket{x_1\cdots x_N}$（类似于单粒子 Hilbert 空间的 $\ket{x}$ 基底），满足正交完备性。因此我们可以用这组完备的基底来对任意的多粒子态进行展开，也就是说在坐标表象下考察多粒子态，其对应系数的模的平方可以诠释为这些粒子处于相应的位置的概率。对于多体系统的这组基底，我们约定每交换两个坐标 $x_i,x_j$，态矢 $\ket{x_1\cdots x_N}$ 将改变一个 $\xi$ 的因子，即满足交换对称性
\begin{equation}
\begin{aligned}
\ket{\cdots x_i \cdots x_j \cdots}& =
\xi \ket{\cdots x_j \cdots x_i \cdots} \\
&=\frac{1}{\sqrt{N!}}\sum_P \xi^P\ket{x_{P_1}}\ket{x_{P_2}}\cdots\ket{x_{P_N}}
\end{aligned}
\end{equation}

更一般地，我们定义这样的多粒子态，其中第 $i$ 个粒子的波函数可以由 $\psi_i(x)$ 描述。
\begin{equation}
\begin{aligned}
\ket{\psi_1\cdots\psi_N}&=\frac{1}{\sqrt{N!}}\sum_P \xi^P\ket{\psi_{P_1}}\cdots \ket{\psi_{P_N}}\\
&=\frac{1}{\sqrt{N!}}\sum_P \xi^P\psi_{P_1}(x_1)\cdots \psi_{P_N}(x_N)
\end{aligned}
\end{equation}
则经过计算，它的坐标表象为
\begin{equation}\label{SecQua_eq1}
\braket{x_1\cdots x_N}{\psi_1\cdots\psi_N}=\frac{1}{N!}\sum_P\sum_Q \xi^P \xi^Q \braket{x_{P_1}}{\psi_{Q_1}}\cdots\braket{x_{P_N}}{\psi_{Q_N}}
\end{equation}
我们可以将右侧的 $\braket{x_{P_i}}{\psi_{Q_i}}$ 重排，使得 $Q_i$ 从左往右依次是 $1,2,\cdots,N$，那么 $P_i$ 从左往右依次是 $P'_1,P'_2,\cdots,P'_N$。这意味着 $P'_{Q_i}=P_i$，或者说 $P'=P\circ Q^{-1}$。根据逆序数的性质，$\xi^P\xi^Q=\xi^{P\circ Q^{-1}}=\xi^{P'}$，\autoref{SecQua_eq1}  最终可以化简为
\begin{equation}
\begin{aligned}
\braket{x_1\cdots x_N}{\psi_1\cdots\psi_N}&=\frac{1}{N!}\sum_{P'}\sum_Q \xi^{P'} \braket{x_{P'_1}}{\psi_{1}}\cdots\braket{x_{P'_N}}{\psi_{N}}\\
&=\sum_{P}\xi^P\braket{x_{P_1}}{\psi_{1}}\cdots\braket{x_{P_N}}{\psi_{N}}\\
&=\left|\begin{matrix}
\braket{x_1}{\psi_1} &\braket{x_2}{\psi_1} &\cdots &\braket{x_N}{\psi_1}\\
\braket{x_1}{\psi_2} &\braket{x_2}{\psi_2} &\cdots & \braket{x_N}{\psi_2}\\
\vdots & \vdots & & \vdots \\
\braket{x_1}{\psi_N} &\braket{x_2}{\psi_N} &\cdots & \braket{x_N}{\psi_N}
\end{matrix}\right|_\xi
\end{aligned}
\end{equation}
上述行列式右下角的 $\xi$ 表示每一个乘积项都带有一个 $\xi^P$ 的符号。可以将上述公式拓展到求某两个多粒子态（这两个多粒子态分别是由若干个单粒子波函数张量积再作对称化而构造的） $\ket{\psi_1\cdots\psi_N}$ 和 $\ket{\phi_1\cdots\phi_N}$ 的内积：
\begin{equation}\label{SecQua_eq2}
\begin{aligned}
\braket{\phi_1\cdots \phi_N}{\psi_1\cdots\psi_N}
&=\sum_{P}\xi^P\braket{\phi_{P_1}}{\psi_{1}}\cdots\braket{\phi_{P_N}}{\psi_{N}}\\
&=\left|\begin{matrix}
\braket{\phi_1}{\psi_1} &\braket{\phi_2}{\psi_1} &\cdots &\braket{\phi_N}{\psi_1}\\
\braket{\phi_1}{\psi_2} &\braket{\phi_2}{\psi_2} &\cdots & \braket{\phi_N}{\psi_2}\\
\vdots & \vdots & & \vdots \\
\braket{\phi_1}{\psi_N} &\braket{\phi_2}{\psi_N} &\cdots & \braket{\phi_N}{\psi_N}
\end{matrix}\right|_\xi
\end{aligned}
\end{equation}
\subsubsection{构造正交完备基}
利用上述的内积关系，我们可以构造一组正交完备基。例如，我们取单粒子 Hilbert 空间的一组基 $\ket{1},\ket{2}\cdots$，满足正交关系 $\braket{i}{j}=\delta_{ij}$，和完备关系 $\sum_i \ket{i}\bra{i}=1$（这里的 $\sum$ 只是一个形式上的记号，如果指标 $i$ 是连续的，则应当视作积分，且 $\delta_{ij}$ 要视为相应的 $\delta-$函数。）那么，对于多粒子态 $\ket{\underbrace{1 1 \cdots 1}_{n_1 \text{个} 1} \ \underbrace{2 2 \cdots 2}_{n_2 \text{个} 2}\cdots }$，可以证明
\begin{equation}
\begin{aligned}
&\braket{\underbrace{1 1 \cdots 1}_{n_1 \text{个} 1} \ \underbrace{2 2 \cdots 2}_{n_2 \text{个} 2}\cdots }{\underbrace{1 1 \cdots 1}_{n_1 \text{个} 1} \ \underbrace{2 2 \cdots 2}_{n_2 \text{个} 2}\cdots }\\
&=\begin{cases}
n_1!n_2!\cdots\ &\xi=1\\
1   &\xi=-1,\ (n_1\le 1)\&\& (n_2\le 1) \&\& \cdots
\end{cases}
\end{aligned}
\end{equation}
其中 $\xi=-1$ 对应费米子态，需要满足 $n_i\le 1$，即每个 $\ket i$ 上最多有一个粒子占据。 $\xi=1$ 对应玻色子态，要注意到它的模方有 $n_1!n_2!\cdots$ 的因子。

最后我们写出 $N$ 粒子态 Fock 空间 $\mathcal{H}_N$ 的完备关系：
\begin{equation}
\frac{1}{N!}\sum_{i_1}\sum_{i_2}\cdots\sum_{i_N}\ket{i_1i_2\cdots i_N}\bra{i_1i_2\cdots i_N}=\mathbb{1}_N
\end{equation}
上述公式中 $\ket{i_j},i_j=1,2,\cdots$ 是单粒子 Hilbert 空间的完备基，因此左侧相当于枚举这 $N$ 个粒子分别对应单粒子 Hilbert 空间基底中的哪个矢量。要注意的是，如果是费米子，则上述公式中 $i_j,j=1,\cdots,N$ 必须互不相同，由于交换任意两个粒子，将 $i_j,i_k$ 对换后 $\ket{i_1\cdots i_N}\bra{i_1\cdots i_N}$ 都不变，这意味着左侧的这一个投影算符项被重复计算了 $N!$ 次，这也解释了为什么等式左侧有一个因子 $1/N!$，这样才能得到正确的完备关系。对于玻色子，则 $i_j,j=1,\cdots,N$ 可能出现重复，设重数为 $n_1,n_2,\cdots$，那么相应的投影算符 $\ket{i_1i_2\cdots i_N}\bra{i_1i_2\cdots i_N}$ 实际上被统计了 $N!/(n_1!n_2!\cdots)$。注意到 $\ket{i_1i_2\cdots i_N}$ 并非归一化的态矢量，它与自己的内积为 $n_1!n_2!\cdots$。因此为了得到正确的完备关系，需要乘的因子仍然是 $1/N!$。因此上述完备关系对费米统计、玻色统计都是成立的。
\subsection{产生湮灭算符}
\subsubsection{产生湮灭算符的定义}
定义产生湮灭算符，它们作用到一个 $N$ 粒子态上，将得到一个 $N+1$ 或 $N-1$ 粒子的态。也就是说，产生湮灭算符联系了相邻两个 $\mathcal{H}_N$ 之间的变换。

具体地，定义产生算符 $a^\dagger(\varphi)$ 为：在当前的多体系统中激发一个波函数为 $\varphi$ 的单粒子，也就是说
\begin{equation}\label{SecQua_eq3}
a^\dagger(\varphi)\ket{\psi_1\cdots\psi_N}=\ket{\varphi\psi_1\cdots\psi_N}
\end{equation}
注意对于费米子系统，$\varphi$ 在 $\ket{\varphi\psi_1\cdots\psi_N}$ 中的位置是对符号有影响的，而对于玻色系统则没有影响。因此，两个产生算符作用于任意的态矢量，其作用的先后顺序只会对结果产生一个符号的影响（如果是玻色子，则不会产生影响），即 $a^\dagger(\varphi_1)a^\dagger(\varphi_2)\ket{\cdots}=\xi a^\dagger(\varphi_2)a^\dagger(\varphi_1)\ket{\cdots}$ 总是成立，因此两个产生算符总是满足对易关系或反对易关系：
\begin{equation}
[a^\dagger(\varphi_1),a^\dagger(\varphi_2)]_{-\xi}=0
\end{equation}
这里我们定义了 $[A,B]_{-\xi}=AB-\xi BA$，对于费米子系统它实际上就是 $\{\cdot,\cdot \}$ 括号。

现在考虑湮灭算符。由产生算符得到湮灭算符的最直接的做法是，取 $a^\dagger$ 算符的共轭\footnote{回忆共轭算符在量子力学中的定义：$\bra{\psi}F\ket{\phi}=(\psi,F \phi)=(F^\dagger \psi,\phi)$ 恒成立。}：
\begin{equation}
a(\varphi)=(a^\dagger(\varphi))^\dagger
\end{equation}
那么
\begin{equation}\label{SecQua_eq4}
\begin{aligned}
\bra{\phi_1\cdots\phi_{N-1}} a(\varphi) \ket{\psi_1\cdots\psi_{N}}&=(\bra{\psi_1\cdots\psi_{N}}a^\dagger(\varphi)\ket{\phi_1\cdots\phi_{N-1}})^*\\
&=(\braket{\psi_1\cdots\psi_{N}}{\varphi\phi_1\cdots\phi_{N-1}})^*\\
&=\left|
\begin{matrix}
\braket{\varphi}{\psi_1} & \braket{\phi_1}{\psi_1} & \vdots\\
\braket{\varphi}{\psi_2} & \braket{\phi_1}{\psi_2} & \vdots\\
\cdots & \cdots & \ddots
\end{matrix}
\right|_{\xi}
\end{aligned}
\end{equation}
我们期望 $a(\varphi)$ 作用于 $\ket{\psi_1\cdots\psi_N}$ 后得到的是 $N-1$ 粒子的态，那么根据\autoref{SecQua_eq2} 这些态和 $\bra{\phi_1\cdots\phi_{N-1}}$ 作内积以后得到的将是若干个 $N-1$ 阶行列式的和。因此，可以对上面的 $N$ 阶行列式的第一列拉普拉斯展开，即展开成第一列每一个元素乘以它的代数余子式（代数余子式是一个 $N-1$ 阶行列式带上一个 $(-1)^{ij}$ 的符号）。最终我们得到了湮灭算符的另一个等价的定义式：
\begin{equation}\label{SecQua_eq5}
a(\varphi)\ket{\psi_1\cdots\psi_N}=\sum_{k=1}^N \xi^{k-1} \braket{\varphi}{\psi_k} \cdot\ket{\psi_1\cdots\psi_{k-1}\psi_{k+1}\cdots \psi_N}
\end{equation}
不难验证湮灭算符也有类似于反湮灭算符的对易（反对易）关系：
\begin{equation}
[a(\varphi_1),a(\varphi_2)]_{-\xi}=0
\end{equation}
利用上面的定义式，最后还可以证明
\begin{equation}
[a(\varphi_1),a^\dagger(\varphi_2)]_{-\xi}=\braket{\varphi_1}{\varphi_2}
\end{equation}
这个关系式非常重要，注意到如果我们取单粒子 Hilbert 空间的一组正交完备基，再用这组基中的态矢量构造产生湮灭算符，那么不同的基对应的产生湮灭算符就是完全对易（或反对易）的。这些正交完备集的产生湮灭算符，代表了多体系统（或者场）的不同模式的激发。
\begin{exercise}{证明产生湮灭算符的对易关系式}
利用 \autoref{SecQua_eq3} 和 \autoref{SecQua_eq4}，证明
\begin{equation}
[a(\varphi_1),a^\dagger(\varphi_2)]_{-\xi}=\braket{\varphi_1}{\varphi_2}
\end{equation}
\end{exercise}
\subsubsection{由单粒子 Hilbert 空间的正交完备基构造产生湮灭算符}
设 $\ket{1}\ket{2}\cdots$ 为单粒子 Hilbert 空间的一组正交完备基（$\braket{i}{j}=\delta_{ij},\sum_i\ket{i}\bra{i}=1$），那么可以由它们得到相应的产生湮灭算符 $a_1,a^\dagger_1,a_2,a^\dagger_2,\cdots$，满足
\begin{equation}
\begin{aligned}
&[a_i,a_j]_{-\xi}=[a_i^\dagger,a_j^\dagger]_{-\xi}=0\\
&[a_i,a_j^\dagger]_{-\xi}=\delta_{ij}
\end{aligned}
\end{equation}
例如，当我们考察三维空间坐标表象下的正交完备基 $\ket{\bvec x}$，（满足正交关系 $\braket{\bvec x}{\bvec y}=\delta^3(\bvec x-\bvec y)$）时，我们可以得到
\begin{equation}
\begin{aligned}
&[a_{\bvec x},a_{\bvec y}]_{-\xi}=[a_{\bvec x}^\dagger,a_{\bvec y}^\dagger]_{-\xi}=0\\
&[a_{\bvec x},a_{\bvec y}^\dagger]_{-\xi}=\delta^3(\bvec x-\bvec y)
\end{aligned}
\end{equation}
我们还可以将坐标表象变换到其他表象，相应的正交完备基发生变化，产生湮灭算符也要发生变化。具体地，假设 $\varphi_1(\bvec x),\varphi_2(\bvec x),\cdots$ 为单粒子 Hilbert 空间的一组正交归一化的一组完备的波函数：
\begin{equation}
\braket{\varphi_i}{\varphi_j}=\int \dd[3]{\bvec x}\braket{\varphi_i}{\bvec x}\braket{\bvec x}{\varphi_j}=\int \dd[3]{\bvec x} \varphi_i^\dagger(\bvec x)\varphi_j(\bvec x) =\delta_{ij} 
\end{equation}
那么可以由\autoref{SecQua_eq5} 得到
\begin{equation}
\begin{aligned}
&a(\varphi_i) = \int \dd[3]{\bvec x} \braket{\varphi_i}{\bvec x} a_{\bvec x}=\int \dd[3]{\bvec x} \varphi_i^\dagger(\bvec x) a_{\bvec x}\\
&a_{\bvec x} = \sum_j \braket{\bvec x}{\varphi_j} a(\varphi_j) = \sum_j \varphi_j(\bvec x)a(\varphi_j)
\end{aligned}
\end{equation}
对上式取共轭 $\dagger$ 可以得到产生算符的变换关系式。由此就可以得到不同表象下的产生湮灭算符之间的联系。以动量表象为例，设
\begin{equation}
\braket{\bvec k}{\bvec q}=\int \dd[3]{x} e^{-i\bvec k\cdot \bvec x} e^{i\bvec q\cdot \bvec x} = (2\pi)^3 \delta(\bvec k-\bvec q)
\end{equation}
那么
\begin{equation}
a_{\bvec p}=\int \dd[3]{\bvec x} e^{-i\bvec p\cdot \bvec x} a_{\bvec x},\quad a_{\bvec x}=\int \frac{\dd[3]{\bvec p}}{(2\pi)^3}e^{i\bvec p\cdot \bvec x}a_{\bvec p}
\end{equation}

