% 拉格朗日电磁势
% keys 拉格朗日方程|广义势能|广义坐标|哈密顿量
% license Xiao
% type Tutor

\begin{issues}
\issueDraft
\end{issues}

\pentry{电磁场标势和矢势\nref{nod_EMPot}， 广义力\nref{nod_LagEqQ}}{nod_ab5d}

由于（\autoref{eq_LagEqQ_2}~\upref{LagEqQ}）
\begin{equation}
\dv{t}\pdv{T}{\dot q_i} - \pdv{T}{q_i} = Q_i~.
\end{equation}
若非常规势能  $U(q_1, q_2...\dot q_1, \dot q_2..., t)$ 与广义力满足
\begin{equation}\label{eq_EMLagP_2}
Q_i = \dv{t} \pdv{U}{\dot q_i} - \pdv{U}{q_i}~.
\end{equation}
且定义拉格朗日量为 $L = T - U$， 则代入可得拉格朗日方程
\begin{equation}
\dv{t} \pdv{L}{\dot q_i} = \pdv{L}{q_i}~.
\end{equation}

现在证明在任意电磁场中运动的点电荷的非常规势（或者称“\textbf{广义势}”）为
\begin{equation}\label{eq_EMLagP_4}
U = q(\Phi  - \bvec A \vdot \bvec v)~.
\end{equation}
其中 $\Phi$ 和 $\bvec A$ 分别为点电荷所在位置的电磁标势和矢势， $\bvec v$ 为点电荷的速度。

\subsection{直角坐标中的证明}
以下用直角坐标证明（令 $x_1, x_2, x_3 = x,y,z$）
\begin{equation}\label{eq_EMLagP_5}
F_i = Q_i =  \dv{t} \pdv{U}{\dot x_i} - \pdv{U}{x_i}~.
\end{equation}
以 $x$ 分量为例
\begin{equation}
\dv{t} \pdv{U}{\dot x} =  - q\dv{t} A_x =  - q\qty[ (\grad A_x) \vdot \bvec v + \pdv{A_x}{t} ]~,
\end{equation}
\begin{equation}
\pdv{U}{x} = q\qty( \pdv{\Phi}{x} - \pdv{\bvec A}{x} \vdot \bvec v )~.
\end{equation}
代入\autoref{eq_EMLagP_5} 右边得
\begin{equation}
q\qty[ -\pdv{\Phi}{x} - \pdv{A_x}{t} + v_y \qty( \pdv{A_y}{x} - \pdv{A_x}{y} ) - v_z \qty( \pdv{A_x}{z} - \pdv{A_z}{x}) ]~.
\end{equation} 
根据广义洛伦兹力及电磁势的定义
\begin{equation}
\bvec F = q\qty(\bvec E + \bvec v \cross \bvec B)~,
\qquad
\bvec E =  - \grad \Phi  - \pdv{\bvec A}{t}~,
\qquad
\bvec B = \curl \bvec A~.
\end{equation}
\begin{equation}\begin{aligned}
F_x &= q \qty(E_x + v_y B_z - v_z B_y) \\
&= q\qty[ - \pdv{\Phi}{x} - \pdv{A_x}{t} + v_y \qty(\pdv{A_y}{x} - \pdv{A_x}{y}) - v_z \qty( \pdv{A_x}{z} - \pdv{A_z}{x}) ]~.
\end{aligned}\end{equation}
对比可得\autoref{eq_EMLagP_5} 在 $x$ 方向成立， $y,z$ 分量的证明类似。 另外容易证明多个点电荷组成的系统的非常规势等于每个点电荷的非常规势之和。

\subsection{广义坐标的证明}
下面来证明对于任意广义坐标 $\qty{q_i}$， \autoref{eq_EMLagP_4} 都满足\autoref{eq_EMLagP_2}。 首先令变换关系为
\begin{equation}
x_i = x_i(q_1, q_2, \dots, t)~.
\end{equation}
其中 $x_i$ 包括每个质点的 $x, y, z$ 坐标， 则
\begin{equation}
\pdv{U}{\dot q_i} = \sum_j \pdv{U}{\dot x_j} \pdv{\dot x_j}{\dot q_i} = \sum_j \pdv{U}{\dot x_j} \pdv{x_j}{q_i}~,
\end{equation}
注意第二步用到了\autoref{eq_dAlbt_27}~\upref{dAlbt}。 对时间求全导数得
\begin{equation}\label{eq_EMLagP_13}
\dv{t} \pdv{U}{\dot q_i} = \sum_j \dv{t}\pdv{U}{\dot x_j} \pdv{x_j}{q_i} + \sum_j \pdv{U}{\dot x_j} \dv{t} \pdv{x_j}{q_i}~.
\end{equation}
另外有
\begin{equation}\label{eq_EMLagP_14}
\pdv{U}{q_i} = \sum_j \pdv{U}{x_j} \pdv{x_j}{q_i} + \sum_j \pdv{U}{\dot x_j} \pdv{\dot x_j}{q_i}~,
\end{equation}
易证\autoref{eq_EMLagP_13} 和\autoref{eq_EMLagP_14} 的右边第二项相等。 将以上两式代入\autoref{eq_EMLagP_2} 右边得（第二步利用了\autoref{eq_EMLagP_5}）
\begin{equation}
\dv{t} \pdv{U}{\dot x_i} - \pdv{U}{x_i} =  \sum_j \dv{t}\pdv{U}{\dot x_j} \pdv{x_j}{q_i} - \sum_j \pdv{U}{x_j} \pdv{x_j}{q_i} = \sum_j F_j \pdv{x_j}{q_i}~,
\end{equation}
而这恰好是 $Q_i$ 的定义。%链接未完成
证毕。

\subsection{哈密顿量}

首先求广义动量
\begin{equation}\label{eq_EMLagP_1}
\bvec p = \pdv{L}{\dot{\bvec q}} = m\bvec v + q\bvec A~,
\end{equation}
则哈密顿量为
\begin{equation}
H = \bvec p \dot{\bvec q} - L = \frac{1}{2m}(\bvec p - q\bvec A)^2 + q\Phi~.
\end{equation}
