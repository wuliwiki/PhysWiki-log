% 虚误差函数
% 复数|虚误差函数|换元法|级数展开

\pentry{误差函数\upref{Erf}}

\textbf{虚误差函数}的定义为
\begin{equation}
\erfi(x) = -\I \erf(\I x) = \frac{1}{\sqrt{\pi}} \int_{-x}^x \E^{t^2} \dd{t}
= \frac{2}{\sqrt{\pi}} \int_0^x \E^{t^2} \dd{t}
\end{equation}

推导如下， 使用换元法 $t = \I \tau$ 有
\begin{equation}
\erfi(x) = \frac{-\I}{\sqrt{\pi}} \int_{-\I x}^{\I x} \E^{t^2} \dd{t}
= \frac{-\I}{\sqrt{\pi}} \int_{-x}^{x} \E^{-(\I \tau)^2} \dd{(\I \tau)}
= \frac{1}{\sqrt{\pi}} \int_{-x}^{x} \E^{\tau^2} \dd{\tau}
\end{equation}
同理可得
\begin{equation}
\erfi(\I x) = \I \erf(x)
\end{equation}

其导函数为
\begin{equation}
\dv{x} \erfi(x) = \frac{2}{\sqrt{\pi}} \E^{x^2}
\end{equation}
所以
\begin{equation}
\int \E^{x^2} \dd{x} = \frac{\sqrt{\pi}}{2} \erfi(x) + C
\end{equation}

与误差函数的级数展开同理， $\erfi(x)$ 的级数展开为
\begin{equation}
\erfi(x) = \frac{2}{\sqrt{\pi}} \sum_{n=0}^\infty \frac{x^{2n+1}}{(2n+1)n!}
= \frac{2}{\sqrt{\pi}}\qty(x + \frac{x^3}{3} + \frac{x^5}{10} + \frac{x^7}{42} + \frac{x^9}{216} \dots)
\end{equation}