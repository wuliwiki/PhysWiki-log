% 二次型的规范型
% 二次型|规范型

\pentry{二次型\upref{QuaFor}}
\subsection{二次型的规范型}
在规范基底\upref{QuaFor}下，二次型有比较简单的形式，这在理论和应用上都有重要价值。
\begin{theorem}{}\label{the_GuaOQu_1}
矢量空间 $V$ 上每个对称的双线性型 $f$ 都有规范基底。
\end{theorem}
\textbf{证明：} 对 $V$ 的维度 $n$ 应用数学归纳法。当 $n=1$ 时命题显然。

如果 $f(\bvec x,\bvec y)=0$ 对所有 $\bvec x,\bvec y\in V$ 都成立（即 $f=0$），定理显然对任意基底都适用。如果 $f\neq 0$ ，那么对应二次型也不为0（\autoref{the_QuaFor_1}~\upref{QuaFor}）。于是存在这么一个向量 $\bvec e_1$ ，使得 $q(\bvec e_1)=f(\bvec e_1,\bvec e_1)\neq0$ 。于是，线性函数
\begin{equation}
f_1:\bvec x\mapsto f(\bvec x,\bvec e_1)
\end{equation}
非零（$f_1(\bvec e_1)\neq0$）。由\autoref{cor_MatLS2_1}~\upref{MatLS2}，线性子空间
\begin{equation}
L=\mathrm{Ker} f_1=\{\bvec x\in V|f_1(\bvec x)=0\}
\end{equation}
的维数是 $n-1$ 。其中，$n$ 是矢量空间 $V$ 的维数。

根据归纳法假设，对 $L$ 必有基底 $(\bvec e_2,\cdots,\bvec e_n)$，在此基底下，$f$ 限制（\autoref{def_map_3}~\upref{map}）在 $L$ 上的矩阵是对角的，即 
\begin{equation}
f(\bvec e_i,\bvec e_j)=0,\quad i,j=2,\cdots ,n,\quad i\neq j
\end{equation}
按构造方式， $f(\bvec e_i,\bvec e_1)=0,i=2,3,\cdots n$。所以得到 $f(\bvec e_i,\bvec e_j)=0,i\neq j$。现在，只需证明向量组 $\bvec e_1,\cdots,\bvec e_n$ 线性无关， $(\bvec e_k)$ 就具有规范基底的特征了。设，情形相反，那么在任意非平凡关系式
\begin{equation}
\alpha_1\bvec e_1+\cdots+\alpha_n\bvec e_n=\bvec 0
\end{equation}
中，只能有 $\alpha_1\neq0$ ，因为 $(\bvec e_2,\cdots ,\bvec e_n)$ 是 $L$ 的基底，但此时 $\bvec e_1=\sum\limits_{i>1}\beta _i\bvec e_i$ 且
\begin{equation}
0\neq f_1(\bvec e_1)=f_1(\sum\limits_{i>1}\beta_i\bvec e_i)=\sum\limits_{i>1}\beta_if_1(\bvec e_i)=0~.
\end{equation}
这是一个矛盾，证毕!
\begin{corollary}{}
在域 $F$ 上的 $n$ 维向量空间 $V$ 上给定一个秩为 $r\leq n$ 的二次型 $q$ 。那么，在 $V$ 中存在一个基底 $(\bvec e_i)$ ，在它之下 $q$ 取规范型式：
\begin{equation}\label{eq_GuaOQu_1}
q(\bvec x)=\lambda_1 x_1^2+\cdots+\lambda_r x_r^2~.
\end{equation}

\end{corollary}
\begin{corollary}{}
每个对称矩阵 $F$ 都有非退化矩阵（行列式为0） $A$ 使得 $A^{T}FA$ 是和 $F$ 秩相同的对角矩阵，换言之，每个对称矩阵都合同于某个对角矩阵。（链接合同矩阵的词条） 
\end{corollary}
\subsection{古巴比伦法化二次型为规范型}
设二次型 $q(\bvec x)$ 表达式为
\begin{equation}
q(x_1,\cdots,x_n)=q(\bvec x)=\sum\limits_{i,j=1}^n f_{ij}x_ix_j~.
\end{equation}

首先提出所有含 $x_1$ 的项：
\begin{equation}
q(x_1,\cdots,x_n)=f_{11} x_1^2+2f_{12}x_1x_2+\cdots+2f_{1n}x_1x_n+\sum_{i,j\neq1}f_{ij}x_ix_j~.
\end{equation}
设 $f_{11}\neq0$ ，且依靠不含 $x_1$ 的项的系数提出来完全项
\begin{equation}
q(x_1,\cdots,x_n)=\frac{1}{f_{11}}(f_{11}x_1+f_{12}x_2+\cdots+f_{1n}x_n)^2+\sum_{i,j\neq1}f'_{ij}x_ix_j~.
\end{equation}

现在，令
\begin{equation}
x'_1=f_{11}x_1+f_{12}x_2+\cdots+f_{1n}x_n,\quad x_i'=x_i\quad i>1.
\end{equation}
就把二次型 $q$ 化为了
\begin{equation}
q(x_1,\cdots,x_n)=\frac{1}{f_{11}}x_1'^2+q'(x_2',\cdots,x_n')~.
\end{equation}
其中， $q'(x_2',\cdots,x_n')=\sum\limits_{i,j=2}^nf'_{ij}x_i'x_j'$ 是变量数目更少的一个二次型。重复上面的程序可以把 $q(\bvec x)$ 写成 $r=\mathrm{rank}\; q$ 个二次型的线性组合（因为重新设置的 $(x'_1)^2$ 是个二次型）。

对限制性假设 $f_{11},f_{22},\cdots\neq0$ 不成立的情形，比方说 $f_{11}=0$ 而 $f_{kk}\neq0$，那么变动 $x_1,x_k$ 的指标（或基向量顺序）。但，若 $q(\bvec x)\neq0$ 不含任何二次项，即所有 $f_{kk}=0$ 。那么，不失一般性，设 $2f_{12}x_1x_2\neq0$，此时可用替换
\begin{equation}
x_1=x_1'+x_2',\quad x_2=x_1'-x_2',\quad x_k=x_k',\quad k>2~,
\end{equation}
就有不可能被约掉的项 $2f_{12}(x_1'^2-x_2'^2)$ 出现了，于是程序得以运行。