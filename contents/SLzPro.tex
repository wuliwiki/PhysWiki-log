% 正则 S-L 边值问题本征函数零点数量的证明
% license Usr
% type Tutor


\begin{issues}
\issueDraft
\issueTODO
\end{issues}

\pentry{施图姆—刘维尔理论\nref{nod_SLthrm}，阿贝尔微分方程恒等式\nref{nod_AbelID}}{nod_2f44}

\begin{definition}{三角函数形式边界条件的 S-L 问题}\label{def_SLzPro_1}
对于微分算子
\begin{equation}
\hat L = \frac{1}{r(x)} \left[-\dv{}{x}\left(p(x)\dv{}{x}\right) + q(x)\right] ~,
\end{equation}
S-L 微分方程可化为 $\hat L (y) = \lambda y$。

边界条件为：
\begin{equation}
\left\{\begin{aligned}
y(a) \cos \alpha &= y'(a) p(a) \sin \alpha ~, \\
y(b) \cos \beta &= y'(b) p(b) \sin \beta ~.
\end{aligned}\right.
\end{equation}

由于 $\tan \theta$ 遍历整个 $\mathbb R$，这是与常见的形式等价的。

\end{definition}

回顾正则 S-L 边值本征问题的形式：
\begin{definition}{正则 S-L 边值本征问题}
\begin{equation}\label{eq_SLzPro_1}
[p(x) y']' + [q(x) - \lambda r(x)] y = 0, x \in (a, b) ~.
\end{equation}
限定对于 $x \in [a, b]$，$p(x) , r(x) > 0$。
\end{definition}
考虑同 $\lambda$ 修改后的朗斯基行列式，由阿贝尔微分恒等式，
\begin{equation}
W_x(u, v) = p(x) [u(x) v'(x) - v(x) u'(x)] ~,
\end{equation}
限定 $u, v$ 是方程\autoref{eq_SLzPro_1} 的解，这行列式将与 $x$ 值无关。

对于另外的 $u, v$ 是 $\hat L u = \lambda_u u$、$\hat L v = \lambda_v v$ 的任意（非零）解，有
\begin{equation}
W'(u, v) = (\lambda_u - \lambda_v) r u v~,
\end{equation}
即等价的对于 $c, d \in (a, b)$，
\begin{equation}
W_d(u, v) - W_c(u, v) = \eval{W(u, v)}_{x = d} - \eval{W(u, v)}_{x = c} = (\lambda_u - \lambda_v) \int_c^d \left(u(t) v(t) r(t) \right) \dd t ~.
\end{equation}
引入普拉夫（Prüfer）变量
\begin{equation}
\begin{aligned}
u(x) &= \rho_u(x) \sin(\theta_u(x)) ~,\\
p(x) u'(x) &= \rho_u(x) \cos(\theta_u(x)) ~.
\end{aligned}
\end{equation}
其中若 $u(x)$、$p(x)u'(x)$ 总不同时为 $0$ 且 $u$ 可微则
\begin{equation}
\rho_u(x) = \sqrt{u^2(x) + \left(p(x) u'(x)\right)^2} > 0 ~.
\end{equation}
另外 $\theta_u$ 被要求为正的且
\begin{equation}
\theta_u(x) = \operatorname{atan2}(p(x)u'(x), u(x)) \mod (2\pi) ~.
\end{equation}
这里 $\operatorname{atan2}$ 是\enref{四象限 Arctan 函数}{Arctan}。

从而 $\hat L u = \lambda u$ 可以化为
\begin{equation}\label{eq_SLzPro_2}
\left\{
    \begin{aligned}
    \theta_u' &= \frac{\cos(\theta_u)^2}{p} + (\lambda r - q) \sin(\theta_u)^2 ~,\\
    \rho_u' &= \rho_u(\frac{1}{p} + q - \lambda r) \sin(\theta_u) \cos(\theta_u)~.
    \end{aligned}
\right.
\end{equation}
从而可解得
\begin{equation}
\rho_u(x) = \rho_u(c) \exp(\frac{1}{2} \int_c^x \left[p^{-1}(t) + q(t) - \lambda r(t)\right]\sin\left(2 \theta_u(x)\right) \dd t) ~.
\end{equation}
其中利用了三角恒等变换。

同时，若 $\theta_u$ 对应 $u(x)$，则 $\theta_u + n \pi$，$n \in \mathbb Z$ 对应解 $\left(-1\right)^{n} u(x)$。

现在，我们考虑\autoref{eq_SLzPro_2} 中 $\theta_u$ 的微分方程的右侧。对于解 $u$ 而言，显然有
\begin{equation}
u(x_0) = 0 \Leftrightarrow \theta_u(x_0) = 0 \mod \pi \Rightarrow \theta'_u(x_0) = p(x_0)^{-1} > 0~.
\end{equation}

而，$\theta_u$ 的两连续 $\operatorname{mod} \pi = 0$ 的点间总相差 $\pi$（这是显然的），故，若用 $\#_{(a, b)}(f)$ 表示 $f$ 的在 $(a, b)$ 内的零点的数量，则有
\begin{equation}
\#_{(a, b)} (u) = \#_{(a, b)} (\theta_u) = \lceil \theta_u(b)/\pi \rceil - \lceil \theta_u(a)/\pi \rceil -1~,
\end{equation}

我们已经几乎得到了解 $u$ 的零点数量。下面更深一步，讨论特征值与零点数量的关系。
仍考察 $\theta_u$ 的微分方程。由于 $r(x)$ 总正，故 $\theta_u$ 应随着 $\lambda$ 的增加而增加。
\pentry{李普希茨条件\nref{nod_LipCon}}{nod_f30e}
\begin{lemma}{}
设 $f$ 是满足局部 Lipschitz 连续的的，$x$ 对 $t$ 一致。即意味着对于每个紧集 $V \subset U$
\begin{equation}
L = \sup_{(t, x) \neq (t, y) \in V} \frac{|f(t, x) - f(t, y)|}{|x-y|} ~,
\end{equation}
有限。
而 $x(t)$、$y(t)$ 是可微函数，满足
\begin{equation}\label{eq_SLzPro_3}
x(t_0) \le y(t_0), \dot x(t)-f(t, x (t)) \le \dot y(t) - f(t, y(t)), t \in [t_0, T) ~,
\end{equation}
则对于 $t \in [t_0, T)$ 总有 $x(t) \le y(t)$。
\end{lemma}
证明考虑反证法，先假设\autoref{eq_SLzPro_3} 中第一个条件不正确，这将使得我们可以找到一些 $t_1$ 有 $x(t_1) = y(t_1)$ 而 $x(t) > y(t)$ 对于 $t \in (t_1, t_1 + \varepsilon)$。 考虑引入 $\Delta(t) = x(t) - y(t)$ 就有，
\begin{equation}
\dot \Delta(t) = \dot x(t) - \dot y(t) \le f(t, x(t)) - f(t, y(t)) \le L\Delta(t), t \in [t_1, t_1 + \varepsilon) ~,
\end{equation}
其中第一个不等式是因为我们假设第一个条件不正确，第二个是利用了局部 Lipschitz 连续的性质。但是这就意味着 $\widetilde \Delta(t) = \Delta(t) e^{-Lt}$ 满足 $\dot{\widetilde \Delta}(t) \le 0$ 从而 $\widetilde \Delta(t)\le \widetilde \Delta(t_1) = 0$。也就是说，对于 $t \in[t_0, T)$，$x (t)\le y (t)$ 与假设相矛盾。

同样的假设第二个条件不正确，反之取 $\Delta(t) = y(t)-x(t)$，类似的 $\dot{\widetilde \Delta}(t) \ge 0$，有类似的证明。

接下来我们继续考虑 $\theta_u$ 的问题：$\theta_u$ 应该随 $\lambda$ 增加。所以我们考虑 $\hat Lu = \lambda u$ 的解 $u (\lambda, x)$ ，并沿用 Prufer 变量的记号 $\rho_u (\lambda, x)$，$\theta_u (\lambda, x)$。若 $u(\lambda, x)$ 是 $\hat Lu = \lambda u$ 的解，对于 $\lambda_1 > \lambda_0$，有 $\theta_u (\lambda_1, x) > \theta_u (\lambda_0, x)$ 对于 $x > c$（这是由刚才的引理，$\theta_u (\lambda_1, c)\ge \theta_u (\lambda_0,c)$）。对于 $x < c$，颠倒不等号方向。

现在回顾三角函数形式的边界条件\autoref{def_SLzPro_1} ，代入 $\theta$ 将会有
\begin{equation}
\theta_a(\lambda, a) = \alpha\in [0, \pi), -\theta_b(\lambda,  b) = \pi-\beta \in [0,\pi) ~.
\end{equation}
而这两函数 $\theta_a(..., a)$ 与 $\theta_b(..., b)$ 总有界（大于 $0$）而递增。同时可以证明以下引理
\begin{lemma}{}
\begin{equation}
\lim_{\lambda \rightarrow -\infty} \theta_b(\lambda, x) = \lim_{\lambda \rightarrow -\infty} \theta_a(\lambda, x) = 0, x \in [a, b) ~.
\end{equation}

\end{lemma}
这使得可以证明，对于 $u_a(\lambda)$，其是一个本征解，当且仅当在 $b$ 处满足条件，即 $\theta_a(\lambda, b) = \beta \mod \pi$。而当 $\lambda \rightarrow -\infty$ 时 $\theta_a \rightarrow 0$，这就使得可以取到一个最小 $\beta \in (0, \pi]$，而对应一个最小的本征值。这就使得可以有
\begin{theorem}{}
\begin{equation}
\#_{(-\infty, \lambda)}(\hat L) = \left\lceil \frac{\theta_a(\lambda, b) - \beta}{\pi}\right\rceil = \left\lfloor \frac{\alpha - \theta_b(\lambda, a)}{\pi}\right\rfloor~.
\end{equation}

\end{theorem}

这就可以轻而易举地证明，本征值可以从小到大排序而零点个数与其本征值的序数相关是第 $\lambda_i$ 个本征值恰好有 $i$ 个零点的。