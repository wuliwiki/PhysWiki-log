% 正则 S-L 边值问题本征函数零点数量的证明
% license Usr
% type Tutor


\begin{issues}
\issueDraft
\issueTODO
\end{issues}

\pentry{施图姆—刘维尔理论\nref{nod_SLthrm}，阿贝尔微分方程恒等式\nref{nod_AbelID}}{nod_2f44}

\begin{definition}{三角函数形式边界条件的 S-L 问题}
对于微分算子
\begin{equation}
\hat L = \frac{1}{r(x)} \left[-\dv{}{x}\left(p(x)\dv{}{x}\right) + q(x)\right] ~,
\end{equation}
S-L 微分方程可化为 $\hat L (y) = \lambda y$。

边界条件为：
\begin{equation}
\left\{\begin{aligned}
y(a) \cos \alpha &= y'(a) p(a) \sin \alpha ~, \\
y(b) \cos \beta &= y'(b) p(b) \sin \beta ~.
\end{aligned}\right.
\end{equation}

由于 $\tan \theta$ 遍历整个 $\mathbb R$，这是与常见的形式等价的。

\end{definition}

回顾正则 S-L 边值本征问题的形式：
\begin{definition}{正则 S-L 边值本征问题}
\begin{equation}\label{eq_SLzPro_1}
[p(x) y']' + [q(x) - \lambda r(x)] y = 0, x \in (a, b) ~.
\end{equation}
限定对于 $x \in [a, b]$，$p(x) , r(x) > 0$。
\end{definition}
考虑同 $\lambda$ 修改后的朗斯基行列式，由阿贝尔微分恒等式，
\begin{equation}
W_x(u, v) = p(x) [u(x) v'(x) - v(x) u'(x)] ~,
\end{equation}
限定 $u, v$ 是方程\autoref{eq_SLzPro_1} 的解，这行列式将与 $x$ 值无关。

对于另外的 $u, v$ 是 $\hat L u = \lambda_u u$、$\hat L v = \lambda_v v$ 的任意（非零）解，有
\begin{equation}
W'(u, v) = (\lambda_u - \lambda_v) r u v~,
\end{equation}
即等价的对于 $c, d \in (a, b)$，
\begin{equation}
W_d(u, v) - W_c(u, v) = \eval{W(u, v)}_{x = d} - \eval{W(u, v)}_{x = c} = (\lambda_u - \lambda_v) \int_c^d \left(u(t) v(t) r(t) \right) \dd t ~.
\end{equation}
引入普拉夫（Prüfer）变量
\begin{equation}
\begin{aligned}
u(x) &= \rho_u(x) \sin(\theta_u(x)) ~,\\
p(x) u'(x) &= \rho_u(x) \cos(\theta_u(x)) ~.
\end{aligned}
\end{equation}
其中若 $u(x)$、$p(x)u'(x)$ 总不同时为 $0$ 且 $u$ 可微则
\begin{equation}
\rho_u(x) = \sqrt{u^2(x) + \left(p(x) u'(x)\right)^2} > 0 ~.
\end{equation}
另外 $\theta_u$ 被要求为正的且
\begin{equation}
\theta_u(x) = \operatorname{atan2}(p(x)u'(x), u(x)) \mod (2\pi) ~.
\end{equation}
这里 $\operatorname{atan2}$ 是四象限 Arctan 函数\upref{Arctan}。

从而 $\hat L u = \lambda u$ 可以化为
\begin{equation}\label{eq_SLzPro_2}
\left\{
    \begin{aligned}
    \theta_u' &= \frac{\cos(\theta_u)^2}{p} + (\lambda r - q) \sin(\theta_u)^2 ~,\\
    \rho_u' &= \rho_u(\frac{1}{p} + q - \lambda r) \sin(\theta_u) \cos(\theta_u)~.
    \end{aligned}
\right.
\end{equation}
从而可解得
\begin{equation}
\rho_u(x) = \rho_u(c) \exp(\frac{1}{2} \int_c^x \left[p^{-1}(t) + q(t) - \lambda r(t)\right]\sin\left(2 \theta_u(x)\right) \dd t) ~.
\end{equation}
其中利用了三角恒等变换。

同时，若 $\theta_u$ 对应 $u(x)$，则 $\theta_u + n \pi$，$n \in \mathbb Z$ 对应解 $\left(-1\right)^{n} u(x)$。

现在，我们考虑\autoref{eq_SLzPro_2} 中 $\theta_u$ 的微分方程的右侧。对于解 $u$ 而言，显然有
\begin{equation}
u(x_0) = 0 \Leftrightarrow \theta_u(x_0) = 0 \mod \pi \Rightarrow \theta'_u(x_0) = p(x_0)^{-1} > 0~.
\end{equation}

而，$\theta_u$ 的两连续 $\operatorname{mod} \pi = 0$ 的点间总相差 $\pi$（这是显然的），故，若用 $\#_{(a, b)}(f)$ 表示 $f$ 的在 $(a, b)$ 内的零点的数量，则有
\begin{equation}
\#_{(a, b)} (u) = \#_{(a, b)} (\theta_u) = \lceil \theta_u(b)/\pi \rceil - \lceil \theta_u(a)/\pi \rceil -1~,
\end{equation}

我们已经几乎得到了解 $u$ 的零点数量。下面更深一步，讨论特征值与零点数量的关系。
仍考察 $\theta_u$ 的微分方程。由于 $r(x)$ 总正，故 $\theta_u$ 应随着 $\lambda$ 的增加而增加。
\pentry{李普希茨条件\nref{nod_LipCon}}{nod_f30e}
