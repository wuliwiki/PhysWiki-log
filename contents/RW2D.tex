% 二维随机游走
% keys 统计|随机变量|高斯分布|圆高斯分布|中心极限定理|分布函数|平均值|方均根|多元微积分|重积分|random walk
% license Xiao
% type Tutor

\pentry{中心极限定理\upref{CLT}}{nod_f441}

若平面上某点从坐标原点出发， 每一步沿随机方向走动一个随机步长， 步长的分布函数为 $f(r)$， $N\ \ (N \gg 1)$ 步之后， 该点的位置分布可以用\textbf{圆高斯分布}表示
\begin{equation}\label{eq_RW2D_1}
P(X,Y) = \frac{a}{\pi} \E^{-a(X^2 + Y^2)} \quad \text{或} \quad
P(R) = 2aR \E^{-aR^2}~.
\end{equation}
其中
\begin{equation}\label{eq_RW2D_2}
a = \frac{1}{N\ev{r^2}}~, \qquad
\ev{r^2} = \int_0^{\infty} r^2 f(r)\dd{r}~.
\end{equation}
由分布函数可得， 随机点最终离原点的距离的平均值和方均根为
\begin{equation}
\ev{R} = \frac{\sqrt{\pi}}{2}\sqrt{N\ev{r^2}}~, \qquad
\sqrt{\ev{R^2}} = \sqrt{N\ev{r^2}}~.
\end{equation}

\subsection{推导}
我们先来分析随机点的 $x$ 坐标。 假设每一步在 $x$ 方向投影的长度为 $x_i$， $N$ 步以后， 该点的 $x$ 坐标为 $X$， 则
\begin{equation}
\ev{x^2} = \int_0^{\infty} \int_0^{2\pi}  (r\cos\theta)^2 \cdot f(r)\dd{r} \cdot \frac{1}{2\pi}\dd{\theta} = \frac12 \ev{r^2}~.
\end{equation}
根据中心极限定理\upref{CLT}， $X$ 满足高斯分布， 且
\begin{equation}\label{eq_RW2D_5}
\ev{X^2} = N\ev{x^2} = \frac12 N\ev{r^2}~.
\end{equation}
对 $y$ 轴分析也有类似的结果， 将 $P(X,Y)$ 分布归一化后， 可以得到\autoref{eq_RW2D_1}。 我们由\autoref{eq_RW2D_1} 求 $\ev{X^2}$， 得
\begin{equation}\label{eq_RW2D_6}
\ev{X^2} = \int_0^\infty \int_0^\infty X^2 P(X,Y) \dd{X}\dd{Y}
= \int_0^\infty  \sqrt{\frac{a}{\pi}} X^2\E^{-a X^2} \dd{X} =\frac{1}{2a}~,
\end{equation}
对比\autoref{eq_RW2D_5} 和\autoref{eq_RW2D_6} 即可得到\autoref{eq_RW2D_2}。 证毕。
