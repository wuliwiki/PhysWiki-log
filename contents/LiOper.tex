% 线性算子代数
% keys 线性算子|算子代数
% license Xiao
% type Tutor

\subsection{线性算子}\label{sub_LiOper_4}
\pentry{多重线性映射\upref{MulMap}，矩阵与线性映射\upref{MatLS}}

域 $\mathbb{F}$ 上所有从矢量空间 $V$ 到维矢量空间 $W$ 的线性映射 $f:V\rightarrow W$ 的集合用符号 $\mathcal{L}(V, W)$ (或者 $\mathrm{Hom}(V, W)$) 表示，它仍是一个矢量空间\upref{MulMap}；如果$V, W$是有限维度的，维度分别为$n, m$，那么线性映射 $f \in \mathcal{L}(V, W)$ 和一个 $m\times n$ 的矩阵一一对应\upref{MatLS}。在 $V=W$ 的情形，矢量空间 $\mathcal{L}(V, W)$ 简记为 $\mathcal{L}(V)$ （或 $\mathrm{End}(V)$），它的向量通常称为\textbf{线性算子}。

\textbf{符号约定：}在线性代数部分，线性算子将用拉丁字母 $\mathcal{A,B,C,\cdots}$ 表示，而在矢量空间 $V$ 的基底 $( e_i)$ 之下对应的矩阵用粗体正体字母 $\mat A,\mat B,\mat C,\cdots$ 表示，另一基底 $( e_i')$ 之下对应矩阵则表示为 $\mat A',\mat B',\mat C',\cdots$ 。总是用 $\mathcal{E}=\mathrm{Id}$ 和 $E=(\delta_{ij})$ 表示恒等（单位）映射 $ x\mapsto  x$ 。算子 $\mathcal{A}$ 作用在 $ x$ 上的结果 $\mathcal{A}(x)$ 简写成 $\mathcal{A} x$。

线性算子 $\mathcal{B}$ 称为 $\mathcal{A}$ 的\textbf{逆算子}，如果 $\mathcal{AB}=\mathcal{BA}=\mathcal{E}$ 。算子 $\mathcal{A}$ 的逆算子通常记为 $\mathcal{A}^{-1}$。由\autoref{cor_MatLS2_1}~\upref{MatLS2}，$\mathcal{A}^{-1}$ 存在等价于 $\mathrm{Ker}\mathcal{A}=0$ 或者 $\mathrm{dim}\;V=\mathrm{dim\;Im}\mathcal{A}$ 。$\mathrm{dim\;Ker}\mathcal{A}$ 称为 $\mathcal{A}$ 的\textbf{亏数}。
\begin{example}{零算子}\label{ex_LiOper_1}
零算子 $\mathcal{O}$ 把每个向量 $ v\in V$ 都变成零：$\mathrm{rank}\; \mathcal{O}=0$。
\end{example}
\begin{example}{相似算子}
$\mathcal{A} x=\lambda x$，其中 $\lambda\in\mathbb{F}$。
\end{example}
\begin{example}{投影算子}
设 $V=U\oplus W$，则 $ x= x_U+ x_W$ 且 $\mathcal{P} x= x_U$，那么称 $\mathcal{P}$ 为\textbf{投影算子}或在子空间 $U$ 平行于 $W$ 的\textbf{投影}。显然 $\mathcal{P}^2=\mathcal{P}$。
\end{example}
\subsection{算子代数}\label{sub_LiOper_3}
根据线性映射的数乘，加法运算\upref{MulMap}，及映射复合\autoref{def_map_4}~\upref{map}，可令
\begin{equation}\label{eq_LiOper_1}
(\mathcal{A}+\mathcal{B}) x=\mathcal{A} x+\mathcal{B} x~,\quad (\lambda\mathcal A) x=\lambda(\mathcal A x)~,\quad (\mathcal{AB}) x=\mathcal{A}(\mathcal{B} x)~.
\end{equation}
也就是说，复合 $\mathcal{A\circ B}$ 可直接表达为 $\mathcal{AB}$ 。

由\autoref{eq_LiOper_1} 可直接验证
\begin{equation}
\begin{aligned}
&\alpha(\mathcal{A+B})=\alpha\mathcal{A}+\alpha\mathcal{B}~,\\
&(\alpha+\beta)\mathcal{A}=\alpha\mathcal{A}+\beta\mathcal{A}~,\\
&(\alpha\beta)\mathcal{A}=\alpha(\beta\mathcal{A})~,\\
&1\cdot \mathcal{A}=\mathcal A~,\\
&\mathcal{A}(\mathcal{BC})=(\mathcal{AB})\mathcal C\quad(\text{结合律})~,\\
&\mathcal A(\mathcal{B+C})=\mathcal{AB+AC}~,\quad (\mathcal{A+B})\mathcal C=\mathcal{AC+BC}\quad(\text{分配律})~,\\
&\lambda(\mathcal{AB})=(\lambda\mathcal{A})\mathcal{B}=\mathcal{A}(\lambda \mathcal B)~.
\end{aligned}
\end{equation}
我们看到，$\mathcal{L}(V)$ 不仅是个矢量空间，同时也是个结合环\autoref{def_Ring_2}~\upref{Ring} ，最后的关系式建立了纯量和算子之间乘法的补充定律。这样一个满足补充定律 $\lambda(ab)=(\lambda a)b=a(\lambda b)$ , 又是环又是域 $\mathbb{F}$ 上的向量空间 $K$ ，就称为域 $\mathbb{F}$ 上的\textbf{代数}，\autoref{def_AlgFie_1}~\upref{AlgFie}。$K$ 作为矢量空间的维数即称为代数 $K$ 的\textbf{维数}。

\begin{theorem}{}\label{the_LiOper_1}
如果
\begin{equation}\label{eq_LiOper_2}
\mathcal{A}: e_k\mapsto \mathcal{A} e_k=\sum_i^{n}a_{ik} e_i~,\quad \mathcal{B}: e_j\mapsto  \mathcal{B} e_j=\sum_{k=1}^n b_{kj} e_k~.
\end{equation}
是线性空间 $V$ 在基底 $( e_i)$ 之下以 $\mat A=(a_{ij}), \mat B=(b_{kj})$ 为矩阵的线性算子，那么，算子 $\mathcal{AB}$ 在同一基底下的矩阵是 $\mat C=\mat{AB}$
\end{theorem}
\textbf{证明：}
\begin{equation}
\begin{aligned}
\sum_i c_{ij} e_i&=(\mathcal{AB}) e_j=\mathcal{A}(\mathcal{B} e_j)=\mathcal{A}\qty(\sum_k b_{kj} e_k)=\sum_k b_{kj}\mathcal{A} e_k\\
&=\sum_k b_{kj}\sum_i a_{ik} e_i=\sum_{i,k}a_{ik}b_{kj} e_i=\mat{AB} e_i~.
\end{aligned}
\end{equation}
\textbf{证毕}！
\subsection{不同基底下线性算子对应的矩阵}\label{sub_LiOper_1}
\begin{theorem}{}\label{the_LiOper_2}
若线性算子 $\mathcal A$ 在基底 $( e_1\cdots  e_n)$ 下对应矩阵为 $\mat A$，则在另一基底  $( e'_1\cdots  e'_n)$ 之下对应的矩阵 $\mat A'$ 为
\begin{equation}
\mat A'=\mat B^{-1}\mat{AB}~,
\end{equation}
其中 $\mat B$ 为基底 $( e_i)$ 向基底 $( e_j')$ 的过渡矩阵\upref{TransM}.
\end{theorem}
\textbf{证明：}
由定理条件，若设 $\mat A=(a_{ij}), \mat A'=(a_{kj}'),\mat B=(b_{ij})$ ，则
\begin{equation}
\begin{aligned}
&\mathcal{A} e_i=\sum_{k} a_{ki} e_k
~,\\
&\mathcal{A} e_j'=\sum_{k} a'_{kj} e'_k~,\\
& e_j'=\sum_i b_{ij} e_i~.
\end{aligned}
\end{equation}
引入算子 $\mathcal{B}$ ，它在基底 $( e_1\cdots  e_n)$ 下对应的矩阵为 $\mat B$ ，那么
\begin{equation}
\mathcal{B} e_j=\sum_i b_{ij} e_i= e_j'~.
\end{equation}

由于线性算子与矩阵之间在固定基底之下一一对应，所以可定义一算子 $\mathcal{A'}$ ，它在基底 $( e_1\cdots  e_n)$ 之下对应的矩阵为 $\mat A'$ ，即
\begin{equation}
\mathcal A' e_j=\sum_i a'_{ij} e_i~.
\end{equation}
于是
\begin{equation}
\mathcal{AB} e_j=\mathcal{A} e'_j=\sum_i a'_{ij}  e'_i=\sum_i a'_{ij}\mathcal{B} e_i=\mathcal{B}\qty(\sum_i a'_{ij} e_i)=\mathcal{BA'} e_j~,
\end{equation}
于是 
\begin{equation}
\mathcal{A'}=\mathcal{B}^{-1}\mathcal{AB}~.
\end{equation}
由\autoref{the_LiOper_1} ，上式对应的矩阵的形式就为
\begin{equation}
\mat A'=\mat B^{-1}\mat{AB}~.
\end{equation}
\textbf{证毕}！
\begin{definition}{相似矩阵}
称矩阵 $\mat A'$ 相似于矩阵 $\mat A$ ，如果存在非退化矩阵 $\mat B$ ，使得
\begin{equation}
\mat A'=\mat B^{-1}\mat{AB}~,
\end{equation}
并记作 $\mat A'\sim \mat A$ 。
\end{definition}
容易验证，矩阵的相似关系是一种等价关系\autoref{sub_Relat_1}~\upref{Relat}.

\autoref{the_LiOper_2} 表明，每一个线性算子都对应一个相似矩阵类（所以相似的矩阵构成的集合），而其中每一矩阵都相当于同一线性算子在不同基底下的矩阵。
\subsection{线性算子的行列式与迹}\label{sub_LiOper_2}
设 $\mathcal{A}$ 对应矩阵为 $A$ ，则\autoref{the_trace_1}~\upref{trace} 
\begin{equation}\label{eq_LiOper_3}
\begin{aligned}
&\mathrm{det}(\mat B^{-1}\mat{AB})=\mathrm{det}(\mat A)~,\\
&\mathrm{tr}\;(\mat B^{-1}\mat{AB})=\mathrm{tr}\;(\mat{ABB}^{-1})=\mathrm{tr}\;(\mat A)~.
\end{aligned}
\end{equation}
\begin{definition}{}
称
$
\mathrm{det}\;\mathcal{A}=\mathrm{det}\;A
$
为线性算子$\mathcal{A}$的\textbf{行列式}。

称
$
\mathrm{tr}\;\mathcal{A}=\mathrm{tr}\;A
$
为线性算子 $\mathcal{A}$ 的\textbf{迹}。
\end{definition}
\autoref{eq_LiOper_3} 表明，线性算子 $\mathcal{A}$ 的行列式和迹是 $\mathcal{A}$ 的不变量，即这个定义是适当的。
