% 线性算子
% keys 线性算子
% license Xiao
% type Tutor

\begin{issues}
\issueTODO
\end{issues}


\subsection{线性算子}\label{sub_LiOper_4}
\pentry{线性映射\nref{nod_LinMap}}{nod_92b2}

域 $\mathbb{F}$ 上所有从向量空间 $V$ 到维向量空间 $W$ 的线性映射 $f:V\rightarrow W$ 的集合用符号 $\mathcal{L}(V, W)$ (或者 $\mathrm{Hom}(V, W)$) 表示，它仍是一个向量空间；如果$V, W$是有限维度的，维度分别为$n, m$，那么线性映射 $f \in \mathcal{L}(V, W)$ 和一个 $m\times n$ 的矩阵一一对应\upref{MatLS}。在 $V=W$ 的情形，向量空间 $\mathcal{L}(V, W)$ 简记为 $\mathcal{L}(V)$ （或 $\mathrm{End}(V)$），它的向量通常称为\textbf{线性算子}。

\textbf{符号约定：}在本文中，线性算子将用手写体字母 $\mathcal{A,B,C}$ 表示，而在向量空间 $V$ 的基底 $(e_i)$ 之下对应的矩阵用粗体正体字母 $\mat A,\mat B,\mat C$ 表示，另一基底 $(e_i')$ 之下对应矩阵则表示为 $\mat A',\mat B',\mat C'$ 。总是用 $\mathcal{E}$ 表示恒等映射 $x \mapsto  x$，用 $\mat E = (\delta_{ij})$ 表示单位矩阵。算子 $\mathcal{A}$ 作用在 $ x$ 上的结果 $\mathcal{A}(x)$ 简写成 $\mathcal{A} x$。

线性算子比起一般的线性映射，可以定义复合运算：考虑 $\mathcal{A}, \mathcal{B}: V \to V$，
\begin{equation}
(\mathcal{A} \circ \mathcal{B})(x) = \mathcal{A} (\mathcal{B}(x))~.
\end{equation}
方便起见，我们时常省略掉 $\circ$，直接记做 $\mathcal{A} \mathcal{B}$。

线性算子 $\mathcal{B}$ 称为 $\mathcal{A}$ 的\textbf{逆算子}，如果 $\mathcal{AB}=\mathcal{BA}=\mathcal{E}$ 。算子 $\mathcal{A}$ 的逆算子通常记为 $\mathcal{A}^{-1}$。由\autoref{cor_MatLS2_1}~\upref{MatLS2}，$\mathcal{A}^{-1}$ 存在等价于 $\mathrm{Ker}\mathcal{A}=0$ 或者 $\mathrm{dim}\;V=\mathrm{dim\;Im}\mathcal{A}$ 。$\mathrm{dim\;Ker}\mathcal{A}$ 称为 $\mathcal{A}$ 的\textbf{亏数}。
\begin{example}{零算子}\label{ex_LiOper_1}
零算子 $\mathcal{O}$ 把每个向量 $ v\in V$ 都变成零：$\mathrm{rank}\; \mathcal{O}=0$。
\end{example}
\begin{example}{数乘算子}
$\mathcal{A} x=\lambda x$，其中 $\lambda\in\mathbb{F}$。
\end{example}
\begin{example}{投影算子}
设 $V=U\oplus W$，则 $ x= x_U+ x_W$ 且 $\mathcal{P} x= x_U$，那么称 $\mathcal{P}$ 为\textbf{投影算子}或在子空间 $U$ 平行于 $W$ 的\textbf{投影}。显然 $\mathcal{P}^2=\mathcal{P}$。
\end{example}

\subsection{待定}

% Giacomo：从线性映射中移动而来。

\addTODO{重写相关内容}

要知道一个具体的线性算子的性质，我们只需要知道它把基向量都映射到哪里去了。我们知道，基向量张成线性空间 $V$ 本身，而任意一组基向量变换后所得到的向量组，张成\upref{VecSpn}了线性算子的\textbf{像空间（image space）}，即 $V$ 中全体向量变换后的结果之集合。如果基向量变换后的向量组还是线性无关的，那么这个向量组也是一组基，从而像空间就是 $V$ 本身；但有的时候变换后的向量组线性相关了，这时候的像空间就是 $V$ 的一个真子集了。极端情况下甚至把所有向量都变换为零向量，这样的线性算子的像空间就只有零向量了。

如果一个线性算子的像空间是 $V$ 的一个真子集，那么这个真子集一定是 $V$ 中的一个“过原点的平面”，我们把这种线性算子称为\textbf{退化（degenerate）}的。反过来，$V$ 中的一个“过原点的平面”可以是某线性算子的像空间。一个线性算子唯一对应一个像空间，但是一个像空间总是对应无穷多个线性算子。

如果 $v\in V$ 在基 $\{{e}_i\}$ 中表示为 $\sum c_i {e}_i$，那么它变换后的向量就是 $T v=T\sum c_i {e}_i=\sum c_iT {e}_i$。如果向量组 $\{T {e}_i\}$ 是线性相关的，那么就意味着存在并非全为零的 $\{c_i\}$ 使得 $T v=\sum c_iT {e}_i=0$；而 $\{c_i\}$ 并非全为零意味着 $v$ 不是零向量。这就是说，退化的线性算子会把一些非零向量变换成零向量。

\begin{exercise}{}
如果线性算子非退化，那么非零向量有可能被变换为零向量吗？提示：退化和非退化的区别在于基做了线性算子后得到的向量组还是不是线性无关的，或者说还是不是一组基。
\end{exercise}

\subsection{不同基底下线性算子对应的矩阵}\label{sub_LiOper_1}


\addTODO{移动到线性映射的矩阵表示}
\begin{theorem}{}\label{the_LiOper_1}
如果
\begin{equation}
\mathcal{A} e_k = \sum_i^{n}a_{ik} e_i~, \mathcal{B} e_j = \sum_{k=1}^n b_{kj} e_k~.
\end{equation}
是线性空间 $V$ 在基底 $( e_i)$ 之下以 $\mat A=(a_{ij}), \mat B=(b_{kj})$ 为矩阵的线性算子，那么，算子 $\mathcal{AB}$ 在同一基底下的矩阵是 $\mat C=\mat{AB}$
\end{theorem}

\textbf{证明：}
\begin{equation}
\begin{aligned}
\sum_i c_{ij} e_i&=(\mathcal{AB}) e_j=\mathcal{A}(\mathcal{B} e_j)=\mathcal{A}\qty(\sum_k b_{kj} e_k)=\sum_k b_{kj}\mathcal{A} e_k\\
&=\sum_k b_{kj}\sum_i a_{ik} e_i=\sum_{i,k}a_{ik}b_{kj} e_i=\mat{AB} e_i~.
\end{aligned}
\end{equation}
\textbf{证毕！}

\begin{theorem}{}\label{the_LiOper_2}
若线性算子 $\mathcal A$ 在基底 $( e_1\cdots  e_n)$ 下对应矩阵为 $\mat A$，则在另一基底  $( e'_1\cdots  e'_n)$ 之下对应的矩阵 $\mat A'$ 为
\begin{equation}
\mat A'=\mat B^{-1}\mat{AB}~,
\end{equation}
其中 $\mat B$ 为基底 $( e_i)$ 向基底 $( e_j')$ 的过渡矩阵\upref{TransM}.
\end{theorem}

\textbf{证明：}
由定理条件，若设 $\mat A=(a_{ij}), \mat A'=(a_{kj}'),\mat B=(b_{ij})$ ，则
\begin{equation}
\begin{aligned}
&\mathcal{A} e_i=\sum_{k} a_{ki} e_k
~,\\
&\mathcal{A} e_j'=\sum_{k} a'_{kj} e'_k~,\\
& e_j'=\sum_i b_{ij} e_i~.
\end{aligned}
\end{equation}
引入算子 $\mathcal{B}$ ，它在基底 $( e_1\cdots  e_n)$ 下对应的矩阵为 $\mat B$ ，那么
\begin{equation}
\mathcal{B} e_j=\sum_i b_{ij} e_i= e_j'~.
\end{equation}

由于线性算子与矩阵之间在固定基底之下一一对应，所以可定义一算子 $\mathcal{A'}$ ，它在基底 $( e_1\cdots  e_n)$ 之下对应的矩阵为 $\mat A'$ ，即
\begin{equation}
\mathcal A' e_j=\sum_i a'_{ij} e_i~.
\end{equation}
于是
\begin{equation}
\mathcal{AB} e_j=\mathcal{A} e'_j=\sum_i a'_{ij}  e'_i=\sum_i a'_{ij}\mathcal{B} e_i=\mathcal{B}\qty(\sum_i a'_{ij} e_i)=\mathcal{BA'} e_j~,
\end{equation}
于是 
\begin{equation}
\mathcal{A'}=\mathcal{B}^{-1}\mathcal{AB}~.
\end{equation}
由\autoref{the_LiOper_1} ，上式对应的矩阵的形式就为
\begin{equation}
\mat A'=\mat B^{-1}\mat{AB}~.
\end{equation}
\textbf{证毕}！


\addTODO{移动到线性代数的矩阵部分}
\begin{definition}{相似矩阵}
称矩阵 $\mat A'$ \textbf{相似于}矩阵 $\mat A$ ，如果存在可逆矩阵 $\mat B$ ，使得
\begin{equation}
\mat A'=\mat B^{-1}\mat{AB}~,
\end{equation}
并记作 $\mat A'\sim \mat A$ 。
\end{definition}
容易验证，矩阵的相似关系是一种等价关系\autoref{sub_Relat_1}~\upref{Relat}.

\autoref{the_LiOper_2} 表明，每一个线性算子都对应一个相似矩阵类（所以相似的矩阵构成的集合），而其中每一矩阵都相当于同一线性算子在不同基底下的矩阵。
\subsection{线性算子的行列式与迹}\label{sub_LiOper_2}
设 $\mathcal{A}$ 对应矩阵为 $A$ ，则\autoref{the_trace_1}~\upref{trace} 
\begin{equation}\label{eq_LiOper_3}
\begin{aligned}
&\mathrm{det}(\mat B^{-1}\mat{AB})=\mathrm{det}(\mat A)~,\\
&\mathrm{tr}\;(\mat B^{-1}\mat{AB})=\mathrm{tr}\;(\mat{ABB}^{-1})=\mathrm{tr}\;(\mat A)~.
\end{aligned}
\end{equation}
\begin{definition}{}
称
$
\mathrm{det}\;\mathcal{A}=\mathrm{det}\;A
$
为线性算子$\mathcal{A}$的\textbf{行列式}。

称
$
\mathrm{tr}\;\mathcal{A}=\mathrm{tr}\;A
$
为线性算子 $\mathcal{A}$ 的\textbf{迹}。
\end{definition}
\autoref{eq_LiOper_3} 表明，线性算子 $\mathcal{A}$ 的行列式和迹是 $\mathcal{A}$ 的不变量，即这个定义是适当的。


