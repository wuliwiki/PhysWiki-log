% 泊松方程
% 拉普拉斯方程|泊松方程|非齐次

\pentry{拉普拉斯方程\upref{LapEq}}

\footnote{参考 Wikipedia \href{https://en.wikipedia.org/wiki/Poisson's_equation}{相关页面}。}三维空间的\textbf{泊松方程（Poisson's equation）}可以记为
\begin{equation}
\Delta u=f(x, y, z)~,
\end{equation}
泊松方程可以看做是非齐次的拉普拉斯方程。

泊松方程与时间无关，显然不适用冲量定理法。我们可以采用特解法。先不管边界条件，任取这泊松方程的一个特解 $v$，然后令 $u=v+w$。这就把问题转化为求解 $w$，而 $\Delta w=\Delta u-\Delta v=\Delta u-f=0$，这不再是泊松方程而是拉普拉斯方程。在一定边界条件下求解拉普拉斯方程是我们之前研究过的问题。

\begin{example}{}
在圆域 $\rho<\rho_0$ 上求解泊松方程的边值问题：
\begin{equation}
\left\{\begin{array}{l}\Delta u=a+b\left(x^{2}-y^{2}\right) \\ \left.u\right|_{\rho=\rho_{0}}=c\end{array}~,\right.
\end{equation}

先设法找泊松方程的一个特解。显然 $\Delta (ax^2/2)=a, \Delta (ay^2/2)=a$，为了对称起见，取 $a(x^2+y^2)/4$。又 $\Delta (bx^4/12)=bx^2,\Delta (by^4/12)=by^2$。这样，找到一个特解
\begin{equation}
    \begin{array}{l}=\frac{a}{4}\left(x^{2}+y^{2}\right)+\frac{b}{12}\left(x^{4}-y^{4}\right)=\frac{a}{4} \rho^{2}+\frac{b}{12}\left(x^{2}+y^{2}\right)\left(x^{2}-y^{2}\right) \\ =\frac{a}{4} \rho^{2}+\frac{b}{12} \rho^{4} \cos 2 \varphi\end{array}~,
\end{equation}
令
\begin{equation}
    u=v+w=\frac{a}{4} \rho^{2}+\frac{b}{12} \rho^{4} \cos 2 \varphi+w~.
\end{equation}
就把问题转化为 $w$ 的定解问题：
\begin{equation}
    \left\{\begin{array}{l}\Delta w=0 \\ \left.w\right|_{\rho=\rho_{0}}=c-\frac{a}{4} \rho_{0}^{2}-\frac{b}{12} \rho_{0}^{4} \cos 2 \varphi\end{array}~.\right.
\end{equation}
在极坐标系中用分离变数法求解拉普拉斯方程，即
\begin{equation}
    \begin{aligned} w(\rho, \varphi)=& C_{0}+D_{0} \ln \rho+\sum_{m=1}^{\infty} \rho^{m}\left(A_{m} \cos m \varphi+B_{m} \sin m \varphi\right) \\ &+\sum_{i}^{\infty} \rho^{-m}\left(C_{m} \cos m \varphi+D_{m} \sin m \varphi\right) \end{aligned}~,
\end{equation}
$w $ 在圆内应当处处有限。但上式的 $\ln \rho $ 和 $\rho^{-m}$ 在圆心为无限大，所以应当排除，就是说 $D_0=0,C_m=0,D_m=0$。于是，
\begin{equation}
    w(\rho, \varphi)=\sum_{m=0}^{\infty} \rho^{m}\left(A_{m} \cos m \varphi+B_{m} \sin ^{+} m \varphi\right)~.
\end{equation}
把上式代入边界条件，
\begin{equation}
    \sum_{m=0}^{\infty} \rho_{0}^{m}\left(A_{m} \cos m \varphi+B_{m} \sin m \varphi\right)=c-\frac{a}{4} \rho_{0}^{2}-\frac{b}{12} \rho_{0}^{4} \cos 2 \varphi~.
\end{equation}
比较两边系数，得
\begin{equation}
    A_{0}=c-\frac{a}{4} \rho_{0}^{2}, A_{2}=-\frac{b}{12} \rho_{0}^{2}, A_{m}=0(m \neq 0,2) ; B_{m}=0~.
\end{equation}
这样，所求解是
\begin{equation}
    u=v+w=c+\frac{a}{4}\left(\rho^{2}-\rho_{0}^{2}\right)+\frac{b}{12} \rho^{2}\left(\rho^{2}-\rho_{0}^{2}\right) \cos 2 \varphi~.
\end{equation}
\end{example}

\begin{example}{}
    在矩形域 $0\leq x\leq a, 0\leq y\leq b$ 上求解泊松方程的边值问题
    \begin{equation}
        \Delta_{2} u=-2~,
    \end{equation}
    \begin{equation} \label{eq_PoiEqu_1}
        \left.u\right|_{x=0}=0,\left.u\right|_{x=a}=0~,
    \end{equation}
    \begin{equation}\label{eq_PoiEqu_2}
        \left.u\right|_{y=0}=0,\left.u\right|_{y=b}=0~.
    \end{equation}
    先找泊松方程的一个特解 $v$，显然，$v=-x^2$ 满足 $\Delta v =-2$。其实，$v=-x^2+c_1x+c_2$（$c_1$ 和 $c_2$ 是两个积分常数）也满足 $\Delta v = -2$。我们打算选择适当的 $c_1$ 和 $c_2$，使 $v$ 满足齐次边界条件\autoref{eq_PoiEqu_1}。 容易看出，$c_1=a,c_2 = 0$.
    这样，
    \begin{equation}
        v(x,y) = x(a-x)
    \end{equation}
    令
    \begin{equation}
        u(x,y)=v+w=x(a-x)+w(x,y)~,
    \end{equation}
    把上式代入 $u$ 的定解问题，就把它转化为 $w $ 的定解问题
    \begin{equation} \label{eq_PoiEqu_3}
        \Delta w =0~,
    \end{equation}
    \begin{equation} \label{eq_PoiEqu_4}
        \left.w\right|_{x=0}=0,\left.w\right|_{x=a}=0~,
    \end{equation}
    \begin{equation} \label{eq_PoiEqu_5}
        \left.w\right|_{y=0}=x(x-a),\left.w\right|_{y=b}=x(x-a)~.
    \end{equation}
    显然，满足\autoref{eq_PoiEqu_3} 和\autoref{eq_PoiEqu_4} 的解可表为
    \begin{equation} \label{eq_PoiEqu_6}
        w(x, y)=\sum_{n=1}^{\infty}\left(A_{n} e^{\frac{n \pi y}{a}}+B_{n} e^{-\frac{n \pi y}{a}}\right) \sin \frac{n \pi x}{a}~.
    \end{equation}
    为确定系数 $A_n$ 和 $B_n$，以\autoref{eq_PoiEqu_6} 代入边界条件\autoref{eq_PoiEqu_5}，有
    \begin{equation}  \label{eq_PoiEqu_7}
        \begin{array}{l}\sum_{n=1}^{\infty}\left(A_{n}+B_{n}\right) \sin \frac{n \pi x}{a}=x(x-a) \\ \sum_{n=1}^{\infty}\left(A_{n} \mathrm{e}^{\frac{n \pi b}{a}}+B_{n} \mathrm{e}^{-\frac{n \pi b}{a}}\right) \sin \frac{n \pi x}{a}=x(x-a)~,\end{array}
    \end{equation}
    把\autoref{eq_PoiEqu_7} 的右边也展为傅里叶正弦级数：
    \begin{equation} \label{eq_PoiEqu_8}
        x(x-a)=\sum_{n=1}^{\infty} C_{n} \sin \frac{n \pi x}{a}~.
    \end{equation}
    其中
    \begin{equation}
        C_{n}=\frac{2}{a} \int_{0}^{a}\left(x^{2}-a x\right) \sin \frac{n \pi x}{a} \mathrm{d} x=\frac{4 a^{2}}{n^{3} \pi^{3}}\left[(-1)^{n}-1\right]~,
    \end{equation}
    以\autoref{eq_PoiEqu_8} 代入\autoref{eq_PoiEqu_7} 的两边，比较两边的傅里叶系数，
    \begin{equation}
        \begin{array}{c}A_{n}+B_{n}=C_{n} \\ A_{n} \mathrm{e}^{\frac{n \pi b}{a}}+B_{n} \mathrm{e}^{-\frac{n \pi b}{a}}=C_{n}~.\end{array}
    \end{equation}
    由此可得
    \begin{equation}
        \begin{aligned}
            A_n&=\frac{1-\text{e}^{-n\pi b/a}}{\text{e}^{n\pi b/a}-\text{e}^{-n\pi b/a}}C_n=\frac{\text{e}^{-n\pi b/2a}\left( \text{e}^{n\pi b/2a}-\text{e}^{-n\pi b/2a} \right)}{\text{e}^{n\pi b/a}-\text{e}^{-n\pi b/a}}\\
            &=\frac{\text{e}^{-n\pi b/2a}}{\text{e}^{n\pi b/2a}+\text{e}^{-n\pi b/2a}}C_n=\frac{\text{e}^{-n\pi b/2a}}{\cosh \left( n\pi b/2a \right)}C_n\\
            B_n&=\frac{\text{e}^{n\pi b/a}-1}{\text{e}^{n\pi b/a}-\text{e}^{-n\pi b/a}}C_n=\frac{\text{e}^{n\pi b/2a}\left( \text{e}^{n\pi b/2a}-\text{e}^{-n\pi b/2a} \right)}{\text{e}^{n\pi b/a}-\text{e}^{-n\pi b/a}}\\
            &=\frac{\text{e}^{n\pi b/2a}}{\text{e}^{n\pi b/2a}+\text{e}^{-n\pi b/2a}}C_n=\frac{\text{e}^{n\pi b/2a}}{\cosh \left( n\pi b/2a \right)}C_n\\~.
        \end{aligned}
    \end{equation}
    于是代回\autoref{eq_PoiEqu_6} 成为
    \begin{equation}
        w(x, y)=\sum_{n=1}^{\infty} \frac{\cosh [n \pi(y-b / 2) / a]}{\cosh (n \pi b / 2 a)} C_{n} \sin \frac{n \pi x}{a}~.
    \end{equation}
    我们又知道，对于 $n=2k(k=1,2,\ddots)$，$C_n=0$。对于 $n=2k-1(k=1,2,\ddots)$, $C_n=-8a^2/(2k-1)^3\pi^3$。这样，
    \begin{equation}
        w(x, y)=-\frac{8 a^{2}}{\pi^{3}} \sum_{k=1}^{\infty} \frac{\cosh [(2 k-1) \pi(y-b / 2) / a]}{(2 k-1)^{3} \cosh [(2 k-1) \pi b / 2 a]} \sin \frac{(2 k-1) \pi x}{a}~,
    \end{equation}
    把 $w(x,y)$ 加上 $x(x-a)$ 就是所求的 $u(x,y)$。
\end{example}
