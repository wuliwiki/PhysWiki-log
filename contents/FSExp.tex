% 傅里叶级数（指数）
% keys 微积分|傅里叶级数|欧拉公式|狄利克雷条件|指数函数|三角函数|函数基底
% license Xiao
% type Tutor

\pentry{傅里叶级数（三角）\nref{nod_FSTri}， 欧拉公式\nref{nod_CExp}}{nod_3a49}
$f(x)$ 是自变量为实数的复变函数，若满足狄利克雷条件，则可在区间 $[- l,l]$ 展开成复数的傅里叶级数
\begin{equation}\label{eq_FSExp_1}
f(x) = \sum_{n =  - \infty }^{ + \infty } c_n \exp ( \I\frac{n\pi }{l}x )~.
\end{equation}
其中 $c_n$ 是复常数， 可以用定积分\upref{DefInt}计算
\begin{equation}\label{eq_FSExp_2}
c_n = \frac{1}{2l} \int_{ - l}^l  f(x)\exp( -\I\frac{n\pi }{l}x ) \dd{x} ~.
\end{equation}
当 $f(x)$ 为实函数时，$c_n$ 与 $c_{-n}$ 互为复共轭。当 $f(x)$ 为偶函数或奇函数时，分别有 $c_{-n} = c_n$ 或 $c_{-n} = -c_n$。

要特别注意的是， 严格来说\autoref{eq_FSExp_1} 并不能用等号。 因为若函数 $f(x)$ 在某点不连续， 在该点处等式右边的级数未必会收敛到 $f(x)$。 对此本文并不过多讨论， 且为了方便仍然使用等号。

\subsection{几何理解}
若把\autoref{eq_FSExp_1} 中的 $x$ 改成时间 $t$， 那么 $f(t)$ 可以看作是复平面上一个点随时间的运动。 而根据欧拉公式（\autoref{eq_CExp_2}~\upref{CExp}）， \autoref{eq_FSExp_1} 中的每一项， 则是平面上一个矢量的匀速圆周运动（$n=0$ 的项是例外， 它不随时间变化）。 由于复数的加法相当于复平面上矢量的相加（\autoref{fig_GVecOp_1}~\upref{GVecOp}）， 那么 $f(t)$ 所代表的运动就是从坐标原点出发， 把所有这些做圆周运动的矢量首尾相接后， 最后一个矢量的末端的运动。

\begin{figure}[ht]
\centering
\includegraphics[width=10cm]{./figures/786b152986bcaf62.png}
\caption{动画见\href{https://wuli.wiki/apps/FFTplt.html}{这里}。 这里的曲线使用小时百科的图标\upref{xwLogo}。 代码见 “用傅里叶级数画曲线（Matlab）\upref{FFTdrw}”。} \label{fig_FSExp_1}
\end{figure}

根据\autoref{eq_FSExp_1}， 第 $n$ 个圆周运动的角速度为 $\omega_n = n\pi/l$， 注意逆时针为正， 顺时针为负。 周期为 $T_n = 2\pi/\omega = 2l/n$（$n\ne 0$）。 也就是说在一个周期内， $n=1$ 的圆周运动在时间 $T = 2l$ 内逆时针转一圈， $n=2$ 的逆时针转两圈， $n=-1$ 的顺时针转一圈， $n=-2$ 的顺时针转两圈……

\subsection{推导}
类比三角傅里叶级数\upref{FSTri}的情况。这时，完备正交归一的函数基底变为
\begin{equation}\label{eq_FSExp_3}
f_n(x) = \exp( \I\frac{n\pi }{l}x ) \quad{n \in N}~.
\end{equation} 
定义复函数 $f(x)$ 与 $g(x)$ 的内积为
\begin{equation}
\braket{f}{g} = \int_{-l}^{l}  f(x)\Cj g(x) \dd{x}~.
\end{equation}
可证明函数基底（\autoref{eq_FSExp_3} ）正交且模长为 $2l$， 用克罗内克 $\delta$ 函数%未完成：文章
表示为
\begin{equation}\label{eq_FSExp_4}
\braket{f_m}{f_n} = 2l \delta_{mn}~.
\end{equation}
与三角傅里叶级数同理，可得\autoref{eq_FSExp_1} 和\autoref{eq_FSExp_2}。

\subsection{与三角傅里叶级数的关系}
根据欧拉公式（\autoref{eq_CExp_2}~\upref{CExp}）， 可以写出正余弦函数和复指数函数的关系
\begin{equation}
\cos x = \frac{\E^{\I x} + \E^{-\I x}}{2}, \qquad
\sin x = \frac{\E^{\I x} - \E^{-\I x}}{2\I}~.
\end{equation}
三角傅里叶级数的系数\autoref{eq_FSTri_2}~\upref{FSTri} 和\autoref{eq_FSTri_3}~\upref{FSTri}可以用指数傅里叶级数的系数表示
\begin{equation}
\ali{
a_n &= \frac{1}{l}\int_{ - l}^l f( x )\cos (\frac{n\pi }{l}x) \dd{x}\\
&=  \frac{1}{2l}\int_{ - l}^l f( x )\exp(\I\frac{n\pi }{l}x) \dd{x} + \frac{1}{2l}\int_{ - l}^l f( x )\exp(-\I\frac{n\pi}{l}x) \dd{x} \\
&= c_n + c_{-n}~.
}\end{equation}
同理，
\begin{equation}\ali{
b_n &= \I(c_n - c_{-n})~.
}\end{equation}
注意这里全都有 $n\geqslant 0$。 由以上两式，也可以解得
\begin{equation}\label{eq_FSExp_9}
c_n = \frac{a_n - \I b_n}{2}, \qquad
c_{-n} = \frac{a_n + \I b_n}{2}~.
\end{equation}

\subsection{实函数，奇函数，和偶函数的情况}
特殊地，当 $f(x)$ 为实函数时，由于 $a_n$ 和 $b_n$ 必定是实数，根据\autoref{eq_FSExp_9} 可知
\begin{equation}
c_{-n} = c_{n}\Cj~.
\end{equation}
即正负系数互为复共轭。当 $f(x)$ 为偶函数或奇函数时， 三角傅里叶级数分别只有 $a_n$ 或 $b_n$ 不为零\upref{FSTri}， 同样根据\autoref{eq_FSExp_9} 可得，两种情况分别对应
\begin{equation}
c_{-n} = c_n =\frac{a_n}{2}, \qquad
c_{-n} = -c_n = \I \frac{b_n}{2}~.
\end{equation}
由以上两式可得，如果 $f(x)$ 既是实函数又是偶函数时，$c_n$ 和 $c_{-n}$ 是相等的实数，如果既是实函数又是奇函数，$c_n$ 和 $c_{-n}$ 是相反的纯虚数。

\subsection{性质}
\begin{equation}
\int_{-l}^l \abs{f^2(x)} \dd{x} =  2l\sum_n \abs{c_n}^2~.
\end{equation}
证明： 用狄拉克符号\upref{braket}记为 $\ket{f} = \sum_n c_n \ket{n}$， 利用基底的正交性（\autoref{eq_FSExp_4}）
\begin{equation}
\braket{f}{f} = \sum_i c_i^* \bra{i} \sum_j c_j \ket{j} = 2l \sum_{i,j} \abs{c_i}^2 \delta_{i,j} = 2l \sum_n \abs{c_n}^2~.
\end{equation}
如果把基底为正交归一化（每个基底 $\ket{n}$ 除以 $\sqrt{2l}$， 使得 $\braket{i}{j} = \delta_{i,j}$， 则有更简洁的关系
\begin{equation}\label{eq_FSExp_5}
\int_{-l}^l \abs{f^2(x)} \dd{x} =  \sum_n \abs{c_n}^2~.
\end{equation}
这叫做 \textbf{Parseval 定理}。

\subsection{任意区间的展开}
类比\autoref{sub_FSTri_2}~\upref{FSTri}中的讨论， 要用指数傅里叶级数展开 $[a, b]$ 区间的函数 $f(x)$， 一种方法是令 $l = (b - a)/2$， 并把\autoref{eq_FSExp_2} 的积分区间改为 $[a, b]$ 即可。 或者也可以取 $l > (b - a)/2$ 的任意实数。
