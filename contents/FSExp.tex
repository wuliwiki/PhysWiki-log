% 傅里叶级数（指数）
% 微积分|傅里叶级数|欧拉公式|狄利克雷条件|指数函数|三角函数|函数基底

\pentry{傅里叶级数（三角）\upref{FSTri}， 欧拉公式\upref{CExp}}
$f(x)$ 是自变量为实数的复变函数，若满足狄利克雷条件，则可展在区间 $[- l,l]$ 展开成复数的傅里叶级数
\begin{equation}\label{FSExp_eq1}
f(x) = \sum_{n =  - \infty }^{ + \infty } c_n \exp ( \I\frac{n\pi }{l}x )
\end{equation}
其中
\begin{equation}\label{FSExp_eq2}
c_n = \frac{1}{2l} \int_{ - l}^l  f(x)\exp( -\I\frac{n\pi }{l}x ) \dd{x} 
\end{equation}
当 $f(x)$ 为实函数时，$c_n$ 与 $c_{-n}$ 互为复共轭．当 $f(x)$ 为偶函数或奇函数时，分别有 $c_{-n} = c_n$ 或 $c_{-n} = -c_n$．

一个形象有趣的动画演示见 “用傅里叶级数画曲线（Matlab）\upref{FFTdrw}”．

\subsection{推导}
类比三角傅里叶级数\upref{FSTri}的情况．这时，完备正交归一的函数基底变为
\begin{equation}\label{FSExp_eq3}
f_n(x) = \exp( \I\frac{n\pi }{l}x ) \quad{n \in N}
\end{equation} 
定义复函数 $f(x)$ 与 $g(x)$ 的内积为
\begin{equation}
\braket{f}{g} = \int_{-l}^{l}  f(x)\Cj g(x) \dd{x}
\end{equation}
可证明函数基底（\autoref{FSExp_eq3} ）正交且模长为 $2l$， 用克罗内克 $\delta$ 函数%未完成：词条
表示为
\begin{equation}\label{FSExp_eq4}
\braket{f_m}{f_n} = 2l \delta_{mn}
\end{equation}
与三角傅里叶级数同理，可得\autoref{FSExp_eq1} 和\autoref{FSExp_eq2}．

\subsection{与三角傅里叶级数的关系}
% 未完成
考虑到正余弦函数和复指数函数的关系
\begin{equation}
\cos x = \frac{\E^{\I x} + \E^{-\I x}}{2} \qquad
\sin x = \frac{\E^{\I x} - \E^{-\I x}}{2\I}
\end{equation}
三角傅里叶级数的系数\autoref{FSTri_eq2}~\upref{FSTri} 和\autoref{FSTri_eq3}~\upref{FSTri}可以用指数傅里叶级数的系数表示
\begin{equation}
\ali{
a_n &= \frac{1}{l}\int_{ - l}^l f( x )\cos (\frac{n\pi }{l}x) \dd{x}\\
&=  \frac{1}{2l}\int_{ - l}^l f( x )\exp(\I\frac{n\pi }{l}x) \dd{x} + \frac{1}{2l}\int_{ - l}^l f( x )\exp(-\I\frac{n\pi}{l}x) \dd{x} \\
&= c_{-n} + c_n
}\end{equation}
同理，
\begin{equation}\ali{
b_n &= \frac{c_{-n}-c_n}{\I}
}\end{equation}
注意这里全都有 $n\geqslant 0$． 由以上两式，也可以解得
\begin{equation}\label{FSExp_eq9}
c_n = \frac{a_n - \I b_n}{2} \qquad
c_{-n} = \frac{a_n + \I b_n}{2}
\end{equation}

\subsection{实函数，奇函数，和偶函数的情况}
特殊地，当 $f(x)$ 为实函数时，由于 $a_n$ 和 $b_n$ 必定是实数，根据\autoref{FSExp_eq9} 可知
\begin{equation}
c_{-n} = c_{n}\Cj
\end{equation}
即正负系数互为复共轭．当 $f(x)$ 为偶函数或奇函数时， 三角傅里叶级数分别只有 $a_n$ 或 $b_n$ 不为零\upref{FSTri}， 同样根据\autoref{FSExp_eq9} 可得，两种情况分别对应
\begin{equation}
c_{-n} = c_n =\frac{a_n}{2} \qquad
c_{-n} = -c_n = \I \frac{b_n}{2}
\end{equation}
由以上两式可得，如果 $f(x)$ 既是实函数又是偶函数时，$c_n$ 和 $c_{-n}$ 是相等的实数，如果既是实函数又是奇函数，$c_n$ 和 $c_{-n}$ 是相反的纯虚数．

\subsection{性质}
\begin{equation}
\int_{-l}^l \abs{f^2(x)} \dd{x} =  2l\sum_n \abs{c_n}^2
\end{equation}
证明： 用狄拉克符号记为 $\ket{f} = \sum_n c_n \ket{n}$， 利用基底的正交性（\autoref{FSExp_eq4}）
\begin{equation}
\braket{f}{f} = \sum_i c_i^* \bra{i} \sum_j c_j \ket{j} = 2l \sum_{i,j} \abs{c_i}^2 \delta_{i,j} = 2l \sum_n \abs{c_n}^2
\end{equation}
如果把基底为正交归一化（每个基底 $\ket{n}$ 除以 $\sqrt{2l}$， 使得 $\braket{i}{j} = \delta_{i,j}$， 则有更简洁的关系
\begin{equation}\label{FSExp_eq5}
\int_{-l}^l \abs{f^2(x)} \dd{x} =  \sum_n \abs{c_n}^2
\end{equation}

\subsection{任意区间}
\addTODO{任意区间 $[a, b]$ 的函数展开成傅里叶级数， 有多种方式， 取决于周期是多少， 或者区间两端的边界条件． $T = 2\pi/\Delta \omega$， $\Delta\omega$ 就是相邻两项的频率之差． 事实上只要 $T > b - a$ 都可以． 其实这比三角傅里叶级数要简单， 因为 $exp$ 里面的相位可以提到系数中．}
\addTODO{做一个二维漂亮闭合曲线， 展开成傅里叶级数， 做成动画．}
