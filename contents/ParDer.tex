% 偏导数（简明微积分）
% 多元微积分|导数|偏导数|混合偏导

\pentry{导数\upref{Der}}

对一个多元函数 $y = f(x_1, x_2 \dots x_i \dots)$，如果求导时只把 $x_i$ 看成自变量，剩下的 $x_{j \ne i}$ 都看做常数，得到的导数就叫函数（关于 $x_i$）的\textbf{偏导数}。 以二元函数 $z=f(x,y)$ 为例，对 $x$ 的偏导数常可记为以下几种表达式的其中之一\textbf{：} 
\begin{equation}\label{ParDer_eq1}
\pdv{z}{x}, \qquad \pdv{f}{x}, \qquad f_x,  \qquad \qty(\pdv{f}{x})_y
\end{equation}
最后一种记号在括号右下角声明了保持不变的自变量，这在许多情况下能避免混淆。

\begin{example}{}\label{ParDer_ex1}
对于函数 $f(x,y) = x^2 + 2 y^2 + 2xy$， 两个偏导数分别为
\begin{equation}
\pdv{f}{x} = 2x + 2y  \qquad  \pdv{f}{y} = 4y + 2x
\end{equation}
\end{example}

\begin{example}{}\label{ParDer_ex2}
对于函数 $z = \sin (y\cos x) + \cos ^2 x$
\begin{equation}
\begin{aligned}
\pdv{z}{x} &=  - y\cos (y\cos x)\sin x - 2\cos x\sin x =  - y\cos (y\cos x)\sin x - \sin 2x\\
\pdv{z}{y} &= \cos (y\cos x)\cos x
\end{aligned}
\end{equation}
\end{example}

\subsection{几何意义}
\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/ParDer_1.png}
\caption{偏导数} \label{ParDer_fig1}
\end{figure}
类比导数的几何意义（曲线的斜率）， 若在三维直角坐标系中画出曲面 $f(x,y)$，则 $\pdv*{f}{x}$ 和 $\pdv*{f}{y}$ 分别是是某点处曲面延 $x$ 方向和 $y$ 方向的斜率。所以从某点 $(x_0, y_0)$ 延 $x$ 方向移动一个微小量 $\Delta x$，假设曲面平滑，则函数值增加
\begin{equation}
\Delta f \approx \pdv{f}{x}\Delta x
\end{equation}
写成微分关系就是
\begin{equation}
\dd{f} = \pdv{f}{x} \dd{x} \quad (y\, \text{不变})
\end{equation}

\subsection{高阶偏导}
与一元函数的高阶导数类似，多元函数也可以求高阶偏导数，不同的是，由于每求一次偏导都需要指定对哪个变量。例如二元函数 $f(x,y)$ 的二阶偏导有
\begin{equation}
\pdv[2]{f}{x} \qquad
\pdv{f}{x}{y} \qquad
\pdv{f}{y}{x} \qquad
\pdv[2]{f}{y}
\end{equation}
若高阶偏导的分母中出现不止一个变量，我们就称其为\textbf{混合偏导}。混合偏导的一个重要性质就是当函数的任意混合偏导均在某点 $M_0$ 连续时，偏导的顺序可以任意改变，例如上式中有 $\pdv*{f}{x}{y} = \pdv*{f}{y}{x}$。\\
以二元函数 $z=f(x,y)$ 为例，证明其混合偏导 $f_{xy}$ 和 $f_{yx}$ 在 $M_0(x_0,y_0)$ 连续时，$f_{xy}|_{M_0}=f_{yx}|_{M_0}$。\\


\addTODO{这个证明不应该出现在简明微积分}
\textbf{证}：
考虑差商
\begin{equation}
I=\frac{[f(x_0+\Delta x,y_0+\Delta y)-f(x_0+\Delta x,y_0)]-[f(x_0,y_0+\Delta y)-f(x_0,y_0)]}{\Delta x\Delta y}\\
\end{equation}
设
\begin{equation}
\begin{aligned} 
&\qquad\varphi(x)=f(x,y_0+\Delta y)-f(x,y_0),\\
&\qquad\psi(y)=f(x_0+\Delta x,y)-f(x_0,y),\\
\end{aligned}
\end{equation}
那么利用微分中值定理可得
\begin{equation}
\begin{aligned} 
&I=\frac{[f(x_0+\Delta x,y_0+\Delta y)-f(x_0+\Delta x,y_0)]-[f(x_0,y_0+\Delta y)-f(x_0,y_0)]}{\Delta x\Delta y}\\
&\ \ =\frac{\varphi(x_0+\Delta x)-\varphi(x_0)}{\Delta x\Delta y}\\
&\ \ =\frac{\varphi'(x_0+\alpha_1\Delta x)\Delta x}{\Delta x\Delta y}\\
&\ \ =\frac{f_x(x_0+\alpha_1\Delta x,y_0+\Delta y)-f_x(x_0+\alpha_1\Delta x,y_0)}{\Delta y}\\
&\ \ =f_{xy}(x_0+\alpha_1\Delta x,y_0+\alpha_2\Delta y)\qquad(0<\alpha_1,\alpha_2<1)\\
\end{aligned}
\end{equation}
同理，将 $I$ 重新组合可以得到
\begin{equation}
\begin{aligned} 
&I=f_{yx}(x_0+\alpha_4\Delta x,y_0+\alpha_3\Delta y)\qquad(0<\alpha_3,\alpha_4<1)\\
\end{aligned}
\end{equation}
因此
\begin{equation}
\begin{aligned} 
&\qquad f_{xy}(x_0+\alpha_1\Delta x,y_0+\alpha_2\Delta y)=f_{yx}(x_0+\alpha_4\Delta x,y_0+\alpha_3\Delta y)\\
\end{aligned}
\end{equation}
利用两个混合偏导 $f_{xy}$ 和 $f_{yx}$ 在点 $(x_0,y_0)$ 连续的条件，得到
\begin{equation}
\begin{aligned} 
&f_{xy}(x_0,y_0)=\lim_{(\Delta x,\Delta y)\to(0,0)}f_{xy}(x_0+\alpha_1\Delta x,y_0+\alpha_2\Delta y)\\
&\qquad\qquad\ =\lim_{(\Delta x,\Delta y)\to(0,0)}f_{yx}(x_0+\alpha_4\Delta x,y_0+\alpha_3\Delta y)\\
&\qquad\qquad\ =f_{yx}(x_0,y_0)
\end{aligned}
\end{equation}









