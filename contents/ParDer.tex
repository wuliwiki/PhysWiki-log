% 偏导数（简明微积分）
% 多元微积分|导数|偏导数|混合偏导

\pentry{导数\upref{Der}}

对一个多元函数 $y = f(x_1, x_2 \dots x_i \dots)$，如果求导时只把 $x_i$ 看成自变量，剩下的 $x_{j \ne i}$ 都看做常数，得到的导数就叫函数（关于 $x_i$）的\textbf{偏导数}。 以二元函数 $z=f(x,y)$ 为例，对 $x$ 的偏导数常可记为以下几种表达式的其中之一： 
\begin{equation}\label{eq_ParDer_1}
\pdv{z}{x}~, \qquad \pdv{f}{x}~, \qquad f_x~,  \qquad \qty(\pdv{f}{x})_y~.
\end{equation}
最后一种记号在括号右下角声明函数中所有保持不变的自变量，这在一些情况下能避免混淆（见\autoref{sub_ParDer_1}）。

\begin{example}{}\label{ex_ParDer_3}
对于函数 $f(x,y) = x^2 + 2 y^2 + 2xy$， 两个偏导数分别为
\begin{equation}
\pdv{f}{x} = 2x + 2y~, \qquad  \pdv{f}{y} = 4y + 2x~.
\end{equation}
\end{example}

\begin{example}{}\label{ex_ParDer_2}
对于函数 $z = \sin (y\cos x) + \cos ^2 x$
\begin{equation}
\begin{aligned}
\pdv{z}{x} &=  - y\cos (y\cos x)\sin x - 2\cos x\sin x =  - y\cos (y\cos x)\sin x - \sin 2x~,\\
\pdv{z}{y} &= \cos (y\cos x)\cos x~.
\end{aligned}
\end{equation}
\end{example}

\subsection{几何意义}
\begin{figure}[ht]
\centering
\includegraphics[width=14cm]{./figures/b93564b6b517887d.png}
\caption{偏导数} \label{fig_ParDer_1}
\end{figure}
类比导数的几何意义（曲线的斜率）， 若在三维直角坐标系中画出曲面 $f(x,y)$，则 $\pdv*{f}{x}$ 和 $\pdv*{f}{y}$ 分别是是某点处曲面延 $x$ 方向和 $y$ 方向的斜率。所以从某点 $(x_0, y_0)$ 延 $x$ 方向移动一个微小量 $\Delta x$，假设曲面平滑，则函数值增加
\begin{equation}
\Delta f \approx \pdv{f}{x}\Delta x~,
\end{equation}
写成微分关系就是
\begin{equation}
\dd{f} = \pdv{f}{x} \dd{x} \qquad (y\, \text{不变})~.
\end{equation}

\subsection{通用函数名}\label{sub_ParDer_1}
物理中常常会出现一种容易混淆的情况，就是当一个因变量可以有几套自变量（例如上面的 $z(u,v)$ 和 $z(x,y)$）时，通常直接用因变量（$z$）作为函数名而另外不定义函数名（$f$）。然而 $z(u,v)$ 与 $z(x,y)$ 中的 $z$ 并不是同一个函数。以下举例说明

\begin{example}{} \label{ex_ParDer_1}
在二维直角坐标系中，定义一个曲面的方程为
\begin{equation}\label{eq_ParDer_7}
z=f(x,y)=x^2+y^2+2x~,
\end{equation}
而若用极坐标\upref{Polar}的方程描述该曲面， 则函数变为
\begin{equation}\label{eq_ParDer_8}
z = g(r,\theta) = f(r\cos \theta, r\sin \theta ) = r^2 + 2r\cos \theta~.
\end{equation}
但许多物理书为了方便并不用 $f$ 和 $g$ 区分两个不同的函数， 而是使用 $z(x,y)$ 表示\autoref{eq_ParDer_7} 和 $z(r,\theta)$ 表示\autoref{eq_ParDer_8}。这样后者就有可能被误解为
\begin{equation}
z(r,\theta) = r^2+\theta^2+2r \quad \text{(错)}~.
\end{equation}
这就需要从语境中判断是否使用了\textbf{通用函数名}\footnote{“通用函数名”是笔者起的名字， 不清楚是否有其他叫法}。

使用通用函数名时，要注意从语境中判断偏导数使用的是哪一套变量，例如 $\pdv*{z}{x}$ 一般默认使用 $z(x,y)$ 求偏导， 即把 $y$ 看成常数； $\pdv*{z}{r}$ 一般默认使用 $z(r,\theta)$ 求偏导， 即把 $\theta$ 看成常数。 或者为了明确起见可以分别把两种情况记为\autoref{eq_ParDer_1} 中的最后一种形式
\begin{equation}
\qty(\pdv{z}{x})_y~, \qquad \qty(\pdv{z}{r})_\theta~.
\end{equation}
这样， 把求偏导的变量和括号外的变量就是函数的自变量。

再看一种更复杂的情况， 如
\begin{equation}
\qty(\pdv{z}{x})_\theta~.
\end{equation}
按照上述定义，应该是仅用 $x$ 和 $\theta$ 表示 $z$，然后求偏导。 考虑极坐标系和直角坐标系的转换（\autoref{sub_Polar_1}~\upref{Polar}）， 有 $y=x\tan\theta$，代入\autoref{eq_ParDer_7} 得
\begin{equation}
z(x,\theta) = x^2(1+\tan^2 \theta) + 2x~,
\end{equation}
现在再对 $x$ 求偏导即可（过程略）。
\end{example}

\subsection{高阶偏导}
与一元函数的高阶导数类似，多元函数也可以求高阶偏导数，不同的是，由于每求一次偏导都需要指定对哪个变量。例如二元函数 $f(x,y)$ 的二阶偏导有：
\begin{equation}
\pdv[2]{f}{x}~, \qquad
\pdv{f}{x}{y}~, \qquad
\pdv{f}{y}{x}~, \qquad
\pdv[2]{f}{y}~.
\end{equation}
若高阶偏导的分母中出现不止一个变量，我们就称其为\textbf{混合偏导}。混合偏导的一个重要性质就是当函数的任意混合偏导均在某点 $M_0$ 连续时，偏导的顺序可以任意改变，例如上式中有 $\pdv*{f}{x}{y} = \pdv*{f}{y}{x}$。\\
以二元函数 $z=f(x,y)$ 为例，证明其混合偏导 $f_{xy}$ 和 $f_{yx}$ 在 $M_0(x_0,y_0)$ 连续时，$f_{xy}|_{M_0}=f_{yx}|_{M_0}$。\\


\addTODO{这个证明不应该出现在简明微积分}
\textbf{证}：
考虑差商
\begin{equation}
I=\frac{[f(x_0+\Delta x,y_0+\Delta y)-f(x_0+\Delta x,y_0)]-[f(x_0,y_0+\Delta y)-f(x_0,y_0)]}{\Delta x\Delta y}\\~.
\end{equation}
设
\begin{equation}
\begin{aligned} 
&\qquad\varphi(x)=f(x,y_0+\Delta y)-f(x,y_0)~,\\
&\qquad\psi(y)=f(x_0+\Delta x,y)-f(x_0,y)~,\\
\end{aligned}
\end{equation}
那么利用微分中值定理可得
\begin{equation}
\begin{aligned} 
&I=\frac{[f(x_0+\Delta x,y_0+\Delta y)-f(x_0+\Delta x,y_0)]-[f(x_0,y_0+\Delta y)-f(x_0,y_0)]}{\Delta x\Delta y}\\
&\ \ =\frac{\varphi(x_0+\Delta x)-\varphi(x_0)}{\Delta x\Delta y}\\
&\ \ =\frac{\varphi'(x_0+\alpha_1\Delta x)\Delta x}{\Delta x\Delta y}\\
&\ \ =\frac{f_x(x_0+\alpha_1\Delta x,y_0+\Delta y)-f_x(x_0+\alpha_1\Delta x,y_0)}{\Delta y}\\
&\ \ =f_{xy}(x_0+\alpha_1\Delta x,y_0+\alpha_2\Delta y)\qquad(0<\alpha_1,\alpha_2<1)~.\\
\end{aligned}
\end{equation}
同理，将 $I$ 重新组合可以得到
\begin{equation}
\begin{aligned} 
&I=f_{yx}(x_0+\alpha_4\Delta x,y_0+\alpha_3\Delta y)\qquad(0<\alpha_3,\alpha_4<1)~.\\
\end{aligned}
\end{equation}
因此
\begin{equation}
\begin{aligned} 
&\qquad f_{xy}(x_0+\alpha_1\Delta x,y_0+\alpha_2\Delta y)=f_{yx}(x_0+\alpha_4\Delta x,y_0+\alpha_3\Delta y)~.\\
\end{aligned}
\end{equation}
利用两个混合偏导 $f_{xy}$ 和 $f_{yx}$ 在点 $(x_0,y_0)$ 连续的条件，得到
\begin{equation}
\begin{aligned} 
&f_{xy}(x_0,y_0)=\lim_{(\Delta x,\Delta y)\to(0,0)}f_{xy}(x_0+\alpha_1\Delta x,y_0+\alpha_2\Delta y)\\
&\qquad\qquad\ =\lim_{(\Delta x,\Delta y)\to(0,0)}f_{yx}(x_0+\alpha_4\Delta x,y_0+\alpha_3\Delta y)\\
&\qquad\qquad\ =f_{yx}(x_0,y_0)~.
\end{aligned}
\end{equation}









