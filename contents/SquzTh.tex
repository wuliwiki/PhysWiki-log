% 夹逼定理
% keys 极限|函数|数列|序列
% license Xiao
% type Tutor

\begin{issues}
\issueDraft
\end{issues}
\pentry{极限定义 \nref{nod_Lim}，极限运算法则 \nref{nod_LimOp}}{nod_014c}
\textbf{夹逼定理}（Squeeze Theorem，或称夹挤定理）



夹逼定理（squeeze theorem），又称夹逼定理、夹极限定理、三明治定理、逼近定理、迫敛定理、两边夹定理等。其含义很直观：直观的含义是，如果有两个数列或者函数趋近于同一个极限，那么一直被这两个数列或者函数夹在中间的数列也必然趋近于这一极限。

举个例子：取数列$\{a_n\}, \{b_n\}, \{c_n\}$，如果$a_n=0$，$b_n=1/n^2$，$c_n=1/n$，那么在$n\to\infty$的过程中，一直有$a_n<b_n<c_n$，也就是$b_n$一直被夹在中间；由于$a_n$和$c_n$的极限相同，夹逼定理断言$b_n$的极限也跟它们一样。


这个例子过于平凡，因为很容易计算出这三个数列的极限，不需要夹逼定理，也能靠计算结果知道，三者的极限都是$0$。然而，实践中常遇到不知如何分析的极限，有时候就可以利用夹逼定理，将难以计算的数列或者函数夹在已经算出极限的数列和函数中间，绕过复杂的详细分析而得到答案。


一个特别经典的例子如下。

\begin{example}{正弦小角极限}

在\enref{函数的极限（极简微积分）}{FunLim}的\autoref{ex_FunLim_1} 和\enref{小角极限（极简微积分）}{LimArc}中提到
\begin{equation}
\lim_{x\to 0}\frac{\sin x}{x}=1~, 
\end{equation}
但并未证明。现在我们用夹逼定理就可以证明。

这个极限是一个关键节点，有了它才能顺利地计算出$\sin(x)$的导函数，进而得到大量实用的导函数，并开启微积分的大门。


\begin{figure}[ht]
\centering
\includegraphics[width=12cm]{./figures/ea5ad550659a2ee1.pdf}
\caption{正弦小角近似应用夹逼定理的示意图。图中点$A$和$C$都在单位圆上，点$B$在$OA$延长线上，$BC$垂直于横轴。} \label{fig_SquzTh_1}
\end{figure}


在平面直角坐标系中作单位圆，并取一个任意角度$x$，使得$0<x<\frac{\pi}{2}$，如\autoref{fig_SquzTh_1} 所示。图中三角形$AOC$底边$OC$长为$1$，高为$\sin x$，因此面积是$\frac{1}{2}\sin x$；三角形$BOC$底边$OC$长为$1$，高为$\tan x$，因此面积是$\frac{1}{2}\tan x$；扇形$ACO$的面积为$\frac{1}{2}x$。根据这三个几何图形的互相包含关系，可知它们的面积满足
\begin{equation}
\frac{1}{2}\sin x < \frac{1}{2}x < \frac{1}{2}\tan x~. 
\end{equation}
将该不等式中所有部分同时乘以$2$、取倒数、乘以$\sin x$，即可化为
\begin{equation}
1<\frac{\sin x}{x}<\cos x~. 
\end{equation}
于是，当$x\to 0^+$时，函数$\frac{\sin x}{x}$总是被夹在$1$和$\cos x$中间，而$1$和$\cos x$的极限都是$1$，从而得证$\lim\limits_{x\to 0^+}\frac{\sin x}{x}=1$。类似地，也可以得到$\lim\limits_{x\to 0^-}\frac{\sin x}{x}=1$，从而完整证明该小角极限。



\end{example}


夹逼定理果然很好用！

为了保证上述证明严谨，并且方便在更多场景准确应用夹逼定理，下面将准确表述夹逼定理并证明。




\subsection{定理表述与证明}







\begin{theorem}{数列极限的夹逼定理}\label{the_SquzTh_1}
若数列$\{a_n\}$,$\{b_n\}$以及$\{x_n\}$满足
\begin{enumerate}
\item $\exists N_0\in \mathbb{N}$，$\forall n>N_0$，$a_n\leq x_n\leq b_n$，
\item $n$趋于无穷时，$\{a_n\}$和$\{b_n\}$的极限存在且相等，即$\lim_{n\to\infty}a_n=\lim_{n\to\infty}b_n=m$；
\end{enumerate}
则$n$趋于无穷时，数列$\{x_n\}$的极限存在且
\begin{equation}
\lim_{n\to\infty}x_n =m.~
\end{equation}
\end{theorem}

\textbf{证明}：

由于$\lim_{n\to\infty}a_n=m$，可知对于任意$\varepsilon>0$，存在正整数$N_a$使得对于任意$n>N_a$，都有$\abs{a_n-m}<\varepsilon$。同理，对于同一个$\varepsilon>0$，存在正整数$N_b$使得对于任意$n>N_b$，都有$\abs{b_n-m}<\varepsilon$。

令$N_\varepsilon=\max\{N_a, N_b\}$，于是对于任意$n>N_\varepsilon$，都有$\abs{a_n-m}<\varepsilon$且$\abs{b_n-m}<\varepsilon$。由于$a_n\leq x_n$，可知$x_n>m-\varepsilon$；由于$x_n\leq b_n$，可知$x_n<m+\varepsilon$。综上，$\abs{x_n-m}<\varepsilon$。

上述结论可简写为：对于任意$\varepsilon>0$，存在正整数$N_\varepsilon$使得对于任意$n>N_\varepsilon$，都有$\abs{x_n-m}<\varepsilon$；意即$\lim\limits_{n\to\infty}x_n = m$。

\textbf{证毕}。






\begin{theorem}{函数极限的夹逼定理}\label{the_SquzTh_2}
若函数$f(x)$、$g(x)$以及$h(x)$满足
\begin{enumerate}
\item 存在确定的$\delta>0$，使得对任意符合$0<|x-x_0|<\delta$的$x$，都有$g(x)\leq f(x)\leq h(x)$，
\item $x$趋于$x_0$时，$h(x)$和$g(x)$的极限存在且相等，即$\lim _{x\to x_0}h(x)=\lim _{x\to x_0}g(x)=a$；
\end{enumerate}
则函数$f(x)$在$x_0$处的极限存在且
\begin{equation}
\lim _{x\to x_0}f(x)=a~.
\end{equation}
\end{theorem}



\textbf{证明}：

函数的极限定义为：若对于\textbf{任意}趋于$x_0$的数列$\{a_n\}$，数列$\{f(a_n)\}$趋于$a$，则称“在$x$趋于$x_0$的时候，函数$f(x)$趋于$a$”。

现在任取趋于$x_0$的数列$\{a_n\}$，则可构造出三个数列$\{f(a_n)\}$、$\{g(a_n)\}$和$\{h(a_n)\}$，由题设，根据数列极限的夹逼定理（\autoref{the_SquzTh_1} ）可知，$\lim\limits_{n\to\infty}f(a_n)=a$。由数列$\{a_n\}$的任意性，得证。

\textbf{证毕}。







\subsection{夹逼定理的奇技淫巧}

在面对不太容易通过极限运算得到结果的极限时，尤其是涉及到复合、求和等场景或存在比较显然的不等关系时，记得使用夹逼定理，可以收获奇效。事实上，在使用夹逼定理时，其实是把复杂的对极限的运算转移到了构造不等式上来。而且，就像乱拳打死老师傅，由于不需要考虑中间的极限是否存在，也能够避免一些需要讨论存在性的场景，避免出错（说的就是你，洛必达法则）。

当然，这里对于不等式的构造会有一定的要求，所以下面会提供一些常用的不等关系，一起服用，效果极佳。

\begin{itemize}
\item $\sin x < x < \tan x, \quad x \in \left(0, \frac{\pi}{2}\right)$
\item $\sin x \leq x, \quad x \in (0, +\infty)$
\item $\arctan x \leq x \leq \arcsin x, \quad x \in [0, 1] $
\item $x + 1\leq e^x$
\item $\ln x\leq x - 1 , \quad x \in (0, +\infty)$
\item $\frac{1}{1 + x} \leq \ln\left(1 + \frac{1}{x}\right) \leq \frac{1}{x}, \quad x \in (0, +\infty)$
\item $\sqrt{xy} \leq \frac{x + y}{2} \leq \sqrt{\frac{x^2 + y^2}{2}}, \quad (x, y > 0)$
\end{itemize}

\begin{example}{\addTODO{应用上述不等式的例题}}

\end{example}
另外，在处理求和的极限时，将与n相关的分子或分母进行放大或缩小，使其能够消去或易于计算，也是一个好方法。
\begin{example}{$\lim_{n\to \infty}\sum_{i=1}^n{i\over n^2+n+i}$}
\addTODO{求和的例题}
\end{example}



\begin{example}{设a是一个正整数，$\lim_{n\to\infty}\sqrt[n]{1^n+2^n+\cdots+a^n}$}
a
\end{example}
\begin{example}{设a是一个正整数，$\lim_{n\to\infty}{a^n\over n!}$}
0
\end{example}
\begin{example}{$\lim_{n\to\infty}\sum_{i=1}^n{n\over n^2+i\pi}$}
1
\end{example}
\begin{example}{$\lim_{n\to\infty}\sum_{i=1}^n{1\over\sqrt{n^2+i}}$}
1
\end{example}

\begin{example}{$\lim_{n\to\infty}\sqrt[n]{1^3+2^3+\cdots+n^3}$}
1
\end{example}
\subsection{数列极限的夹逼定理证明}

先回顾一下\autoref{the_SquzTh_1} 内容，下面给出证明：

已知$\lim_{n \to \infty} a_n = \lim_{n \to \infty} b_n = m$，由极限定义可知，对于给定的 $\varepsilon > 0$，存在一个正整数 $N_1$，使得当 $n > N_1$ 时，$|a_n - m| < \varepsilon$。同理，存在一个正整数 $N_2$，使得当 $n > N_2$ 时，$|b_n - m| < \varepsilon$。取$N_m = \max(N_1, N_2)$。当 $n > N_m$ 时，以上两不等式同时成立，即：
\begin{equation}
- \varepsilon < a_n-m <\varepsilon.~
\end{equation}
\begin{equation}
-\varepsilon < b_n-m <\varepsilon.~
\end{equation}

又已知$\exists N_0\in \mathbb{N}$，$\forall n>N_0$，$a_n\leq x_n\leq b_n$，因此，取$N=\max(N_0, N_m)$，当 $n > N$ 时，三个不等式均成立，有：
\begin{equation}
- \varepsilon < a_n-m \leq x_n-m \leq b_n-m <\varepsilon\implies |x_n-m|<\varepsilon.~
\end{equation}

根据极限的定义，可知极限存在且为$m$，即 $\lim_{n \to \infty} x_n = m$。

证毕。


\subsection{函数极限的夹逼定理证明}


先回顾一下\autoref{the_SquzTh_2} 的内容，下面会先证明一个引理，然后再给出证明。

\begin{lemma}{不等式一端为0时的极限}\label{lem_SquzTh_1}
若函数$f(x)$、$h(x)$满足：
\begin{enumerate}
\item 存在确定的$\delta>0$，使得对任意符合$0<|x-x_0|<\delta$的$x$，都有$0\leq f(x)\leq h(x)$；
\item $\lim _{x\to x_0}h(x)=0$。
\end{enumerate}
则函数$f(x)$在$x_0$处的极限存在且
\begin{equation}
\lim _{x\to x_0}f(x)=0~.
\end{equation}

证明：

由函数极限定义，取某个$\varepsilon>0$，满足$\delta>\delta_1>0$，$0<|x-x_0|<\delta_1\implies|h(x)|<\varepsilon$。

由于$0\leq f(x)\leq h(x)$，所以对$0<|x-x_0|<\delta_1$，有$|f(x)|\leq |h(x)|<\varepsilon$，即$|f(x)|<\varepsilon$。根据极限定义可知：$\lim _{x\to x_0}f(x)=0$。

\end{lemma}

证明：

由存在确定的$\delta>0$，使得对任意符合$0<|x-x_0|<\delta$的$x$，都有$g(x)\leq f(x)\leq h(x)$，变形可得$0\leq f(x)-g(x)\leq h(x)-g(x)$。目标是使用\autoref{lem_SquzTh_1} 来求取$\lim _{x\to x_0}(f(x)-g(x))$，因此，下面求$\lim _{x\to x_0}(h(x)-g(x))$。
$$
\begin{align*}
\lim _{x\to x_0}(h(x)-g(x))&\overset{\mathrm{1}}{=}\lim _{x\to x_0}h(x)-\lim _{x\to x_0}g(x)\\
&=a-a\\
&=0~.
\end{align*}
$$

因此，由\autoref{lem_SquzTh_1} 可知$\lim _{x\to x_0}(f(x)-g(x))=0$。现在已经求得了$\lim _{x\to x_0}(f(x)-g(x))$，又已知$\lim _{x\to x_0}g(x)$，剩下的就是：
$$
\begin{align*}
\lim _{x\to x_0}f(x) &= \lim _{x\to x_0}[(f(x)-g(x))+g(x)] \\ 
&\overset{\mathrm{1}}{=} \lim _{x\to x_0}(f(x)-g(x))+\lim _{x\to x_0}g(x)\\ 
&= 0+a\\ 
&=a~.\end{align*}
$$
上面的推导过程中，所有等号1的地方都使用了极限运算法则的\autoref{the_LimOp_1}。

证毕。
