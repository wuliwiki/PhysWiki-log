% 张量积空间
% 线性代数|多元微积分|矢量空间|傅里叶级数|二维傅里叶级数|基底|n维空间|张量积|张量积空间|分配律|子空间|分量|内积|部分内积|矩阵元|部分矩阵元|本征问题|基底展开

\pentry{多元函数的傅里叶级数\upref{NdFuri}， 子空间\upref{SubSpc}}

\subsection{定义}

我们以二维傅里叶级数来引入张量积的概念。 我们已知一维函数的傅里叶级数展开可以看做是一个矢量在一组正交归一基底上的展开， 自然地， 我们也希望能从矢量的空间的角度理解二维傅里叶级数展开。 为了讨论方便， 我们只讨论可以用有限项傅里叶级数展开的函数。

如果 $x$ 和 $y$ 方向分别取 $N_x$ 和 $N_y$ 个函数基底， 那么二维傅里叶级数中就有 $N_xN_y$ 个基底， 即被展开的函数是一个 $N_xN_y$ 维空间中的矢量。

观察二维傅里叶级数中的函数基底可以发现， 每一个基底都是一个 $N_x$ 维空间中的 $x$ 基底和一个 $N_y$ 维空间中的 $y$ 基底的乘积（两个一元函数相乘变为二元函数）。 从矢量的角度来看， 这是一种以前没有见过的矢量乘法， 它既不是数乘%链接未完成
（得到同维度的矢量）也不是内积%链接未完成
（得到标量）， 而是将两个不同矢量空间中的矢量相乘得到一个更高维空间中的矢量， 使新矢量的维度等于前两个矢量各自的维度相乘。 我们把这样的矢量乘法叫做\textbf{张量积}， 用狄拉克符号\upref{braket}记为
\begin{equation}
\ket{v} = \ket{x} \otimes \ket{y}~,
\end{equation}
我们把张量积得到的矢量所在的空间叫做\textbf{张量积空间}。 为了书写方便我们时常省略张量积号记为 $\ket{x}\ket{y}$， 或者将张量积的结果记为一个整体 $\ket{x, y} = \ket{v}$。

我们将两个一维傅里叶变换空间中的基底分别为 $\{\ket{x_i}\}$ 和 $\{\ket{y_j}\}$， 那么我们定义张量积空间为基底 $\{\ket{x_i}\ket{y_j}\}$ 张成的空间， 里面的任意矢量都可以用基底展开。
\begin{equation}
\ket{v} = \sum_{i,j} C_{ij}\ket{x_i, y_j}~.
\end{equation}

定义张量积满足\textbf{分配律}， 即两个低维空间中任意各选一个矢量 $\ket{x}$ 和 $\ket{y}$， 它们都可以在各自空间的基底中展开， 则它们的张量积为
\begin{equation}\label{eq_DirPro_2}
\ket{x}\ket{y} = \sum_i a_i\ket{x_i} \sum_j b_j\ket{y_j}
= \sum_{i,j} a_i b_j \ket{x_i, y_j}~.
\end{equation}

注意张量积空间的的任意一个矢量不一定可以表示为一个张量积运算， 例如 $\ket{x_1}\ket{y_1} + \ket{x_2}\ket{y_2}$ （$x_1, x_2$ 不共线， $y_1, y_2$ 不共线）。 也可类比函数的情况， $f_x(x)f_y(y)$ 可以记为 $f(x, y)$， 但 $f(x, y)$ 不一定能分解为 $f_x(x)f_y(y)$。

任何矢量空间的基底都需要有固定的顺序， 一旦确定在所有的计算中都不能改变。 张量积基底通常按照以下两种方式排序\footnote{由于这里每个基底都有两个角标， 使初学者有把基底排成长方形的冲动， 这是错误的。}
\begin{equation}\label{eq_DirPro_4}
\qty{\ket{x_1, y_1}, \ket{x_1, y_2}\dots  \ket{x_2, y_1}, \ket{x_2, y_2}\dots }~,
\end{equation}
\begin{equation}\label{eq_DirPro_5}
\qty{\ket{x_1, y_1}, \ket{x_2, y_1}\dots  \ket{x_1, y_2}, \ket{x_2, y_2}\dots }~.
\end{equation}
排序以后， 我们就可以用单下标来区分不同的基底， 令
\begin{equation}
\ket{x, y}_\alpha = \ket{x_i, y_j}~,
\end{equation}
对应两种排序， 分别有
\begin{equation}
\alpha = N_y (i-1) + j
\quad \text{或} \quad
\alpha = i + N_x (j-1)
\qquad 
(1 \leqslant \alpha \leqslant N_xN_y)~.
\end{equation}

\subsection{矢量的内积}

若我们需要在张量积空间中讨论模长和正交这样的概念就必须先定义\textbf{内积}： 张量积空间中两矢量（先假设它们可以表示为单个张量积）的内积等于把每个低维空间中对应矢量分别做内积再相乘。 即 $\ket{c}\ket{d}$ 和 $\ket{a}\ket{b}$ 的内积为
\begin{equation}
\qty(\bra{d}\bra{c})\qty(\ket{a}\ket{b})
= \bra{d}\braket{c}{a}\ket{b}
= \braket{c}{a}\braket{d}{b}~,
\end{equation}
注意 $\ket{c}\ket{d}$ 的厄米共轭%未完成
记为 $\bra{d}\bra{c}$ 而不是 $\bra{c}\bra{d}$。 这样就可以很容易看出需要把 $\braket{c}{a}$ 组合做内积而不是 $\braket{d}{a}$。 但如果把两矢量记为 $\ket{a, b}$ 和 $\ket{c, d}$， 那么内积记为\footnote{书写习惯上，ket 和对应的 bra 中的记号应保持相同。所以 $\ket{c, d}$ 的厄米共轭记为 $\bra{c, d}$ 而不是 $\bra{d, c}$。}
\begin{equation}
\braket{c, d}{a, b} = \braket{c}{a}\braket{d}{b}~,
\end{equation}

张量积空间中的内积是否满足交换律取决于两个低维空间中的内积是否满足交换律。 按照内积的一般性质 $\braket{u}{v} = \braket{v}{u}^*$， 所以张量积空间中的也有
\begin{equation}
\braket{a, b}{c, d} = \braket{a}{c}\braket{b}{d}
= \braket{c}{a}^*\braket{d}{b}^* = \braket{c, d}{a, b}^*~.
\end{equation}

如果两个低维空间中的基底都是正交归一的， 那么张量积空间中的基底也是正交归一的
\begin{equation}
\braket{x_{i'}, y_{j'}}{x_i, y_j} = \braket{x_{i'}}{x_i}\braket{y_{j'}}{y_j}
= \delta_{i,i'}\delta_{j,j'}~,
\end{equation}
以后我们一般讨论正交归一基底。

知道了张量积空间基底之间的内积后， 要计算张量积空间中任意两个矢量的内积， 只需先将它们分解到基底上， 再按照内积的分配律和正交归一化条件即可得到熟悉的内积公式
\begin{equation}\ali{
\braket{v'}{v} &= \qty(\sum_{i',j'} C'^*_{i',j'}\bra{y_{j'}}\bra{x_{i'}}) \qty( \sum_{i,j} C_{i,j} \ket{x_{i'}}\ket{y_{j'}}) \\
&= \sum_{i',j'} \sum_{i,j} C'^*_{i',j'} C_{i,j} \delta_{i,i'}\delta_{j,j'}
= \sum_{i,j} C'^*_{i,j} C_{i,j}~.
}\end{equation}

正交归一基底的\textbf{完备性}%未完成引用矢量空间的对应公式
仍然可以记为
\begin{equation}\label{eq_DirPro_13}
\sum_{i,j} \ket{x_i, y_j} \bra{x_i, y_j} = \Q I~,
\end{equation}
其中 $\Q I$ 是张量积空间的单位算符。

我们现在从张量积空间的角度来看二维傅里叶级数， 将被展开的函数记为矢量 $\ket{f}$， 则
\begin{equation}\label{eq_DirPro_14}
\ket{f} = \sum_\alpha C_\alpha\ket{x, y}_\alpha = \sum_{i,j} C_{i,j}\ket{x_i, y_j}~.
\end{equation}
其中
\begin{equation}\label{eq_DirPro_15}
C_{i,j} = \int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f_{x,i}(x) f_{y,j}(y) f(x, y) \dd{x}\dd{y}
= \braket{x_i, y_j}{f}~,
\end{equation}
我们可以验证基底的完备性（\autoref{eq_DirPro_13}）， 将\autoref{eq_DirPro_15} 代入\autoref{eq_DirPro_14} 得
\begin{equation}
\ket{f} = \sum_{i,j} \ket{x_i, y_j}\braket{x_i, y_i}{f}
= \qty(\sum_{i,j} \ket{x_i, y_j}\bra{x_i, y_i})\ket{f}~.
\end{equation}
对所有 $\ket{f}$ 都成立， 这就间接证明了\autoref{eq_DirPro_13}。

若张量积空间中一个矢量可以表示为单个张量积  $\ket{u}\ket{v}$， 则其基底展开为
\begin{equation}
\ket{u}\ket{v} = \qty(\sum_i a_i\ket{u_i}) \otimes \qty(\sum_j b_j \ket{v_j})
= \sum_{i,j} a_i b_j \ket{u_i, v_j}~.
\end{equation}

\subsection{张量积空间的子空间}

令 $\ket{u_i}$ 和 $\ket{v_j}$ 分别为两个低维空间的基底， 则张量积空间中存在两种 “天然” 的子空间。
一种将张量积基底根据 $i$ 的值分成许多组， 每组张成一个子空间。 同理， 也可以根据 $j$ 来划分子空间。 我们姑且分别称它们为 $u$ 子空间和 $v$ 子空间。

任意一个张量空间中的矢量可以看做是每个子空间中的一个矢量的线性组合
\begin{equation}
\ali{
\sum_{i,j} C_{ij}\ket{u_i}\ket{v_j} &= \sum_j \qty(\sum_i C_{ij}\ket{u_i}) \otimes \ket{v_j} = \sum_j \ket{a_j}\ket{v_j}\\
&= \sum_i \ket{u_i} \otimes \qty(\sum_j C_{ij}\ket{v_j})   = \sum_i \ket{u_i}\ket{b_i}~,
}\end{equation}
上式中的 $\ket{a_j}$ 可以理解为矢量在每个 $\ket{v_j}$ 子空间的\textbf{分量}（$u$ 空间的矢量）， $\ket{b_i}$ 理解为矢量在每个 $\ket{u_i}$ 子空间中的\textbf{分量}（$v$ 空间的矢量）。
