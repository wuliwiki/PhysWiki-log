% 电磁场角动量分解
% keys 电磁场|角动量|电磁波|轨道角动量
% license Xiao
% type Tutor

电磁场的动量为
\begin{equation}
\bvec p = \epsilon_0 \int \dd{V} \bvec E \cross \bvec B~.
\end{equation}
角动量为
\begin{equation}
\bvec J = \bvec r \cross \bvec p = \epsilon_0 \int \dd{V} \bvec r \cross \bvec E \cross (\curl \bvec A)~.
\end{equation}
现在假设电磁场只在一定范围内不为零， 且体积分的边界处场强为零。 假设该范围内没有净电荷与电流， 则
\begin{equation}\ali{
\bvec r \cross \bvec E \cross (\curl \bvec A) &= \bvec r \cross [\grad (\bvec E \vdot \bvec A) - \bvec A(\bvec E \vdot \bvec\nabla )]_{\partial A} \\
&= [(\bvec r \cross \bvec\nabla )(\bvec E \vdot \bvec A) - (\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial A}~.
}\end{equation}
其中转微分算符 $[\,]_{\partial A}$ 的作用是先把方括号内的 $\bvec\nabla$ 作为普通矢量进行计算， 再把展开结果中每一项的偏微分作用在 $A$ 的分量上。 上式第一项为 $\sum\limits_i {E_i} (\bvec r \cross \bvec\nabla ) A_i$， 第二项为
\begin{equation}
-[(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial A} =  - (\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A) + [(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial r}~.
\end{equation}
其中第二项为 $[(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial r} = [(\bvec E \vdot \bvec\nabla )\bvec r] \cross \bvec A = \bvec E \cross \bvec A$， 第一项中
\begin{equation}
\begin{aligned}
(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A) &= [(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial ErA} - [(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial E}\\
& = [(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial ErA}~,
\end{aligned}
\end{equation}
这是因为 $[(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial E} = (\div\bvec E)(\bvec r \cross \bvec A) = 0$。  综上，
\begin{equation}
\bvec J = \epsilon_0 \int \dd{V} \sum_i  E_i (\bvec r \cross \bvec\nabla ) A_i + \epsilon_0 \int \dd{V} \bvec E \cross \bvec A + \epsilon_0 \int \dd{V} [(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial ErA}~.
\end{equation}
现在证明最后一项为0。 以 $x$ 分量为例，
\begin{equation}
\begin{aligned}
\uvec x \int \dd{V} [(\bvec E \vdot \bvec\nabla )(\bvec r \cross \bvec A)]_{\partial ErA}  &= \int \dd{V} \div [\bvec E(\uvec x \vdot \bvec r \cross \bvec A) ] \\
&= \oint \dd{\bvec s} \bvec E(\uvec x \vdot \bvec r \cross \bvec A)  = 0~.
\end{aligned}
\end{equation}
最后一步是因为边界处场强为零。 现在我们可以看出角动量由两部分组成
\begin{equation}
\bvec J = \bvec L + \bvec S~, \qquad
\bvec L = \epsilon_0 \int \dd{V} \sum_i E_i (\bvec r \cross \bvec\nabla ) A_i ~,\qquad
\bvec S = \epsilon_0 \int \dd{V} \bvec E \cross \bvec A~.
\end{equation}
其中 $\bvec L$ 是轨道角动量， $\bvec S$ 是自旋角动量。
